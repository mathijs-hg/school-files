<!-- 
EMBA - EMBEDDED LINUX ANALYZER

Copyright 2020-2023 Siemens AG
Copyright 2020-2024 Siemens Energy AG

EMBA comes with ABSOLUTELY NO WARRANTY. This is free software, and you are
welcome to redistribute it under the terms of the GNU General Public License.
See LICENSE file for usage of this software.

EMBA is licensed under GPLv3

Author(s) and contributors from the EMBA project are listed here: https://github.com/e-m-b-a/emba/blob/master/CONTRIBUTORS.md
-->

<!-- Used icons: https://github.com/CoreyGinnivan/system-uicons -->
 
<!DOCTYPE html>
<html lang="en">
<head>
  <title>EMBA firmware report</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="./../../style/style.css" type="text/css">
  <link rel="icon" type="image/png" href="./../../style/favicon.png">
</head>
<body>

<div id="sidenav" class="side">
  <div id="logo">
    <a class="inherit" href="./../../index.html"><img class="inherit" id="logoImage" src="./../../style/emba.svg" alt="logo"></a>
  </div>
  <div id="nav">
      <a id="embark" class="hidden" href="{{ embarkBackUrl }}">&laquo; Back to EMBArk</a> <!-- nosem -->
      <a class="backButton" href="./../../index.html">&laquo; Back to main</a>
<a class="modul" href="./../semgrep_mDNSClientPosix.html" title="./../semgrep_mDNSClientPosix.html" >&laquo; Back to semgrep_mDNSClientPosix</a>
      <!-- navigation start -->
      <!-- navigation end -->
      <input id="expand" class="expand_njs hidden" type="button" value="More results:" onclick="this.value=this.value=='+ Show more results'?'- Hide more results':'+ Show more results';">
      <div class="expand_area">
        <!-- etc start -->
        <!-- etc end -->
      </div>
  </div>
  <a href="TIMELINK"><div id="buttonTimeInvisible" class="rectButton"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="white" stroke-linecap="round" stroke-linejoin="round" transform="matrix(-1 0 0 1 19 2)"><circle cx="8.5" cy="8.5" r="8"/><path d="M8.5 5.5v4H5"/></g></svg></div></a>
  <div id="buttonSizer" class="rectButton buttonClose" onclick="buttonNav()"></div>
</div>
<div id="main" class="main">
  <!-- content start -->
<br />
<pre>/* WARNING: Removing unreachable block (ram,0x0043dc64) */</pre>
<pre>/* WARNING: Removing unreachable block (ram,0x0043dcb8) */</pre>
<pre>/* WARNING: Could not reconcile some variable overlaps */</pre>
<br />
<pre>int FUN_0043cd50(int param_1,ushort *param_2,undefined4 param_3,int *param_4,int *param_5,</pre>
<pre>                byte param_6,byte param_7,byte param_8,int param_9)</pre>
<br />
<pre>{</pre>
<pre>  bool bVar1;</pre>
<pre>  bool bVar2;</pre>
<pre>  bool bVar3;</pre>
<pre>  undefined4 *puVar4;</pre>
<pre>  int iVar5;</pre>
<pre>  int **ppiVar6;</pre>
<pre>  undefined4 uVar7;</pre>
<pre>  int **ppiVar8;</pre>
<pre>  int *piVar9;</pre>
<pre>  int iVar10;</pre>
<pre>  int *piVar11;</pre>
<pre>  ushort *puVar12;</pre>
<pre>  undefined4 *puVar13;</pre>
<pre>  int iVar14;</pre>
<pre>  int iVar15;</pre>
<pre>  undefined4 *puVar16;</pre>
<pre>  int **ppiVar17;</pre>
<pre>  int *piVar18;</pre>
<pre>  undefined4 *puVar19;</pre>
<pre>  ushort *puVar20;</pre>
<pre>  int *piVar21;</pre>
<pre>  int **local_5b8;</pre>
<pre>  int ***local_5b4;</pre>
<pre>  int *local_5b0;</pre>
<pre>  int *local_5ac;</pre>
<pre>  int *piStack_5a8;</pre>
<pre>  int local_5a4;</pre>
<pre>  int local_564;</pre>
<pre>  undefined4 local_474;</pre>
<pre>  undefined auStack_454 [256];</pre>
<pre>  undefined4 local_354;</pre>
<pre>  undefined auStack_318 [340];</pre>
<pre>  int *apiStack_1c4 [64];</pre>
<pre>  undefined2 local_c4;</pre>
<pre>  undefined2 local_c2;</pre>
<pre>  int **local_88;</pre>
<pre>  int **local_84;</pre>
<pre>  undefined *local_80;</pre>
<pre>  int local_7c;</pre>
<pre>  uint local_78;</pre>
<pre>  int local_74;</pre>
<pre>  int local_70;</pre>
<pre>  int local_6c;</pre>
<pre>  int local_68;</pre>
<pre>  int local_64;</pre>
<pre>  uint local_60;</pre>
<pre>  int **local_5c;</pre>
<pre>  int **local_58;</pre>
<pre>  int **local_54;</pre>
<pre>  uint local_50;</pre>
<pre>  int *local_4c;</pre>
<pre>  int local_48;</pre>
<pre>  uint local_44;</pre>
<pre>  int local_40;</pre>
<pre>  int **local_3c;</pre>
<pre>  char *local_38;</pre>
<pre>  int *local_34;</pre>
<pre>  int **local_30;</pre>
<pre>  </pre>
<pre>  local_78 = (uint)param_6;</pre>
<pre>  local_60 = (uint)param_7;</pre>
<pre>  local_44 = (uint)param_8;</pre>
<pre>  if (param_4 == (int *)0x0) {</pre>
<pre>LAB_0043cdd4:</pre>
<pre>    local_48 = 0;</pre>
<pre>  }</pre>
<pre>  else {</pre>
<pre>    iVar5 = FUN_00426100(param_1,param_5,param_4);</pre>
<pre>    local_48 = 1;</pre>
<pre>    if (iVar5 == 0) goto LAB_0043cdd4;</pre>
<pre>  }</pre>
<pre>  local_5b4 = &amp;local_5b8;</pre>
<pre>  local_5b8 = (int **)0x0;</pre>
<pre>  local_5b0 = (int *)0x0;</pre>
<pre>  local_5ac = (int *)0x0;</pre>
<pre>  iVar5 = LocateOptRR(param_2,param_3,0xc);</pre>
<pre>  if (iVar5 != 0) {</pre>
<pre>    iVar5 = GetLargeResourceRecord(param_1,param_2,iVar5,param_3,param_5,0x80,param_1 + 0x7fa8);</pre>
<pre>    if (((iVar5 != 0) &amp;&amp; (*(char *)(param_1 + 0x7fac) != -0x10)) &amp;&amp;</pre>
<pre>       (ppiVar6 = (int **)0x4, *(short *)(param_1 + 0x7fae) == 0x29)) {</pre>
<pre>      puVar12 = (ushort *)(*(int *)(param_1 + 0x7fcc) + 4);</pre>
<pre>      puVar20 = (ushort *)((int)puVar12 + (uint)*(ushort *)(param_1 + 0x7fb8));</pre>
<pre>      for (; puVar12 &lt; puVar20; puVar12 = puVar12 + 0xc) {</pre>
<pre>        if ((((int **)(uint)*puVar12 == ppiVar6) &amp;&amp; (*(char *)(puVar12 + 2) == '\0')) &amp;&amp;</pre>
<pre>           (*(int *)(puVar12 + 3) != 0)) {</pre>
<pre>          local_3c = ppiVar6;</pre>
<pre>          FUN_0043cad4(param_1,puVar12 + 2,*(undefined4 *)(param_1 + 0x2164));</pre>
<pre>          FUN_0043cad4(param_1,puVar12 + 2,*(undefined4 *)(param_1 + 0x2160));</pre>
<pre>          ppiVar6 = local_3c;</pre>
<pre>        }</pre>
<pre>      }</pre>
<pre>    }</pre>
<pre>    *(undefined *)(param_1 + 0x7fac) = 0;</pre>
<pre>  }</pre>
<pre>  local_58 = (int **)(param_2 + 6);</pre>
<pre>  local_7c = param_1 + 0x7fac;</pre>
<pre>  local_80 = (undefined *)(param_1 + 0x7fa8);</pre>
<pre>  local_64 = param_1 + 0x2f;</pre>
<pre>  local_68 = 0;</pre>
<pre>  FUN_004382b0(param_1,param_2,param_3,param_5,&amp;local_5ac);</pre>
<pre>  local_54 = &amp;local_5b0;</pre>
<pre>  local_84 = &amp;piStack_5a8;</pre>
<pre>  local_88 = local_58;</pre>
<pre>  local_40 = param_9;</pre>
<pre>  piVar21 = (int *)0x0;</pre>
<pre>  local_4c = param_4;</pre>
<pre>LAB_0043d6b8:</pre>
<pre>  iVar5 = local_40;</pre>
<pre>  piVar18 = local_4c;</pre>
<pre>  if (local_68 &lt; (int)(uint)param_2[2]) {</pre>
<pre>    local_88 = (int **)getQuestion(param_2,local_88,param_3,param_5,local_84);</pre>
<pre>    piVar18 = local_4c;</pre>
<pre>    if (local_88 != (int **)0x0) {</pre>
<pre>      local_564 = 0;</pre>
<pre>      if (local_5ac != (int *)0x0) {</pre>
<pre>        InitializeAnonInfoForQuestion(param_1,&amp;local_5ac,local_84);</pre>
<pre>      }</pre>
<pre>      if ((local_60 == 0) || (local_78 != 0)) {</pre>
<pre>        local_50 = 0;</pre>
<pre>      }</pre>
<pre>      else {</pre>
<pre>        local_50 = (uint)~(int)local_354._2_2_ &gt;&gt; 0x1f;</pre>
<pre>      }</pre>
<pre>      if (local_354._2_2_ &lt; 0) {</pre>
<pre>        *(int *)(param_1 + 0x397c) = *(int *)(param_1 + 0x397c) + 1;</pre>
<pre>      }</pre>
<pre>      else {</pre>
<pre>        *(int *)(param_1 + 0x3980) = *(int *)(param_1 + 0x3980) + 1;</pre>
<pre>      }</pre>
<pre>      iVar5 = *(int *)(param_1 + 0x216c);</pre>
<pre>      local_354 = local_354 &amp; 0xffff7fff;</pre>
<pre>      if (iVar5 != 0) {</pre>
<pre>        uVar7 = GetRRDisplayString_rdb(iVar5 + 4,*(int *)(iVar5 + 0x24) + 4,local_64);</pre>
<pre>        LogMsgWithLevel(0,"ProcessQuery ERROR m-&gt;CurrentRecord already set %s",uVar7);</pre>
<pre>      }</pre>
<pre>      local_5c = (int **)&amp;SUB_fffffffe;</pre>
<pre>      if (local_78 != 0) {</pre>
<pre>        local_5c = local_88;</pre>
<pre>      }</pre>
<pre>      *(undefined4 *)(param_1 + 0x216c) = *(undefined4 *)(param_1 + 0x2160);</pre>
<pre>      local_6c = 0;</pre>
<pre>      puVar4 = (undefined4 *)0x0;</pre>
<pre>LAB_0043d538:</pre>
<pre>      do {</pre>
<pre>        puVar16 = puVar4;</pre>
<pre>        puVar13 = *(undefined4 **)(param_1 + 0x216c);</pre>
<pre>        puVar19 = puVar13 + 1;</pre>
<pre>        if (puVar13 == (undefined4 *)0x0) goto code_r0x0043d544;</pre>
<pre>        *(undefined4 *)(param_1 + 0x216c) = *puVar13;</pre>
<pre>        iVar5 = AnyTypeRecordAnswersQuestion(puVar19,local_84);</pre>
<pre>        puVar4 = puVar16;</pre>
<pre>        if (iVar5 != 0) {</pre>
<pre>          if (((local_44 != 0) || (local_60 != 0)) || (*(char *)((int)puVar13 + 0x49) != '\0')) {</pre>
<pre>            *(int *)(param_1 + 0x3984) = *(int *)(param_1 + 0x3984) + 1;</pre>
<pre>            if (((*(short *)((int)puVar13 + 6) == 5) ||</pre>
<pre>                (*(short *)((int)puVar13 + 6) == local_354._0_2_)) ||</pre>
<pre>               ((local_354._0_2_ == 0xff || (iVar5 = RRAssertsNonexistence(puVar19), iVar5 != 0))))</pre>
<pre>            {</pre>
<pre>              if (*(byte *)(puVar13 + 1) == 2) {</pre>
<pre>                bVar1 = false;</pre>
<pre>                local_74 = 0;</pre>
<pre>                local_70 = LocateAuthorities(param_2,param_3);</pre>
<pre>                while ((local_74 &lt; (int)(uint)param_2[4] &amp;&amp;</pre>
<pre>                       (local_70 = GetLargeResourceRecord</pre>
<pre>                                             (param_1,param_2,local_70,param_3,local_474,0xa0,</pre>
<pre>                                              local_80), local_70 != 0))) {</pre>
<pre>                  if ((*(char *)(param_1 + 0x7fac) != -0x10) &amp;&amp;</pre>
<pre>                     (iVar5 = ResourceRecordAnswersQuestion(local_7c,local_84), iVar5 != 0)) {</pre>
<pre>                    iVar5 = FUN_0042d4d0(param_1,puVar13,local_80);</pre>
<pre>                    bVar1 = true;</pre>
<pre>                    if (iVar5 != 0) {</pre>
<pre>                      iVar5 = (uint)*(ushort *)(puVar13 + 2) - (uint)*(ushort *)(param_1 + 0x7fb0);</pre>
<pre>                      if (((iVar5 == 0) &amp;&amp;</pre>
<pre>                          (iVar5 = (uint)*(ushort *)((int)puVar13 + 6) -</pre>
<pre>                                   (uint)*(ushort *)(param_1 + 0x7fae), iVar5 == 0)) &amp;&amp;</pre>
<pre>                         (iVar5 = FUN_0042df20(puVar13,local_80), iVar5 == 0)) {</pre>
<pre>                        bVar1 = true;</pre>
<pre>                      }</pre>
<pre>                      else {</pre>
<pre>                        local_38 = "lost:";</pre>
<pre>                        if (-1 &lt; iVar5) {</pre>
<pre>                          local_38 = "won: ";</pre>
<pre>                        }</pre>
<pre>                        local_34 = *(int **)(param_1 + 0x7fc0);</pre>
<pre>                        local_30 = (int **)local_474;</pre>
<pre>                        uVar7 = GetRRDisplayString_rdb</pre>
<pre>                                          (local_7c,*(int *)(param_1 + 0x7fcc) + 4,local_64);</pre>
<pre>                        LogMsgWithLevel(0,"ResolveSimultaneousProbe: %p Pkt Record:        %08lX %s"</pre>
<pre>                                        ,local_30,local_34,uVar7);</pre>
<pre>                        local_3c = (int **)puVar13[7];</pre>
<pre>                        local_34 = (int *)(uint)*(byte *)((int)puVar13 + 0x86);</pre>
<pre>                        local_30 = (int **)puVar13[6];</pre>
<pre>                        uVar7 = GetRRDisplayString_rdb(puVar19,puVar13[9] + 4,local_64);</pre>
<pre>                        LogMsgWithLevel(0,"ResolveSimultaneousProbe: %p Our Record %d %s %08lX %s",</pre>
<pre>                                        local_3c,local_34,local_38,local_30,uVar7);</pre>
<pre>                        bVar1 = true;</pre>
<pre>                        if (iVar5 &lt; 0) {</pre>
<pre>                          iVar5 = (int)mDNSPlatformOneSecond + *(int *)(param_1 + 0x234);</pre>
<pre>                          if (iVar5 == 0) {</pre>
<pre>                            iVar5 = 1;</pre>
<pre>                          }</pre>
<pre>                          *(int *)(param_1 + 0x2180) = iVar5;</pre>
<pre>                          *(undefined *)((int)puVar13 + 0x86) = 3;</pre>
<pre>                          *(undefined *)((int)puVar13 + 0x87) = 4;</pre>
<pre>                          FUN_00428828(param_1,puVar13);</pre>
<pre>                          goto LAB_0043d394;</pre>
<pre>                        }</pre>
<pre>                      }</pre>
<pre>                    }</pre>
<pre>                  }</pre>
<pre>                  *(undefined *)(param_1 + 0x7fac) = 0;</pre>
<pre>                  local_74 = local_74 + 1;</pre>
<pre>                }</pre>
<pre>                if ((!bVar1) &amp;&amp; (mDNS_LoggingEnabled != 0)) {</pre>
<pre>                  local_3c = (int **)puVar13[8];</pre>
<pre>                  uVar7 = DNSTypeName(*(undefined2 *)((int)puVar13 + 6));</pre>
<pre>                  LogMsgWithLevel(3,"ResolveSimultaneousProbe: %##s (%s): No Update Record found",</pre>
<pre>                                  local_3c,uVar7);</pre>
<pre>                }</pre>
<pre>LAB_0043d394:</pre>
<pre>                *(undefined *)(param_1 + 0x7fac) = 0;</pre>
<pre>              }</pre>
<pre>              else if (((((*(byte *)(puVar13 + 1) &amp; 0x3c) != 0) &amp;&amp;</pre>
<pre>                        ((puVar13[0xc] == 0 || ((*(byte *)(puVar13[0xc] + 4) &amp; 0x3c) != 0)))) &amp;&amp;</pre>
<pre>                       ((puVar13[0xd] == 0 || ((*(byte *)(puVar13[0xd] + 4) &amp; 0x3c) != 0)))) &amp;&amp;</pre>
<pre>                      ((puVar13[0xe] == 0 || ((*(byte *)(puVar13[0xe] + 4) &amp; 0x3c) != 0)))) {</pre>
<pre>                local_6c = local_6c + 1;</pre>
<pre>                if ((local_564 != 0) &amp;&amp; (puVar13[0xb] != 0)) {</pre>
<pre>                  SetAnonData(local_84,puVar19,1);</pre>
<pre>                }</pre>
<pre>                if ((local_50 == 0) &amp;&amp; (((local_48 != 0 || (local_60 == 0)) || (local_78 != 0)))) {</pre>
<pre>                  if (puVar13[0x2d] == 0) {</pre>
<pre>                    puVar13[0x2d] = local_5c;</pre>
<pre>                  }</pre>
<pre>                }</pre>
<pre>                else if ((-1 &lt; (-puVar13[0x31] - (int)mDNSPlatformOneSecond) +</pre>
<pre>                               *(int *)(param_1 + 0x234)) ||</pre>
<pre>                        (((int *)puVar13[0x32] != (int *)0xffffffff &amp;&amp;</pre>
<pre>                         ((int *)puVar13[0x32] != param_5)))) {</pre>
<pre>                  puVar13[0x2d] = 0xffffffff;</pre>
<pre>                }</pre>
<pre>              }</pre>
<pre>            }</pre>
<pre>            else if (((((((*(byte *)(puVar13 + 1) &amp; 0x30) != 0) &amp;&amp;</pre>
<pre>                        ((*(byte *)(puVar13 + 1) &amp; 0x3c) != 0)) &amp;&amp;</pre>
<pre>                       ((puVar13[0xc] == 0 || ((*(byte *)(puVar13[0xc] + 4) &amp; 0x3c) != 0)))) &amp;&amp;</pre>
<pre>                      ((puVar13[0xd] == 0 || ((*(byte *)(puVar13[0xd] + 4) &amp; 0x3c) != 0)))) &amp;&amp;</pre>
<pre>                     ((puVar13[0xe] == 0 || ((*(byte *)(puVar13[0xe] + 4) &amp; 0x3c) != 0)))) &amp;&amp;</pre>
<pre>                    (puVar4 = puVar13, puVar16 == (undefined4 *)0x0)) goto LAB_0043d538;</pre>
<pre>          }</pre>
<pre>          puVar4 = puVar16;</pre>
<pre>        }</pre>
<pre>      } while( true );</pre>
<pre>    }</pre>
<pre>    goto LAB_0043dfac;</pre>
<pre>  }</pre>
<pre>  for (ppiVar6 = *(int ***)(param_1 + 0x2160); ppiVar6 != (int **)0x0; ppiVar6 = (int **)*ppiVar6) {</pre>
<pre>    if (((ppiVar6[0x2d] != (int *)0x0) &amp;&amp; (ppiVar6[0x2c] == (int *)0x0)) &amp;&amp;</pre>
<pre>       (local_5b4 != (int ***)(ppiVar6 + 0x2c))) {</pre>
<pre>      *local_5b4 = ppiVar6;</pre>
<pre>      ppiVar6[0x2e] = (int *)0x0;</pre>
<pre>      local_5b4 = (int ***)(ppiVar6 + 0x2c);</pre>
<pre>    }</pre>
<pre>  }</pre>
<pre>  FUN_0042a238(param_1,local_5b8,&amp;local_5b4,param_5);</pre>
<pre>  local_84 = &amp;local_5b0;</pre>
<pre>  for (iVar14 = 0; ppiVar6 = local_5b8, iVar14 &lt; (int)(uint)param_2[3]; iVar14 = iVar14 + 1) {</pre>
<pre>    local_88 = (int **)GetLargeResourceRecord</pre>
<pre>                                 (param_1,param_2,local_88,param_3,param_5,0xc0,local_80);</pre>
<pre>    if (local_88 == (int **)0x0) goto LAB_0043dfac;</pre>
<pre>    ppiVar6 = local_5b8;</pre>
<pre>    if (*(char *)(param_1 + 0x7fac) != -0x10) {</pre>
<pre>      for (; ppiVar6 != (int **)0x0; ppiVar6 = (int **)ppiVar6[0x2c]) {</pre>
<pre>        if (((ppiVar6[0x2d] != (int *)0x0) || (ppiVar6[0x2e] != (int *)0x0)) &amp;&amp;</pre>
<pre>           (local_30 = ppiVar6, iVar15 = FUN_0042d7b4(local_80,ppiVar6), ppiVar6 = local_30,</pre>
<pre>           iVar15 != 0)) {</pre>
<pre>          *(int *)(param_1 + 0x3970) = *(int *)(param_1 + 0x3970) + 1;</pre>
<pre>          local_30[0x2d] = (int *)0x0;</pre>
<pre>          local_30[0x2e] = (int *)0x0;</pre>
<pre>        }</pre>
<pre>      }</pre>
<pre>      for (ppiVar6 = *(int ***)(param_1 + 0x2160); ppiVar6 != (int **)0x0;</pre>
<pre>          ppiVar6 = (int **)*ppiVar6) {</pre>
<pre>        if ((ppiVar6[0x24] == param_5) &amp;&amp;</pre>
<pre>           (local_30 = ppiVar6, iVar15 = FUN_0042d7b4(local_80,ppiVar6), ppiVar6 = local_30,</pre>
<pre>           iVar15 != 0)) {</pre>
<pre>          if (*piVar18 == 4) {</pre>
<pre>            if (local_30[0x27] == (int *)piVar18[1]) {</pre>
<pre>              local_30[0x27] = (int *)0x0;</pre>
<pre>            }</pre>
<pre>          }</pre>
<pre>          else if ((((*piVar18 == 6) &amp;&amp; (local_30[0x28] == (int *)piVar18[1])) &amp;&amp;</pre>
<pre>                   (local_30[0x29] == (int *)piVar18[2])) &amp;&amp;</pre>
<pre>                  ((local_30[0x2a] == (int *)piVar18[3] &amp;&amp; (local_30[0x2b] == (int *)piVar18[4]))))</pre>
<pre>          {</pre>
<pre><span class="green"><span class="green">            memcpy(local_30 + 0x28,zerov6Addr,0x10)</span></span></span></pre>
<pre>          }</pre>
<pre>          ppiVar6 = local_30;</pre>
<pre>          if (((local_30[0x27] == (int *)0x0) &amp;&amp; (local_30[0x29] == (int *)0x0)) &amp;&amp;</pre>
<pre>             ((local_30[0x28] == (int *)0x0 &amp;&amp;</pre>
<pre>              ((local_30[0x2a] == (int *)0x0 &amp;&amp; (local_30[0x2b] == (int *)0x0)))))) {</pre>
<pre>            *(int *)(param_1 + 0x3970) = *(int *)(param_1 + 0x3970) + 1;</pre>
<pre>            local_30[0x24] = (int *)0x0;</pre>
<pre>            *(undefined *)((int)local_30 + 0x8b) = 0;</pre>
<pre>          }</pre>
<pre>        }</pre>
<pre>      }</pre>
<pre>      iVar15 = FUN_0042d2bc(param_1,local_7c);</pre>
<pre>      ppiVar6 = local_84;</pre>
<pre>      if (iVar15 == 0) {</pre>
<pre>        while (ppiVar17 = (int **)*ppiVar6, ppiVar17 != (int **)0x0) {</pre>
<pre>          local_3c = ppiVar6;</pre>
<pre>          local_30 = ppiVar17;</pre>
<pre>          iVar15 = ResourceRecordAnswersQuestion(local_7c,ppiVar17);</pre>
<pre>          ppiVar17 = local_30;</pre>
<pre>          ppiVar6 = local_3c;</pre>
<pre>          if (iVar15 == 0) {</pre>
<pre>            ppiVar6 = local_30 + 0x10;</pre>
<pre>          }</pre>
<pre>          else {</pre>
<pre>            *local_3c = local_30[0x10];</pre>
<pre>            ppiVar17[0x10] = (int *)0x0;</pre>
<pre>          }</pre>
<pre>        }</pre>
<pre>      }</pre>
<pre>    }</pre>
<pre>    *(undefined *)(param_1 + 0x7fac) = 0;</pre>
<pre>  }</pre>
<pre>  for (; bVar1 = false, ppiVar6 != (int **)0x0; ppiVar6 = (int **)ppiVar6[0x2c]) {</pre>
<pre>    piVar11 = ppiVar6[0x2e];</pre>
<pre>    if (((piVar11 != (int *)0x0) &amp;&amp; (piVar11[0x2d] == 0)) &amp;&amp; (piVar11[0x2e] == 0)) {</pre>
<pre>      ppiVar6[0x2d] = (int *)0x0;</pre>
<pre>      ppiVar6[0x2e] = (int *)0x0;</pre>
<pre>    }</pre>
<pre>  }</pre>
<pre>  local_88 = (int **)(piVar18 + 1);</pre>
<pre>  piVar11 = (int *)0xffffffff;</pre>
<pre>  ppiVar6 = &amp</span>DNSPlatformOneSecond;</pre>
<pre>  for (ppiVar17 = local_5b8; ppiVar17 != (int **)0x0; ppiVar17 = (int **)ppiVar17[0x2c]) {</pre>
<pre>    piVar9 = ppiVar17[0x2d];</pre>
<pre>    if (piVar9 == (int *)0x0) {</pre>
<pre>      if ((ppiVar17[0x2e] != (int *)0x0) &amp;&amp; ((int *)ppiVar17[0x2e][0x2d] == piVar11)) {</pre>
<pre>        ppiVar17[0x25] = param_5;</pre>
<pre>      }</pre>
<pre>    }</pre>
<pre>    else {</pre>
<pre>      iVar14 = (int)ppiVar17[3] * (int)*ppiVar6;</pre>
<pre>      if (iVar14 &lt; 0) {</pre>
<pre>        iVar14 = iVar14 + 3;</pre>
<pre>      }</pre>
<pre>      bVar2 = false;</pre>
<pre>      if ((-1 &lt; (*(int *)(param_1 + 0x234) - (int)ppiVar17[0x31]) - (iVar14 &gt;&gt; 2)) &amp;&amp;</pre>
<pre>         (bVar2 = true, piVar9 == (int *)&amp;SUB_fffffffe)) {</pre>
<pre>        *(int *)(param_1 + 0x3990) = *(int *)(param_1 + 0x3990) + 1;</pre>
<pre>        ppiVar17[0x2d] = piVar11;</pre>
<pre>        piVar9 = ppiVar17[0x2d];</pre>
<pre>      }</pre>
<pre>      if (piVar9 == piVar11) {</pre>
<pre>        bVar3 = false;</pre>
<pre>        *(int *)(param_1 + 0x398c) = *(int *)(param_1 + 0x398c) + 1;</pre>
<pre>LAB_0043daa0:</pre>
<pre>        *(undefined4 *)(param_1 + 0x254) = *(undefined4 *)(param_1 + 0x234);</pre>
<pre>        if ((ppiVar17[0x24] == (int *)0x0) || (ppiVar17[0x24] == param_5)) {</pre>
<pre>          ppiVar17[0x24] = param_5;</pre>
<pre>          if (bVar3) {</pre>
<pre>            *(undefined *)((int)ppiVar17 + 0x8b) = 1;</pre>
<pre>          }</pre>
<pre>          if (*piVar18 == 4) {</pre>
<pre>            if (ppiVar17[0x27] == (int *)0x0) {</pre>
<pre>              ppiVar17[0x27] = (int *)piVar18[1];</pre>
<pre>            }</pre>
<pre>            else if (ppiVar17[0x27] != (int *)piVar18[1]) {</pre>
<pre>              ppiVar17[0x27] = (int *)0xffffffff;</pre>
<pre>            }</pre>
<pre>          }</pre>
<pre>          else if (*piVar18 == 6) {</pre>
<pre>            if ((((ppiVar17[0x29] == (int *)0x0) &amp;&amp; (ppiVar17[0x28] == (int *)0x0)) &amp;&amp;</pre>
<pre>                (ppiVar17[0x2a] == (int *)0x0)) &amp;&amp; (ppiVar17[0x2b] == (int *)0x0)) {</pre>
<pre>              local_34 = piVar11;</pre>
<pre>              local_30 = ppiVar6;</pre>
<pre><span class="green"><span class="green">              memcpy(ppiVar17 + 0x28,local_88,0x10)</span></span></span></pre>
<pre>              ppiVar6 = local_30;</pre>
<pre>              piVar11 = local_34;</pre>
<pre>            }</pre>
<pre>            else if (((ppiVar17[0x28] != (int *)piVar18[1]) || (ppiVar17[0x29] != (int *)piVar18[2])</pre>
<pre>                     ) || ((ppiVar17[0x2a] != (int *)piVar18[3] ||</pre>
<pre>                           (ppiVar17[0x2b] != (int *)piVar18[4])))) {</pre>
<pre>              local_34 = piVar11;</pre>
<pre>              local_30 = ppiVar6;</pre>
<pre><span class="green"><span class="green">              memcpy(ppiVar17 + 0x28,onesIPv6Addr,0x10)</span></span></span></pre>
<pre>              ppiVar6 = local_30;</pre>
<pre>              piVar11 = local_34;</pre>
<pre>            }</pre>
<pre>          }</pre>
<pre>        }</pre>
<pre>        else {</pre>
<pre>          ppiVar17[0x24] = (int *)0xffffffff;</pre>
<pre>        }</pre>
<pre>      }</pre>
<pre>      else {</pre>
<pre>        if (piVar9 == (int *)&amp;SUB_fffffffe) {</pre>
<pre>          bVar3 = true;</pre>
<pre>          *(int *)(param_1 + 0x3988) = *(int *)(param_1 + 0x3988) + 1;</pre>
<pre>          goto LAB_0043daa0;</pre>
<pre>        }</pre>
<pre>        if (piVar9 != (int *)0x0) {</pre>
<pre>          bVar1 = true;</pre>
<pre>        }</pre>
<pre>        bVar3 = false;</pre>
<pre>        if (bVar2) goto LAB_0043daa0;</pre>
<pre>      }</pre>
<pre>      if ((*(byte *)(param_2 + 1) &amp; 2) == 0) {</pre>
<pre>        if (*(char *)(ppiVar17 + 1) == '\b') {</pre>
<pre>          piVar21 = *ppiVar6;</pre>
<pre>        }</pre>
<pre>      }</pre>
<pre>      else {</pre>
<pre>        piVar21 = (int *)((int)*ppiVar6 * 0x14);</pre>
<pre>      }</pre>
<pre>    }</pre>
<pre>  }</pre>
<pre>  if ((piVar21 != (int *)0x0) &amp;&amp;</pre>
<pre>     ((*(int *)(param_1 + 0x244) == 0 ||</pre>
<pre>      (*(int *)(param_1 + 0x244) - *(int *)(param_1 + 0x234) &lt; ((int)piVar21 + 0x31) / 0x32)))) {</pre>
<pre>    iVar15 = *(int *)(param_1 + 0x234);</pre>
<pre>    iVar14 = mDNSRandom((int)mDNSPlatformOneSecond * 5);</pre>
<pre>    iVar15 = ((int)piVar21 + iVar14 + 0x31) / 0x32 + iVar15;</pre>
<pre>    *(int *)(param_1 + 0x244) = iVar15;</pre>
<pre>    if (iVar15 == 0) {</pre>
<pre>      *(undefined4 *)(param_1 + 0x244) = 1;</pre>
<pre>    }</pre>
<pre>  }</pre>
<pre>  ppiVar6 = local_5b8;</pre>
<pre>  if (bVar1) {</pre>
<pre>    local_88 = (int **)(iVar5 + 0x22f8);</pre>
<pre>    iVar14 = iVar5 + 0xc;</pre>
<pre>    piVar21 = (int *)0x70000000;</pre>
<pre>    InitializeDNSMessage(iVar5,(uint)*param_2 &lt;&lt; 0x10,0x84000000);</pre>
<pre>    if (local_78 != 0) {</pre>
<pre>      local_84 = apiStack_1c4;</pre>
<pre>      ppiVar17 = local_58;</pre>
<pre>      local_80 = auStack_318;</pre>
<pre>      for (iVar15 = 0; iVar15 &lt; (int)(uint)param_2[2]; iVar15 = iVar15 + 1) {</pre>
<pre>        ppiVar17 = (int **)getQuestion(param_2,ppiVar17,param_3,param_5,local_80);</pre>
<pre>        ppiVar8 = ppiVar6;</pre>
<pre>        if (ppiVar17 == (int **)0x0) goto LAB_0043dfac;</pre>
<pre>        for (; ppiVar8 != (int **)0x0; ppiVar8 = (int **)ppiVar8[0x2c]) {</pre>
<pre>          if ((int **)ppiVar8[0x2d] == ppiVar17) {</pre>
<pre>            local_30 = ppiVar17;</pre>
<pre>            iVar14 = putQuestion(iVar5,iVar14,local_88,local_84,local_c4,local_c2);</pre>
<pre>            ppiVar17 = local_30;</pre>
<pre>            if (iVar14 == 0) {</pre>
<pre>              *(undefined *)(param_1 + 0x7fac) = 0;</pre>
<pre>              goto LAB_0043dfc8;</pre>
<pre>            }</pre>
<pre>            break;</pre>
<pre>          }</pre>
<pre>        }</pre>
<pre>      }</pre>
<pre>      piVar21 = (int *)0xa;</pre>
<pre>      if (*(short *)(iVar5 + 4) == 0) {</pre>
<pre>        LogMsgWithLevel(0,"GenerateUnicastResponse: ERROR! Why no questions?");</pre>
<pre>        goto LAB_0043dfac;</pre>
<pre>      }</pre>
<pre>    }</pre>
<pre>    for (ppiVar17 = ppiVar6; ppiVar17 != (int **)0x0; ppiVar17 = (int **)ppiVar17[0x2c]) {</pre>
<pre>      iVar15 = iVar14;</pre>
<pre>      if (ppiVar17[0x2d] != (int *)0x0) {</pre>
<pre>        if (((*(short *)(iVar5 + 6) != 0) || (*(short *)(iVar5 + 8) != 0)) ||</pre>
<pre>           (iVar15 = iVar5 + 0x22ec, *(short *)(iVar5 + 10) != 0)) {</pre>
<pre>          iVar15 = iVar5 + 0x5a0;</pre>
<pre>        }</pre>
<pre>        piVar11 = ppiVar17[3];</pre>
<pre>        if (piVar21 &lt;= ppiVar17[3]) {</pre>
<pre>          piVar11 = piVar21;</pre>
<pre>        }</pre>
<pre>        iVar15 = PutResourceRecordTTLWithLimit</pre>
<pre>                           (iVar5,iVar14,iVar5 + 6,ppiVar17 + 1,piVar11,iVar15 + 0xc);</pre>
<pre>        if (iVar15 == 0) {</pre>
<pre>          *(byte *)(iVar5 + 2) = *(byte *)(iVar5 + 2) | 2;</pre>
<pre>          iVar15 = iVar14;</pre>
<pre>        }</pre>
<pre>      }</pre>
<pre>      iVar14 = iVar15;</pre>
<pre>    }</pre>
<pre>    for (; ppiVar6 != (int **)0x0; ppiVar6 = (int **)ppiVar6[0x2c]) {</pre>
<pre>      iVar15 = iVar14;</pre>
<pre>      if ((ppiVar6[0x2e] != (int *)0x0) &amp;&amp; (ppiVar6[0x2d] == (int *)0x0)) {</pre>
<pre>        if ((*(short *)(iVar5 + 6) != 0) ||</pre>
<pre>           ((*(short *)(iVar5 + 8) != 0 || (iVar15 = iVar5 + 0x22ec, *(short *)(iVar5 + 10) != 0))))</pre>
<pre>        {</pre>
<pre>          iVar15 = iVar5 + 0x5a0;</pre>
<pre>        }</pre>
<pre>        piVar11 = ppiVar6[3];</pre>
<pre>        if (piVar21 &lt;= ppiVar6[3]) {</pre>
<pre>          piVar11 = piVar21;</pre>
<pre>        }</pre>
<pre>        iVar15 = PutResourceRecordTTLWithLimit</pre>
<pre>                           (iVar5,iVar14,iVar5 + 10,ppiVar6 + 1,piVar11,iVar15 + 0xc);</pre>
<pre>        if (iVar15 == 0) {</pre>
<pre>          iVar15 = iVar14;</pre>
<pre>        }</pre>
<pre>      }</pre>
<pre>      iVar14 = iVar15;</pre>
<pre>    }</pre>
<pre>    *(undefined *)(param_1 + 0x7fac) = 0;</pre>
<pre>  }</pre>
<pre>  else {</pre>
<pre>LAB_0043dfac:</pre>
<pre>    iVar14 = 0;</pre>
<pre>    *(undefined *)(param_1 + 0x7fac) = 0;</pre>
<pre>  }</pre>
<pre>LAB_0043dfc8:</pre>
<pre>  while (local_5b8 != (int **)0x0) {</pre>
<pre>    ppiVar6 = (int **)local_5b8[0x2c];</pre>
<pre>    local_5b8[0x2e] = (int *)0x0;</pre>
<pre>    local_5b8[0x2c] = (int *)0x0;</pre>
<pre>    local_5b8[0x2d] = (int *)0x0;</pre>
<pre>    local_5b8 = ppiVar6;</pre>
<pre>  }</pre>
<pre>  do {</pre>
<pre>    piVar21 = local_5ac;</pre>
<pre>    if (local_5b0 == (int *)0x0) {</pre>
<pre>      while (piVar21 != (int *)0x0) {</pre>
<pre>        piVar21 = (int *)*piVar21;</pre>
<pre>        ReleaseCacheRecord(param_1);</pre>
<pre>      }</pre>
<pre>      return iVar14;</pre>
<pre>    }</pre>
<pre>    piVar11 = (int *)local_5b0[0x10];</pre>
<pre>    iVar5 = 0;</pre>
<pre>    local_5b0[0x10] = 0;</pre>
<pre>    iVar15 = *(int *)(param_1 + 0x234);</pre>
<pre>    piVar21 = local_5b0;</pre>
<pre>    do {</pre>
<pre>      if (((int *)piVar21[0x13] == param_5) &amp;&amp; (piVar21[0x14] == *piVar18)) goto LAB_0043e074;</pre>
<pre>      iVar5 = iVar5 + 1;</pre>
<pre>      piVar21 = piVar21 + 3;</pre>
<pre>    } while (iVar5 != 8);</pre>
<pre>    iVar5 = 0;</pre>
<pre>    iVar10 = 1;</pre>
<pre>    piVar21 = local_5b0;</pre>
<pre>    do {</pre>
<pre>      if (local_5b0[iVar5 * 3 + 0x13] == 0) break;</pre>
<pre>      if ((piVar21[0x16] == 0) || (piVar21[0x15] - local_5b0[iVar5 * 3 + 0x12] &lt; 0)) {</pre>
<pre>        iVar5 = iVar10;</pre>
<pre>      }</pre>
<pre>      iVar10 = iVar10 + 1;</pre>
<pre>      piVar21 = piVar21 + 3;</pre>
<pre>    } while (iVar10 != 8);</pre>
<pre>LAB_0043e074:</pre>
<pre>    local_5b0[iVar5 * 3 + 0x14] = *piVar18;</pre>
<pre>    local_5b0[iVar5 * 3 + 0x12] = iVar15;</pre>
<pre>    local_5b0[iVar5 * 3 + 0x13] = (int)param_5;</pre>
<pre>    local_5b0 = piVar11;</pre>
<pre>  } while( true );</pre>
<pre>code_r0x0043d544:</pre>
<pre>  piVar18 = piVar21;</pre>
<pre>  if ((local_6c == 0) &amp;&amp; (piVar18 = mDNSPlatformOneSecond, puVar16 != (undefined4 *)0x0)) {</pre>
<pre>    puVar16[0x23] = param_5;</pre>
<pre>    *(undefined4 *)(param_1 + 0x254) = *(undefined4 *)(param_1 + 0x234);</pre>
<pre>    piVar18 = piVar21;</pre>
<pre>  }</pre>
<pre>  if ((*(byte *)(param_2 + 1) &amp; 2) != 0) {</pre>
<pre>    *(int *)(param_1 + 0x3974) = *(int *)(param_1 + 0x3974) + 1;</pre>
<pre>  }</pre>
<pre>  ppiVar6 = local_54;</pre>
<pre>  if (((local_50 != 0) &amp;&amp; ((*(byte *)(param_2 + 1) &amp; 2) == 0)) &amp;&amp; (local_564 == 0)) {</pre>
<pre>    for (ppiVar17 = *(int ***)(param_1 + 0x2ac); ppiVar17 != (int **)0x0;</pre>
<pre>        ppiVar17 = (int **)*ppiVar17) {</pre>
<pre>      if (((ppiVar17[0x4f] == (int *)0x0) &amp;&amp; (0 &lt; (int)ppiVar17[4])) &amp;&amp;</pre>
<pre>         (ppiVar17[0xf] == (int *)0x0)) {</pre>
<pre>        piVar21 = mDNSPlatformOneSecond;</pre>
<pre>        if ((int)mDNSPlatformOneSecond &lt; 0) {</pre>
<pre>          piVar21 = (int *)((int)mDNSPlatformOneSecond + 3);</pre>
<pre>        }</pre>
<pre>        if (((((int)piVar21 &gt;&gt; 2 &lt; *(int *)(param_1 + 0x234) - (int)ppiVar17[0x2d]) &amp;&amp;</pre>
<pre>             ((ppiVar17[0x4d] == (int *)0x0 || (ppiVar17[0x4d] == param_5)))) &amp;&amp;</pre>
<pre>            (ppiVar17[0x10] == (int *)0x0)) &amp;&amp;</pre>
<pre>           ((((ppiVar6 != ppiVar17 + 0x10 &amp;&amp; (ppiVar17[0x95] == (int *)local_354)) &amp;&amp;</pre>
<pre>             (ppiVar17[1] == (int *)local_5a4)) &amp;&amp;</pre>
<pre>            (iVar5 = SameDomainName(ppiVar17 + 0x55,auStack_454), iVar5 != 0)))) {</pre>
<pre>          *ppiVar6 = (int *)ppiVar17;</pre>
<pre>          ppiVar6 = ppiVar17 + 0x10;</pre>
<pre>        }</pre>
<pre>      }</pre>
<pre>    }</pre>
<pre>  }</pre>
<pre>  local_54 = ppiVar6;</pre>
<pre>  if (local_564 != 0) {</pre>
<pre>    FreeAnonInfo();</pre>
<pre>  }</pre>
<pre>  local_68 = local_68 + 1;</pre>
<pre>  piVar21 = piVar18;</pre>
<pre>  goto LAB_0043d6b8;</pre>
<pre>}</pre>
<br />
  <!-- content end -->
</div>

<a href="https://github.com/e-m-b-a/emba" title="github.com/e-m-b-a/emba" target="_blank">
  <div id="buttonInfo" class="rectButtonVisible">
    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" transform="translate(2 2)"><g stroke="white" stroke-linecap="round" stroke-linejoin="round"><circle cx="8.5" cy="8.5" r="8"/><path d="M8.5 12.5v-4h-1"/><path d="M7.5 12.5h2"/></g><circle cx="8.5" cy="5.5" fill="white" r="1"/></g></svg>
  </div>
</a>
<div id="buttonBack" class="nonClickable rectButtonVisible"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><path d="M9.5 14.5l4-4l-4-4" fill="none" stroke="#444" stroke-linecap="round" stroke-linejoin="round"/></svg></div>
<div id="buttonForward" class="nonClickable rectButtonVisible"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><path d="M11.5 14.5l-4-4l4-4" fill="none" stroke="#444" stroke-linecap="round" stroke-linejoin="round"/></svg></div> 
<div id="buttonDown" class="rectButton" onclick="scrollDown()"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="#fff" stroke-linecap="round" stroke-linejoin="round"><path d="M14.5 6.5l-4 4l-4-4"/><path d="M14.5 10.5l-4 4l-4-4"/></g></svg></div>
<div id="buttonUp" class="rectButton" onclick="scrollUp()"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="#fff" stroke-linecap="round" stroke-linejoin="round"><path d="M6.5 14.5l4-4l4 4"/><path d="M6.5 10.5l4-4l4 4"/></g></svg></div> 

<script>
window.onload = function () {
  var buttons = document.getElementsByClassName("rectButton");
  for (let i=0; i<buttons.length; i++) {
    buttons[i].style.visibility = "visible";
  }
  var buttonDown = document.getElementById("buttonDown");
  buttonDown.classList.add('rectButtonVisible');
  buttonDown.classList.remove('rectButton');

  var buttonUp = document.getElementById("buttonUp");
  buttonUp.classList.add('rectButtonVisible');
  buttonUp.classList.remove('rectButton');
    
  var buttonSizer = document.getElementById("buttonSizer");
  buttonSizer.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="white" stroke-linecap="round" stroke-linejoin="round"><path d="M9.5 16.5v-4.978l-5-.022"/><path d="M18.5 2.5l-7 7"/><path d="M16.5 9.5l-5 .023V4.5"/><path d="M9.5 11.5l-7 7"/></g></svg>';
  if (document.getElementById("buttonTime") !== null) {
    var buttonTime = document.getElementById("buttonTime");
    buttonTime.style.bottom = "50px";
  }
  document.getElementById("expand").value = "+ Show more results";
  document.getElementById("expand").className += " expand";
  var embarkButton = document.getElementById("embark");
  if ( !(embarkButton.href.includes("embarkBackUrl")) ) {
    embarkButton.classList.remove('hidden');
    document.getElementById("logoImage").src = "./../../style/embark.svg";
    document.getElementById("logo").style.background = "#2d2d2d";
  }
}

function openNav() {
  document.getElementById("sidenav").style.width = "250px";
  document.getElementById("main").style.marginLeft = "250px";
  document.getElementById("nav").style.visibility = "visible";
}

function closeNav() {
  document.getElementById("sidenav").style.width = "50px";
  document.getElementById("sidenav").scrollTop = 0;
  document.getElementById("main").style.marginLeft = "50px";
  document.getElementById("nav").style.visibility = "hidden";
}

function scrollDown() {
  window.scrollTo(0,document.body.scrollHeight);
}

function scrollUp() {
  window.scrollTo(0,0);
}

function buttonNav() {
  var button = document.getElementById("buttonSizer");
  if ( button.classList.contains('buttonOpen') ) {
    button.classList.remove('buttonOpen');
    button.classList.add('buttonClose');
    button.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="white" stroke-linecap="round" stroke-linejoin="round"><path d="M9.5 16.5v-4.978l-5-.022"/><path d="M18.5 2.5l-7 7"/><path d="M16.5 9.5l-5 .023V4.5"/><path d="M9.5 11.5l-7 7"/></g></svg>';
    openNav();
  } else if( button.classList.contains('buttonClose') ) {
    button.classList.remove('buttonClose');
    button.classList.add('buttonOpen');
    button.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="white" stroke-linecap="round" stroke-linejoin="round"><path d="M18.5 7.5v-5h-5"/><path d="M18.5 2.5l-6 5.929"/><path d="M7.5 18.5l-5 .023V13.5"/><path d="M8.5 12.5l-6 6"/></g></svg>';
    closeNav();
  };
}

// the following function is currently not used
// it is for future extensions
function overlay_output(link) {
  var rawfile = new XMLHttpRequest();
  rawfile.open('GET', link, false);
  rawfile.overrideMimeType("text");
  rawfile.onreadystatechange = function()
  {
    alert(rawfile.responseText);
    //console.log(rawfile.responseText);
  }
  rawfile.send(null);
}

document.onkeydown = function(e) {
    switch (e.keyCode) {
      case 37:
        document.getElementById("buttonForward").parentNode.click(); 
        break;
      case 39:
        document.getElementById("buttonBack").parentNode.click();       
        break;
    }
};
</script>

</body>
</html>
