<!-- 
EMBA - EMBEDDED LINUX ANALYZER

Copyright 2020-2023 Siemens AG
Copyright 2020-2024 Siemens Energy AG

EMBA comes with ABSOLUTELY NO WARRANTY. This is free software, and you are
welcome to redistribute it under the terms of the GNU General Public License.
See LICENSE file for usage of this software.

EMBA is licensed under GPLv3

Author(s) and contributors from the EMBA project are listed here: https://github.com/e-m-b-a/emba/blob/master/CONTRIBUTORS.md
-->

<!-- Used icons: https://github.com/CoreyGinnivan/system-uicons -->
 
<!DOCTYPE html>
<html lang="en">
<head>
  <title>EMBA firmware report</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="./../../style/style.css" type="text/css">
  <link rel="icon" type="image/png" href="./../../style/favicon.png">
</head>
<body>

<div id="sidenav" class="side">
  <div id="logo">
    <a class="inherit" href="./../../index.html"><img class="inherit" id="logoImage" src="./../../style/emba.svg" alt="logo"></a>
  </div>
  <div id="nav">
      <a id="embark" class="hidden" href="{{ embarkBackUrl }}">&laquo; Back to EMBArk</a> <!-- nosem -->
      <a class="backButton" href="./../../index.html">&laquo; Back to main</a>
<a class="modul" href="./../semgrep_mDNSClientPosix.html" title="./../semgrep_mDNSClientPosix.html" >&laquo; Back to semgrep_mDNSClientPosix</a>
      <!-- navigation start -->
      <!-- navigation end -->
      <input id="expand" class="expand_njs hidden" type="button" value="More results:" onclick="this.value=this.value=='+ Show more results'?'- Hide more results':'+ Show more results';">
      <div class="expand_area">
        <!-- etc start -->
        <!-- etc end -->
      </div>
  </div>
  <a href="TIMELINK"><div id="buttonTimeInvisible" class="rectButton"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="white" stroke-linecap="round" stroke-linejoin="round" transform="matrix(-1 0 0 1 19 2)"><circle cx="8.5" cy="8.5" r="8"/><path d="M8.5 5.5v4H5"/></g></svg></div></a>
  <div id="buttonSizer" class="rectButton buttonClose" onclick="buttonNav()"></div>
</div>
<div id="main" class="main">
  <!-- content start -->
<br />
<pre>/* WARNING: Removing unreachable block (ram,0x00433778) */</pre>
<pre>/* WARNING: Removing unreachable block (ram,0x00433738) */</pre>
<pre>/* WARNING: Removing unreachable block (ram,0x00433560) */</pre>
<br />
<pre>undefined4 mDNS_StartQuery_internal(int param_1,undefined4 *param_2)</pre>
<br />
<pre>{</pre>
<pre>  undefined2 uVar1;</pre>
<pre>  char cVar2;</pre>
<pre>  undefined4 uVar3;</pre>
<pre>  uint uVar4;</pre>
<pre>  undefined4 *puVar5;</pre>
<pre>  undefined4 *puVar6;</pre>
<pre>  int iVar7;</pre>
<pre>  undefined4 uVar8;</pre>
<pre>  undefined4 uVar9;</pre>
<pre>  undefined uVar10;</pre>
<pre>  bool bVar11;</pre>
<pre>  bool bVar12;</pre>
<pre>  int iVar13;</pre>
<pre>  undefined4 *puVar14;</pre>
<pre>  char local_38;</pre>
<pre>  char local_37 [7];</pre>
<pre>  undefined2 local_30 [2];</pre>
<pre>  undefined4 *local_2c;</pre>
<pre>  </pre>
<pre>  if (*(int *)(param_1 + 0x2c8) == 0) {</pre>
<pre>    uVar3 = 0xfffefff6;</pre>
<pre>  }</pre>
<pre>  else {</pre>
<pre>    iVar13 = param_2[0x4f];</pre>
<pre>    if ((iVar13 != 0) &amp;&amp;</pre>
<pre>       (((iVar13 != 4 &amp;&amp; (iVar13 != 6)) ||</pre>
<pre>        ((*(short *)(param_2 + 0x54) != 0x35 &amp;&amp; (*(short *)(param_2 + 0x54) != 0x14e9)))))) {</pre>
<pre>      LogMsgWithLevel(0,</pre>
<pre>                      "ValidateParameters: Warning! Target.type = %ld port = %u (Client forgot to initialize before calling mDNS_StartQuery? for question %##s)"</pre>
<pre>                      ,iVar13,*(undefined2 *)(param_2 + 0x54),param_2 + 0x55);</pre>
<pre>      param_2[0x4f] = 0;</pre>
<pre>    }</pre>
<pre>    if (param_2[0x4f] == 0) {</pre>
<pre>      *(undefined2 *)(param_2 + 0x54) = 0;</pre>
<pre>    }</pre>
<pre>    puVar14 = param_2 + 0x55;</pre>
<pre>    uVar4 = DomainNameLengthLimit(puVar14,param_2 + 0x95);</pre>
<pre>    if (uVar4 &lt; 0x101) {</pre>
<pre>      iVar13 = param_2[0x4d];</pre>
<pre>      if ((((iVar13 != 0) &amp;&amp; (iVar13 != -2)) &amp;&amp; (iVar13 != -3)) &amp;&amp; (iVar13 != -4)) {</pre>
<pre>        for (puVar5 = *(undefined4 **)(param_1 + 0x2174); puVar5 != (undefined4 *)0x0;</pre>
<pre>            puVar5 = (undefined4 *)*puVar5) {</pre>
<pre>          if (puVar5[0x548] == iVar13) goto LAB_004336fc;</pre>
<pre>        }</pre>
<pre>        if (mDNS_LoggingEnabled != 0) {</pre>
<pre>          local_2c = (undefined4 *)iVar13;</pre>
<pre>          uVar3 = DNSTypeName(*(undefined2 *)(param_2 + 0x95));</pre>
<pre>          LogMsgWithLevel(3,</pre>
<pre>                          "ValidateParameters: Note: InterfaceID %d for question %##s (%s) not currently found in active interface list"</pre>
<pre>                          ,local_2c,puVar14,uVar3);</pre>
<pre>        }</pre>
<pre>      }</pre>
<pre>LAB_004336fc:</pre>
<pre>      if (((param_2[0x4f] == 0) &amp;&amp; (iVar13 = param_2[0x4d], iVar13 != -3)) &amp;&amp;</pre>
<pre>         ((*(char *)((int)param_2 + 0x267) == '\0' &amp;&amp;</pre>
<pre>          (((iVar13 == -2 || (iVar13 == -4)) ||</pre>
<pre>           ((*(char *)((int)param_2 + 0x25a) != '\0' ||</pre>
<pre>            (iVar13 = IsLocalDomain(puVar14), iVar13 != 0)))))))) {</pre>
<pre>        local_30[0] = 0;</pre>
<pre>      }</pre>
<pre>      else {</pre>
<pre>        mDNS_NewMessageID(local_30,param_1);</pre>
<pre>      }</pre>
<pre>      *(undefined2 *)((int)param_2 + 0x152) = local_30[0];</pre>
<pre>      puVar5 = (undefined4 *)(param_1 + 0x2b8);</pre>
<pre>      if ((param_2[0x4d] != -2) &amp;&amp; (puVar5 = (undefined4 *)(param_1 + 0x2ac), param_2[0x4d] == -4))</pre>
<pre>      {</pre>
<pre>        puVar5 = (undefined4 *)(param_1 + 0x2b8);</pre>
<pre>      }</pre>
<pre>      while (puVar6 = (undefined4 *)*puVar5, puVar6 != (undefined4 *)0x0) {</pre>
<pre>        puVar5 = puVar6;</pre>
<pre>        if (puVar6 == param_2) {</pre>
<pre>          uVar3 = DNSTypeName(*(undefined2 *)(param_2 + 0x95));</pre>
<pre>          LogMsgWithLevel(0,</pre>
<pre>                          "mDNS_StartQuery_internal: Error! Tried to add a question %##s (%s) %p that\'s already in the active list"</pre>
<pre>                          ,puVar14,uVar3,param_2);</pre>
<pre>          return 0xfffefff5;</pre>
<pre>        }</pre>
<pre>      }</pre>
<pre>      *puVar5 = param_2;</pre>
<pre>      *param_2 = 0;</pre>
<pre>      local_37[0] = '\0';</pre>
<pre>      param_2[4] = (mDNSPlatformOneSecond + 2) / 3;</pre>
<pre>      local_2c = (undefined4 *)DomainNameHashValue(puVar14);</pre>
<pre>      param_2[1] = local_2c;</pre>
<pre>      uVar4 = DomainNameHashValue(puVar14);</pre>
<pre>      uVar3 = FUN_004279b4(param_1,puVar14,local_2c,uVar4 % 499,&amp;local_38);</pre>
<pre>      param_2[2] = uVar3;</pre>
<pre>      param_2[3] = *(undefined4 *)(param_1 + 0x234);</pre>
<pre>      param_2[5] = 0;</pre>
<pre>      uVar3 = *(undefined4 *)(param_1 + 0x26c);</pre>
<pre>      param_2[7] = 0;</pre>
<pre>      param_2[6] = uVar3;</pre>
<pre>      param_2[8] = 0;</pre>
<pre>      param_2[9] = 0;</pre>
<pre>      *(undefined *)((int)param_2 + 0xad) = 0;</pre>
<pre>      param_2[10] = 0;</pre>
<pre>      param_2[0xb] = 0;</pre>
<pre>      *(undefined *)((int)param_2 + 0xbd) = 0;</pre>
<pre>      param_2[0xc] = 0;</pre>
<pre>      param_2[0xd] = 0;</pre>
<pre>      if ((param_2[0x4e] &amp; 0x10000000) == 0) {</pre>
<pre>        mDNSPlatformGetDNSRoutePolicy(param_1,param_2,local_37);</pre>
<pre>      }</pre>
<pre>      else if (mDNS_LoggingEnabled != 0) {</pre>
<pre>        uVar3 = DNSTypeName(*(undefined2 *)(param_2 + 0x95));</pre>
<pre>        LogMsgWithLevel(3,</pre>
<pre>                        "InitCommonState: Query for %##s (%s), PID[%d], EUID[%d], ServiceID[%d] is already set by client"</pre>
<pre>                        ,puVar14,uVar3,param_2[0x9b],param_2[0xa0],param_2[0x4c]);</pre>
<pre>      }</pre>
<pre>      param_2[0x37] = 0;</pre>
<pre>      param_2[0x39] = 0;</pre>
<pre>      param_2[0x38] = 0;</pre>
<pre>      *(undefined2 *)((int)param_2 + 0xea) = 0;</pre>
<pre>      *(undefined2 *)(param_2 + 0x3a) = 0;</pre>
<pre>      param_2[0x30] = 0;</pre>
<pre>      if ((param_2[0x4d] != -2) &amp;&amp; (param_2[0x4d] != -4)) {</pre>
<pre>        if (*(short *)((int)param_2 + 0x152) == 0) {</pre>
<pre>          if (*(char *)(param_2 + 0x98) != '\0') {</pre>
<pre>            uVar3 = 0xffffffff;</pre>
<pre>            iVar13 = *(int *)(param_1 + 0x234);</pre>
<pre>            puVar5 = (undefined4 *)0x0;</pre>
<pre>            uVar8 = CountLabels(puVar14);</pre>
<pre>            for (puVar6 = *(undefined4 **)(param_1 + 0x2194); puVar6 != (undefined4 *)0x0;</pre>
<pre>                puVar6 = (undefined4 *)*puVar6) {</pre>
<pre>              local_2c = puVar6 + 3;</pre>
<pre>              uVar9 = CountLabels(puVar6 + 3);</pre>
<pre>              iVar7 = FUN_00428184(puVar14,uVar8,local_2c,uVar9,uVar3);</pre>
<pre>              if (iVar7 == 1) {</pre>
<pre>                uVar3 = uVar9;</pre>
<pre>                puVar5 = puVar6;</pre>
<pre>              }</pre>
<pre>            }</pre>
<pre>            if (mDNS_LoggingEnabled != 0) {</pre>
<pre>              uVar3 = 5;</pre>
<pre>              if (puVar5 != (undefined4 *)0x0) {</pre>
<pre>                uVar3 = puVar5[0x43];</pre>
<pre>              }</pre>
<pre>              LogMsgWithLevel(3,"GetTimeoutForMcastQuestion: question %##s curmatch %p, Timeout %d",</pre>
<pre>                              puVar14,puVar5,uVar3);</pre>
<pre>            }</pre>
<pre>            iVar7 = 5;</pre>
<pre>            if (puVar5 != (undefined4 *)0x0) {</pre>
<pre>              iVar7 = puVar5[0x43];</pre>
<pre>            }</pre>
<pre>            iVar13 = iVar7 * mDNSPlatformOneSecond + iVar13;</pre>
<pre>            if (iVar13 == 0) {</pre>
<pre>              iVar13 = 1;</pre>
<pre>            }</pre>
<pre>            param_2[0x30] = iVar13;</pre>
<pre>          }</pre>
<pre>        }</pre>
<pre>        else {</pre>
<pre>          iVar13 = SetValidDNSServers(param_1,param_2);</pre>
<pre>          if (*(char *)(param_2 + 0x98) != '\0') {</pre>
<pre>            iVar7 = iVar13 * mDNSPlatformOneSecond + *(int *)(param_1 + 0x234);</pre>
<pre>            if (iVar7 == 0) {</pre>
<pre>              iVar7 = 1;</pre>
<pre>            }</pre>
<pre>            param_2[0x30] = iVar7;</pre>
<pre>            if (mDNS_LoggingEnabled != 0) {</pre>
<pre>              uVar3 = DNSTypeName(*(undefined2 *)(param_2 + 0x95));</pre>
<pre>              LogMsgWithLevel(3,"InitDNSConfig: Setting StopTime on question %p %##s (%s)",param_2,</pre>
<pre>                              puVar14,uVar3);</pre>
<pre>            }</pre>
<pre>          }</pre>
<pre>          uVar3 = GetServerForQuestion(param_1,param_2);</pre>
<pre>          param_2[0x37] = uVar3;</pre>
<pre>          if (mDNS_LoggingEnabled != 0) {</pre>
<pre>            uVar3 = DNSTypeName(*(undefined2 *)(param_2 + 0x95));</pre>
<pre>            iVar7 = param_2[0x37];</pre>
<pre>            if (iVar7 == 0) {</pre>
<pre>              iVar7 = 0;</pre>
<pre>              uVar1 = 0;</pre>
<pre>            }</pre>
<pre>            else {</pre>
<pre>              uVar1 = *(undefined2 *)(iVar7 + 0x20);</pre>
<pre>              iVar7 = iVar7 + 0xc;</pre>
<pre>            }</pre>
<pre>            LogMsgWithLevel(3,"InitDNSConfig: question %p %##s (%s) Timeout %d, DNS Server %#a:%d",</pre>
<pre>                            param_2,puVar14,uVar3,iVar13,iVar7,uVar1);</pre>
<pre>          }</pre>
<pre>        }</pre>
<pre>        if (param_2[0x30] != 0) {</pre>
<pre>          if (*(int *)(param_1 + 0x24) != *(int *)(param_1 + 0x28) + 1) {</pre>
<pre>            LogMsgWithLevel(0,"%s: Lock not held! mDNS_busy (%ld) mDNS_reentrancy (%ld)",</pre>
<pre>                            "SetNextQueryStopTime",*(int *)(param_1 + 0x24),*(int *)(param_1 + 0x28)</pre>
<pre>                           );</pre>
<pre>          }</pre>
<pre>          if (0 &lt; *(int *)(param_1 + 0x2a8) - param_2[0x30]) {</pre>
<pre>            *(undefined4 *)(param_1 + 0x2a8) = param_2[0x30];</pre>
<pre>          }</pre>
<pre>        }</pre>
<pre>        SetNextQueryTime(param_1,param_2);</pre>
<pre>      }</pre>
<pre>      uVar3 = GetAuthInfoForQuestion(param_1,param_2);</pre>
<pre>      param_2[0xe] = uVar3;</pre>
<pre>      *(undefined *)(param_2 + 0x2f) = 0;</pre>
<pre>      if (*(char *)(param_2 + 0x97) != '\0') {</pre>
<pre>        uVar10 = FUN_004326d4(param_1,param_2);</pre>
<pre>        *(undefined *)(param_2 + 0x2f) = uVar10;</pre>
<pre>      }</pre>
<pre>      bVar12 = true;</pre>
<pre>      if ((param_2[0x4c] != 0) &amp;&amp; (bVar12 = false, local_37[0] != '\0')) {</pre>
<pre>        if (param_2[0x37] == 0) {</pre>
<pre>          bVar12 = false;</pre>
<pre>        }</pre>
<pre>        else {</pre>
<pre>          bVar12 = *(char *)(param_2[0x37] + 0x13c) != '\0';</pre>
<pre>        }</pre>
<pre>      }</pre>
<pre>      *(bool *)((int)param_2 + 0x12e) = bVar12;</pre>
<pre>      if ((bVar12) &amp;&amp; (mDNS_LoggingEnabled != 0)) {</pre>
<pre>        uVar3 = DNSTypeName(*(undefined2 *)(param_2 + 0x95));</pre>
<pre>        LogMsgWithLevel(3,</pre>
<pre>                        "InitCommonState: Query suppressed for %##s (%s), PID %d/ServiceID %d not allowed"</pre>
<pre>                        ,puVar14,uVar3,param_2[0x9b],param_2[0x4c]);</pre>
<pre>      }</pre>
<pre>      param_2[0x2c] = 2;</pre>
<pre>      param_2[0x10] = 0;</pre>
<pre>      param_2[0x2a] = 0;</pre>
<pre>      *(undefined *)(param_2 + 0x2b) = 0;</pre>
<pre>      param_2[0x2d] = *(undefined4 *)(param_1 + 0x234);</pre>
<pre>      param_2[0x2e] = 0;</pre>
<pre>      *(undefined *)((int)param_2 + 0xbe) = 0;</pre>
<pre>      if (*(char *)((int)param_2 + 0x261) != '\0') {</pre>
<pre>        *(undefined *)((int)param_2 + 0xbe) = 3;</pre>
<pre>        local_38 = '\x01';</pre>
<pre>      }</pre>
<pre>      iVar13 = 0;</pre>
<pre>      do {</pre>
<pre>        iVar7 = iVar13 + 0xc;</pre>
<pre>        *(undefined4 *)((int)param_2 + iVar13 + 0x4c) = 0;</pre>
<pre>        iVar13 = iVar7;</pre>
<pre>      } while (iVar7 != 0x60);</pre>
<pre>      *(undefined *)((int)param_2 + 0x113) = 0;</pre>
<pre>      if ((param_2[2] != 0) &amp;&amp; (mDNS_LoggingEnabled != 0)) {</pre>
<pre>        local_2c = (undefined4 *)(param_2[2] - *(int *)(param_1 + 0x234));</pre>
<pre>        uVar3 = DNSTypeName(*(undefined2 *)(param_2 + 0x95));</pre>
<pre>        LogMsgWithLevel(3,</pre>
<pre>                        "InitCommonState: Delaying answering for %d ticks while cache stabilizes for %##s (%s)"</pre>
<pre>                        ,local_2c,puVar14,uVar3);</pre>
<pre>      }</pre>
<pre>      cVar2 = local_38;</pre>
<pre>      param_2[0x36] = 0;</pre>
<pre>      *(undefined *)(param_2 + 0x3b) = 0;</pre>
<pre>      param_2[0x3c] = 0;</pre>
<pre><span class="green"><span class="green">      memcpy(param_2 + 0x3d,zeroAddr,0x14)</span></span></span></pre>
<pre>      param_2[0x43] = 0;</pre>
<pre>      *(undefined2 *)(param_2 + 0x42) = 0;</pre>
<pre>      param_2[0x45] = 1;</pre>
<pre>      param_2[0x49] = 0;</pre>
<pre>      param_2[0x4a] = 0;</pre>
<pre>      *(undefined *)((int)param_2 + 0x112) = 0;</pre>
<pre>      param_2[0x46] = 0;</pre>
<pre>      param_2[0x47] = 0;</pre>
<pre>      *(undefined2 *)(param_2 + 0x48) = 0;</pre>
<pre>      if (param_2[0x37] != 0) {</pre>
<pre>        if (*(char *)(param_2[0x37] + 0x13c) != '\0') {</pre>
<pre>          *(undefined *)((int)param_2 + 0x266) = 0;</pre>
<pre>        }</pre>
<pre>        if ((*(char *)((int)param_2 + 0x266) == '\x02') &amp;&amp;</pre>
<pre>           (*(char *)(param_2[0x37] + 0x142) == '\0')) {</pre>
<pre>          if (mDNS_LoggingEnabled != 0) {</pre>
<pre>            uVar3 = DNSTypeName(*(undefined2 *)(param_2 + 0x95));</pre>
<pre>            LogMsgWithLevel(3,</pre>
<pre>                            "InitDNSSECProxyState: Turning off validation for %##s (%s); req_DO false"</pre>
<pre>                            ,puVar14,uVar3);</pre>
<pre>          }</pre>
<pre>          *(undefined *)((int)param_2 + 0x266) = 0;</pre>
<pre>        }</pre>
<pre>      }</pre>
<pre>      param_2[0x32] = 0;</pre>
<pre>      param_2[0x31] = (uint)(*(char *)((int)param_2 + 0x266) != '\0');</pre>
<pre>      *(undefined2 *)(param_2 + 0x4b) = 0;</pre>
<pre>      puVar5 = *(undefined4 **)(param_1 + 0x2ac);</pre>
<pre>      do {</pre>
<pre>        if (puVar5 == (undefined4 *)0x0) {</pre>
<pre>LAB_004333cc:</pre>
<pre>          param_2[0xf] = puVar5;</pre>
<pre>          if (puVar5 != (undefined4 *)0x0) {</pre>
<pre>            param_2[0xe] = puVar5[0xe];</pre>
<pre>          }</pre>
<pre>          if ((param_2[0x4d] == -2) || (param_2[0x4d] == -4)) {</pre>
<pre>            if (*(int *)(param_1 + 700) == 0) {</pre>
<pre>              *(undefined4 **)(param_1 + 700) = param_2;</pre>
<pre>              return 0;</pre>
<pre>            }</pre>
<pre>          }</pre>
<pre>          else {</pre>
<pre>            if (*(int *)(param_1 + 0x2b0) == 0) {</pre>
<pre>              *(undefined4 **)(param_1 + 0x2b0) = param_2;</pre>
<pre>            }</pre>
<pre>            if (*(short *)((int)param_2 + 0x152) == 0) {</pre>
<pre>              if (cVar2 == '\0') {</pre>
<pre>                return 0;</pre>
<pre>              }</pre>
<pre>              if (mDNS_LoggingEnabled != 0) {</pre>
<pre>                LogMsgWithLevel(3,"mDNS_StartQuery_internal: Purging for %##s",puVar14);</pre>
<pre>              }</pre>
<pre>              FUN_00428fe8(param_1,param_2);</pre>
<pre>            }</pre>
<pre>            else {</pre>
<pre>              puVar5 = (undefined4 *)param_2[0xf];</pre>
<pre>              if (puVar5 != (undefined4 *)0x0) {</pre>
<pre>                param_2[0x38] = puVar5[0x38];</pre>
<pre>                param_2[0x39] = puVar5[0x39];</pre>
<pre>                param_2[0x37] = puVar5[0x37];</pre>
<pre>                if (mDNS_LoggingEnabled != 0) {</pre>
<pre>                  local_2c = puVar5;</pre>
<pre>                  uVar3 = DNSTypeName(*(undefined2 *)(param_2 + 0x95));</pre>
<pre>                  iVar13 = param_2[0x37];</pre>
<pre>                  if (iVar13 == 0) {</pre>
<pre>                    iVar13 = 0;</pre>
<pre>                    uVar1 = 0;</pre>
<pre>                  }</pre>
<pre>                  else {</pre>
<pre>                    uVar1 = *(undefined2 *)(iVar13 + 0x20);</pre>
<pre>                    iVar13 = iVar13 + 0xc;</pre>
<pre>                  }</pre>
<pre>                  LogMsgWithLevel(3,</pre>
<pre>                                  "FinalizeUnicastQuestion: Duplicate question %p (%p) %##s (%s), DNS Server %#a:%d"</pre>
<pre>                                  ,param_2,local_2c,puVar14,uVar3,iVar13,uVar1);</pre>
<pre>                }</pre>
<pre>              }</pre>
<pre>              FUN_0042c3ac(param_1,param_2,0);</pre>
<pre>              if (cVar2 == '\0') {</pre>
<pre>                if ((param_2[0xf] == 0) &amp;&amp;</pre>
<pre>                   (((*(char *)((int)param_2 + 0x266) != '\0' || (*(char *)(param_2 + 0x33) != '\0')</pre>
<pre>                     ) || ((*(char *)((int)param_2 + 0x267) != '\0' &amp;&amp;</pre>
<pre>                           (*(char *)(param_2 + 0x9a) != '\0')))))) {</pre>
<pre>                  puVar5 = (undefined4 *)0x0;</pre>
<pre>                  uVar4 = DomainNameHashValue(puVar14);</pre>
<pre>                  iVar13 = CacheGroupForName(param_1,uVar4 % 499,param_2[1],puVar14);</pre>
<pre>                  if (iVar13 != 0) {</pre>
<pre>                    puVar5 = *(undefined4 **)(iVar13 + 8);</pre>
<pre>                  }</pre>
<pre>                  for (; puVar5 != (undefined4 *)0x0; puVar5 = (undefined4 *)*puVar5) {</pre>
<pre>                    iVar13 = SameNameRecordAnswersQuestion(puVar5 + 1,param_2);</pre>
<pre>                    if ((iVar13 != 0) &amp;&amp;</pre>
<pre>                       (((*(char *)(puVar5 + 1) != -0x10 || (puVar5[0x15] == 0)) &amp;&amp;</pre>
<pre>                        (*(char *)((int)puVar5 + 0x4d) == '\0')))) {</pre>
<pre>                      if (mDNS_LoggingEnabled != 0) {</pre>
<pre>                        uVar3 = GetRRDisplayString_rdb(puVar5 + 1,puVar5[9] + 4,param_1 + 0x2f);</pre>
<pre>                        LogMsgWithLevel(3,"CheckForDNSSECRecords: Flushing %s",uVar3);</pre>
<pre>                      }</pre>
<pre>                      mDNS_PurgeCacheResourceRecord(param_1,puVar5);</pre>
<pre>                    }</pre>
<pre>                  }</pre>
<pre>                }</pre>
<pre>              }</pre>
<pre>              else {</pre>
<pre>                param_2[2] = 0;</pre>
<pre>                FUN_00428fe8(param_1,param_2);</pre>
<pre>              }</pre>
<pre>              if (*(char *)(param_2 + 0x96) == '\0') {</pre>
<pre>                return 0;</pre>
<pre>              }</pre>
<pre>              if (*(int *)(param_1 + 0x29b0) != 0) {</pre>
<pre>                return 0;</pre>
<pre>              }</pre>
<pre>              *(undefined *)(param_1 + 0x29a4) = 1;</pre>
<pre>              *(code **)(param_1 + 0x29b0) = FUN_0042dc1c;</pre>
<pre>              *(undefined2 *)(param_1 + 0x29a8) = *(undefined2 *)(param_1 + 0x10);</pre>
<pre>              *(undefined4 *)(param_1 + 0x29b4) = 1;</pre>
<pre>              *(undefined2 *)(param_1 + 0x29a6) = *(undefined2 *)(param_1 + 0x10);</pre>
<pre>              mDNS_StartNATOperation_internal(param_1,param_1 + 0x2970);</pre>
<pre>            }</pre>
<pre>          }</pre>
<pre>          return 0;</pre>
<pre>        }</pre>
<pre>        if (puVar5 == param_2) {</pre>
<pre>          puVar5 = (undefined4 *)0x0;</pre>
<pre>          goto LAB_004333cc;</pre>
<pre>        }</pre>
<pre>        if ((puVar5[0x4d] == param_2[0x4d]) &amp;&amp;</pre>
<pre>           ((((puVar5[0x4f] == 0 &amp;&amp; (param_2[0x4f] == 0)) ||</pre>
<pre>             ((iVar13 = mDNSSameAddress(puVar5 + 0x4f,param_2 + 0x4f), iVar13 != 0 &amp;&amp;</pre>
<pre>              (*(short *)(puVar5 + 0x54) == *(short *)(param_2 + 0x54))))) &amp;&amp;</pre>
<pre>            (puVar5[0x95] == param_2[0x95])))) {</pre>
<pre>          bVar12 = false;</pre>
<pre>          if (*(char *)(puVar5 + 0x96) != '\0') {</pre>
<pre>            bVar12 = *(short *)((int)puVar5 + 0x152) != 0;</pre>
<pre>          }</pre>
<pre>          bVar11 = false;</pre>
<pre>          if (*(char *)(param_2 + 0x96) != '\0') {</pre>
<pre>            bVar11 = *(short *)((int)param_2 + 0x152) != 0;</pre>
<pre>          }</pre>
<pre>          if ((((((bool)(bVar12 ^ 1U) != bVar11) &amp;&amp;</pre>
<pre>                (((puVar5[0xe] == 0 || (param_2[0xe] != 0)) &amp;&amp; (puVar5[0x11] == param_2[0x11])))) &amp;&amp;</pre>
<pre>               ((*(char *)(puVar5 + 0x2f) == *(char *)(param_2 + 0x2f) &amp;&amp;</pre>
<pre>                (*(char *)((int)puVar5 + 0x266) == *(char *)((int)param_2 + 0x266))))) &amp;&amp;</pre>
<pre>              (*(char *)(puVar5 + 0x33) == *(char *)(param_2 + 0x33))) &amp;&amp;</pre>
<pre>             (((*(char *)((int)puVar5 + 0x12e) == *(char *)((int)param_2 + 0x12e) &amp;&amp;</pre>
<pre>               (puVar5[9] == param_2[9])) &amp;&amp;</pre>
<pre>              ((puVar5[1] == param_2[1] &amp;&amp;</pre>
<pre>               (((((uint)puVar5[0x4e] &gt;&gt; 0x14 ^ 1 ^ (uint)param_2[0x4e] &gt;&gt; 0x14) &amp; 1) != 0 &amp;&amp;</pre>
<pre>                (iVar13 = SameDomainName(puVar5 + 0x55,puVar14), iVar13 != 0))))))))</pre>
<pre>          goto LAB_004333cc;</pre>
<pre>        }</pre>
<pre>        puVar5 = (undefined4 *)*puVar5;</pre>
<pre>      } while( true );</pre>
<pre>    }</pre>
<pre>    uVar3 = DNSTypeName(*(undefined2 *)(param_2 + 0x95));</pre>
<pre>    LogMsgWithLevel(0,"ValidateParameters: Attempt to start query with invalid qname %##s (%s)",</pre>
<pre>                    puVar14,uVar3);</pre>
<pre>    uVar3 = 0xfffefff3;</pre>
<pre>  }</pre>
<pre>  return uVar3;</pre>
<pre>}</pre>
<br />
  <!-- content end -->
</div>

<a href="https://github.com/e-m-b-a/emba" title="github.com/e-m-b-a/emba" target="_blank">
  <div id="buttonInfo" class="rectButtonVisible">
    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" transform="translate(2 2)"><g stroke="white" stroke-linecap="round" stroke-linejoin="round"><circle cx="8.5" cy="8.5" r="8"/><path d="M8.5 12.5v-4h-1"/><path d="M7.5 12.5h2"/></g><circle cx="8.5" cy="5.5" fill="white" r="1"/></g></svg>
  </div>
</a>
<div id="buttonBack" class="nonClickable rectButtonVisible"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><path d="M9.5 14.5l4-4l-4-4" fill="none" stroke="#444" stroke-linecap="round" stroke-linejoin="round"/></svg></div>
<div id="buttonForward" class="nonClickable rectButtonVisible"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><path d="M11.5 14.5l-4-4l4-4" fill="none" stroke="#444" stroke-linecap="round" stroke-linejoin="round"/></svg></div> 
<div id="buttonDown" class="rectButton" onclick="scrollDown()"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="#fff" stroke-linecap="round" stroke-linejoin="round"><path d="M14.5 6.5l-4 4l-4-4"/><path d="M14.5 10.5l-4 4l-4-4"/></g></svg></div>
<div id="buttonUp" class="rectButton" onclick="scrollUp()"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="#fff" stroke-linecap="round" stroke-linejoin="round"><path d="M6.5 14.5l4-4l4 4"/><path d="M6.5 10.5l4-4l4 4"/></g></svg></div> 

<script>
window.onload = function () {
  var buttons = document.getElementsByClassName("rectButton");
  for (let i=0; i<buttons.length; i++) {
    buttons[i].style.visibility = "visible";
  }
  var buttonDown = document.getElementById("buttonDown");
  buttonDown.classList.add('rectButtonVisible');
  buttonDown.classList.remove('rectButton');

  var buttonUp = document.getElementById("buttonUp");
  buttonUp.classList.add('rectButtonVisible');
  buttonUp.classList.remove('rectButton');
    
  var buttonSizer = document.getElementById("buttonSizer");
  buttonSizer.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="white" stroke-linecap="round" stroke-linejoin="round"><path d="M9.5 16.5v-4.978l-5-.022"/><path d="M18.5 2.5l-7 7"/><path d="M16.5 9.5l-5 .023V4.5"/><path d="M9.5 11.5l-7 7"/></g></svg>';
  if (document.getElementById("buttonTime") !== null) {
    var buttonTime = document.getElementById("buttonTime");
    buttonTime.style.bottom = "50px";
  }
  document.getElementById("expand").value = "+ Show more results";
  document.getElementById("expand").className += " expand";
  var embarkButton = document.getElementById("embark");
  if ( !(embarkButton.href.includes("embarkBackUrl")) ) {
    embarkButton.classList.remove('hidden');
    document.getElementById("logoImage").src = "./../../style/embark.svg";
    document.getElementById("logo").style.background = "#2d2d2d";
  }
}

function openNav() {
  document.getElementById("sidenav").style.width = "250px";
  document.getElementById("main").style.marginLeft = "250px";
  document.getElementById("nav").style.visibility = "visible";
}

function closeNav() {
  document.getElementById("sidenav").style.width = "50px";
  document.getElementById("sidenav").scrollTop = 0;
  document.getElementById("main").style.marginLeft = "50px";
  document.getElementById("nav").style.visibility = "hidden";
}

function scrollDown() {
  window.scrollTo(0,document.body.scrollHeight);
}

function scrollUp() {
  window.scrollTo(0,0);
}

function buttonNav() {
  var button = document.getElementById("buttonSizer");
  if ( button.classList.contains('buttonOpen') ) {
    button.classList.remove('buttonOpen');
    button.classList.add('buttonClose');
    button.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="white" stroke-linecap="round" stroke-linejoin="round"><path d="M9.5 16.5v-4.978l-5-.022"/><path d="M18.5 2.5l-7 7"/><path d="M16.5 9.5l-5 .023V4.5"/><path d="M9.5 11.5l-7 7"/></g></svg>';
    openNav();
  } else if( button.classList.contains('buttonClose') ) {
    button.classList.remove('buttonClose');
    button.classList.add('buttonOpen');
    button.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="white" stroke-linecap="round" stroke-linejoin="round"><path d="M18.5 7.5v-5h-5"/><path d="M18.5 2.5l-6 5.929"/><path d="M7.5 18.5l-5 .023V13.5"/><path d="M8.5 12.5l-6 6"/></g></svg>';
    closeNav();
  };
}

// the following function is currently not used
// it is for future extensions
function overlay_output(link) {
  var rawfile = new XMLHttpRequest();
  rawfile.open('GET', link, false);
  rawfile.overrideMimeType("text");
  rawfile.onreadystatechange = function()
  {
    alert(rawfile.responseText);
    //console.log(rawfile.responseText);
  }
  rawfile.send(null);
}

document.onkeydown = function(e) {
    switch (e.keyCode) {
      case 37:
        document.getElementById("buttonForward").parentNode.click(); 
        break;
      case 39:
        document.getElementById("buttonBack").parentNode.click();       
        break;
    }
};
</script>

</body>
</html>
