<!-- 
EMBA - EMBEDDED LINUX ANALYZER

Copyright 2020-2023 Siemens AG
Copyright 2020-2024 Siemens Energy AG

EMBA comes with ABSOLUTELY NO WARRANTY. This is free software, and you are
welcome to redistribute it under the terms of the GNU General Public License.
See LICENSE file for usage of this software.

EMBA is licensed under GPLv3

Author(s) and contributors from the EMBA project are listed here: https://github.com/e-m-b-a/emba/blob/master/CONTRIBUTORS.md
-->

<!-- Used icons: https://github.com/CoreyGinnivan/system-uicons -->
 
<!DOCTYPE html>
<html lang="en">
<head>
  <title>EMBA firmware report</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="./../../style/style.css" type="text/css">
  <link rel="icon" type="image/png" href="./../../style/favicon.png">
</head>
<body>

<div id="sidenav" class="side">
  <div id="logo">
    <a class="inherit" href="./../../index.html"><img class="inherit" id="logoImage" src="./../../style/emba.svg" alt="logo"></a>
  </div>
  <div id="nav">
      <a id="embark" class="hidden" href="{{ embarkBackUrl }}">&laquo; Back to EMBArk</a> <!-- nosem -->
      <a class="backButton" href="./../../index.html">&laquo; Back to main</a>
<a class="modul" href="./../semgrep_mDNSClientPosix.html" title="./../semgrep_mDNSClientPosix.html" >&laquo; Back to semgrep_mDNSClientPosix</a>
      <!-- navigation start -->
      <!-- navigation end -->
      <input id="expand" class="expand_njs hidden" type="button" value="More results:" onclick="this.value=this.value=='+ Show more results'?'- Hide more results':'+ Show more results';">
      <div class="expand_area">
        <!-- etc start -->
        <!-- etc end -->
      </div>
  </div>
  <a href="TIMELINK"><div id="buttonTimeInvisible" class="rectButton"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="white" stroke-linecap="round" stroke-linejoin="round" transform="matrix(-1 0 0 1 19 2)"><circle cx="8.5" cy="8.5" r="8"/><path d="M8.5 5.5v4H5"/></g></svg></div></a>
  <div id="buttonSizer" class="rectButton buttonClose" onclick="buttonNav()"></div>
</div>
<div id="main" class="main">
  <!-- content start -->
<br />
<pre>/* WARNING: Removing unreachable block (ram,0x00446bf0) */</pre>
<pre>/* WARNING: Removing unreachable block (ram,0x00446684) */</pre>
<pre>/* WARNING: Removing unreachable block (ram,0x00446df0) */</pre>
<br />
<pre>undefined4 mDNS_Register_internal(int param_1,int *param_2)</pre>
<br />
<pre>{</pre>
<pre>  byte bVar1;</pre>
<pre>  byte bVar2;</pre>
<pre>  short sVar3;</pre>
<pre>  undefined4 uVar4;</pre>
<pre>  undefined4 *puVar5;</pre>
<pre>  uint uVar6;</pre>
<pre>  undefined *puVar7;</pre>
<pre>  undefined2 uVar9;</pre>
<pre>  int *piVar8;</pre>
<pre>  undefined uVar11;</pre>
<pre>  int *piVar10;</pre>
<pre>  char *pcVar12;</pre>
<pre>  int **ppiVar13;</pre>
<pre>  int *piVar14;</pre>
<pre>  int iVar15;</pre>
<pre>  int **ppiVar16;</pre>
<pre>  int **ppiVar17;</pre>
<pre>  int **ppiVar18;</pre>
<pre>  code *pcVar19;</pre>
<pre>  undefined auStack_48 [24];</pre>
<pre>  int **local_30;</pre>
<pre>  int local_2c;</pre>
<pre>  </pre>
<pre><span class="green">  sVar3 = *(short *)((int)param_2 + 6)</span></span></pre>
<pre>  if ((((sVar3 == 2) || (sVar3 == 5)) || (sVar3 == 0xc)) || (sVar3 == 0x27)) {</pre>
<pre>    piVar14 = (int *)(param_2[9] + 4);</pre>
<pre>  }</pre>
<pre>  else if (((sVar3 == 0xf) || (sVar3 == 0x12)) || ((sVar3 == 0x15 || (sVar3 == 0x24)))) {</pre>
<pre>    piVar14 = (int *)(param_2[9] + 6);</pre>
<pre>  }</pre>
<pre>  else {</pre>
<pre>    piVar14 = (int *)0x0;</pre>
<pre>    if (sVar3 == 0x21) {</pre>
<pre>      piVar14 = (int *)(param_2[9] + 10);</pre>
<pre>    }</pre>
<pre>  }</pre>
<pre>  iVar15 = param_2[3];</pre>
<pre>  if (iVar15 &lt; 1) {</pre>
<pre>    uVar4 = GetRRDisplayString_rdb(param_2 + 1,param_2[9] + 4,param_1 + 0x2f);</pre>
<pre>    LogMsgWithLevel(0,"mDNS_Register_internal: TTL %X should be 1 - 0x7FFFFFFF %s",iVar15,uVar4);</pre>
<pre>  }</pre>
<pre>  else {</pre>
<pre>    if (*(char *)(param_2 + 1) != '\0') {</pre>
<pre>      if (*(int *)(param_1 + 0x240) != 0) {</pre>
<pre>        uVar4 = GetRRDisplayString_rdb(param_2 + 1,param_2[9] + 4,param_1 + 0x2f);</pre>
<pre>        LogMsgWithLevel(0,"mDNS_Register_internal: Shutting down, can\'t register %s",uVar4);</pre>
<pre>        return 0xfffeffe5;</pre>
<pre>      }</pre>
<pre>      if ((*(char *)(param_1 + 10) != '\0') &amp;&amp;</pre>
<pre>         (((param_2[7] != 0 || (*(char *)((int)param_2 + 0x4a) != '\0')) ||</pre>
<pre>          (iVar15 = IsLocalDomain(param_2[8],param_2,param_1 + 0x2f), iVar15 != 0)))) {</pre>
<pre>        iVar15 = param_2[7];</pre>
<pre>        if ((iVar15 == 0) || (iVar15 == -4)) {</pre>
<pre>          param_2[0x1f] = 4;</pre>
<pre>          param_2[7] = -2;</pre>
<pre>        }</pre>
<pre>        if (param_2[7] != -2) {</pre>
<pre>          for (puVar5 = *(undefined4 **)(param_1 + 0x2174); puVar5 != (undefined4 *)0x0;</pre>
<pre>              puVar5 = (undefined4 *)*puVar5) {</pre>
<pre>            if (puVar5[0x548] == param_2[7]) {</pre>
<pre>              if (*(char *)((int)puVar5 + 0x1592) == '\0') {</pre>
<pre>                param_2[7] = -2;</pre>
<pre>                param_2[0x1f] = 4;</pre>
<pre>              }</pre>
<pre>              break;</pre>
<pre>            }</pre>
<pre>          }</pre>
<pre>        }</pre>
<pre>        if ((param_2[7] != iVar15) &amp;&amp; (mDNS_LoggingEnabled != 0)) {</pre>
<pre>          uVar4 = GetRRDisplayString_rdb(param_2 + 1,param_2[9] + 4,param_1 + 0x2f);</pre>
<pre>          LogMsgWithLevel(3,"mDNS_Register_internal: Diverting record to local-only %s",uVar4);</pre>
<pre>        }</pre>
<pre>      }</pre>
<pre>      ppiVar17 = (int **)(param_1 + 0x2160);</pre>
<pre>      if (param_2[0x1f] - 4U &lt; 2) {</pre>
<pre>        uVar6 = DomainNameHashValue(param_2[8]);</pre>
<pre>        iVar15 = FUN_00427c58(param_1 + 0x1278,uVar6 % 499,param_2 + 1);</pre>
<pre>        ppiVar18 = (int **)(param_1 + 0x2164);</pre>
<pre>        if (iVar15 != 0) {</pre>
<pre>          for (ppiVar13 = *(int ***)(iVar15 + 8); ppiVar18 = (int **)(param_1 + 0x2164),</pre>
<pre>              ppiVar13 != (int **)0x0; ppiVar13 = (int **)*ppiVar13) {</pre>
<pre>            if (ppiVar13 == (int **)param_2) {</pre>
<pre>              local_2c = (int)ppiVar13[8];</pre>
<pre>              local_30 = ppiVar13;</pre>
<pre>              uVar4 = DNSTypeName(*(undefined2 *)((int)ppiVar13 + 6));</pre>
<pre>              pcVar12 = </pre>
<pre>              "mDNS_Register_internal: ERROR!! Tried to register LocalOnly AuthRecord %p %##s (%s) that\'s already in the list"</pre>
<pre>              ;</pre>
<pre>              param_2 = (int *)local_30;</pre>
<pre>              goto LAB_00446780;</pre>
<pre>            }</pre>
<pre>          }</pre>
<pre>        }</pre>
<pre>LAB_00446744:</pre>
<pre>        do {</pre>
<pre>          ppiVar13 = (int **)*ppiVar18;</pre>
<pre>          if (ppiVar13 == (int **)0x0) {</pre>
<pre>            if (param_2[0xe] != 0) {</pre>
<pre>              if (*(char *)(param_2 + 1) != '\x02') {</pre>
<pre>                local_30 = (int **)param_2[8];</pre>
<pre>                uVar4 = DNSTypeName(*(undefined2 *)((int)param_2 + 6));</pre>
<pre>                LogMsgWithLevel(0,</pre>
<pre>                                "mDNS_Register_internal: ERROR! %##s (%s): rr-&gt;DependentOn &amp;&amp; RecordType != kDNSRecordTypeUnique"</pre>
<pre>                                ,local_30,uVar4);</pre>
<pre>                return 0xfffefff3;</pre>
<pre>              }</pre>
<pre>              *(undefined *)(param_2 + 1) = 0x10;</pre>
<pre>              if ((*(byte *)(param_2[0xe] + 4) &amp; 0x32) == 0) {</pre>
<pre>                local_30 = (int **)param_2[8];</pre>
<pre>                uVar4 = DNSTypeName(*(undefined2 *)((int)param_2 + 6));</pre>
<pre>                LogMsgWithLevel(0,</pre>
<pre>                                "mDNS_Register_internal: ERROR! %##s (%s): rr-&gt;DependentOn-&gt;RecordType bad type %X"</pre>
<pre>                                ,local_30,uVar4,*(undefined *)(param_2[0xe] + 4));</pre>
<pre>                return 0xfffefff3;</pre>
<pre>              }</pre>
<pre>            }</pre>
<pre>            *param_2 = 0;</pre>
<pre>            if ((*(char *)(param_2 + 0x12) != '\0') &amp;&amp; (piVar14 != (int *)0x0)) {</pre>
<pre>              *(undefined *)piVar14 = 0;</pre>
<pre>            }</pre>
<pre>            uVar11 = 3;</pre>
<pre>            if (*(char *)(param_2 + 1) != '\x02') {</pre>
<pre>              uVar11 = 0;</pre>
<pre>            }</pre>
<pre>            *(undefined *)((int)param_2 + 0x87) = 4;</pre>
<pre>            *(undefined *)((int)param_2 + 0x86) = uVar11;</pre>
<pre>            *(undefined *)(param_2 + 0x21) = 0;</pre>
<pre>            param_2[0x27] = 0;</pre>
<pre>            *(undefined *)((int)param_2 + 0x85) = 0;</pre>
<pre>            *(undefined *)(param_2 + 0x22) = 0;</pre>
<pre>            *(undefined *)((int)param_2 + 0x89) = 0;</pre>
<pre>            *(undefined *)((int)param_2 + 0x8a) = 0;</pre>
<pre>            *(undefined *)((int)param_2 + 0x8b) = 0;</pre>
<pre>            param_2[0x23] = 0;</pre>
<pre>            param_2[0x24] = 0;</pre>
<pre>            param_2[0x25] = 0;</pre>
<pre>            param_2[0x26] = 0;</pre>
<pre><span class="green"><span class="green">            memcpy(param_2 + 0x28,zerov6Addr,0x10)</span></span></span></pre>
<pre>            param_2[0x2c] = 0;</pre>
<pre>            param_2[0x2d] = 0;</pre>
<pre>            param_2[0x2e] = 0;</pre>
<pre>            if (*(char *)(param_2 + 0x12) == '\0') {</pre>
<pre>              FUN_00428828(param_1,param_2);</pre>
<pre>            }</pre>
<pre>            param_2[0x36] = 10;</pre>
<pre>            param_2[0x33] = 0;</pre>
<pre>            *(undefined2 *)(param_2 + 0x34) = 0;</pre>
<pre>            param_2[0x35] = 0;</pre>
<pre>            param_2[0x37] = 0;</pre>
<pre>            param_2[0x38] = 0;</pre>
<pre>            if ((*(int *)((int)param_2 + 0x4e) != 0) &amp;&amp; (param_2[0x18] == 0)) {</pre>
<pre>              *(undefined *)((int)param_2 + 0x87) = 2;</pre>
<pre>            }</pre>
<pre>            param_2[0x3f] = param_2[8];</pre>
<pre>            *(undefined2 *)((int)param_2 + 0xf2) = 0;</pre>
<pre>            param_2[0x3d] = 0;</pre>
<pre>            param_2[0x3e] = 0;</pre>
<pre>            param_2[0x39] = 0;</pre>
<pre>            *(undefined *)(param_2 + 0x3a) = 0;</pre>
<pre>            param_2[0x3b] = 0;</pre>
<pre>            *(undefined *)(param_2 + 0x3c) = 0;</pre>
<pre>            param_2[0x40] = 0;</pre>
<pre>            param_2[0x41] = 0;</pre>
<pre>            param_2[0x5b] = 0;</pre>
<pre>            *(undefined2 *)(param_2 + 0x59) = 0;</pre>
<pre>            param_2[0x5c] = 0;</pre>
<pre>            *(undefined2 *)((int)param_2 + 0x166) = 0;</pre>
<pre>            param_2[0x5d] = 0;</pre>
<pre>            *(undefined2 *)(param_2 + 0x5a) = 0;</pre>
<pre>            if ((*(short *)((int)param_2 + 6) == 0x10) &amp;&amp; (*(short *)(param_2 + 4) == 0)) {</pre>
<pre>              *(undefined2 *)(param_2 + 4) = 1;</pre>
<pre>              *(undefined *)(param_2[9] + 4) = 0;</pre>
<pre>            }</pre>
<pre>            if (*(char *)(param_2 + 0x12) == '\0') {</pre>
<pre>              uVar9 = GetRDLength(param_2 + 1,0);</pre>
<pre>              *(undefined2 *)(param_2 + 4) = uVar9;</pre>
<pre>              uVar9 = GetRDLength(param_2 + 1,1);</pre>
<pre>              *(undefined2 *)((int)param_2 + 0x12) = uVar9;</pre>
<pre>            }</pre>
<pre>            else {</pre>
<pre>              FUN_0042cc08(param_1,param_2);</pre>
<pre>              if (param_2[0x39] == 8) {</pre>
<pre><span class="green">                sVar3 = *(short *)((int)param_2 + 6)</span></span></pre>
<pre>                if ((((sVar3 == 2) || (sVar3 == 5)) || (sVar3 == 0xc)) || (sVar3 == 0x27)) {</pre>
<pre>                  puVar7 = (undefined *)(param_2[9] + 4);</pre>
<pre>LAB_00446a3c:</pre>
<pre>                  if (puVar7 != (undefined *)0x0) {</pre>
<pre>                    *puVar7 = 0;</pre>
<pre>                  }</pre>
<pre>                }</pre>
<pre>                else {</pre>
<pre>                  if (((sVar3 == 0xf) || (sVar3 == 0x12)) || ((sVar3 == 0x15 || (sVar3 == 0x24)))) {</pre>
<pre>                    puVar7 = (undefined *)(param_2[9] + 6);</pre>
<pre>                    goto LAB_00446a3c;</pre>
<pre>                  }</pre>
<pre>                  if (sVar3 == 0x21) {</pre>
<pre>                    puVar7 = (undefined *)(param_2[9] + 10);</pre>
<pre>                    goto LAB_00446a3c;</pre>
<pre>                  }</pre>
<pre>                }</pre>
<pre>                if (mDNS_LoggingEnabled != 0) {</pre>
<pre>                  uVar4 = GetRRDisplayString_rdb(param_2 + 1,param_2[9] + 4,param_1 + 0x2f);</pre>
<pre>                  LogMsgWithLevel(3,"mDNS_Register_internal: record %s in NoTarget state",uVar4);</pre>
<pre>                }</pre>
<pre>              }</pre>
<pre>            }</pre>
<pre>            uVar6 = DomainNameLengthLimit(param_2[8],param_2[8] + 0x100);</pre>
<pre>            if (0x100 &lt; uVar6) {</pre>
<pre>              uVar4 = GetRRDisplayString_rdb(param_2 + 1,param_2[9] + 4,param_1 + 0x2f);</pre>
<pre>              pcVar12 = "Attempt to register record with invalid name: %s";</pre>
<pre>LAB_00446b50:</pre>
<pre>              LogMsgWithLevel(0,pcVar12,uVar4);</pre>
<pre>              return 0xfffefff3;</pre>
<pre>            }</pre>
<pre>            iVar15 = ValidateRData(*(undefined2 *)((int)param_2 + 6),*(undefined2 *)(param_2 + 4));</pre>
<pre>            if (iVar15 == 0) {</pre>
<pre>              uVar4 = GetRRDisplayString_rdb(param_2 + 1,param_2[9] + 4,param_1 + 0x2f);</pre>
<pre>              pcVar12 = "Attempt to register record with invalid rdata: %s";</pre>
<pre>              goto LAB_00446b50;</pre>
<pre>            }</pre>
<pre>            iVar15 = DomainNameHashValue(param_2[8]);</pre>
<pre>            param_2[5] = iVar15;</pre>
<pre>            if (piVar14 == (int *)0x0) {</pre>
<pre>              pcVar19 = RDataHashValue;</pre>
<pre>              piVar14 = param_2 + 1;</pre>
<pre>            }</pre>
<pre>            else {</pre>
<pre>              pcVar19 = DomainNameHashValue;</pre>
<pre>            }</pre>
<pre>            iVar15 = (*pcVar19)(piVar14);</pre>
<pre>            param_2[6] = iVar15;</pre>
<pre>            if ((param_2[0x1f] - 4U &lt; 2) &amp;&amp; ((*(byte *)(param_2 + 1) &amp; 0x32) != 0)) {</pre>
<pre>              uVar6 = DomainNameHashValue(param_2[8]);</pre>
<pre>              iVar15 = FUN_00427c58(param_1 + 0x1278,uVar6 % 499,param_2 + 1);</pre>
<pre>              ppiVar13 = (int **)(iVar15 + 8);</pre>
<pre>              if (iVar15 != 0) {</pre>
<pre>                for (; piVar14 = *ppiVar13, piVar14 != (int *)0x0; ppiVar13 = (int **)*ppiVar13) {</pre>
<pre>                  piVar10 = (int *)param_2[0xf];</pre>
<pre>                  if ((int *)param_2[0xf] == (int *)0x0) {</pre>
<pre>                    piVar10 = param_2;</pre>
<pre>                  }</pre>
<pre>                  piVar8 = (int *)piVar14[0xf];</pre>
<pre>                  if ((int *)piVar14[0xf] == (int *)0x0) {</pre>
<pre>                    piVar8 = piVar14;</pre>
<pre>                  }</pre>
<pre>                  if (((piVar10 != piVar8) &amp;&amp;</pre>
<pre>                      (*(short *)((int)piVar14 + 6) == *(short *)((int)param_2 + 6))) &amp;&amp;</pre>
<pre>                     (iVar15 = FUN_00427870(piVar14,param_2), iVar15 != 0)) {</pre>
<pre>                    piVar14 = *ppiVar13;</pre>
<pre>                    if (((*(short *)((int)piVar14 + 6) != *(short *)((int)param_2 + 6)) ||</pre>
<pre>                        (*(short *)(piVar14 + 2) != *(short *)(param_2 + 2))) ||</pre>
<pre>                       ((*(short *)(piVar14 + 4) != *(short *)(param_2 + 4) ||</pre>
<pre>                        ((piVar14[6] != param_2[6] ||</pre>
<pre>                         (iVar15 = SameRDataBody(piVar14 + 1,param_2[9] + 4,SameDomainName),</pre>
<pre>                         iVar15 == 0)))))) {</pre>
<pre>                      if (mDNS_LoggingEnabled != 0) {</pre>
<pre>                        uVar4 = GetRRDisplayString_rdb(param_2 + 1,param_2[9] + 4,param_1 + 0x2f);</pre>
<pre>                        LogMsgWithLevel(3,</pre>
<pre>                                        "mDNS_Register_internal: Name conflict %s (%p), InterfaceID %p"</pre>
<pre>                                        ,uVar4,param_2,param_2[7]);</pre>
<pre>                      }</pre>
<pre>                      return 0xfffefff4;</pre>
<pre>                    }</pre>
<pre>                  }</pre>
<pre>                }</pre>
<pre>              }</pre>
<pre>            }</pre>
<pre>            if (((param_2[7] == 0) &amp;&amp; (*(char *)((int)param_2 + 0x4a) == '\0')) &amp;&amp;</pre>
<pre>               (iVar15 = IsLocalDomain(param_2[8]), iVar15 == 0)) {</pre>
<pre>              if (*(int *)(param_1 + 0x2168) == 0) {</pre>
<pre>                *(int **)(param_1 + 0x2168) = param_2;</pre>
<pre>              }</pre>
<pre>              do {</pre>
<pre>                ppiVar18 = ppiVar17;</pre>
<pre>                ppiVar17 = (int **)*ppiVar18;</pre>
<pre>              } while (ppiVar17 != (int **)0x0);</pre>
<pre>              *ppiVar18 = param_2;</pre>
<pre>              if (*(char *)(param_2 + 1) == '\x02') {</pre>
<pre>                *(undefined *)(param_2 + 1) = 0x10;</pre>
<pre>              }</pre>
<pre>              *(undefined *)((int)param_2 + 0x86) = 0;</pre>
<pre>              *(undefined *)((int)param_2 + 0x85) = 0;</pre>
<pre>              *(undefined *)((int)param_2 + 0x87) = 0;</pre>
<pre>              if (param_2[0x39] == 8) {</pre>
<pre>                return 0;</pre>
<pre>              }</pre>
<pre>              ActivateUnicastRegistration(param_1,param_2);</pre>
<pre>              return 0;</pre>
<pre>            }</pre>
<pre>            if (param_2[0x1f] - 4U &lt; 2) {</pre>
<pre>              *(undefined *)((int)param_2 + 0x86) = 0;</pre>
<pre>              *(undefined *)((int)param_2 + 0x85) = 0;</pre>
<pre>              *(undefined *)((int)param_2 + 0x87) = 0;</pre>
<pre>              uVar6 = DomainNameHashValue(param_2[8]);</pre>
<pre>              iVar15 = FUN_00427c58(param_1 + 0x1278,uVar6 % 499,param_2 + 1);</pre>
<pre>              ppiVar16 = (int **)(iVar15 + 8);</pre>
<pre>              if (iVar15 != 0) {</pre>
<pre>                for (; piVar14 = *ppiVar16, piVar14 != (int *)0x0; ppiVar16 = (int **)*ppiVar16) {</pre>
<pre>                  if (piVar14[7] == param_2[7]) {</pre>
<pre>                    bVar1 = *(byte *)(piVar14 + 1);</pre>
<pre>                    bVar2 = *(byte *)(param_2 + 1);</pre>
<pre>                    if ((((bVar1 == bVar2) || ((bVar2 | bVar1) == 0x12)) ||</pre>
<pre>                        ((bVar1 == 1 || (bVar2 == 1)))) &amp;&amp;</pre>
<pre>                       (((*(short *)((int)piVar14 + 6) == *(short *)((int)param_2 + 6) &amp;&amp;</pre>
<pre>                         (*(short *)(piVar14 + 2) == *(short *)(param_2 + 2))) &amp;&amp;</pre>
<pre>                        ((piVar14[5] == param_2[5] &amp;&amp;</pre>
<pre>                         ((((*(short *)(piVar14 + 4) == *(short *)(param_2 + 4) &amp;&amp;</pre>
<pre>                            (piVar14[6] == param_2[6])) &amp;&amp;</pre>
<pre>                           (iVar15 = SameRDataBody(piVar14 + 1,param_2[9] + 4,SameDomainName),</pre>
<pre>                           iVar15 != 0)) &amp;&amp;</pre>
<pre>                          (iVar15 = SameDomainName((*ppiVar16)[8],param_2[8]), iVar15 != 0)))))))) {</pre>
<pre>                      ppiVar13 = (int **)*ppiVar16;</pre>
<pre>                      if (*(char *)((int *)ppiVar13 + 1) != '\x01') {</pre>
<pre>                        if (ppiVar13 != (int **)0x0) goto LAB_0044701c;</pre>
<pre>                        break;</pre>
<pre>                      }</pre>
<pre>                      *(undefined *)((int)ppiVar13 + 0x87) = 0;</pre>
<pre>                    }</pre>
<pre>                  }</pre>
<pre>                }</pre>
<pre>              }</pre>
<pre>            }</pre>
<pre>            else {</pre>
<pre>              for (ppiVar13 = *(int ***)(param_1 + 0x2160); ppiVar13 != (int **)0x0;</pre>
<pre>                  ppiVar13 = (int **)*ppiVar13) {</pre>
<pre>                if (ppiVar13[7] == (int *)param_2[7]) {</pre>
<pre>                  bVar1 = *(byte *)(ppiVar13 + 1);</pre>
<pre>                  bVar2 = *(byte *)(param_2 + 1);</pre>
<pre>                  if ((((bVar1 == bVar2) || ((bVar2 | bVar1) == 0x12)) ||</pre>
<pre>                      ((bVar1 == 1 || (bVar2 == 1)))) &amp;&amp;</pre>
<pre>                     ((((*(short *)((int)ppiVar13 + 6) == *(short *)((int)param_2 + 6) &amp;&amp;</pre>
<pre>                        (*(short *)(ppiVar13 + 2) == *(short *)(param_2 + 2))) &amp;&amp;</pre>
<pre>                       (ppiVar13[5] == (int *)param_2[5])) &amp;&amp;</pre>
<pre>                      ((((*(short *)(ppiVar13 + 4) == *(short *)(param_2 + 4) &amp;&amp;</pre>
<pre>                         (ppiVar13[6] == (int *)param_2[6])) &amp;&amp;</pre>
<pre>                        (iVar15 = SameRDataBody(ppiVar13 + 1,param_2[9] + 4,SameDomainName),</pre>
<pre>                        iVar15 != 0)) &amp;&amp;</pre>
<pre>                       (iVar15 = SameDomainName(ppiVar13[8],param_2[8]), iVar15 != 0)))))) {</pre>
<pre>                    if (*(char *)(ppiVar13 + 1) != '\x01') {</pre>
<pre>LAB_0044701c:</pre>
<pre>                      *ppiVar18 = param_2;</pre>
<pre>                      if ((*(char *)(param_2 + 1) == '\x02') &amp;&amp;</pre>
<pre>                         (*(char *)((int *)ppiVar13 + 1) == '\x10')) {</pre>
<pre>                        *(undefined *)((int)param_2 + 0x86) = 0;</pre>
<pre>                      }</pre>
<pre>                      goto LAB_004470bc;</pre>
<pre>                    }</pre>
<pre>                    *(undefined *)((int)ppiVar13 + 0x87) = 0;</pre>
<pre>                  }</pre>
<pre>                }</pre>
<pre>              }</pre>
<pre>            }</pre>
<pre>            if (param_2[0x1f] - 4U &lt; 2) {</pre>
<pre>              iVar15 = FUN_004389bc(param_1,param_1 + 0x1278,param_2);</pre>
<pre>              if ((iVar15 != 0) &amp;&amp; (*(int *)(iVar15 + 0x14) == 0)) {</pre>
<pre>                *(undefined *)(param_1 + 0x2170) = 1;</pre>
<pre>                *(int **)(iVar15 + 0x14) = param_2;</pre>
<pre>              }</pre>
<pre>              if (*(char *)(param_2 + 1) == '\x02') {</pre>
<pre>                *(undefined *)(param_2 + 1) = 0x10;</pre>
<pre>              }</pre>
<pre>              FUN_00426c2c(param_1,param_2);</pre>
<pre>              return 0;</pre>
<pre>            }</pre>
<pre>            if (*(int *)(param_1 + 0x2168) == 0) {</pre>
<pre>              *(int **)(param_1 + 0x2168) = param_2;</pre>
<pre>            }</pre>
<pre>            *ppiVar17 = param_2;</pre>
<pre>LAB_004470bc:</pre>
<pre>            if ((*(int *)((int)param_2 + 0x4e) == 0) &amp;&amp; (*(short *)((int)param_2 + 6) == 10)) {</pre>
<pre>              uVar6 = (uint)*(byte *)param_2[8];</pre>
<pre>              iVar15 = uVar6 + 1;</pre>
<pre>              if (uVar6 == 0) {</pre>
<pre>                iVar15 = 0;</pre>
<pre>              }</pre>
<pre>              iVar15 = SameDomainLabel((byte *)param_2[8] + iVar15,"\n_keepalive");</pre>
<pre>              if (iVar15 != 0) {</pre>
<pre>                *(undefined *)(param_2 + 1) = 0x20;</pre>
<pre>                *(undefined *)((int)param_2 + 0x87) = 0;</pre>
<pre>                FUN_0042b250(param_1,param_2,auStack_48);</pre>
<pre>                mDNSPlatformGetRemoteMacAddr(param_1,auStack_48);</pre>
<pre>              }</pre>
<pre>            }</pre>
<pre>            if (((param_2[7] == 0) &amp;&amp; (*(char *)((int)param_2 + 0x4a) == '\0')) &amp;&amp;</pre>
<pre>               (iVar15 = IsLocalDomain(param_2[8]), iVar15 == 0)) {</pre>
<pre>              return 0;</pre>
<pre>            }</pre>
<pre>            if (param_2[0x1f] - 4U &lt; 2) {</pre>
<pre>              if (mDNS_LoggingEnabled != 0) {</pre>
<pre>                uVar4 = GetRRDisplayString_rdb(param_2 + 1,param_2[9] + 4,param_1 + 0x2f);</pre>
<pre>                LogMsgWithLevel(3,"IncrementAutoTargetServices: called for RRLocalOnly() record: %s"</pre>
<pre>                                ,uVar4);</pre>
<pre>              }</pre>
<pre>            }</pre>
<pre>            else if ((((param_2[7] != 0) || (*(char *)((int)param_2 + 0x4a) != '\0')) ||</pre>
<pre>                     (iVar15 = IsLocalDomain(param_2[8]), iVar15 != 0)) &amp;&amp;</pre>
<pre>                    ((*(short *)((int)param_2 + 6) == 0x21 &amp;&amp; (*(char *)(param_2 + 0x12) == '\x01'))</pre>
<pre>                    )) {</pre>
<pre>              iVar15 = *(int *)(param_1 + 0x3908) + 1;</pre>
<pre>              *(int *)(param_1 + 0x3908) = iVar15;</pre>
<pre>              if (mDNS_LoggingEnabled != 0) {</pre>
<pre>                uVar4 = GetRRDisplayString_rdb(param_2 + 1,param_2[9] + 4,param_1 + 0x2f);</pre>
<pre>                LogMsgWithLevel(3,"IncrementAutoTargetServices: AutoTargetServices %d Record %s",</pre>
<pre>                                iVar15,uVar4);</pre>
<pre>              }</pre>
<pre>              if (*(int *)(param_1 + 0x3908) == 1) {</pre>
<pre>                FUN_004477f0(param_1);</pre>
<pre>              }</pre>
<pre>            }</pre>
<pre>            if (1 &lt; (byte)(*(char *)(param_2 + 1) - 1U)) {</pre>
<pre>              FUN_00426c2c(param_1,param_2);</pre>
<pre>            }</pre>
<pre>            FUN_0042f54c(param_1);</pre>
<pre>            return 0;</pre>
<pre>          }</pre>
<pre>          ppiVar18 = ppiVar13;</pre>
<pre>        } while (ppiVar13 != (int **)param_2);</pre>
<pre>        local_2c = param_2[8];</pre>
<pre>        uVar4 = DNSTypeName(*(undefined2 *)((int)param_2 + 6));</pre>
<pre>        pcVar12 = </pre>
<pre>        "mDNS_Register_internal: ERROR!! Tried to register AuthRecord %p %##s (%s) that\'s already in the Duplicate list"</pre>
<pre>        ;</pre>
<pre>      }</pre>
<pre>      else {</pre>
<pre>        do {</pre>
<pre>          ppiVar13 = (int **)*ppiVar17;</pre>
<pre>          ppiVar18 = (int **)(param_1 + 0x2164);</pre>
<pre>          if (ppiVar13 == (int **)0x0) goto LAB_00446744;</pre>
<pre>          ppiVar17 = ppiVar13;</pre>
<pre>        } while (ppiVar13 != (int **)param_2);</pre>
<pre>        local_2c = param_2[8];</pre>
<pre>        uVar4 = DNSTypeName(*(undefined2 *)((int)param_2 + 6));</pre>
<pre>        pcVar12 = </pre>
<pre>        "mDNS_Register_internal: ERROR!! Tried to register AuthRecord %p %##s (%s) that\'s already in the list"</pre>
<pre>        ;</pre>
<pre>      }</pre>
<pre>LAB_00446780:</pre>
<pre>      LogMsgWithLevel(0,pcVar12,param_2,local_2c,uVar4);</pre>
<pre>      return 0xfffefff5;</pre>
<pre>    }</pre>
<pre>    uVar4 = GetRRDisplayString_rdb(param_2 + 1,param_2[9] + 4);</pre>
<pre>    LogMsgWithLevel(0,"mDNS_Register_internal: RecordType must be non-zero %s",uVar4);</pre>
<pre>  }</pre>
<pre>  return 0xfffefffc;</pre>
<pre>}</pre>
<br />
  <!-- content end -->
</div>

<a href="https://github.com/e-m-b-a/emba" title="github.com/e-m-b-a/emba" target="_blank">
  <div id="buttonInfo" class="rectButtonVisible">
    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" transform="translate(2 2)"><g stroke="white" stroke-linecap="round" stroke-linejoin="round"><circle cx="8.5" cy="8.5" r="8"/><path d="M8.5 12.5v-4h-1"/><path d="M7.5 12.5h2"/></g><circle cx="8.5" cy="5.5" fill="white" r="1"/></g></svg>
  </div>
</a>
<div id="buttonBack" class="nonClickable rectButtonVisible"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><path d="M9.5 14.5l4-4l-4-4" fill="none" stroke="#444" stroke-linecap="round" stroke-linejoin="round"/></svg></div>
<div id="buttonForward" class="nonClickable rectButtonVisible"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><path d="M11.5 14.5l-4-4l4-4" fill="none" stroke="#444" stroke-linecap="round" stroke-linejoin="round"/></svg></div> 
<div id="buttonDown" class="rectButton" onclick="scrollDown()"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="#fff" stroke-linecap="round" stroke-linejoin="round"><path d="M14.5 6.5l-4 4l-4-4"/><path d="M14.5 10.5l-4 4l-4-4"/></g></svg></div>
<div id="buttonUp" class="rectButton" onclick="scrollUp()"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="#fff" stroke-linecap="round" stroke-linejoin="round"><path d="M6.5 14.5l4-4l4 4"/><path d="M6.5 10.5l4-4l4 4"/></g></svg></div> 

<script>
window.onload = function () {
  var buttons = document.getElementsByClassName("rectButton");
  for (let i=0; i<buttons.length; i++) {
    buttons[i].style.visibility = "visible";
  }
  var buttonDown = document.getElementById("buttonDown");
  buttonDown.classList.add('rectButtonVisible');
  buttonDown.classList.remove('rectButton');

  var buttonUp = document.getElementById("buttonUp");
  buttonUp.classList.add('rectButtonVisible');
  buttonUp.classList.remove('rectButton');
    
  var buttonSizer = document.getElementById("buttonSizer");
  buttonSizer.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="white" stroke-linecap="round" stroke-linejoin="round"><path d="M9.5 16.5v-4.978l-5-.022"/><path d="M18.5 2.5l-7 7"/><path d="M16.5 9.5l-5 .023V4.5"/><path d="M9.5 11.5l-7 7"/></g></svg>';
  if (document.getElementById("buttonTime") !== null) {
    var buttonTime = document.getElementById("buttonTime");
    buttonTime.style.bottom = "50px";
  }
  document.getElementById("expand").value = "+ Show more results";
  document.getElementById("expand").className += " expand";
  var embarkButton = document.getElementById("embark");
  if ( !(embarkButton.href.includes("embarkBackUrl")) ) {
    embarkButton.classList.remove('hidden');
    document.getElementById("logoImage").src = "./../../style/embark.svg";
    document.getElementById("logo").style.background = "#2d2d2d";
  }
}

function openNav() {
  document.getElementById("sidenav").style.width = "250px";
  document.getElementById("main").style.marginLeft = "250px";
  document.getElementById("nav").style.visibility = "visible";
}

function closeNav() {
  document.getElementById("sidenav").style.width = "50px";
  document.getElementById("sidenav").scrollTop = 0;
  document.getElementById("main").style.marginLeft = "50px";
  document.getElementById("nav").style.visibility = "hidden";
}

function scrollDown() {
  window.scrollTo(0,document.body.scrollHeight);
}

function scrollUp() {
  window.scrollTo(0,0);
}

function buttonNav() {
  var button = document.getElementById("buttonSizer");
  if ( button.classList.contains('buttonOpen') ) {
    button.classList.remove('buttonOpen');
    button.classList.add('buttonClose');
    button.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="white" stroke-linecap="round" stroke-linejoin="round"><path d="M9.5 16.5v-4.978l-5-.022"/><path d="M18.5 2.5l-7 7"/><path d="M16.5 9.5l-5 .023V4.5"/><path d="M9.5 11.5l-7 7"/></g></svg>';
    openNav();
  } else if( button.classList.contains('buttonClose') ) {
    button.classList.remove('buttonClose');
    button.classList.add('buttonOpen');
    button.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="white" stroke-linecap="round" stroke-linejoin="round"><path d="M18.5 7.5v-5h-5"/><path d="M18.5 2.5l-6 5.929"/><path d="M7.5 18.5l-5 .023V13.5"/><path d="M8.5 12.5l-6 6"/></g></svg>';
    closeNav();
  };
}

// the following function is currently not used
// it is for future extensions
function overlay_output(link) {
  var rawfile = new XMLHttpRequest();
  rawfile.open('GET', link, false);
  rawfile.overrideMimeType("text");
  rawfile.onreadystatechange = function()
  {
    alert(rawfile.responseText);
    //console.log(rawfile.responseText);
  }
  rawfile.send(null);
}

document.onkeydown = function(e) {
    switch (e.keyCode) {
      case 37:
        document.getElementById("buttonForward").parentNode.click(); 
        break;
      case 39:
        document.getElementById("buttonBack").parentNode.click();       
        break;
    }
};
</script>

</body>
</html>
