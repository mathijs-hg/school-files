<!-- 
EMBA - EMBEDDED LINUX ANALYZER

Copyright 2020-2023 Siemens AG
Copyright 2020-2024 Siemens Energy AG

EMBA comes with ABSOLUTELY NO WARRANTY. This is free software, and you are
welcome to redistribute it under the terms of the GNU General Public License.
See LICENSE file for usage of this software.

EMBA is licensed under GPLv3

Author(s) and contributors from the EMBA project are listed here: https://github.com/e-m-b-a/emba/blob/master/CONTRIBUTORS.md
-->

<!-- Used icons: https://github.com/CoreyGinnivan/system-uicons -->
 
<!DOCTYPE html>
<html lang="en">
<head>
  <title>EMBA firmware report</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="./../../style/style.css" type="text/css">
  <link rel="icon" type="image/png" href="./../../style/favicon.png">
</head>
<body>

<div id="sidenav" class="side">
  <div id="logo">
    <a class="inherit" href="./../../index.html"><img class="inherit" id="logoImage" src="./../../style/emba.svg" alt="logo"></a>
  </div>
  <div id="nav">
      <a id="embark" class="hidden" href="{{ embarkBackUrl }}">&laquo; Back to EMBArk</a> <!-- nosem -->
      <a class="backButton" href="./../../index.html">&laquo; Back to main</a>
<a class="modul" href="./../semgrep_mDNSClientPosix.html" title="./../semgrep_mDNSClientPosix.html" >&laquo; Back to semgrep_mDNSClientPosix</a>
      <!-- navigation start -->
      <!-- navigation end -->
      <input id="expand" class="expand_njs hidden" type="button" value="More results:" onclick="this.value=this.value=='+ Show more results'?'- Hide more results':'+ Show more results';">
      <div class="expand_area">
        <!-- etc start -->
        <!-- etc end -->
      </div>
  </div>
  <a href="TIMELINK"><div id="buttonTimeInvisible" class="rectButton"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="white" stroke-linecap="round" stroke-linejoin="round" transform="matrix(-1 0 0 1 19 2)"><circle cx="8.5" cy="8.5" r="8"/><path d="M8.5 5.5v4H5"/></g></svg></div></a>
  <div id="buttonSizer" class="rectButton buttonClose" onclick="buttonNav()"></div>
</div>
<div id="main" class="main">
  <!-- content start -->
<br />
<pre>/* WARNING: Removing unreachable block (ram,0x00438ef0) */</pre>
<pre>/* WARNING: Removing unreachable block (ram,0x00439534) */</pre>
<br />
<pre>undefined4 mDNS_Deregister_internal(int param_1,int **param_2,int param_3)</pre>
<br />
<pre>{</pre>
<pre>  char cVar1;</pre>
<pre>  byte bVar2;</pre>
<pre>  byte bVar3;</pre>
<pre>  bool bVar4;</pre>
<pre>  uint uVar5;</pre>
<pre>  int iVar6;</pre>
<pre>  int **ppiVar7;</pre>
<pre>  undefined4 uVar8;</pre>
<pre>  undefined uVar9;</pre>
<pre>  int *piVar10;</pre>
<pre>  undefined4 *puVar11;</pre>
<pre>  int **ppiVar12;</pre>
<pre>  int **ppiVar13;</pre>
<pre>  </pre>
<pre><span class="green">  cVar1 = *(char *)(param_2 + 1)</span></span></pre>
<pre>  ppiVar7 = (int **)(param_1 + 0x2160);</pre>
<pre>  if (param_2[0x1f] + -1 &lt; (int *)0x2) {</pre>
<pre>    uVar5 = DomainNameHashValue(param_2[8]);</pre>
<pre>    iVar6 = FUN_00427c58(param_1 + 0x1278,uVar5 % 499,param_2 + 1);</pre>
<pre>    if (iVar6 == 0) {</pre>
<pre>      return 0;</pre>
<pre>    }</pre>
<pre>    ppiVar7 = *(int ***)(iVar6 + 8);</pre>
<pre>    ppiVar13 = (int **)(iVar6 + 8);</pre>
<pre>    while ((ppiVar12 = ppiVar7, ppiVar12 != (int **)0x0 &amp;&amp; (ppiVar12 != param_2))) {</pre>
<pre>      ppiVar13 = ppiVar12;</pre>
<pre>      ppiVar7 = (int **)*ppiVar12;</pre>
<pre>    }</pre>
<pre>  }</pre>
<pre>  else {</pre>
<pre>    do {</pre>
<pre>      ppiVar13 = ppiVar7;</pre>
<pre>      ppiVar7 = (int **)*ppiVar13;</pre>
<pre>      if (ppiVar7 == (int **)0x0) goto LAB_00438f58;</pre>
<pre>    } while (ppiVar7 != param_2);</pre>
<pre>  }</pre>
<pre>  ppiVar7 = (int **)*ppiVar13;</pre>
<pre>LAB_00438f58:</pre>
<pre>  if (ppiVar7 == (int **)0x0) {</pre>
<pre>    ppiVar7 = *(int ***)(param_1 + 0x2164);</pre>
<pre>    ppiVar13 = (int **)(param_1 + 0x2164);</pre>
<pre>    while (ppiVar12 = ppiVar7, bVar4 = false, ppiVar12 != (int **)0x0) {</pre>
<pre>      if (ppiVar12 == param_2) {</pre>
<pre>        bVar4 = true;</pre>
<pre><span class="green"><span class="green">        memcpy((void *)((int)param_2 + 0x4e),&amp;zeroEthAddr,6)</span></span></span></pre>
<pre>        *(undefined *)(param_2 + 1) = 1;</pre>
<pre>        *(undefined *)(param_2 + 0x22) = 0;</pre>
<pre>        break;</pre>
<pre>      }</pre>
<pre>      ppiVar13 = ppiVar12;</pre>
<pre>      ppiVar7 = (int **)*ppiVar12;</pre>
<pre>    }</pre>
<pre>  }</pre>
<pre>  else {</pre>
<pre>    ppiVar7 = (int **)(param_1 + 0x2164);</pre>
<pre>    if (param_3 == 2) {</pre>
<pre>      for (puVar11 = *(undefined4 **)(param_1 + 0x2164); puVar11 != (undefined4 *)0x0;</pre>
<pre>          puVar11 = (undefined4 *)*puVar11) {</pre>
<pre>        if ((int *)puVar11[7] == param_2[7]) {</pre>
<pre>          bVar2 = *(byte *)(puVar11 + 1);</pre>
<pre>          bVar3 = *(byte *)(param_2 + 1);</pre>
<pre>          if (((((((bVar2 == bVar3) || ((bVar3 | bVar2) == 0x12)) || (bVar2 == 1)) || (bVar3 == 1))</pre>
<pre>               &amp;&amp; ((*(short *)((int)puVar11 + 6) == *(short *)((int)param_2 + 6) &amp;&amp;</pre>
<pre>                   (*(short *)(puVar11 + 2) == *(short *)(param_2 + 2))))) &amp;&amp;</pre>
<pre>              (((int *)puVar11[5] == param_2[5] &amp;&amp;</pre>
<pre>               ((*(short *)(puVar11 + 4) == *(short *)(param_2 + 4) &amp;&amp;</pre>
<pre>                ((int *)puVar11[6] == param_2[6])))))) &amp;&amp;</pre>
<pre>             ((iVar6 = SameRDataBody(puVar11 + 1,param_2[9] + 1,SameDomainName), iVar6 != 0 &amp;&amp;</pre>
<pre>              (iVar6 = SameDomainName(puVar11[8],param_2[8]), iVar6 != 0)))) {</pre>
<pre>            *(undefined *)((int)puVar11 + 0x86) = 0xff;</pre>
<pre>          }</pre>
<pre>        }</pre>
<pre>      }</pre>
<pre>      bVar4 = false;</pre>
<pre>    }</pre>
<pre>    else {</pre>
<pre>      for (; piVar10 = *ppiVar7, piVar10 != (int *)0x0; ppiVar7 = (int **)*ppiVar7) {</pre>
<pre>        if ((int *)piVar10[7] == param_2[7]) {</pre>
<pre>          bVar2 = *(byte *)(piVar10 + 1);</pre>
<pre>          bVar3 = *(byte *)(param_2 + 1);</pre>
<pre>          if (((((bVar2 == bVar3) || ((bVar3 | bVar2) == 0x12)) || (bVar2 == 1)) || (bVar3 == 1)) &amp;&amp;</pre>
<pre>             (((((*(short *)((int)piVar10 + 6) == *(short *)((int)param_2 + 6) &amp;&amp;</pre>
<pre>                 (*(short *)(piVar10 + 2) == *(short *)(param_2 + 2))) &amp;&amp;</pre>
<pre>                (((int *)piVar10[5] == param_2[5] &amp;&amp;</pre>
<pre>                 ((*(short *)(piVar10 + 4) == *(short *)(param_2 + 4) &amp;&amp;</pre>
<pre>                  ((int *)piVar10[6] == param_2[6])))))) &amp;&amp;</pre>
<pre>               (iVar6 = SameRDataBody(piVar10 + 1,param_2[9] + 1,SameDomainName), iVar6 != 0)) &amp;&amp;</pre>
<pre>              (iVar6 = SameDomainName((*ppiVar7)[8],param_2[8]), iVar6 != 0)))) break;</pre>
<pre>        }</pre>
<pre>      }</pre>
<pre>      ppiVar12 = (int **)*ppiVar7;</pre>
<pre>      if (ppiVar12 == (int **)0x0) {</pre>
<pre>        bVar4 = false;</pre>
<pre>      }</pre>
<pre>      else {</pre>
<pre>        *ppiVar7 = *ppiVar12;</pre>
<pre>        if (param_2[0x1f] + -1 &lt; (int *)0x2) {</pre>
<pre>          *ppiVar12 = (int *)0x0;</pre>
<pre>          iVar6 = FUN_004389bc(param_1,param_1 + 0x1278,ppiVar12);</pre>
<pre>          if (iVar6 == 0) {</pre>
<pre>            uVar8 = GetRRDisplayString_rdb(ppiVar12 + 1,ppiVar12[9] + 1,param_1 + 0x2f);</pre>
<pre>            LogMsgWithLevel(0,"mDNS_Deregister_internal: ERROR!! cannot insert %s",uVar8);</pre>
<pre>          }</pre>
<pre>        }</pre>
<pre>        else {</pre>
<pre>          *ppiVar12 = *param_2;</pre>
<pre>          *param_2 = (int *)ppiVar12;</pre>
<pre>        }</pre>
<pre>        *(undefined *)(ppiVar12 + 1) = *(undefined *)(param_2 + 1);</pre>
<pre>        bVar4 = false;</pre>
<pre>        *(undefined *)((int)ppiVar12 + 0x86) = *(undefined *)((int)param_2 + 0x86);</pre>
<pre>        *(undefined *)((int)ppiVar12 + 0x85) = *(undefined *)((int)param_2 + 0x85);</pre>
<pre>        *(undefined *)((int)ppiVar12 + 0x87) = *(undefined *)((int)param_2 + 0x87);</pre>
<pre>        *(undefined *)(ppiVar12 + 0x22) = *(undefined *)(param_2 + 0x22);</pre>
<pre>        *(undefined *)((int)ppiVar12 + 0x89) = *(undefined *)((int)param_2 + 0x89);</pre>
<pre>        ppiVar12[0x24] = param_2[0x24];</pre>
<pre>        *(undefined *)((int)ppiVar12 + 0x8b) = *(undefined *)((int)param_2 + 0x8b);</pre>
<pre>        ppiVar12[0x25] = param_2[0x25];</pre>
<pre>        ppiVar12[0x27] = param_2[0x27];</pre>
<pre><span class="green"><span class="green">        memcpy(ppiVar12 + 0x28,param_2 + 0x28,0x10)</span></span></span></pre>
<pre>        ppiVar12[0x2f] = param_2[0x2f];</pre>
<pre>        ppiVar12[0x30] = param_2[0x30];</pre>
<pre>        ppiVar12[0x31] = param_2[0x31];</pre>
<pre>        ppiVar12[0x32] = param_2[0x32];</pre>
<pre>        *(undefined *)(ppiVar12 + 0x3c) = *(undefined *)(param_2 + 0x3c);</pre>
<pre>        ppiVar12[0x39] = param_2[0x39];</pre>
<pre>        *(undefined *)(param_2 + 0x22) = 0;</pre>
<pre>        *(undefined *)((int)param_2 + 0x89) = 0;</pre>
<pre>      }</pre>
<pre>    }</pre>
<pre>  }</pre>
<pre>  if (*ppiVar13 == (int *)0x0) {</pre>
<pre>    if (param_3 != 3) {</pre>
<pre>      uVar8 = GetRRDisplayString_rdb(param_2 + 1,param_2[9] + 1,param_1 + 0x2f);</pre>
<pre>      LogMsgWithLevel(0,"mDNS_Deregister_internal: Record %p not found in list %s",param_2,uVar8);</pre>
<pre>    }</pre>
<pre>LAB_00439318:</pre>
<pre>    uVar8 = 0xfffefffb;</pre>
<pre>  }</pre>
<pre>  else {</pre>
<pre>    if (((param_2[7] == (int *)0x0) &amp;&amp; (*(char *)((int)param_2 + 0x4a) == '\0')) &amp;&amp;</pre>
<pre>       (iVar6 = IsLocalDomain(param_2[8]), iVar6 == 0)) {</pre>
<pre>      if (*(char *)(param_2 + 0x22) != '\0') {</pre>
<pre>        if (param_2[0x41] != (int *)0x0) {</pre>
<pre>          DisposeTCPConn();</pre>
<pre>          param_2[0x41] = (int *)0x0;</pre>
<pre>        }</pre>
<pre>        *(undefined *)(param_2 + 1) = 1;</pre>
<pre>        *(undefined *)(param_1 + 0x274) = 1;</pre>
<pre>        uDNS_DeregisterRecord(param_1,param_2);</pre>
<pre>        return 0;</pre>
<pre>      }</pre>
<pre>      *(undefined2 *)((int)param_2 + 0xf2) = 0;</pre>
<pre>      if (param_2[0x53] != (int *)0x0) {</pre>
<pre>        mDNS_StopNATOperation_internal(param_1,param_2 + 0x42);</pre>
<pre>        param_2[0x53] = (int *)0x0;</pre>
<pre>      }</pre>
<pre>      if (param_2[0x40] != (int *)0x0) {</pre>
<pre>        CancelGetZoneData(param_1);</pre>
<pre>        param_2[0x40] = (int *)0x0;</pre>
<pre>      }</pre>
<pre>      if (param_2[0x41] != (int *)0x0) {</pre>
<pre>        DisposeTCPConn();</pre>
<pre>        param_2[0x41] = (int *)0x0;</pre>
<pre>      }</pre>
<pre>    }</pre>
<pre>    if (cVar1 == '\0') {</pre>
<pre>      uVar8 = GetRRDisplayString_rdb(param_2 + 1,param_2[9] + 1,param_1 + 0x2f);</pre>
<pre>      LogMsgWithLevel(0,"mDNS_Deregister_internal: %s already marked kDNSRecordTypeUnregistered",</pre>
<pre>                      uVar8);</pre>
<pre>    }</pre>
<pre>    else if (cVar1 == '\x01') {</pre>
<pre>      uVar8 = GetRRDisplayString_rdb(param_2 + 1,param_2[9] + 1,param_1 + 0x2f);</pre>
<pre>      LogMsgWithLevel(0,"mDNS_Deregister_internal: %s already marked kDNSRecordTypeDeregistering",</pre>
<pre>                      uVar8);</pre>
<pre>      goto LAB_00439318;</pre>
<pre>    }</pre>
<pre>    if ((*(int *)((int)param_2 + 0x4e) == 0) &amp;&amp;</pre>
<pre>       ((cVar1 != '\b' || (((uint)param_2[0x22] &amp; 0xffff0000) == 0)))) {</pre>
<pre>      if ((bVar4) || ((int *)0x1 &lt; param_2[0x1f] + -1)) {</pre>
<pre>        *ppiVar13 = *param_2;</pre>
<pre>        if (*(int ***)(param_1 + 0x2168) == param_2) {</pre>
<pre>          *(int **)(param_1 + 0x2168) = *param_2;</pre>
<pre>        }</pre>
<pre>        if (param_2[0x1f] + -1 &lt; (int *)0x2) {</pre>
<pre>          if (mDNS_LoggingEnabled != 0) {</pre>
<pre>            uVar8 = GetRRDisplayString_rdb(param_2 + 1,param_2[9] + 1,param_1 + 0x2f);</pre>
<pre>            LogMsgWithLevel(3,"DecrementAutoTargetServices: called for RRLocalOnly() record: %s",</pre>
<pre>                            uVar8);</pre>
<pre>          }</pre>
<pre>        }</pre>
<pre>        else if ((((param_2[7] != (int *)0x0) || (*(char *)((int)param_2 + 0x4a) != '\0')) ||</pre>
<pre>                 (iVar6 = IsLocalDomain(param_2[8]), iVar6 != 0)) &amp;&amp;</pre>
<pre>                ((*(short *)((int)param_2 + 6) == 0x21 &amp;&amp; (*(char *)(param_2 + 0x12) == '\x01')))) {</pre>
<pre>          if (*(int *)(param_1 + 0x3908) == 1) {</pre>
<pre>            FUN_004399d4(param_1);</pre>
<pre>          }</pre>
<pre>          iVar6 = *(int *)(param_1 + 0x3908) + -1;</pre>
<pre>          *(int *)(param_1 + 0x3908) = iVar6;</pre>
<pre>          if (mDNS_LoggingEnabled != 0) {</pre>
<pre>            uVar8 = GetRRDisplayString_rdb(param_2 + 1,param_2[9] + 1,param_1 + 0x2f);</pre>
<pre>            LogMsgWithLevel(3,"DecrementAutoTargetServices: AutoTargetServices %d Record %s",iVar6,</pre>
<pre>                            uVar8);</pre>
<pre>          }</pre>
<pre>        }</pre>
<pre>      }</pre>
<pre>      else {</pre>
<pre>        iVar6 = FUN_0042801c(param_1,param_1 + 0x1278,param_2);</pre>
<pre>        if (*(int ***)(iVar6 + 0x14) == param_2) {</pre>
<pre>          *(int **)(iVar6 + 0x14) = *param_2;</pre>
<pre>        }</pre>
<pre>      }</pre>
<pre>      if (*(int ***)(param_1 + 0x216c) == param_2) {</pre>
<pre>        *(int **)(param_1 + 0x216c) = *param_2;</pre>
<pre>      }</pre>
<pre>      *param_2 = (int *)0x0;</pre>
<pre>      *(undefined *)(param_2 + 1) = 0;</pre>
<pre>      if (param_2[0x33] != (int *)0x0) {</pre>
<pre>        FUN_0042cb70(param_1,param_2);</pre>
<pre>      }</pre>
<pre>      if (param_3 == 2) {</pre>
<pre>        FUN_004276dc(param_1,param_2);</pre>
<pre>        iVar6 = *(int *)(param_1 + 0x28) + 1;</pre>
<pre>        *(int *)(param_1 + 0x28) = iVar6;</pre>
<pre>        if (*(int *)(param_1 + 0x24) != iVar6) {</pre>
<pre>          LogMsgWithLevel(0,"%s: Locking Failure! mDNS_busy (%ld) != mDNS_reentrancy (%ld)",</pre>
<pre>                          "mDNS_Deregister_internal",*(int *)(param_1 + 0x24),iVar6);</pre>
<pre>        }</pre>
<pre>        if (param_2[0x10] != (int *)0x0) {</pre>
<pre>          (*(code *)param_2[0x10])(param_1,param_2,0xfffefff4);</pre>
<pre>        }</pre>
<pre>        iVar6 = *(int *)(param_1 + 0x28);</pre>
<pre>        if (*(int *)(param_1 + 0x24) != iVar6) {</pre>
<pre>          LogMsgWithLevel(0,"%s: Unlocking Failure! mDNS_busy (%ld) != mDNS_reentrancy (%ld)",</pre>
<pre>                          "mDNS_Deregister_internal",*(int *)(param_1 + 0x24),iVar6);</pre>
<pre>          iVar6 = *(int *)(param_1 + 0x28);</pre>
<pre>        }</pre>
<pre>        puVar11 = *(undefined4 **)(param_1 + 0x2164);</pre>
<pre>        *(int *)(param_1 + 0x28) = iVar6 + -1;</pre>
<pre>        while (puVar11 != (undefined4 *)0x0) {</pre>
<pre>          if (*(char *)((int)puVar11 + 0x86) == -1) {</pre>
<pre>            mDNS_Deregister_internal(param_1,puVar11,2);</pre>
<pre>            puVar11 = *(undefined4 **)(param_1 + 0x2164);</pre>
<pre>          }</pre>
<pre>          else {</pre>
<pre>            puVar11 = (undefined4 *)*puVar11;</pre>
<pre>          }</pre>
<pre>        }</pre>
<pre>      }</pre>
<pre>      else {</pre>
<pre>        iVar6 = *(int *)(param_1 + 0x28) + 1;</pre>
<pre>        *(int *)(param_1 + 0x28) = iVar6;</pre>
<pre>        if (*(int *)(param_1 + 0x24) != iVar6) {</pre>
<pre>          LogMsgWithLevel(0,"%s: Locking Failure! mDNS_busy (%ld) != mDNS_reentrancy (%ld)",</pre>
<pre>                          "mDNS_Deregister_internal",*(int *)(param_1 + 0x24),iVar6);</pre>
<pre>        }</pre>
<pre>        if (mDNS_LoggingEnabled != 0) {</pre>
<pre>          uVar8 = GetRRDisplayString_rdb(param_2 + 1,param_2[9] + 1,param_1 + 0x2f);</pre>
<pre>          LogMsgWithLevel(3,"mDNS_Deregister_internal: mStatus_MemFree for %s",uVar8);</pre>
<pre>        }</pre>
<pre>        if (param_2[0x10] != (int *)0x0) {</pre>
<pre>          (*(code *)param_2[0x10])(param_1,param_2,0xfffeff00);</pre>
<pre>        }</pre>
<pre>        iVar6 = *(int *)(param_1 + 0x28);</pre>
<pre>        if (*(int *)(param_1 + 0x24) != iVar6) {</pre>
<pre>          LogMsgWithLevel(0,"%s: Unlocking Failure! mDNS_busy (%ld) != mDNS_reentrancy (%ld)",</pre>
<pre>                          "mDNS_Deregister_internal",*(int *)(param_1 + 0x24),iVar6);</pre>
<pre>          iVar6 = *(int *)(param_1 + 0x28);</pre>
<pre>        }</pre>
<pre>        *(int *)(param_1 + 0x28) = iVar6 + -1;</pre>
<pre>      }</pre>
<pre>    }</pre>
<pre>    else {</pre>
<pre>      *(undefined *)(param_2 + 1) = 1;</pre>
<pre>      param_2[3] = (int *)0x0;</pre>
<pre>      uVar9 = 0x12;</pre>
<pre>      if ((*(int *)((int)param_2 + 0x4e) == 0) &amp;&amp; (uVar9 = 3, param_3 == 1)) {</pre>
<pre>        uVar9 = 1;</pre>
<pre>      }</pre>
<pre>      *(undefined *)((int)param_2 + 0x87) = uVar9;</pre>
<pre>      iVar6 = mDNSPlatformOneSecond;</pre>
<pre>      param_2[0x2f] = (int *)(mDNSPlatformOneSecond * 2);</pre>
<pre>      param_2[0x30] = (int *)(*(int *)(param_1 + 0x234) + iVar6 * -2);</pre>
<pre>      *(undefined *)(param_1 + 0x274) = 1;</pre>
<pre>      iVar6 = mDNSPlatformOneSecond / 10 + *(int *)(param_1 + 0x234);</pre>
<pre>      if (-1 &lt; *(int *)(param_1 + 0x254) - iVar6) {</pre>
<pre>        *(int *)(param_1 + 0x254) = iVar6;</pre>
<pre>      }</pre>
<pre>    }</pre>
<pre>    FUN_0042f54c(param_1);</pre>
<pre>    uVar8 = 0;</pre>
<pre>  }</pre>
<pre>  return uVar8;</pre>
<pre>}</pre>
<br />
  <!-- content end -->
</div>

<a href="https://github.com/e-m-b-a/emba" title="github.com/e-m-b-a/emba" target="_blank">
  <div id="buttonInfo" class="rectButtonVisible">
    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" transform="translate(2 2)"><g stroke="white" stroke-linecap="round" stroke-linejoin="round"><circle cx="8.5" cy="8.5" r="8"/><path d="M8.5 12.5v-4h-1"/><path d="M7.5 12.5h2"/></g><circle cx="8.5" cy="5.5" fill="white" r="1"/></g></svg>
  </div>
</a>
<div id="buttonBack" class="nonClickable rectButtonVisible"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><path d="M9.5 14.5l4-4l-4-4" fill="none" stroke="#444" stroke-linecap="round" stroke-linejoin="round"/></svg></div>
<div id="buttonForward" class="nonClickable rectButtonVisible"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><path d="M11.5 14.5l-4-4l4-4" fill="none" stroke="#444" stroke-linecap="round" stroke-linejoin="round"/></svg></div> 
<div id="buttonDown" class="rectButton" onclick="scrollDown()"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="#fff" stroke-linecap="round" stroke-linejoin="round"><path d="M14.5 6.5l-4 4l-4-4"/><path d="M14.5 10.5l-4 4l-4-4"/></g></svg></div>
<div id="buttonUp" class="rectButton" onclick="scrollUp()"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="#fff" stroke-linecap="round" stroke-linejoin="round"><path d="M6.5 14.5l4-4l4 4"/><path d="M6.5 10.5l4-4l4 4"/></g></svg></div> 

<script>
window.onload = function () {
  var buttons = document.getElementsByClassName("rectButton");
  for (let i=0; i<buttons.length; i++) {
    buttons[i].style.visibility = "visible";
  }
  var buttonDown = document.getElementById("buttonDown");
  buttonDown.classList.add('rectButtonVisible');
  buttonDown.classList.remove('rectButton');

  var buttonUp = document.getElementById("buttonUp");
  buttonUp.classList.add('rectButtonVisible');
  buttonUp.classList.remove('rectButton');
    
  var buttonSizer = document.getElementById("buttonSizer");
  buttonSizer.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="white" stroke-linecap="round" stroke-linejoin="round"><path d="M9.5 16.5v-4.978l-5-.022"/><path d="M18.5 2.5l-7 7"/><path d="M16.5 9.5l-5 .023V4.5"/><path d="M9.5 11.5l-7 7"/></g></svg>';
  if (document.getElementById("buttonTime") !== null) {
    var buttonTime = document.getElementById("buttonTime");
    buttonTime.style.bottom = "50px";
  }
  document.getElementById("expand").value = "+ Show more results";
  document.getElementById("expand").className += " expand";
  var embarkButton = document.getElementById("embark");
  if ( !(embarkButton.href.includes("embarkBackUrl")) ) {
    embarkButton.classList.remove('hidden');
    document.getElementById("logoImage").src = "./../../style/embark.svg";
    document.getElementById("logo").style.background = "#2d2d2d";
  }
}

function openNav() {
  document.getElementById("sidenav").style.width = "250px";
  document.getElementById("main").style.marginLeft = "250px";
  document.getElementById("nav").style.visibility = "visible";
}

function closeNav() {
  document.getElementById("sidenav").style.width = "50px";
  document.getElementById("sidenav").scrollTop = 0;
  document.getElementById("main").style.marginLeft = "50px";
  document.getElementById("nav").style.visibility = "hidden";
}

function scrollDown() {
  window.scrollTo(0,document.body.scrollHeight);
}

function scrollUp() {
  window.scrollTo(0,0);
}

function buttonNav() {
  var button = document.getElementById("buttonSizer");
  if ( button.classList.contains('buttonOpen') ) {
    button.classList.remove('buttonOpen');
    button.classList.add('buttonClose');
    button.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="white" stroke-linecap="round" stroke-linejoin="round"><path d="M9.5 16.5v-4.978l-5-.022"/><path d="M18.5 2.5l-7 7"/><path d="M16.5 9.5l-5 .023V4.5"/><path d="M9.5 11.5l-7 7"/></g></svg>';
    openNav();
  } else if( button.classList.contains('buttonClose') ) {
    button.classList.remove('buttonClose');
    button.classList.add('buttonOpen');
    button.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="white" stroke-linecap="round" stroke-linejoin="round"><path d="M18.5 7.5v-5h-5"/><path d="M18.5 2.5l-6 5.929"/><path d="M7.5 18.5l-5 .023V13.5"/><path d="M8.5 12.5l-6 6"/></g></svg>';
    closeNav();
  };
}

// the following function is currently not used
// it is for future extensions
function overlay_output(link) {
  var rawfile = new XMLHttpRequest();
  rawfile.open('GET', link, false);
  rawfile.overrideMimeType("text");
  rawfile.onreadystatechange = function()
  {
    alert(rawfile.responseText);
    //console.log(rawfile.responseText);
  }
  rawfile.send(null);
}

document.onkeydown = function(e) {
    switch (e.keyCode) {
      case 37:
        document.getElementById("buttonForward").parentNode.click(); 
        break;
      case 39:
        document.getElementById("buttonBack").parentNode.click();       
        break;
    }
};
</script>

</body>
</html>
