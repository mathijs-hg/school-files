<!-- 
EMBA - EMBEDDED LINUX ANALYZER

Copyright 2020-2023 Siemens AG
Copyright 2020-2024 Siemens Energy AG

EMBA comes with ABSOLUTELY NO WARRANTY. This is free software, and you are
welcome to redistribute it under the terms of the GNU General Public License.
See LICENSE file for usage of this software.

EMBA is licensed under GPLv3

Author(s) and contributors from the EMBA project are listed here: https://github.com/e-m-b-a/emba/blob/master/CONTRIBUTORS.md
-->

<!-- Used icons: https://github.com/CoreyGinnivan/system-uicons -->
 
<!DOCTYPE html>
<html lang="en">
<head>
  <title>EMBA firmware report</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="./../../style/style.css" type="text/css">
  <link rel="icon" type="image/png" href="./../../style/favicon.png">
</head>
<body>

<div id="sidenav" class="side">
  <div id="logo">
    <a class="inherit" href="./../../index.html"><img class="inherit" id="logoImage" src="./../../style/emba.svg" alt="logo"></a>
  </div>
  <div id="nav">
      <a id="embark" class="hidden" href="{{ embarkBackUrl }}">&laquo; Back to EMBArk</a> <!-- nosem -->
      <a class="backButton" href="./../../index.html">&laquo; Back to main</a>
<a class="modul" href="./../semgrep_mDNSClientPosix.html" title="./../semgrep_mDNSClientPosix.html" >&laquo; Back to semgrep_mDNSClientPosix</a>
      <!-- navigation start -->
      <!-- navigation end -->
      <input id="expand" class="expand_njs hidden" type="button" value="More results:" onclick="this.value=this.value=='+ Show more results'?'- Hide more results':'+ Show more results';">
      <div class="expand_area">
        <!-- etc start -->
        <!-- etc end -->
      </div>
  </div>
  <a href="TIMELINK"><div id="buttonTimeInvisible" class="rectButton"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="white" stroke-linecap="round" stroke-linejoin="round" transform="matrix(-1 0 0 1 19 2)"><circle cx="8.5" cy="8.5" r="8"/><path d="M8.5 5.5v4H5"/></g></svg></div></a>
  <div id="buttonSizer" class="rectButton buttonClose" onclick="buttonNav()"></div>
</div>
<div id="main" class="main">
  <!-- content start -->
<br />
<pre>/* WARNING: Removing unreachable block (ram,0x004309f8) */</pre>
<pre>/* WARNING: Removing unreachable block (ram,0x0042ffd8) */</pre>
<pre>/* WARNING: Removing unreachable block (ram,0x0042f9d4) */</pre>
<pre>/* WARNING: Removing unreachable block (ram,0x0042fe10) */</pre>
<pre>/* WARNING: Removing unreachable block (ram,0x0042fe90) */</pre>
<pre>/* WARNING: Removing unreachable block (ram,0x004316ac) */</pre>
<pre>/* WARNING: Removing unreachable block (ram,0x004300c8) */</pre>
<pre>/* WARNING: Removing unreachable block (ram,0x0042f9f4) */</pre>
<pre>/* WARNING: Removing unreachable block (ram,0x0043181c) */</pre>
<pre>/* WARNING: Removing unreachable block (ram,0x00430130) */</pre>
<br />
<pre>void FUN_0042f8fc(int param_1)</pre>
<br />
<pre>{</pre>
<pre>  byte bVar1;</pre>
<pre>  char cVar2;</pre>
<pre>  undefined2 uVar3;</pre>
<pre>  undefined2 uVar4;</pre>
<pre>  undefined2 uVar5;</pre>
<pre>  bool bVar6;</pre>
<pre>  bool bVar7;</pre>
<pre>  undefined4 *puVar8;</pre>
<pre>  undefined4 uVar9;</pre>
<pre>  ushort uVar17;</pre>
<pre>  uint uVar10;</pre>
<pre>  int *piVar11;</pre>
<pre>  uint **ppuVar12;</pre>
<pre>  int iVar13;</pre>
<pre>  int iVar14;</pre>
<pre>  uint **ppuVar15;</pre>
<pre>  undefined2 uVar18;</pre>
<pre>  uint **ppuVar16;</pre>
<pre>  int iVar19;</pre>
<pre>  undefined4 *puVar20;</pre>
<pre>  int *piVar21;</pre>
<pre>  undefined4 *puVar22;</pre>
<pre>  int *piVar23;</pre>
<pre>  int *__n;</pre>
<pre>  int iVar24;</pre>
<pre>  char *pcVar25;</pre>
<pre>  uint **ppuVar26;</pre>
<pre>  int iVar27;</pre>
<pre>  int iVar28;</pre>
<pre>  undefined4 uVar29;</pre>
<pre>  int iVar30;</pre>
<pre>  uint **in_stack_fffffb98;</pre>
<pre>  int local_448;</pre>
<pre>  uint *apuStack_444 [5];</pre>
<pre>  undefined auStack_430 [48];</pre>
<pre>  undefined auStack_400 [4];</pre>
<pre>  undefined auStack_3fc [4];</pre>
<pre>  undefined2 local_3f8;</pre>
<pre>  undefined4 local_3f4;</pre>
<pre>  undefined2 local_3f0;</pre>
<pre>  undefined2 local_3ee;</pre>
<pre>  int local_3dc;</pre>
<pre>  int local_78;</pre>
<pre>  undefined *local_74;</pre>
<pre>  undefined4 local_70;</pre>
<pre>  uint **local_6c;</pre>
<pre>  int *local_68;</pre>
<pre>  uint **local_64;</pre>
<pre>  int local_60;</pre>
<pre>  int local_5c;</pre>
<pre>  int local_58;</pre>
<pre>  int local_54;</pre>
<pre>  int *local_50;</pre>
<pre>  int local_4c;</pre>
<pre>  int local_48;</pre>
<pre>  int local_44;</pre>
<pre>  int local_40;</pre>
<pre>  int *local_3c;</pre>
<pre>  int *local_38;</pre>
<pre>  int *local_34;</pre>
<pre>  char *local_30;</pre>
<pre>  </pre>
<pre>  local_5c = param_1 + 0x7cc;</pre>
<pre>  local_4c = param_1;</pre>
<pre>  puVar8 = (undefined4 *)GetFirstActiveInterface(*(undefined4 *)(param_1 + 0x2174));</pre>
<pre>  local_448 = 0;</pre>
<pre>  iVar19 = param_1;</pre>
<pre>  do {</pre>
<pre>    for (puVar22 = *(undefined4 **)(iVar19 + 0x2e0); puVar22 != (undefined4 *)0x0;</pre>
<pre>        puVar22 = (undefined4 *)*puVar22) {</pre>
<pre>      for (puVar20 = (undefined4 *)puVar22[2]; puVar20 != (undefined4 *)0x0;</pre>
<pre>          puVar20 = (undefined4 *)*puVar20) {</pre>
<pre>        iVar28 = puVar20[0x11];</pre>
<pre>        if ((iVar28 != 0) &amp;&amp; (*(byte *)(puVar20 + 0x13) &lt; 4)) {</pre>
<pre>          iVar27 = *(int *)(param_1 + 0x234);</pre>
<pre>          iVar13 = puVar20[3] * mDNSPlatformOneSecond;</pre>
<pre>          if (-1 &lt; (iVar27 - puVar20[0xf]) + iVar13 / 0x32) {</pre>
<pre>            iVar30 = puVar20[7];</pre>
<pre>            iVar24 = 0;</pre>
<pre>            iVar14 = iVar28;</pre>
<pre>            do {</pre>
<pre>              iVar24 = iVar24 + 1;</pre>
<pre>              if ((*(int *)(iVar14 + 0x4c) == iVar30) &amp;&amp;</pre>
<pre>                 (*(int *)(iVar14 + 0x48) - (iVar27 - iVar13 / 0x14) &lt; 0)) {</pre>
<pre>                *(undefined4 *)(iVar14 + 0x4c) = 0;</pre>
<pre>              }</pre>
<pre>              iVar14 = iVar14 + 0xc;</pre>
<pre>            } while (iVar24 != 8);</pre>
<pre>            if (*(int *)(iVar28 + 0x13c) == 0) {</pre>
<pre>              if (*(short *)(iVar28 + 0x152) == 0) {</pre>
<pre>                iVar27 = puVar20[7];</pre>
<pre>                if (*(int *)(iVar28 + 0xa8) == 0) goto LAB_0042fa90;</pre>
<pre>                if (*(int *)(iVar28 + 0xa8) != iVar27) goto LAB_0042fa8c;</pre>
<pre>              }</pre>
<pre>              else {</pre>
<pre>                *(int *)(iVar28 + 0xc) = *(int *)(param_1 + 0x234) - *(int *)(iVar28 + 0x10);</pre>
<pre>                *(char *)(puVar20 + 0x13) = *(char *)(puVar20 + 0x13) + '\x01';</pre>
<pre>                *(int *)(param_1 + 0x39ac) = *(int *)(param_1 + 0x39ac) + 1;</pre>
<pre>              }</pre>
<pre>            }</pre>
<pre>            else {</pre>
<pre>LAB_0042fa8c:</pre>
<pre>              iVar27 = -1;</pre>
<pre>LAB_0042fa90:</pre>
<pre>              *(int *)(iVar28 + 0xa8) = iVar27;</pre>
<pre>            }</pre>
<pre>            if (*(short *)(iVar28 + 0x152) == 0) {</pre>
<pre>              *(undefined *)(iVar28 + 0xad) = 1;</pre>
<pre>            }</pre>
<pre>          }</pre>
<pre>        }</pre>
<pre>      }</pre>
<pre>    }</pre>
<pre>    iVar19 = iVar19 + 4;</pre>
<pre>  } while (iVar19 != local_5c);</pre>
<pre>  iVar19 = *(int *)(param_1 + 0x2b4);</pre>
<pre>  if (iVar19 != 0) {</pre>
<pre>    uVar9 = DNSTypeName(*(undefined2 *)(iVar19 + 0x254));</pre>
<pre>    LogMsgWithLevel(0,"SendQueries ERROR m-&gt;CurrentQuestion already set: %##s (%s)",iVar19 + 0x154,</pre>
<pre>                    uVar9);</pre>
<pre>  }</pre>
<pre>  local_6c = (uint **)(param_1 + 0x5cbc);</pre>
<pre>  local_58 = param_1 + 0x7fa8;</pre>
<pre>  iVar28 = param_1 + 0x5cb0;</pre>
<pre>  *(undefined4 *)(param_1 + 0x2b4) = *(undefined4 *)(param_1 + 0x2ac);</pre>
<pre>  iVar19 = 0;</pre>
<pre>  while ((puVar22 = *(undefined4 **)(param_1 + 0x2b4), puVar22 != (undefined4 *)0x0 &amp;&amp;</pre>
<pre>         (puVar22 != *(undefined4 **)(param_1 + 0x2b0)))) {</pre>
<pre>    iVar27 = iVar19;</pre>
<pre>    if ((puVar22[0x4f] == 0) ||</pre>
<pre>       ((puVar22[0x2a] == 0 &amp;&amp;</pre>
<pre>        ((((int)puVar22[4] &lt; 1 || (puVar22[0xf] != 0)) ||</pre>
<pre>         ((-puVar22[3] - puVar22[4]) + *(int *)(param_1 + 0x234) &lt; 0)))))) {</pre>
<pre>      if ((*(short *)((int)puVar22 + 0x152) != 0) ||</pre>
<pre>         ((puVar22[0x4f] == 0 &amp;&amp;</pre>
<pre>          (((iVar27 = puVar22[4], iVar27 &lt; 1 || (puVar22[0xf] != 0)) ||</pre>
<pre>           (((-puVar22[3] - iVar27) + *(int *)(param_1 + 0x234) &lt; 0 ||</pre>
<pre>            (puVar22[0x2a] = 0xffffffff, iVar27 &lt;= iVar19)))))))) {</pre>
<pre>        iVar27 = iVar19;</pre>
<pre>      }</pre>
<pre>    }</pre>
<pre>    else {</pre>
<pre>      iVar19 = puVar22[0x36];</pre>
<pre>      if (iVar19 == 0) {</pre>
<pre>        uVar9 = mDNSPlatformUDPSocket(param_1,0);</pre>
<pre>        puVar22[0x36] = uVar9;</pre>
<pre>        iVar19 = puVar22[0x36];</pre>
<pre>      }</pre>
<pre>      if (iVar19 != 0) {</pre>
<pre>        InitializeDNSMessage(iVar28,(uint)*(ushort *)((int)puVar22 + 0x152) &lt;&lt; 0x10,0);</pre>
<pre>        uVar9 = putQuestion(iVar28,local_6c,local_58,puVar22 + 0x55,*(undefined2 *)(puVar22 + 0x95),</pre>
<pre>                            *(undefined2 *)((int)puVar22 + 0x256));</pre>
<pre>        in_stack_fffffb98 =</pre>
<pre>             (uint **)((uint)in_stack_fffffb98 &amp; 0xffff | (uint)*(ushort *)(puVar22 + 0x54) &lt;&lt; 0x10)</pre>
<pre>        ;</pre>
<pre>        mDNSSendDNSMessage(param_1,iVar28,uVar9,0,puVar22[0x36],puVar22 + 0x4f,in_stack_fffffb98,0,0</pre>
<pre>                           ,*(undefined *)((int)puVar22 + 0x262));</pre>
<pre>        puVar22[4] = puVar22[4] * 3;</pre>
<pre>      }</pre>
<pre>      if ((int)(mDNSPlatformOneSecond * 0xe10) &lt; (int)puVar22[4]) {</pre>
<pre>        puVar22[4] = mDNSPlatformOneSecond * 0xe10;</pre>
<pre>      }</pre>
<pre>      puVar22[3] = *(undefined4 *)(param_1 + 0x234);</pre>
<pre>      uVar9 = *(undefined4 *)(param_1 + 0x234);</pre>
<pre>      puVar22[7] = 0;</pre>
<pre>      puVar22[0x2d] = uVar9;</pre>
<pre>      puVar22[0x2a] = 0;</pre>
<pre>      iVar19 = *(int *)(param_1 + 0x234);</pre>
<pre>      if (iVar19 == 0) {</pre>
<pre>        iVar19 = 1;</pre>
<pre>      }</pre>
<pre>      puVar22[5] = iVar19;</pre>
<pre>    }</pre>
<pre>    iVar19 = iVar27;</pre>
<pre>    if (puVar22 == *(undefined4 **)(param_1 + 0x2b4)) {</pre>
<pre>      *(undefined4 *)(param_1 + 0x2b4) = *puVar22;</pre>
<pre>    }</pre>
<pre>  }</pre>
<pre>  while (iVar27 = *(int *)(param_1 + 0x2b4), iVar27 != 0) {</pre>
<pre>    if (mDNS_LoggingEnabled != 0) {</pre>
<pre>      uVar9 = DNSTypeName(*(undefined2 *)(iVar27 + 0x254));</pre>
<pre>      LogMsgWithLevel(3,"SendQueries question loop 1: Skipping NewQuestion %##s (%s)",iVar27 + 0x154</pre>
<pre>                      ,uVar9);</pre>
<pre>    }</pre>
<pre>    *(undefined4 *)(param_1 + 0x2b4) = **(undefined4 **)(param_1 + 0x2b4);</pre>
<pre>  }</pre>
<pre>  *(undefined4 *)(param_1 + 0x2b4) = 0;</pre>
<pre>  *(int *)(param_1 + 0x24c) = *(int *)(param_1 + 0x234) + 0x78000000;</pre>
<pre>  for (puVar22 = *(undefined4 **)(param_1 + 0x2ac);</pre>
<pre>      (puVar22 != (undefined4 *)0x0 &amp;&amp; (puVar22 != *(undefined4 **)(param_1 + 0x2b0)));</pre>
<pre>      puVar22 = (undefined4 *)*puVar22) {</pre>
<pre>    if (*(short *)((int)puVar22 + 0x152) == 0) {</pre>
<pre>      if (puVar22[0x2a] == 0) {</pre>
<pre>        if ((((puVar22[0x4f] == 0) &amp;&amp; (iVar27 = puVar22[4], 0 &lt; iVar27)) &amp;&amp; (puVar22[0xf] == 0)) &amp;&amp;</pre>
<pre>           (iVar27 &lt;= iVar19)) {</pre>
<pre>          if (-1 &lt; (iVar27 / 10 + *(int *)(param_1 + 0x234)) - (iVar27 + puVar22[3]))</pre>
<pre>          goto LAB_0042ff68;</pre>
<pre>          if (-1 &lt; (iVar27 / 2 + *(int *)(param_1 + 0x234)) - (iVar27 + puVar22[3])) {</pre>
<pre>            puVar20 = (undefined4 *)0x0;</pre>
<pre>            local_34 = puVar22 + 0x55;</pre>
<pre>            local_30 = (char *)DomainNameLengthLimit(puVar22 + 0x55,puVar22 + 0x95);</pre>
<pre>            uVar10 = DomainNameHashValue(local_34);</pre>
<pre>            iVar27 = CacheGroupForName(param_1,uVar10 % 499,puVar22[1],local_34);</pre>
<pre>            if (iVar27 != 0) {</pre>
<pre>              puVar20 = *(undefined4 **)(iVar27 + 8);</pre>
<pre>            }</pre>
<pre>            ppuVar16 = (uint **)((int)local_30 + 4);</pre>
<pre>            for (; puVar20 != (undefined4 *)0x0; puVar20 = (undefined4 *)*puVar20) {</pre>
<pre>              if (((*(ushort *)(puVar20 + 4) &lt; 0x401) &amp;&amp;</pre>
<pre>                  (local_30 = (char *)ppuVar16,</pre>
<pre>                  iVar27 = SameNameRecordAnswersQuestion(puVar20 + 1,puVar22),</pre>
<pre>                  ppuVar16 = (uint **)local_30, iVar27 != 0)) &amp;&amp;</pre>
<pre>                 ((-1 &lt; (puVar20[0xd] - *(int *)(param_1 + 0x234)) +</pre>
<pre>                        (int)(puVar20[3] * mDNSPlatformOneSecond) / 2 &amp;&amp;</pre>
<pre>                  ((0 &lt; (-*(int *)(param_1 + 0x234) - puVar22[4]) + puVar20[0xf] &amp;&amp;</pre>
<pre>                   (ppuVar16 = (uint **)((int)local_30 + *(ushort *)((int)puVar20 + 0x12) + 0xc),</pre>
<pre>                   (uint **)0x1ff &lt; ppuVar16)))))) goto LAB_00430230;</pre>
<pre>            }</pre>
<pre>            goto LAB_0042ff64;</pre>
<pre>          }</pre>
<pre>        }</pre>
<pre>      }</pre>
<pre>      else {</pre>
<pre>LAB_0042ff64:</pre>
<pre>        iVar27 = puVar22[4];</pre>
<pre>LAB_0042ff68:</pre>
<pre>        if (-1 &lt; (*(int *)(param_1 + 0x234) - puVar22[3]) - iVar27 / 2) {</pre>
<pre>          if ((((puVar22[9] == 0) || ((uint)puVar22[8] &lt; (uint)puVar22[9])) ||</pre>
<pre>              (*(char *)((int)puVar22 + 0xad) != '\0')) ||</pre>
<pre>             (((puVar22[0x4e] &amp; 0x4000000) != 0 &amp;&amp; (iVar27 == (int)(mDNSPlatformOneSecond + 2) / 3))</pre>
<pre>             )) {</pre>
<pre>            puVar22[0x2a] = 0xffffffff;</pre>
<pre>            puVar22[4] = puVar22[4] * 3;</pre>
<pre>          }</pre>
<pre>          else {</pre>
<pre>            puVar22[0x2a] = 0;</pre>
<pre>            puVar22[4] = mDNSPlatformOneSecond * 0xe10;</pre>
<pre>            uVar9 = *(undefined4 *)(param_1 + 0x234);</pre>
<pre>            puVar22[0x2c] = 0;</pre>
<pre>            puVar22[3] = uVar9;</pre>
<pre>            if (mDNS_LoggingEnabled != 0) {</pre>
<pre>              uVar9 = DNSTypeName(*(undefined2 *)(puVar22 + 0x95));</pre>
<pre>              LogMsgWithLevel(3,"SendQueries: (%s) %##s reached threshold of %d answers",uVar9,</pre>
<pre>                              puVar22 + 0x55,puVar22[9]);</pre>
<pre>            }</pre>
<pre>          }</pre>
<pre>          if ((int)puVar22[4] &lt; (int)(mDNSPlatformOneSecond * 0x1b)) {</pre>
<pre>            if (((puVar22[8] == 0) &amp;&amp; (puVar22[4] == ((int)(mDNSPlatformOneSecond + 2) / 3) * 0x1b))</pre>
<pre>               &amp;&amp; (puVar22[0x2c] == 0)) {</pre>
<pre>              if ((*(short *)(puVar22 + 0x95) == 1) || (*(short *)(puVar22 + 0x95) == 0x1c)) {</pre>
<pre>                local_3c = (int *)puVar22[1];</pre>
<pre>                local_34 = puVar22 + 0x55;</pre>
<pre>                uVar10 = DomainNameHashValue(local_34);</pre>
<pre>                iVar27 = CacheGroupForName(param_1,uVar10 % 499,local_3c,local_34);</pre>
<pre>                puVar20 = (undefined4 *)0x0;</pre>
<pre>                if (iVar27 != 0) {</pre>
<pre>                  puVar20 = *(undefined4 **)(iVar27 + 8);</pre>
<pre>                }</pre>
<pre>                for (; puVar20 != (undefined4 *)0x0; puVar20 = (undefined4 *)*puVar20) {</pre>
<pre>                  if ((*(short *)((int)puVar20 + 6) == 1) || (*(short *)((int)puVar20 + 6) == 0x1c))</pre>
<pre>                  goto LAB_00430194;</pre>
<pre>                }</pre>
<pre>              }</pre>
<pre>              FUN_00429428(param_1,puVar22 + 0x55,puVar22[1],0);</pre>
<pre>            }</pre>
<pre>          }</pre>
<pre>          else {</pre>
<pre>            puVar22[4] = mDNSPlatformOneSecond * 0xe10;</pre>
<pre>          }</pre>
<pre>        }</pre>
<pre>LAB_00430194:</pre>
<pre>        *(bool *)(puVar22 + 0x2b) = puVar22[0x2a] == -1;</pre>
<pre>        if (puVar22[0x2a] == -1) {</pre>
<pre>          iVar27 = 0;</pre>
<pre>          if ((puVar8 != (undefined4 *)0x0) &amp;&amp; (iVar27 = puVar22[0x4d], iVar27 == 0)) {</pre>
<pre>            iVar27 = puVar8[0x548];</pre>
<pre>          }</pre>
<pre>          puVar22[0x2a] = iVar27;</pre>
<pre>          puVar22[3] = *(undefined4 *)(param_1 + 0x234);</pre>
<pre>        }</pre>
<pre>        iVar13 = puVar22[4];</pre>
<pre>        iVar27 = 0;</pre>
<pre>        iVar14 = *(int *)(param_1 + 0x234);</pre>
<pre>        puVar20 = puVar22;</pre>
<pre>        do {</pre>
<pre>          iVar27 = iVar27 + 1;</pre>
<pre>          if (puVar20[0x12] - (iVar14 - iVar13 / 2) &lt; 0) {</pre>
<pre>            puVar20[0x13] = 0;</pre>
<pre>          }</pre>
<pre>          puVar20 = puVar20 + 3;</pre>
<pre>        } while (iVar27 != 8);</pre>
<pre>        puVar22[0x2d] = *(undefined4 *)(param_1 + 0x234);</pre>
<pre>        puVar22[7] = 0;</pre>
<pre>        if (puVar22[0x2c] != 0) {</pre>
<pre>          puVar22[0x2c] = puVar22[0x2c] + -1;</pre>
<pre>        }</pre>
<pre>      }</pre>
<pre>    }</pre>
<pre>LAB_00430230:</pre>
<pre>    SetNextQueryTime(param_1,puVar22);</pre>
<pre>  }</pre>
<pre>  iVar19 = *(int *)(param_1 + 0x216c);</pre>
<pre>  *(int *)(param_1 + 0x250) = *(int *)(param_1 + 0x234) + 0x78000000;</pre>
<pre>  if (iVar19 != 0) {</pre>
<pre>    uVar9 = GetRRDisplayString_rdb(iVar19 + 4,*(int *)(iVar19 + 0x24) + 4,param_1 + 0x2f);</pre>
<pre>    LogMsgWithLevel(0,"SendQueries ERROR m-&gt;CurrentRecord already set %s",uVar9);</pre>
<pre>  }</pre>
<pre>  local_78 = param_1 + 0x2f;</pre>
<pre>  *(undefined4 *)(param_1 + 0x216c) = *(undefined4 *)(param_1 + 0x2160);</pre>
<pre>LAB_004306bc:</pre>
<pre>  puVar22 = *(undefined4 **)(param_1 + 0x216c);</pre>
<pre>  if (puVar22 != (undefined4 *)0x0) {</pre>
<pre>    *(undefined4 *)(param_1 + 0x216c) = *puVar22;</pre>
<pre>    if ((((puVar22[7] != 0) || (*(char *)((int)puVar22 + 0x4a) != '\0')) ||</pre>
<pre>        (iVar19 = IsLocalDomain(puVar22[8]), iVar19 != 0)) &amp;&amp; (*(char *)(puVar22 + 1) == '\x02')) {</pre>
<pre>      if (-1 &lt; (-puVar22[0x30] - puVar22[0x2f]) + *(int *)(param_1 + 0x234)) {</pre>
<pre>        ppuVar16 = (uint **)(uint)*(byte *)((int)puVar22 + 0x86);</pre>
<pre>        if (ppuVar16 != (uint **)0x0) {</pre>
<pre>          if (puVar22[0x18] == 4) {</pre>
<pre>            if (mDNS_LoggingEnabled != 0) {</pre>
<pre>              for (puVar20 = *(undefined4 **)(param_1 + 0x2174); puVar20 != (undefined4 *)0x0;</pre>
<pre>                  puVar20 = (undefined4 *)*puVar20) {</pre>
<pre>                if (puVar20[0x548] == puVar22[7]) {</pre>
<pre>                  local_34 = (int *)((int)puVar20 + 0x1552);</pre>
<pre>                  goto LAB_00430394;</pre>
<pre>                }</pre>
<pre>              }</pre>
<pre>              local_34 = (int *)0x0;</pre>
<pre>LAB_00430394:</pre>
<pre>              local_30 = (char *)ppuVar16;</pre>
<pre>              uVar9 = GetRRDisplayString_rdb(puVar22 + 1,puVar22[9] + 4,local_78);</pre>
<pre>              LogMsgWithLevel(2,"SendQueries ARP Probe %d %s %s",local_30,local_34,uVar9);</pre>
<pre>            }</pre>
<pre>            in_stack_fffffb98 = (uint **)(puVar22 + 0x15);</pre>
<pre>            FUN_004296e0(param_1,1,puVar22,&amp;zerov4Addr,&amp;zeroEthAddr,puVar22 + 0x19,in_stack_fffffb98</pre>
<pre>                        );</pre>
<pre>          }</pre>
<pre>          else if (puVar22[0x18] == 6) {</pre>
<pre>            if (mDNS_LoggingEnabled != 0) {</pre>
<pre>              for (puVar20 = *(undefined4 **)(param_1 + 0x2174); puVar20 != (undefined4 *)0x0;</pre>
<pre>                  puVar20 = (undefined4 *)*puVar20) {</pre>
<pre>                if (puVar20[0x548] == puVar22[7]) {</pre>
<pre>                  local_34 = (int *)((int)puVar20 + 0x1552);</pre>
<pre>                  goto LAB_0043045c;</pre>
<pre>                }</pre>
<pre>              }</pre>
<pre>              local_34 = (int *)0x0;</pre>
<pre>LAB_0043045c:</pre>
<pre>              local_30 = (char *)ppuVar16;</pre>
<pre>              uVar9 = GetRRDisplayString_rdb(puVar22 + 1,puVar22[9] + 4,local_78);</pre>
<pre>              LogMsgWithLevel(2,"SendQueries NDP Probe %d %s %s",local_30,local_34,uVar9);</pre>
<pre>            }</pre>
<pre>            in_stack_fffffb98 = (uint **)(puVar22 + 0x19);</pre>
<pre>            FUN_0042989c(param_1,0x87,0,puVar22,zerov6Addr,0,in_stack_fffffb98,puVar22 + 0x15);</pre>
<pre>          }</pre>
<pre>          iVar19 = 0;</pre>
<pre>          if (((puVar8 == (undefined4 *)0x0) || (iVar19 = 0, *(int *)((int)puVar22 + 0x4e) != 0)) ||</pre>
<pre>             (iVar19 = puVar22[7], iVar19 != 0)) {</pre>
<pre>            puVar22[0x26] = iVar19;</pre>
<pre>          }</pre>
<pre>          else {</pre>
<pre>            puVar22[0x26] = puVar8[0x548];</pre>
<pre>          }</pre>
<pre>          puVar22[0x30] = *(undefined4 *)(param_1 + 0x234);</pre>
<pre>          if (3 &lt; *(byte *)((int)puVar22 + 0x86)) {</pre>
<pre>            *(undefined *)((int)puVar22 + 0x86) = 3;</pre>
<pre>          }</pre>
<pre>          *(char *)((int)puVar22 + 0x86) = *(char *)((int)puVar22 + 0x86) + -1;</pre>
<pre>          FUN_00426db0(param_1,puVar22);</pre>
<pre>          if (*(char *)((int)puVar22 + 0x86) == '\0') {</pre>
<pre>            for (ppuVar16 = *(uint ***)(param_1 + 0x2164); ppuVar16 != (uint **)0x0;</pre>
<pre>                ppuVar16 = (uint **)*ppuVar16) {</pre>
<pre>              if ((*(char *)(ppuVar16 + 1) == '\x02') &amp;&amp; (ppuVar16[7] == (uint *)puVar22[7])) {</pre>
<pre>                bVar1 = *(byte *)(puVar22 + 1);</pre>
<pre>                if ((((bVar1 == 2) || (((bVar1 | 2) == 0x12 || (bVar1 == 1)))) &amp;&amp;</pre>
<pre>                    (*(short *)((int)ppuVar16 + 6) == *(short *)((int)puVar22 + 6))) &amp;&amp;</pre>
<pre>                   (((((*(short *)(ppuVar16 + 2) == *(short *)(puVar22 + 2) &amp;&amp;</pre>
<pre>                       (ppuVar16[5] == (uint *)puVar22[5])) &amp;&amp;</pre>
<pre>                      (*(short *)(ppuVar16 + 4) == *(short *)(puVar22 + 4))) &amp;&amp;</pre>
<pre>                     ((ppuVar16[6] == (uint *)puVar22[6] &amp;&amp;</pre>
<pre>                      (local_30 = (char *)ppuVar16,</pre>
<pre>                      iVar19 = SameRDataBody(ppuVar16 + 1,puVar22[9] + 4,SameDomainName),</pre>
<pre>                      ppuVar16 = (uint **)local_30, iVar19 != 0)))) &amp;&amp;</pre>
<pre>                    (iVar19 = SameDomainName(*(uint **)((int)local_30 + 0x20),puVar22[8]),</pre>
<pre>                    ppuVar16 = (uint **)local_30, iVar19 != 0)))) {</pre>
<pre>                  *(char *)((int)local_30 + 0x86) = '\0';</pre>
<pre>                }</pre>
<pre>              }</pre>
<pre>            }</pre>
<pre>            if (*(char *)(puVar22 + 0x21) == '\0') {</pre>
<pre>              FUN_00426c2c(param_1,puVar22);</pre>
<pre>            }</pre>
<pre>          }</pre>
<pre>          goto LAB_004306bc;</pre>
<pre>        }</pre>
<pre>        if (*(char *)(puVar22 + 0x21) == '\0') {</pre>
<pre>          FUN_00426c2c(param_1,puVar22);</pre>
<pre>        }</pre>
<pre>        *(undefined *)(puVar22 + 1) = 0x10;</pre>
<pre>        puVar22[0x2f] = (int)mDNSPlatformOneSecond / 2;</pre>
<pre>        puVar22[0x30] = *(int *)(param_1 + 0x234) - (int)mDNSPlatformOneSecond / 2;</pre>
<pre>      }</pre>
<pre>      FUN_00426db0(param_1,puVar22);</pre>
<pre>    }</pre>
<pre>    goto LAB_004306bc;</pre>
<pre>  }</pre>
<pre>  *(undefined4 *)(param_1 + 0x216c) = *(undefined4 *)(param_1 + 0x2164);</pre>
<pre>  while( true ) {</pre>
<pre>    puVar22 = *(undefined4 **)(param_1 + 0x216c);</pre>
<pre>    local_64 = (uint **)(param_1 + 0x625c);</pre>
<pre>    if (puVar22 == (undefined4 *)0x0) break;</pre>
<pre>    *(undefined4 *)(param_1 + 0x216c) = *puVar22;</pre>
<pre>    if ((*(char *)(puVar22 + 1) == '\x02') &amp;&amp; ((puVar22[0x21] &amp; 0xff00ff00) == 0)) {</pre>
<pre>      FUN_00426c2c(param_1);</pre>
<pre>    }</pre>
<pre>  }</pre>
<pre>  local_44 = param_1 + 0x5cb6;</pre>
<pre>  local_54 = param_1 + 0x5cb8;</pre>
<pre>  local_48 = param_1 + 0x5cba;</pre>
<pre>  local_60 = 0;</pre>
<pre>LAB_00431718:</pre>
<pre>  do {</pre>
<pre>    iVar19 = local_78;</pre>
<pre>    if (puVar8 == (undefined4 *)0x0) goto LAB_00431724;</pre>
<pre>    iVar19 = 0;</pre>
<pre>    if (((*(int *)(param_1 + 0x27c) != 0) &amp;&amp; (puVar8[0x553] != 0)) &amp;&amp;</pre>
<pre>       ((iVar19 = 0x1d, *(int *)(param_1 + 0x14) == puVar8[0x553] &amp;&amp;</pre>
<pre>        (iVar19 = 0x17, *(short *)(param_1 + 0x18) != *(short *)(puVar8 + 0x554))))) {</pre>
<pre>      iVar19 = 0x1d;</pre>
<pre>    }</pre>
<pre>    iVar27 = 0x14;</pre>
<pre>    if (mDNS_McastTracingEnabled == 0) {</pre>
<pre>      iVar27 = 0;</pre>
<pre>    }</pre>
<pre>    InitializeDNSMessage(iVar28,0,0);</pre>
<pre>    ppuVar16 = local_6c;</pre>
<pre>    if (local_448 == 0) {</pre>
<pre>      puVar22 = *(undefined4 **)(param_1 + 0x2ac);</pre>
<pre>      local_70 = 0;</pre>
<pre>      ppuVar15 = (uint **)(iVar27 + iVar19);</pre>
<pre>      local_68 = &amp;local_448;</pre>
<pre>      local_40 = iVar27;</pre>
<pre>      for (; (iVar27 = local_40, puVar22 != (undefined4 *)0x0 &amp;&amp;</pre>
<pre>             (puVar22 != *(undefined4 **)(param_1 + 0x2b0))); puVar22 = (undefined4 *)*puVar22) {</pre>
<pre>        ppuVar12 = ppuVar15;</pre>
<pre>        if ((*(short *)((int)puVar22 + 0x152) == 0) &amp;&amp; (puVar22[0x2a] == puVar8[0x548])) {</pre>
<pre>          iVar27 = mDNSPlatformValidQuestionForInterface(puVar22,puVar8);</pre>
<pre>          if (iVar27 == 0) {</pre>
<pre>            if (mDNS_LoggingEnabled != 0) {</pre>
<pre>              uVar9 = DNSTypeName(*(undefined2 *)(puVar22 + 0x95));</pre>
<pre>              for (puVar20 = *(undefined4 **)(param_1 + 0x2174); puVar20 != (undefined4 *)0x0;</pre>
<pre>                  puVar20 = (undefined4 *)*puVar20) {</pre>
<pre>                if (puVar20[0x548] == puVar8[0x548]) {</pre>
<pre>                  iVar27 = (int)puVar20 + 0x1552;</pre>
<pre>                  goto LAB_00430878;</pre>
<pre>                }</pre>
<pre>              }</pre>
<pre>              iVar27 = 0;</pre>
<pre>LAB_00430878:</pre>
<pre>              LogMsgWithLevel(3,"SendQueries: Not sending (%s) %##s on %s",uVar9,puVar22 + 0x55,</pre>
<pre>                              iVar27);</pre>
<pre>            }</pre>
<pre>            if ((puVar22[0x4d] == 0) &amp;&amp; (*(char *)(puVar22 + 0x2b) != '\0')) {</pre>
<pre>              uVar9 = GetNextActiveInterfaceID(puVar8);</pre>
<pre>              puVar22[0x2a] = uVar9;</pre>
<pre>            }</pre>
<pre>            else {</pre>
<pre>              puVar22[0x2a] = 0;</pre>
<pre>            }</pre>
<pre>          }</pre>
<pre>          else {</pre>
<pre>            iVar27 = 0;</pre>
<pre>            bVar7 = *(char *)((int)puVar8 + 5) == '\0';</pre>
<pre>            bVar6 = *(char *)((int)puVar8 + 6) == '\0';</pre>
<pre>            puVar20 = puVar22;</pre>
<pre>            do {</pre>
<pre>              iVar27 = iVar27 + 1;</pre>
<pre>              if (puVar20[0x13] == puVar8[0x548]) {</pre>
<pre>                if (puVar20[0x14] != 4) {</pre>
<pre>                  if (puVar20[0x14] == 6) {</pre>
<pre>                    bVar6 = true;</pre>
<pre>                  }</pre>
<pre>                  if (!bVar7) goto LAB_00430920;</pre>
<pre>                }</pre>
<pre>                bVar7 = true;</pre>
<pre>                if (bVar6) {</pre>
<pre>                  *(int *)(param_1 + 0x396c) = *(int *)(param_1 + 0x396c) + 1;</pre>
<pre>                  ppuVar26 = ppuVar16;</pre>
<pre>                  goto LAB_00430c38;</pre>
<pre>                }</pre>
<pre>              }</pre>
<pre>LAB_00430920:</pre>
<pre>              puVar20 = puVar20 + 3;</pre>
<pre>            } while (iVar27 != 8);</pre>
<pre>            if (((puVar22[10] == 0) &amp;&amp; (puVar22[0x2c] == 0)) ||</pre>
<pre>               (uVar17 = 0x8000, *(char *)(param_1 + 8) == '\0')) {</pre>
<pre>              local_74 = (undefined *)0x0;</pre>
<pre>              uVar17 = 0;</pre>
<pre>            }</pre>
<pre>            else {</pre>
<pre>              local_74 = (undefined *)(uint)(*(char *)((int)puVar8 + 0x1599) != '\0');</pre>
<pre>              if (local_74 == (undefined *)0x0) {</pre>
<pre>                uVar17 = 0;</pre>
<pre>              }</pre>
<pre>            }</pre>
<pre>            local_30 = (char *)0x0;</pre>
<pre>            if (puVar22[0x11] != 0) {</pre>
<pre>              local_30 = (char *)(*(ushort *)(*(int *)(puVar22[0x11] + 0xc) + 0xc) + 0xc &amp; 0xff);</pre>
<pre>            }</pre>
<pre>            local_38 = puVar22 + 0x55;</pre>
<pre>            ppuVar26 = (uint **)putQuestion(iVar28,ppuVar16,</pre>
<pre>                                            (char *)((int)local_64 +</pre>
<pre>                                                    (-(int)ppuVar15 - (int)local_30)),local_38,</pre>
<pre>                                            *(undefined2 *)(puVar22 + 0x95),</pre>
<pre>                                            uVar17 | *(ushort *)((int)puVar22 + 0x256));</pre>
<pre>            if (ppuVar26 != (uint **)0x0) {</pre>
<pre>              puVar20 = (undefined4 *)0x0;</pre>
<pre>              uVar10 = DomainNameHashValue(local_38);</pre>
<pre>              piVar11 = (int *)CacheGroupForName(param_1,uVar10 % 499,puVar22[1],local_38);</pre>
<pre>              if (piVar11 != (int *)0x0) {</pre>
<pre>                puVar20 = (undefined4 *)piVar11[2];</pre>
<pre>              }</pre>
<pre>              ppuVar12 = (uint **)((int)local_30 + (int)ppuVar15);</pre>
<pre>              piVar21 = local_68;</pre>
<pre>LAB_00430b64:</pre>
<pre>              if (puVar20 != (undefined4 *)0x0) {</pre>
<pre>                if (((((puVar20[7] != puVar22[0x2a]) || ((*(byte *)(puVar20 + 1) &amp; 0x32) != 0)) ||</pre>
<pre>                     ((puVar20[0xc] != 0 ||</pre>
<pre>                      ((piVar21 == puVar20 + 0xc || (0x400 &lt; *(ushort *)(puVar20 + 4))))))) ||</pre>
<pre>                    (local_3c = piVar21, local_38 = puVar20 + 0xc, local_34 = piVar11,</pre>
<pre>                    local_30 = (char *)ppuVar12,</pre>
<pre>                    iVar27 = SameNameRecordAnswersQuestion(puVar20 + 1,puVar22),</pre>
<pre>                    ppuVar12 = (uint **)local_30, piVar11 = local_34, piVar23 = local_38,</pre>
<pre>                    piVar21 = local_3c, iVar27 == 0)) ||</pre>
<pre>                   ((puVar20[0xd] - *(int *)(param_1 + 0x234)) +</pre>
<pre>                    (int)(mDNSPlatformOneSecond * puVar20[3]) / 2 &lt;= (int)mDNSPlatformOneSecond))</pre>
<pre>                goto LAB_00430b5c;</pre>
<pre>                *local_3c = (int)puVar20;</pre>
<pre>                ppuVar12 = (uint **)((int)ppuVar12 + *(ushort *)((int)puVar20 + 0x12) + 0xc);</pre>
<pre>                piVar21 = piVar23;</pre>
<pre>                if ((*(ushort *)(param_1 + 0x5cb4) &lt; 2) ||</pre>
<pre>                   ((uint **)((int)ppuVar26 + (int)ppuVar12) &lt; local_64)) goto LAB_00430b5c;</pre>
<pre>                *(short *)(param_1 + 0x5cb4) = *(short *)(param_1 + 0x5cb4) + -1;</pre>
<pre>                piVar11 = local_68;</pre>
<pre>                while (iVar27 = *piVar11, ppuVar12 = ppuVar15, iVar27 != 0) {</pre>
<pre>                  *piVar11 = 0;</pre>
<pre>                  piVar11 = (int *)(iVar27 + 0x30);</pre>
<pre>                }</pre>
<pre>                goto LAB_00430e74;</pre>
<pre>              }</pre>
<pre>              if (local_74 != (undefined *)0x0) {</pre>
<pre>                iVar27 = *(int *)(param_1 + 0x234);</pre>
<pre>                if (iVar27 == 0) {</pre>
<pre>                  iVar27 = 1;</pre>
<pre>                }</pre>
<pre>                puVar22[5] = iVar27;</pre>
<pre>              }</pre>
<pre>              if (piVar11 != (int *)0x0) {</pre>
<pre>                puVar20 = (undefined4 *)piVar11[2];</pre>
<pre>              }</pre>
<pre>              for (; puVar20 != (undefined4 *)0x0; puVar20 = (undefined4 *)*puVar20) {</pre>
<pre>                if ((((puVar20[7] == puVar22[0x2a]) &amp;&amp; (puVar20[0xc] == 0)) &amp;&amp;</pre>
<pre>                    (piVar21 != puVar20 + 0xc)) &amp;&amp;</pre>
<pre>                   (local_30 = (char *)ppuVar12,</pre>
<pre>                   iVar27 = SameNameRecordAnswersQuestion(puVar20 + 1,puVar22),</pre>
<pre>                   ppuVar12 = (uint **)local_30, iVar27 != 0)) {</pre>
<pre>                  *(char *)(puVar20 + 0x13) = *(char *)(puVar20 + 0x13) + '\x01';</pre>
<pre>                  puVar20[0x12] = *(undefined4 *)(param_1 + 0x234);</pre>
<pre>                  FUN_00428c90(param_1,puVar20);</pre>
<pre>                  ppuVar12 = (uint **)local_30;</pre>
<pre>                }</pre>
<pre>              }</pre>
<pre>              local_68 = piVar21;</pre>
<pre>              if (puVar22[0x11] != 0) {</pre>
<pre>                *(undefined4 *)(puVar22[0x11] + 0x10) = puVar8[0x548];</pre>
<pre>              }</pre>
<pre>LAB_00430c38:</pre>
<pre>              uVar9 = 0;</pre>
<pre>              if (puVar22[0x4d] == 0) {</pre>
<pre>                if (*(char *)(puVar22 + 0x2b) == '\0') {</pre>
<pre>                  uVar9 = 0;</pre>
<pre>                }</pre>
<pre>                else {</pre>
<pre>                  uVar9 = GetNextActiveInterfaceID(puVar8);</pre>
<pre>                }</pre>
<pre>              }</pre>
<pre>              puVar22[0x2a] = uVar9;</pre>
<pre>              if (*(char *)((int)puVar22 + 0xbe) != '\0') {</pre>
<pre>                piVar11 = (int *)puVar22[0x4d];</pre>
<pre>                if (((piVar11 == (int *)0x0) || (piVar11 == (int *)&amp;SUB_fffffffe)) ||</pre>
<pre>                   (piVar11 == (int *)0xfffffffc)) {</pre>
<pre>                  pcVar25 = </pre>
<pre>                  "mDNSSendWakeOnResolve: ERROR!! Invalid InterfaceID %p for question %##s";</pre>
<pre>                  piVar23 = puVar22 + 0x55;</pre>
<pre>                  piVar21 = piVar11;</pre>
<pre>LAB_00430d24:</pre>
<pre>                  LogMsgWithLevel(0,pcVar25,piVar21,piVar23);</pre>
<pre>                }</pre>
<pre>                else {</pre>
<pre>                  piVar23 = (int *)0x0;</pre>
<pre>                  for (iVar27 = 1; iVar27 &lt; (int)(uint)*(byte *)(puVar22 + 0x55);</pre>
<pre>                      iVar27 = iVar27 + 1) {</pre>
<pre><span class="green">                    cVar2 = *(char *)((int)puVar22 + iVar27 + 0x154)</span></span></pre>
<pre>                    if (cVar2 == '&commat;') {</pre>
<pre>                      if (piVar23 == (int *)0x5) {</pre>
<pre>                        __n = (int *)(iVar27 + -1);</pre>
<pre>                        piVar23 = (int *)((uint)*(byte *)(puVar22 + 0x55) - iVar27);</pre>
<pre>                        if ((int)__n &lt; 0x12) {</pre>
<pre>                          piVar21 = puVar22 + 0x55;</pre>
<pre>                          if (0x2e &lt; (int)piVar23) {</pre>
<pre>                            pcVar25 = </pre>
<pre>                            "mDNSSendWakeOnResolve: ERROR!! Malformed IP address %##s, length %d";</pre>
<pre>                            goto LAB_00430d24;</pre>
<pre>                          }</pre>
<pre>                          local_30 = (char *)apuStack_444;</pre>
<pre>                          local_50 = &amp;local_448;</pre>
<pre>                          local_74 = auStack_430;</pre>
<pre>                          local_3c = piVar23;</pre>
<pre>                          local_38 = piVar21;</pre>
<pre>                          local_34 = __n;</pre>
<pre>                          mDNSPlatformMemCopy(local_30,(void *)((int)puVar22 + 0x155),(size_t)__n);</pre>
<pre>                          *(undefined *)((int)local_50 + (int)local_34 + 4) = 0;</pre>
<pre>                          mDNSPlatformMemCopy(local_74,(void *)((int)local_38 + iVar27 + 1),</pre>
<pre>                                              (size_t)local_3c);</pre>
<pre>                          iVar27 = *(int *)(param_1 + 0x39b4);</pre>
<pre>                          *(undefined *)((int)local_50 + (int)local_3c + 0x18) = 0;</pre>
<pre>                          *(int *)(param_1 + 0x39b4) = iVar27 + 1;</pre>
<pre>                          mDNSPlatformSendWakeupPacket</pre>
<pre>                                    (param_1,piVar11,local_30,local_74,</pre>
<pre>                                     3 - (uint)*(byte *)((int)puVar22 + 0xbe));</pre>
<pre>                          goto LAB_00430e50;</pre>
<pre>                        }</pre>
<pre>                        pcVar25 = </pre>
<pre>                        "mDNSSendWakeOnResolve: ERROR!! Malformed Ethernet address %##s, length %d";</pre>
<pre>                        piVar23 = __n;</pre>
<pre>                      }</pre>
<pre>                      else {</pre>
<pre>                        pcVar25 = </pre>
<pre>                        "mDNSSendWakeOnResolve: ERROR!! Malformed Ethernet address %##s, cnt %d";</pre>
<pre>                      }</pre>
<pre>                      piVar21 = puVar22 + 0x55;</pre>
<pre>                      goto LAB_00430d24;</pre>
<pre>                    }</pre>
<pre>                    piVar23 = (int *)((int)piVar23 + (uint)(cVar2 == ':'));</pre>
<pre>                  }</pre>
<pre>                  LogMsgWithLevel(0,</pre>
<pre>                                  "mDNSSendWakeOnResolve: ERROR!! Malformed WakeOnResolve name %##s"</pre>
<pre>                                  ,puVar22 + 0x55);</pre>
<pre>                }</pre>
<pre>LAB_00430e50:</pre>
<pre>                *(char *)((int)puVar22 + 0xbe) = *(char *)((int)puVar22 + 0xbe) + -1;</pre>
<pre>              }</pre>
<pre>              ppuVar16 = ppuVar26;</pre>
<pre>              if (*(char *)((int)puVar22 + 0x262) != '\0') {</pre>
<pre>                local_70 = 1;</pre>
<pre>              }</pre>
<pre>            }</pre>
<pre>          }</pre>
<pre>        }</pre>
<pre>LAB_00430e74:</pre>
<pre>        ppuVar15 = ppuVar12;</pre>
<pre>      }</pre>
<pre>      for (puVar22 = *(undefined4 **)(param_1 + 0x2160); puVar22 != (undefined4 *)0x0;</pre>
<pre>          puVar22 = (undefined4 *)*puVar22) {</pre>
<pre>        if (puVar22[0x26] == puVar8[0x548]) {</pre>
<pre>          bVar7 = false;</pre>
<pre>          if (1 &lt; *(byte *)((int)puVar22 + 0x86)) {</pre>
<pre>            if (*(char *)(param_1 + 8) == '\0') {</pre>
<pre>              bVar7 = false;</pre>
<pre>            }</pre>
<pre>            else {</pre>
<pre>              bVar7 = *(char *)((int)puVar8 + 0x1599) != '\0';</pre>
<pre>            }</pre>
<pre>          }</pre>
<pre>          iVar13 = 0x22ec;</pre>
<pre>          if (*(short *)(param_1 + 0x5cb4) != 0) {</pre>
<pre>            iVar13 = 0x5a0;</pre>
<pre>          }</pre>
<pre>          uVar17 = 0x8000;</pre>
<pre>          if (!bVar7) {</pre>
<pre>            uVar17 = 0;</pre>
<pre>          }</pre>
<pre>          ppuVar26 = (uint **)(*(ushort *)((int)puVar22 + 0x12) + 0xc + (int)ppuVar15);</pre>
<pre>          ppuVar12 = (uint **)putQuestion(iVar28,ppuVar16,</pre>
<pre>                                          (param_1 + iVar13 + 0x5cbc) - (int)ppuVar26,puVar22[8],</pre>
<pre>                                          0xff,uVar17 | *(ushort *)(puVar22 + 2));</pre>
<pre>          if (ppuVar12 != (uint **)0x0) {</pre>
<pre>            uVar9 = 0;</pre>
<pre>            ppuVar16 = ppuVar12;</pre>
<pre>            if (puVar22[7] == 0) {</pre>
<pre>              local_30 = (char *)ppuVar12;</pre>
<pre>              uVar9 = GetNextActiveInterfaceID(puVar8);</pre>
<pre>              ppuVar16 = (uint **)local_30;</pre>
<pre>            }</pre>
<pre>            puVar22[0x26] = uVar9;</pre>
<pre>            *(undefined *)((int)puVar22 + 0x8a) = 1;</pre>
<pre>            ppuVar15 = ppuVar26;</pre>
<pre>          }</pre>
<pre>        }</pre>
<pre>      }</pre>
<pre>    }</pre>
<pre>    else {</pre>
<pre>      local_70 = 0;</pre>
<pre>    }</pre>
<pre>    while (iVar13 = local_448, local_448 != 0) {</pre>
<pre>      if (mDNSPlatformOneSecond == 0) {</pre>
<pre>        trap(0x1c00);</pre>
<pre>      }</pre>
<pre>      ppuVar15 = (uint **)PutResourceRecordTTLWithLimit</pre>
<pre>                                    (iVar28,ppuVar16,local_44,local_448 + 4,</pre>
<pre>                                     *(int *)(local_448 + 0xc) -</pre>
<pre>                                     (uint)(*(int *)(param_1 + 0x234) - *(int *)(local_448 + 0x34))</pre>
<pre>                                     / mDNSPlatformOneSecond,((param_1 - iVar27) - iVar19) + 0x625c)</pre>
<pre>      ;</pre>
<pre>      if (ppuVar15 == (uint **)0x0) {</pre>
<pre>        if (1 &lt; *(ushort *)(param_1 + 0x5cb4)) {</pre>
<pre>          LogMsgWithLevel(0,"SendQueries:   Put %d answers; No more space for known answers",</pre>
<pre>                          *(undefined2 *)(param_1 + 0x5cb6));</pre>
<pre>        }</pre>
<pre>        *(byte *)(param_1 + 0x5cb2) = *(byte *)(param_1 + 0x5cb2) | 2;</pre>
<pre>        break;</pre>
<pre>      }</pre>
<pre>      local_448 = *(int *)(iVar13 + 0x30);</pre>
<pre>      *(undefined4 *)(iVar13 + 0x30) = 0;</pre>
<pre>      ppuVar16 = ppuVar15;</pre>
<pre>    }</pre>
<pre>    for (puVar22 = *(undefined4 **)(param_1 + 0x2160); puVar22 != (undefined4 *)0x0;</pre>
<pre>        puVar22 = (undefined4 *)*puVar22) {</pre>
<pre>      ppuVar15 = ppuVar16;</pre>
<pre>      if (*(char *)((int)puVar22 + 0x8a) != '\0') {</pre>
<pre>        iVar13 = 0x22ec;</pre>
<pre>        if ((*(short *)(param_1 + 0x5cb6) != 0) || (*(int *)(param_1 + 0x5cb8) != 0)) {</pre>
<pre>          iVar13 = 0x5a0;</pre>
<pre>        }</pre>
<pre>        ppuVar15 = (uint **)PutResourceRecordTTLWithLimit</pre>
<pre>                                      (iVar28,ppuVar16,local_54,puVar22 + 1,puVar22[3],</pre>
<pre>                                       param_1 + iVar13 + 0x5cbc);</pre>
<pre>        *(undefined *)((int)puVar22 + 0x8a) = 0;</pre>
<pre>        if (ppuVar15 == (uint **)0x0) {</pre>
<pre>          uVar9 = GetRRDisplayString_rdb(puVar22 + 1,puVar22[9] + 4,local_78);</pre>
<pre>          LogMsgWithLevel(0,"SendQueries:   How did we fail to have space for the Update record %s",</pre>
<pre>                          uVar9);</pre>
<pre>          ppuVar15 = ppuVar16;</pre>
<pre>        }</pre>
<pre>      }</pre>
<pre>      ppuVar16 = ppuVar15;</pre>
<pre>    }</pre>
<pre>    for (puVar22 = *(undefined4 **)(param_1 + 0x2ac); puVar22 != (undefined4 *)0x0;</pre>
<pre>        puVar22 = (undefined4 *)*puVar22) {</pre>
<pre>      iVar13 = puVar22[0x11];</pre>
<pre>      ppuVar15 = ppuVar16;</pre>
<pre>      if ((iVar13 != 0) &amp;&amp; (*(int *)(iVar13 + 0x10) == puVar8[0x548])) {</pre>
<pre>        iVar14 = 0x5a0;</pre>
<pre>        if ((*(short *)(param_1 + 0x5cb6) == 0) &amp;&amp;</pre>
<pre>           (iVar14 = 0x22ec, *(int *)(param_1 + 0x5cb8) != 0)) {</pre>
<pre>          iVar14 = 0x5a0;</pre>
<pre>        }</pre>
<pre>        ppuVar15 = (uint **)PutResourceRecordTTLWithLimit</pre>
<pre>                                      (iVar28,ppuVar16,local_54,*(int *)(iVar13 + 0xc),</pre>
<pre>                                       *(undefined4 *)(*(int *)(iVar13 + 0xc) + 8),</pre>
<pre>                                       param_1 + iVar14 + 0x5cbc);</pre>
<pre>        if (ppuVar15 == (uint **)0x0) {</pre>
<pre>          uVar9 = GetRRDisplayString_rdb</pre>
<pre>                            (*(int *)(puVar22[0x11] + 0xc),</pre>
<pre>                             *(int *)(*(int *)(puVar22[0x11] + 0xc) + 0x20) + 4,local_78);</pre>
<pre>          LogMsgWithLevel(0,"SendQueries: ERROR!! Cannot add NSEC3 record %s on InterfaceID %p",</pre>
<pre>                          uVar9,puVar8[0x548]);</pre>
<pre>          ppuVar15 = ppuVar16;</pre>
<pre>        }</pre>
<pre>        *(undefined4 *)(puVar22[0x11] + 0x10) = 0;</pre>
<pre>      }</pre>
<pre>      ppuVar16 = ppuVar15;</pre>
<pre>    }</pre>
<pre>    if (ppuVar16 &lt;= local_6c) {</pre>
<pre>      puVar8 = (undefined4 *)GetFirstActiveInterface(*puVar8);</pre>
<pre>      goto LAB_00431718;</pre>
<pre>    }</pre>
<pre>    if ((iVar27 != 0) || (iVar19 != 0)) {</pre>
<pre>      in_stack_fffffb98 = (uint **)0x0;</pre>
<pre>      mDNS_SetupResourceRecord(auStack_400,0,0,0x29,0x1194,0x20,0,0,0);</pre>
<pre>      iVar13 = local_3dc;</pre>
<pre>      local_3f8 = 0x5a0;</pre>
<pre>      local_3ee = 0x18;</pre>
<pre>      local_3f0 = 0x18;</pre>
<pre>      if (iVar19 == 0) {</pre>
<pre>        if (iVar27 != 0) {</pre>
<pre>          *(char *)(local_3dc + 8) = (char)*(undefined4 *)(param_1 + 0x2184);</pre>
<pre>          *(undefined2 *)(local_3dc + 6) = 5;</pre>
<pre>          *(undefined4 *)(local_3dc + 0xc) = 0x5f6e16;</pre>
<pre>          *(undefined2 *)(local_3dc + 4) = 0xfde9;</pre>
<pre>        }</pre>
<pre>      }</pre>
<pre>      else if (iVar27 == 0) {</pre>
<pre>        *(undefined *)(local_3dc + 8) = 0;</pre>
<pre>        *(undefined *)(local_3dc + 9) = *(undefined *)(param_1 + 0x276);</pre>
<pre>        *(undefined2 *)(local_3dc + 10) = *(undefined2 *)(param_1 + 0x14);</pre>
<pre>        *(undefined2 *)(local_3dc + 0xc) = *(undefined2 *)(param_1 + 0x16);</pre>
<pre>        *(undefined2 *)(local_3dc + 0xe) = *(undefined2 *)(param_1 + 0x18);</pre>
<pre>        *(undefined4 *)(local_3dc + 0x10) = puVar8[0x553];</pre>
<pre>        *(undefined2 *)(local_3dc + 0x14) = *(undefined2 *)(puVar8 + 0x554);</pre>
<pre><span class="green"><span class="green">        memcpy((void *)(local_3dc + 0x16),&amp;zeroEthAddr,6)</span></span></span></pre>
<pre>        *(undefined2 *)(iVar13 + 4) = 4;</pre>
<pre>        uVar18 = 0xe;</pre>
<pre>        if ((*(int *)(param_1 + 0x14) == puVar8[0x553]) &amp;&amp;</pre>
<pre>           (uVar18 = 8, *(short *)(param_1 + 0x18) != *(short *)(puVar8 + 0x554))) {</pre>
<pre>          uVar18 = 0xe;</pre>
<pre>        }</pre>
<pre>        *(undefined2 *)(iVar13 + 6) = uVar18;</pre>
<pre>      }</pre>
<pre>      else {</pre>
<pre>        local_3ee = 0x30;</pre>
<pre>        local_3f0 = 0x30;</pre>
<pre>        *(undefined *)(local_3dc + 8) = 0;</pre>
<pre>        *(undefined *)(local_3dc + 9) = *(undefined *)(param_1 + 0x276);</pre>
<pre>        *(undefined2 *)(local_3dc + 10) = *(undefined2 *)(param_1 + 0x14);</pre>
<pre>        *(undefined2 *)(local_3dc + 0xc) = *(undefined2 *)(param_1 + 0x16);</pre>
<pre>        *(undefined2 *)(local_3dc + 0xe) = *(undefined2 *)(param_1 + 0x18);</pre>
<pre>        *(undefined4 *)(local_3dc + 0x10) = puVar8[0x553];</pre>
<pre>        *(undefined2 *)(local_3dc + 0x14) = *(undefined2 *)(puVar8 + 0x554);</pre>
<pre><span class="green"><span class="green">        memcpy((void *)(local_3dc + 0x16),&amp;zeroEthAddr,6)</span></span></span></pre>
<pre>        *(undefined2 *)(iVar13 + 4) = 4;</pre>
<pre>        uVar18 = 0xe;</pre>
<pre>        if ((*(int *)(param_1 + 0x14) == puVar8[0x553]) &amp;&amp;</pre>
<pre>           (uVar18 = 8, *(short *)(param_1 + 0x18) != *(short *)(puVar8 + 0x554))) {</pre>
<pre>          uVar18 = 0xe;</pre>
<pre>        }</pre>
<pre>        *(undefined2 *)(iVar13 + 6) = uVar18;</pre>
<pre>        *(char *)(local_3dc + 0x20) = (char)*(undefined4 *)(param_1 + 0x2184);</pre>
<pre>        *(undefined2 *)(local_3dc + 0x1e) = 5;</pre>
<pre>        *(undefined4 *)(local_3dc + 0x24) = 0x5f6e16;</pre>
<pre>        *(undefined2 *)(local_3dc + 0x1c) = 0xfde9;</pre>
<pre>      }</pre>
<pre>      if (mDNS_LoggingEnabled != 0) {</pre>
<pre>        pcVar25 = "";</pre>
<pre>        if (iVar19 != 0) {</pre>
<pre>          pcVar25 = "OWNER";</pre>
<pre>        }</pre>
<pre>        local_34 = (int *)0x44db00;</pre>
<pre>        if (iVar27 != 0) {</pre>
<pre>          local_34 = (int *)"TRACER";</pre>
<pre>        }</pre>
<pre>        uVar9 = GetRRDisplayString_rdb(auStack_3fc,local_3dc + 4,local_78);</pre>
<pre>        LogMsgWithLevel(3,"SendQueries putting %s %s: %s %s",pcVar25,local_34,(int)puVar8 + 0x1552,</pre>
<pre>                        uVar9);</pre>
<pre>      }</pre>
<pre>      ppuVar16 = (uint **)PutResourceRecordTTLWithLimit</pre>
<pre>                                    (iVar28,ppuVar16,local_48,auStack_3fc,local_3f4,local_58);</pre>
<pre>      if (ppuVar16 == (uint **)0x0) {</pre>
<pre>        local_30 = "";</pre>
<pre>        if (iVar19 != 0) {</pre>
<pre>          local_30 = "OWNER";</pre>
<pre>        }</pre>
<pre>        local_34 = (int *)0x44db00;</pre>
<pre>        if (iVar27 != 0) {</pre>
<pre>          local_34 = (int *)"TRACER";</pre>
<pre>        }</pre>
<pre>        uVar18 = *(undefined2 *)(param_1 + 0x5cb4);</pre>
<pre>        uVar3 = *(undefined2 *)(param_1 + 0x5cb6);</pre>
<pre>        in_stack_fffffb98 = (uint **)(uint)*(ushort *)(param_1 + 0x5cb8);</pre>
<pre>        uVar4 = *(undefined2 *)(param_1 + 0x5cba);</pre>
<pre>        uVar9 = GetRRDisplayString_rdb(auStack_3fc,local_3dc + 4,local_78);</pre>
<pre>        LogMsgWithLevel(0,</pre>
<pre>                        "SendQueries: How did we fail to have space for %s %s OPT record (%d/%d/%d/%d) %s"</pre>
<pre>                        ,local_30,local_34,uVar18,uVar3,in_stack_fffffb98,uVar4,uVar9);</pre>
<pre>      }</pre>
<pre>      else if ((local_64 &lt; ppuVar16) &amp;&amp;</pre>
<pre>              ((*(int *)(param_1 + 0x5cb4) != 0x10000 || (*(int *)(param_1 + 0x5cb8) != 0x10001))))</pre>
<pre>      {</pre>
<pre>        local_30 = "";</pre>
<pre>        if (iVar19 != 0) {</pre>
<pre>          local_30 = "OWNER";</pre>
<pre>        }</pre>
<pre>        local_34 = (int *)0x44db00;</pre>
<pre>        if (iVar27 != 0) {</pre>
<pre>          local_34 = (int *)"TRACER";</pre>
<pre>        }</pre>
<pre>        uVar18 = *(undefined2 *)(param_1 + 0x5cb4);</pre>
<pre>        uVar3 = *(undefined2 *)(param_1 + 0x5cb6);</pre>
<pre>        uVar4 = *(undefined2 *)(param_1 + 0x5cb8);</pre>
<pre>        uVar5 = *(undefined2 *)(param_1 + 0x5cba);</pre>
<pre>        uVar9 = GetRRDisplayString_rdb(auStack_3fc,local_3dc + 4,local_78);</pre>
<pre>        in_stack_fffffb98 = ppuVar16;</pre>
<pre>        LogMsgWithLevel(0,</pre>
<pre>                        "SendQueries: Why did we generate oversized packet with %s %s OPT record %p %p %p (%d/%d/%d/%d) %s"</pre>
<pre>                        ,local_30,local_34,local_6c,local_64,ppuVar16,uVar18,uVar3,uVar4,uVar5,uVar9</pre>
<pre>                       );</pre>
<pre>      }</pre>
<pre>    }</pre>
<pre>    if (((*(byte *)(param_1 + 0x5cb2) &amp; 2) != 0) &amp;&amp; (1 &lt; *(ushort *)(param_1 + 0x5cb4))) {</pre>
<pre>      LogMsgWithLevel(0,</pre>
<pre>                      "SendQueries: Should not have more than one question (%d) in a truncated packet"</pre>
<pre>                     );</pre>
<pre>    }</pre>
<pre>    if (*(char *)((int)puVar8 + 5) != '\0') {</pre>
<pre>      in_stack_fffffb98 = (uint **)((uint)in_stack_fffffb98 &amp; 0xffff | 0x14e90000);</pre>
<pre>      mDNSSendDNSMessage(param_1,iVar28,ppuVar16,puVar8[0x548],0,AllDNSLinkGroup_v4,</pre>
<pre>                         in_stack_fffffb98,0,0,local_70);</pre>
<pre>    }</pre>
<pre>    if (*(char *)((int)puVar8 + 6) != '\0') {</pre>
<pre>      in_stack_fffffb98 = (uint **)((uint)in_stack_fffffb98 &amp; 0xffff | 0x14e90000);</pre>
<pre>      mDNSSendDNSMessage(param_1,iVar28,ppuVar16,puVar8[0x548],0,AllDNSLinkGroup_v6,</pre>
<pre>                         in_stack_fffffb98,0,0,local_70);</pre>
<pre>    }</pre>
<pre>    iVar19 = local_78;</pre>
<pre>    if (*(int *)(param_1 + 0x244) == 0) {</pre>
<pre>      iVar27 = (int)(mDNSPlatformOneSecond + 9) / 10 + *(int *)(param_1 + 0x234);</pre>
<pre>      if (iVar27 == 0) {</pre>
<pre>        iVar27 = 1;</pre>
<pre>      }</pre>
<pre>      *(int *)(param_1 + 0x244) = iVar27;</pre>
<pre>    }</pre>
<pre>    local_60 = local_60 + 1;</pre>
<pre>    if (999 &lt; local_60) {</pre>
<pre>      LogMsgWithLevel(0,"SendQueries exceeded loop limit %d: giving up",local_60);</pre>
<pre>LAB_00431724:</pre>
<pre>      for (puVar8 = *(undefined4 **)(param_1 + 0x2160); iVar28 = local_4c,</pre>
<pre>          puVar8 != (undefined4 *)0x0; puVar8 = (undefined4 *)*puVar8) {</pre>
<pre>        iVar28 = puVar8[0x26];</pre>
<pre>        if (iVar28 != 0) {</pre>
<pre>          if ((1 &lt; puVar8[0x1f] - 4) &amp;&amp; (mDNS_LoggingEnabled != 0)) {</pre>
<pre>            local_34 = (int *)puVar8[7];</pre>
<pre>            uVar9 = GetRRDisplayString_rdb(puVar8 + 1,puVar8[9] + 4,iVar19);</pre>
<pre>            LogMsgWithLevel(3,"SendQueries: No active interface %d to send probe: %d %s",iVar28,</pre>
<pre>                            local_34,uVar9);</pre>
<pre>          }</pre>
<pre>          puVar8[0x26] = 0;</pre>
<pre>        }</pre>
<pre>      }</pre>
<pre>      do {</pre>
<pre>        for (puVar8 = *(undefined4 **)(iVar28 + 0x2e0); puVar8 != (undefined4 *)0x0;</pre>
<pre>            puVar8 = (undefined4 *)*puVar8) {</pre>
<pre>          for (puVar22 = (undefined4 *)puVar8[2]; puVar22 != (undefined4 *)0x0;</pre>
<pre>              puVar22 = (undefined4 *)*puVar22) {</pre>
<pre>            if (((puVar22[0x11] != 0) &amp;&amp; (*(byte *)(puVar22 + 0x13) &lt; 4)) &amp;&amp;</pre>
<pre>               (-1 &lt; (*(int *)(param_1 + 0x234) - puVar22[0xf]) +</pre>
<pre>                     (int)(puVar22[3] * mDNSPlatformOneSecond) / 0x32)) {</pre>
<pre>              *(byte *)(puVar22 + 0x13) = *(byte *)(puVar22 + 0x13) + 1;</pre>
<pre>              *(undefined4 *)(puVar22[0x11] + 0xa8) = 0;</pre>
<pre>              FUN_00428c90(param_1,puVar22);</pre>
<pre>            }</pre>
<pre>          }</pre>
<pre>        }</pre>
<pre>        iVar28 = iVar28 + 4;</pre>
<pre>      } while (iVar28 != local_5c);</pre>
<pre>      for (puVar8 = *(undefined4 **)(param_1 + 0x2ac); puVar8 != (undefined4 *)0x0;</pre>
<pre>          puVar8 = (undefined4 *)*puVar8) {</pre>
<pre>        local_3c = (int *)puVar8[0x2a];</pre>
<pre>        if (local_3c != (int *)0x0) {</pre>
<pre>          for (puVar22 = *(undefined4 **)(param_1 + 0x2b0);</pre>
<pre>              (puVar22 != (undefined4 *)0x0 &amp;&amp; (puVar22 != puVar8));</pre>
<pre>              puVar22 = (undefined4 *)*puVar22) {</pre>
<pre>          }</pre>
<pre>          if (mDNS_LoggingEnabled != 0) {</pre>
<pre>            local_34 = (int *)&amp;UNK_00456ea4;</pre>
<pre>            if (puVar22 != (undefined4 *)0x0) {</pre>
<pre>              local_34 = (int *)&amp;UNK_00456ea8;</pre>
<pre>            }</pre>
<pre>            uVar29 = puVar8[0x4d];</pre>
<pre>            uVar9 = DNSTypeName(*(undefined2 *)(puVar8 + 0x95));</pre>
<pre>            LogMsgWithLevel(3,</pre>
<pre>                            "SendQueries: No active interface %d to send %s question: %d %##s (%s)",</pre>
<pre>                            local_3c,local_34,uVar29,puVar8 + 0x55,uVar9);</pre>
<pre>          }</pre>
<pre>          puVar8[0x2a] = 0;</pre>
<pre>        }</pre>
<pre>        *(undefined *)((int)puVar8 + 0xad) = 0;</pre>
<pre>      }</pre>
<pre>      return;</pre>
<pre>    }</pre>
<pre>  } while( true );</pre>
<pre>LAB_00430b5c:</pre>
<pre>  puVar20 = (undefined4 *)*puVar20;</pre>
<pre>  goto LAB_00430b64;</pre>
<pre>}</pre>
<br />
  <!-- content end -->
</div>

<a href="https://github.com/e-m-b-a/emba" title="github.com/e-m-b-a/emba" target="_blank">
  <div id="buttonInfo" class="rectButtonVisible">
    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" transform="translate(2 2)"><g stroke="white" stroke-linecap="round" stroke-linejoin="round"><circle cx="8.5" cy="8.5" r="8"/><path d="M8.5 12.5v-4h-1"/><path d="M7.5 12.5h2"/></g><circle cx="8.5" cy="5.5" fill="white" r="1"/></g></svg>
  </div>
</a>
<div id="buttonBack" class="nonClickable rectButtonVisible"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><path d="M9.5 14.5l4-4l-4-4" fill="none" stroke="#444" stroke-linecap="round" stroke-linejoin="round"/></svg></div>
<div id="buttonForward" class="nonClickable rectButtonVisible"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><path d="M11.5 14.5l-4-4l4-4" fill="none" stroke="#444" stroke-linecap="round" stroke-linejoin="round"/></svg></div> 
<div id="buttonDown" class="rectButton" onclick="scrollDown()"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="#fff" stroke-linecap="round" stroke-linejoin="round"><path d="M14.5 6.5l-4 4l-4-4"/><path d="M14.5 10.5l-4 4l-4-4"/></g></svg></div>
<div id="buttonUp" class="rectButton" onclick="scrollUp()"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="#fff" stroke-linecap="round" stroke-linejoin="round"><path d="M6.5 14.5l4-4l4 4"/><path d="M6.5 10.5l4-4l4 4"/></g></svg></div> 

<script>
window.onload = function () {
  var buttons = document.getElementsByClassName("rectButton");
  for (let i=0; i<buttons.length; i++) {
    buttons[i].style.visibility = "visible";
  }
  var buttonDown = document.getElementById("buttonDown");
  buttonDown.classList.add('rectButtonVisible');
  buttonDown.classList.remove('rectButton');

  var buttonUp = document.getElementById("buttonUp");
  buttonUp.classList.add('rectButtonVisible');
  buttonUp.classList.remove('rectButton');
    
  var buttonSizer = document.getElementById("buttonSizer");
  buttonSizer.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="white" stroke-linecap="round" stroke-linejoin="round"><path d="M9.5 16.5v-4.978l-5-.022"/><path d="M18.5 2.5l-7 7"/><path d="M16.5 9.5l-5 .023V4.5"/><path d="M9.5 11.5l-7 7"/></g></svg>';
  if (document.getElementById("buttonTime") !== null) {
    var buttonTime = document.getElementById("buttonTime");
    buttonTime.style.bottom = "50px";
  }
  document.getElementById("expand").value = "+ Show more results";
  document.getElementById("expand").className += " expand";
  var embarkButton = document.getElementById("embark");
  if ( !(embarkButton.href.includes("embarkBackUrl")) ) {
    embarkButton.classList.remove('hidden');
    document.getElementById("logoImage").src = "./../../style/embark.svg";
    document.getElementById("logo").style.background = "#2d2d2d";
  }
}

function openNav() {
  document.getElementById("sidenav").style.width = "250px";
  document.getElementById("main").style.marginLeft = "250px";
  document.getElementById("nav").style.visibility = "visible";
}

function closeNav() {
  document.getElementById("sidenav").style.width = "50px";
  document.getElementById("sidenav").scrollTop = 0;
  document.getElementById("main").style.marginLeft = "50px";
  document.getElementById("nav").style.visibility = "hidden";
}

function scrollDown() {
  window.scrollTo(0,document.body.scrollHeight);
}

function scrollUp() {
  window.scrollTo(0,0);
}

function buttonNav() {
  var button = document.getElementById("buttonSizer");
  if ( button.classList.contains('buttonOpen') ) {
    button.classList.remove('buttonOpen');
    button.classList.add('buttonClose');
    button.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="white" stroke-linecap="round" stroke-linejoin="round"><path d="M9.5 16.5v-4.978l-5-.022"/><path d="M18.5 2.5l-7 7"/><path d="M16.5 9.5l-5 .023V4.5"/><path d="M9.5 11.5l-7 7"/></g></svg>';
    openNav();
  } else if( button.classList.contains('buttonClose') ) {
    button.classList.remove('buttonClose');
    button.classList.add('buttonOpen');
    button.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="white" stroke-linecap="round" stroke-linejoin="round"><path d="M18.5 7.5v-5h-5"/><path d="M18.5 2.5l-6 5.929"/><path d="M7.5 18.5l-5 .023V13.5"/><path d="M8.5 12.5l-6 6"/></g></svg>';
    closeNav();
  };
}

// the following function is currently not used
// it is for future extensions
function overlay_output(link) {
  var rawfile = new XMLHttpRequest();
  rawfile.open('GET', link, false);
  rawfile.overrideMimeType("text");
  rawfile.onreadystatechange = function()
  {
    alert(rawfile.responseText);
    //console.log(rawfile.responseText);
  }
  rawfile.send(null);
}

document.onkeydown = function(e) {
    switch (e.keyCode) {
      case 37:
        document.getElementById("buttonForward").parentNode.click(); 
        break;
      case 39:
        document.getElementById("buttonBack").parentNode.click();       
        break;
    }
};
</script>

</body>
</html>
