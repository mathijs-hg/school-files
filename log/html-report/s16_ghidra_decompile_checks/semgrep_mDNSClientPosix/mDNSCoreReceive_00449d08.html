<!-- 
EMBA - EMBEDDED LINUX ANALYZER

Copyright 2020-2023 Siemens AG
Copyright 2020-2024 Siemens Energy AG

EMBA comes with ABSOLUTELY NO WARRANTY. This is free software, and you are
welcome to redistribute it under the terms of the GNU General Public License.
See LICENSE file for usage of this software.

EMBA is licensed under GPLv3

Author(s) and contributors from the EMBA project are listed here: https://github.com/e-m-b-a/emba/blob/master/CONTRIBUTORS.md
-->

<!-- Used icons: https://github.com/CoreyGinnivan/system-uicons -->
 
<!DOCTYPE html>
<html lang="en">
<head>
  <title>EMBA firmware report</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="./../../style/style.css" type="text/css">
  <link rel="icon" type="image/png" href="./../../style/favicon.png">
</head>
<body>

<div id="sidenav" class="side">
  <div id="logo">
    <a class="inherit" href="./../../index.html"><img class="inherit" id="logoImage" src="./../../style/emba.svg" alt="logo"></a>
  </div>
  <div id="nav">
      <a id="embark" class="hidden" href="{{ embarkBackUrl }}">&laquo; Back to EMBArk</a> <!-- nosem -->
      <a class="backButton" href="./../../index.html">&laquo; Back to main</a>
<a class="modul" href="./../semgrep_mDNSClientPosix.html" title="./../semgrep_mDNSClientPosix.html" >&laquo; Back to semgrep_mDNSClientPosix</a>
      <!-- navigation start -->
      <!-- navigation end -->
      <input id="expand" class="expand_njs hidden" type="button" value="More results:" onclick="this.value=this.value=='+ Show more results'?'- Hide more results':'+ Show more results';">
      <div class="expand_area">
        <!-- etc start -->
        <!-- etc end -->
      </div>
  </div>
  <a href="TIMELINK"><div id="buttonTimeInvisible" class="rectButton"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="white" stroke-linecap="round" stroke-linejoin="round" transform="matrix(-1 0 0 1 19 2)"><circle cx="8.5" cy="8.5" r="8"/><path d="M8.5 5.5v4H5"/></g></svg></div></a>
  <div id="buttonSizer" class="rectButton buttonClose" onclick="buttonNav()"></div>
</div>
<div id="main" class="main">
  <!-- content start -->
<br />
<pre>void mDNSCoreReceive(int param_1,ushort *param_2,uint param_3,int *param_4,undefined4 param_5,</pre>
<pre>                    int *param_6,undefined4 param_7,int *param_8)</pre>
<br />
<pre>{</pre>
<pre>  short sVar1;</pre>
<pre>  bool bVar2;</pre>
<pre>  int iVar3;</pre>
<pre>  char *pcVar4;</pre>
<pre>  byte bVar8;</pre>
<pre>  void *pvVar5;</pre>
<pre>  undefined2 uVar7;</pre>
<pre>  byte *pbVar6;</pre>
<pre>  ushort *puVar9;</pre>
<pre>  int iVar10;</pre>
<pre>  int iVar11;</pre>
<pre>  char *pcVar12;</pre>
<pre>  byte *pbVar13;</pre>
<pre>  undefined *puVar14;</pre>
<pre>  uint uVar15;</pre>
<pre>  undefined *puVar16;</pre>
<pre>  uint uVar17;</pre>
<pre>  undefined *puVar18;</pre>
<pre>  ushort *puVar19;</pre>
<pre>  undefined4 uVar20;</pre>
<pre>  short *psVar21;</pre>
<pre>  undefined4 *puVar22;</pre>
<pre>  uint uVar23;</pre>
<pre>  uint uVar24;</pre>
<pre>  size_t __n;</pre>
<pre>  undefined4 uVar25;</pre>
<pre>  code *pcVar26;</pre>
<pre>  int *piVar27;</pre>
<pre>  short *psVar28;</pre>
<pre>  int *in_stack_fffffb50;</pre>
<pre>  uint in_stack_fffffb54;</pre>
<pre>  int *in_stack_fffffb58;</pre>
<pre>  uint in_stack_fffffb5c;</pre>
<pre>  undefined uStack_478;</pre>
<pre>  char local_477;</pre>
<pre>  int local_476;</pre>
<pre>  undefined auStack_470 [6];</pre>
<pre>  undefined auStack_46a [6];</pre>
<pre>  undefined auStack_464 [128];</pre>
<pre>  undefined auStack_3e4 [4];</pre>
<pre>  undefined auStack_3e0 [4];</pre>
<pre>  undefined2 local_3dc;</pre>
<pre>  undefined4 local_3d8;</pre>
<pre>  undefined2 local_3d4;</pre>
<pre>  undefined2 local_3d2;</pre>
<pre>  int local_3c0;</pre>
<pre>  uint local_60;</pre>
<pre>  uint local_5c;</pre>
<pre>  undefined4 local_58;</pre>
<pre>  int local_54;</pre>
<pre>  int local_50;</pre>
<pre>  undefined *local_4c;</pre>
<pre>  uint local_48;</pre>
<pre>  int *local_44;</pre>
<pre>  int local_40;</pre>
<pre>  int local_3c;</pre>
<pre>  char *local_38;</pre>
<pre>  uint local_34;</pre>
<pre>  uint local_30;</pre>
<pre>  ushort *local_2c;</pre>
<pre>  </pre>
<pre>  uVar23 = (uint)param_5._0_2_;</pre>
<pre>  local_5c = (uint)(param_6 == (int *)0x1);</pre>
<pre>  uVar24 = (uint)param_7._0_2_;</pre>
<pre>  iVar3 = mDNSSameAddress(param_4,param_1 + 0x2198);</pre>
<pre>  if (local_5c != 0) {</pre>
<pre>    param_6 = (int *)0x0;</pre>
<pre>  }</pre>
<pre>  if ((iVar3 != 0) &amp;&amp; (uVar23 == 0x14e7)) {</pre>
<pre>    mDNS_Lock_(param_1,"mDNSCoreReceive");</pre>
<pre>    uDNS_ReceiveNATPacket(param_1,param_8,param_2,param_3 - (int)param_2 &amp; 0xffff);</pre>
<pre>    pcVar26 = mDNS_Unlock_;</pre>
<pre>    pcVar12 = "mDNSCoreReceive";</pre>
<pre>    goto LAB_0044b574;</pre>
<pre>  }</pre>
<pre>  local_60 = param_3 - (int)param_2;</pre>
<pre>  if (local_60 &lt; 0xc) {</pre>
<pre>    LogMsgWithLevel(0,"DNS Message from %#a:%d to %#a:%d length %d too short",param_4,uVar23,param_6</pre>
<pre>                    ,uVar24,local_60);</pre>
<pre>    return;</pre>
<pre>  }</pre>
<pre>  bVar8 = *(byte *)(param_2 + 1);</pre>
<pre>  *(char *)((int)param_2 + 5) = (char)param_2[2];</pre>
<pre>  *(char *)(param_2 + 2) = (char)(param_2[2] &gt;&gt; 8);</pre>
<pre>  *(char *)((int)param_2 + 7) = (char)param_2[3];</pre>
<pre>  *(char *)(param_2 + 3) = (char)(param_2[3] &gt;&gt; 8);</pre>
<pre>  *(char *)((int)param_2 + 9) = (char)param_2[4];</pre>
<pre>  *(char *)(param_2 + 4) = (char)(param_2[4] &gt;&gt; 8);</pre>
<pre>  *(char *)((int)param_2 + 0xb) = (char)param_2[5];</pre>
<pre>  *(char *)(param_2 + 5) = (char)(param_2[5] &gt;&gt; 8);</pre>
<pre>  if (param_1 == 0) {</pre>
<pre>    param_1 = 0;</pre>
<pre>    pcVar26 = LogMsgWithLevel;</pre>
<pre>    pcVar12 = "mDNSCoreReceive ERROR m is NULL";</pre>
<pre>    goto LAB_0044b574;</pre>
<pre>  }</pre>
<pre>  if (param_4 != (int *)0x0) {</pre>
<pre>    if (*param_4 == 4) {</pre>
<pre>      bVar2 = 0xfffffffd &lt; param_4[1] - 1U;</pre>
<pre>    }</pre>
<pre>    else {</pre>
<pre>      bVar2 = true;</pre>
<pre>      if (*param_4 == 6) {</pre>
<pre>        if ((((param_4[2] == 0) &amp;&amp; (param_4[1] == 0)) &amp;&amp; (param_4[3] == 0)) &amp;&amp; (param_4[4] == 0)) {</pre>
<pre>          bVar2 = true;</pre>
<pre>        }</pre>
<pre>        else {</pre>
<pre>          bVar2 = (param_4[2] &amp; param_4[1] &amp; param_4[3] &amp; param_4[4]) == 0xffffffff;</pre>
<pre>        }</pre>
<pre>      }</pre>
<pre>    }</pre>
<pre>    if (bVar2) {</pre>
<pre>      return;</pre>
<pre>    }</pre>
<pre>  }</pre>
<pre>  mDNS_Lock_(param_1,"mDNSCoreReceive");</pre>
<pre>  *(int *)(param_1 + 0x26c) = *(int *)(param_1 + 0x26c) + 1;</pre>
<pre>  if (*param_2 == 0) {</pre>
<pre>    *(int *)(param_1 + 0x270) = *(int *)(param_1 + 0x270) + 1;</pre>
<pre>  }</pre>
<pre>  pcVar12 = (char *)(bVar8 &amp; 0xf8);</pre>
<pre>  piVar27 = param_8;</pre>
<pre>  if (param_6 == (int *)0x0) {</pre>
<pre>LAB_0044a01c:</pre>
<pre>    if (*param_2 != 0) {</pre>
<pre>      piVar27 = (int *)0x0;</pre>
<pre>      local_38 = pcVar12;</pre>
<pre>      if (mDNS_PacketLoggingEnabled != 0) {</pre>
<pre>        if (local_5c == 0) {</pre>
<pre>          if (param_6 == (int *)0x0) {</pre>
<pre>            puVar14 = &amp;DAT_0044d19c;</pre>
<pre>          }</pre>
<pre>          else {</pre>
<pre>            puVar14 = &amp;DAT_0044d194;</pre>
<pre>          }</pre>
<pre>        }</pre>
<pre>        else {</pre>
<pre>          puVar14 = &amp;DAT_00450d50;</pre>
<pre>        }</pre>
<pre>        in_stack_fffffb54 = in_stack_fffffb54 &amp; 0xffff | (uint)param_5._0_2_ &lt;&lt; 0x10;</pre>
<pre>        in_stack_fffffb5c = in_stack_fffffb5c &amp; 0xffff | (uint)param_7._0_2_ &lt;&lt; 0x10;</pre>
<pre>        in_stack_fffffb50 = param_4;</pre>
<pre>        in_stack_fffffb58 = param_6;</pre>
<pre>        DumpPacket(param_1,0,0,puVar14,param_4,in_stack_fffffb54,param_6,in_stack_fffffb5c,param_2,</pre>
<pre>                   param_3);</pre>
<pre>      }</pre>
<pre>      in_stack_fffffb50 = (int *)((uint)in_stack_fffffb50 &amp; 0xffff);</pre>
<pre>      uDNS_ReceiveMsg(param_1,param_2,param_3,param_4);</pre>
<pre>      pcVar12 = local_38;</pre>
<pre>    }</pre>
<pre>  }</pre>
<pre>  else if (*param_6 == 4) {</pre>
<pre>    iVar10 = param_6[1];</pre>
<pre>    iVar3 = -0x1fffff05;</pre>
<pre>LAB_0044a000:</pre>
<pre>    if (iVar10 != iVar3) goto LAB_0044a00c;</pre>
<pre>  }</pre>
<pre>  else {</pre>
<pre>    if (((*param_6 == 6) &amp;&amp; (param_6[1] == -0xfe0000)) &amp;&amp; ((param_6[2] == 0 &amp;&amp; (param_6[3] == 0))))</pre>
<pre>    {</pre>
<pre>      iVar3 = 0xfb;</pre>
<pre>      iVar10 = param_6[4];</pre>
<pre>      goto LAB_0044a000;</pre>
<pre>    }</pre>
<pre>LAB_0044a00c:</pre>
<pre>    if ((pcVar12 == (char *)0x80) || (pcVar12 == (char *)0xa8)) goto LAB_0044a01c;</pre>
<pre>  }</pre>
<pre>  if (pcVar12 == (char *)0x0) {</pre>
<pre>    if (((param_4 == (int *)0x0) || (param_6 == (int *)0x0)) ||</pre>
<pre>       (iVar3 = mDNSAddrIsDNSMulticast(param_6), iVar3 != 0)) {</pre>
<pre>LAB_0044a12c:</pre>
<pre>      local_60 = 0;</pre>
<pre>    }</pre>
<pre>    else {</pre>
<pre>      local_60 = 1;</pre>
<pre>      iVar3 = FUN_00426100(param_1,piVar27,param_4);</pre>
<pre>      if (iVar3 == 0) goto LAB_0044a12c;</pre>
<pre>    }</pre>
<pre>    if (((piVar27 == (int *)0x0) &amp;&amp; (param_6 != (int *)0x0)) &amp;&amp;</pre>
<pre>       (iVar3 = mDNSAddrIsDNSMulticast(param_6), iVar3 != 0)) {</pre>
<pre>      if (param_2[2] == 1) {</pre>
<pre>        puVar14 = &amp;DAT_0045b344;</pre>
<pre>      }</pre>
<pre>      else {</pre>
<pre>        puVar14 = &amp;UNK_0045b348;</pre>
<pre>      }</pre>
<pre>      if (param_2[3] == 1) {</pre>
<pre>        puVar18 = &amp;DAT_0045b344;</pre>
<pre>      }</pre>
<pre>      else {</pre>
<pre>        puVar18 = &amp;UNK_0045b348;</pre>
<pre>      }</pre>
<pre>      if (param_2[4] == 1) {</pre>
<pre>        puVar16 = &amp;DAT_0045b34c;</pre>
<pre>      }</pre>
<pre>      else {</pre>
<pre>        puVar16 = &amp;UNK_0045b354;</pre>
<pre>      }</pre>
<pre>      if (param_2[5] == 1) {</pre>
<pre>        pcVar12 = " ";</pre>
<pre>      }</pre>
<pre>      else {</pre>
<pre>        pcVar12 = "s";</pre>
<pre>      }</pre>
<pre>      LogMsgWithLevel(0,</pre>
<pre>                      "Ignoring Query from %#-15a:%-5d to %#-15a:%-5d on 0x%p with %2d Question%s %2d Answer%s %2d Authorit%s %2d Additional%s %d bytes (Multicast, but no InterfaceID)"</pre>
<pre>                      ,param_4,(uint)(param_5._0_2_ &gt;&gt; 8) &lt;&lt; 8 | uVar23 &amp; 0xff,param_6,</pre>
<pre>                      (uint)(param_7._0_2_ &gt;&gt; 8) &lt;&lt; 8 | uVar24 &amp; 0xff,0,param_2[2],puVar14,</pre>
<pre>                      param_2[3],puVar18,param_2[4],puVar16,param_2[5],pcVar12,</pre>
<pre>                      param_3 - (int)(param_2 + 6));</pre>
<pre>    }</pre>
<pre>    else {</pre>
<pre>      uVar23 = mDNSAddrIsDNSMulticast(param_6);</pre>
<pre>      iVar3 = FUN_0043cd50(param_1,param_2,param_3,param_4,piVar27,param_5._0_2_ != 0x14e9,uVar23,</pre>
<pre>                           local_60,param_1 + 0x5cb0);</pre>
<pre>      if (iVar3 != 0) {</pre>
<pre>        mDNSSendDNSMessage(param_1,param_1 + 0x5cb0,iVar3,piVar27,0,param_4,</pre>
<pre>                           uVar23 &amp; 0xffff | (uint)param_5._0_2_ &lt;&lt; 0x10,0,0,0);</pre>
<pre>      }</pre>
<pre>    }</pre>
<pre>  }</pre>
<pre>  else if (pcVar12 == (char *)0x80) {</pre>
<pre>    FUN_00442f38(param_1,param_2,param_3,param_4,</pre>
<pre>                 (uint)in_stack_fffffb50 &amp; 0xffff | (uint)param_5._0_2_ &lt;&lt; 0x10,param_6,</pre>
<pre>                 (uint)in_stack_fffffb58 &amp; 0xffff | (uint)param_7._0_2_ &lt;&lt; 0x10,piVar27);</pre>
<pre>  }</pre>
<pre>  else if (pcVar12 == (char *)0x28) {</pre>
<pre><span class="green"><span class="green">    memcpy(&amp;uStack_478,zeroOwner,0x14)</span></span></span></pre>
<pre>    if (mDNS_LoggingEnabled != 0) {</pre>
<pre>      in_stack_fffffb5c = (uint)param_2[2];</pre>
<pre>      if (in_stack_fffffb5c == 1) {</pre>
<pre>        puVar14 = &amp;DAT_0045b344;</pre>
<pre>      }</pre>
<pre>      else {</pre>
<pre>        puVar14 = &amp;UNK_0045b348;</pre>
<pre>      }</pre>
<pre>      if (param_2[3] == 1) {</pre>
<pre>        puVar18 = &amp;DAT_0045b344;</pre>
<pre>      }</pre>
<pre>      else {</pre>
<pre>        puVar18 = &amp;UNK_0045b348;</pre>
<pre>      }</pre>
<pre>      if (param_2[4] == 1) {</pre>
<pre>        puVar16 = &amp;DAT_0045b34c;</pre>
<pre>      }</pre>
<pre>      else {</pre>
<pre>        puVar16 = &amp;UNK_0045b354;</pre>
<pre>      }</pre>
<pre>      if (param_2[5] == 1) {</pre>
<pre>        pcVar12 = " ";</pre>
<pre>      }</pre>
<pre>      else {</pre>
<pre>        pcVar12 = "s";</pre>
<pre>      }</pre>
<pre>      in_stack_fffffb54 = (uint)(param_7._0_2_ &gt;&gt; 8) &lt;&lt; 8 | uVar24 &amp; 0xff;</pre>
<pre>      in_stack_fffffb58 = param_8;</pre>
<pre>      LogMsgWithLevel(2,</pre>
<pre>                      "Received Update from %#-15a:%-5d to %#-15a:%-5d on 0x%p with %2d Question%s %2d Answer%s %2d Authorit%s %2d Additional%s %d bytes"</pre>
<pre>                      ,param_4,(uint)(param_5._0_2_ &gt;&gt; 8) &lt;&lt; 8 | uVar23 &amp; 0xff,param_6,</pre>
<pre>                      in_stack_fffffb54,param_8,in_stack_fffffb5c,puVar14,param_2[3],puVar18,</pre>
<pre>                      param_2[4],puVar16,param_2[5],pcVar12,param_3 - (int)(param_2 + 6));</pre>
<pre>    }</pre>
<pre>    if (((param_8 != (int *)0x0) &amp;&amp; (*(ushort **)(param_1 + 0x2aa8) != (ushort *)0x0)) &amp;&amp;</pre>
<pre>       (uVar24 == **(ushort **)(param_1 + 0x2aa8))) {</pre>
<pre>      if (mDNS_PacketLoggingEnabled != 0) {</pre>
<pre>        DumpPacket(param_1,0,0,&amp;DAT_0044d194,param_4,</pre>
<pre>                   in_stack_fffffb54 &amp; 0xffff | (uint)param_5._0_2_ &lt;&lt; 0x10,param_6,</pre>
<pre>                   in_stack_fffffb5c &amp; 0xffff | (uint)param_7._0_2_ &lt;&lt; 0x10,param_2,param_3);</pre>
<pre>        in_stack_fffffb58 = param_6;</pre>
<pre>      }</pre>
<pre>      uVar24 = 0;</pre>
<pre>      iVar3 = LocateOptRR(param_2,param_3,0x14);</pre>
<pre>      if (iVar3 != 0) {</pre>
<pre>        in_stack_fffffb58 = (int *)(param_1 + 0x7fa8);</pre>
<pre>        iVar3 = GetLargeResourceRecord(param_1,param_2,iVar3,param_3,0,0x80,in_stack_fffffb58);</pre>
<pre>        if (((iVar3 == 0) || (*(char *)(param_1 + 0x7fac) == -0x10)) ||</pre>
<pre>           (uVar17 = 2, *(short *)(param_1 + 0x7fae) != 0x29)) {</pre>
<pre>          uVar24 = 0;</pre>
<pre>          *(undefined *)(param_1 + 0x7fac) = 0;</pre>
<pre>        }</pre>
<pre>        else {</pre>
<pre>          uVar15 = 4;</pre>
<pre>          puVar19 = (ushort *)(*(int *)(param_1 + 0x7fcc) + 4);</pre>
<pre>          puVar9 = (ushort *)((int)puVar19 + (uint)*(ushort *)(param_1 + 0x7fb8));</pre>
<pre>          while (puVar19 &lt; puVar9) {</pre>
<pre>            if (*puVar19 == uVar17) {</pre>
<pre>              uVar24 = *(uint *)(puVar19 + 2);</pre>
<pre>              puVar19 = puVar19 + 0xc;</pre>
<pre>            }</pre>
<pre>            else {</pre>
<pre>              if ((*puVar19 == uVar15) &amp;&amp; (*(char *)(puVar19 + 2) == '\0')) {</pre>
<pre>                local_34 = uVar17;</pre>
<pre>                local_30 = uVar15;</pre>
<pre>                local_2c = puVar9;</pre>
<pre><span class="green"><span class="green">                memcpy(&amp;uStack_478,puVar19 + 2,0x14)</span></span></span></pre>
<pre>                puVar9 = local_2c;</pre>
<pre>                uVar15 = local_30;</pre>
<pre>                uVar17 = local_34;</pre>
<pre>              }</pre>
<pre>              puVar19 = puVar19 + 0xc;</pre>
<pre>            }</pre>
<pre>          }</pre>
<pre>          *(undefined *)(param_1 + 0x7fac) = 0;</pre>
<pre>        }</pre>
<pre>      }</pre>
<pre>      iVar3 = param_1 + 0x5cbc;</pre>
<pre>      InitializeDNSMessage(param_1 + 0x5cb0,(uint)*param_2 &lt;&lt; 0x10,0xa8000000);</pre>
<pre>      if ((uVar24 == 0) || (local_476 == 0)) {</pre>
<pre>        if (DAT_0046e814 &lt; 100) {</pre>
<pre>          if (uVar24 == 0) {</pre>
<pre>            pcVar12 = " No lease";</pre>
<pre>          }</pre>
<pre>          else {</pre>
<pre>            pcVar12 = "";</pre>
<pre>          }</pre>
<pre>          if (local_476 == 0) {</pre>
<pre>            pcVar4 = " No owner";</pre>
<pre>          }</pre>
<pre>          else {</pre>
<pre>            pcVar4 = "";</pre>
<pre>          }</pre>
<pre>          DAT_0046e814 = DAT_0046e814 + 1;</pre>
<pre>          LogMsgWithLevel(0,"Refusing sleep proxy registration from %#a:%d:%s%s",param_4,</pre>
<pre>                          (uint)(param_5._0_2_ &gt;&gt; 8) &lt;&lt; 8 | uVar23 &amp; 0xff,pcVar12,pcVar4);</pre>
<pre>        }</pre>
<pre>        bVar8 = *(byte *)(param_1 + 0x5cb3) | 1;</pre>
<pre>LAB_0044a780:</pre>
<pre>        *(byte *)(param_1 + 0x5cb3) = bVar8;</pre>
<pre>      }</pre>
<pre>      else {</pre>
<pre>        if (10000 &lt; (int)((uint)param_2[4] + *(int *)(param_1 + 0x38e0))) {</pre>
<pre>          if (DAT_0046e810 &lt; 100) {</pre>
<pre>            in_stack_fffffb58 = (int *)((uint)param_2[4] + *(int *)(param_1 + 0x38e0));</pre>
<pre>            DAT_0046e810 = DAT_0046e810 + 1;</pre>
<pre>            LogMsgWithLevel(0,</pre>
<pre>                            "Refusing sleep proxy registration from %#a:%d: Too many records %d + %d = %d &gt; %d"</pre>
<pre>                            ,param_4,uVar23,*(int *)(param_1 + 0x38e0),(uint)param_2[4],</pre>
<pre>                            in_stack_fffffb58,10000);</pre>
<pre>          }</pre>
<pre>          bVar8 = *(byte *)(param_1 + 0x5cb3) | 5;</pre>
<pre>          goto LAB_0044a780;</pre>
<pre>        }</pre>
<pre>        if (mDNS_LoggingEnabled != 0) {</pre>
<pre>          LogMsgWithLevel(2,"Received Update for H-MAC %.6a I-MAC %.6a Password %.6a seq %d",</pre>
<pre>                          &amp;local_476,auStack_470,auStack_46a,(int)local_477);</pre>
<pre>        }</pre>
<pre>        local_44 = (int *)(param_1 + 0x7fa8);</pre>
<pre>        if (mDNSPlatformOneSecond == 0) {</pre>
<pre>          trap(0x1c00);</pre>
<pre>        }</pre>
<pre>        local_3c = param_1 + 0x2f;</pre>
<pre>        local_40 = param_1 + 0x7fac;</pre>
<pre>        local_50 = 0;</pre>
<pre>        uVar17 = 0x15180;</pre>
<pre>        if (0x40000000 / mDNSPlatformOneSecond &lt; 0x15181) {</pre>
<pre>          uVar17 = 0x40000000 / mDNSPlatformOneSecond;</pre>
<pre>        }</pre>
<pre>        local_48 = uVar24;</pre>
<pre>        if (uVar17 &lt;= uVar24) {</pre>
<pre>          local_48 = uVar17;</pre>
<pre>        }</pre>
<pre>        local_4c = &amp;uStack_478;</pre>
<pre>        local_60 = LocateAuthorities(param_2,param_3);</pre>
<pre>        FUN_0043e188(param_1,&amp;uStack_478,*(undefined4 *)(param_1 + 0x2164),param_8);</pre>
<pre>        FUN_0043e188(param_1,&amp;uStack_478,*(undefined4 *)(param_1 + 0x2160),param_8);</pre>
<pre>LAB_0044af2c:</pre>
<pre>        if (((local_50 &lt; (int)(uint)param_2[4]) &amp;&amp; (local_60 != 0)) &amp;&amp; (local_60 &lt; param_3)) {</pre>
<pre>          in_stack_fffffb58 = local_44;</pre>
<pre>          local_60 = GetLargeResourceRecord(param_1,param_2,local_60,param_3,param_8,0xa0,local_44);</pre>
<pre>          if ((local_60 == 0) || (*(char *)(param_1 + 0x7fac) == -0x10)) goto LAB_0044af1c;</pre>
<pre><span class="green">          sVar1 = *(short *)(param_1 + 0x7fae)</span></span></pre>
<pre><span class="green">          __n = 0x200</span></span></pre>
<pre><span class="green"><span class="green">          if ((sVar1 != 0x11) &amp;&amp; ((__n = 0x202, sVar1 != 0x1a &amp;&amp; (__n = 0x214, sVar1 != 6)))) {</span></span></pre>
<pre><span class="green">            __n = (size_t)*(ushort *)(param_1 + 0x7fb8)</span></span></pre>
<pre>          }</pre>
<pre>          pvVar5 = mDNSPlatformMemAllocate(__n + 0x27c);</pre>
<pre>          if (pvVar5 != (void *)0x0) {</pre>
<pre>            *(ushort *)(param_1 + 0x7fb0) = *(ushort *)(param_1 + 0x7fb0) &amp; 0x7fff;</pre>
<pre>            local_58 = 8;</pre>
<pre>            if ((*(byte *)(param_1 + 0x7fac) &amp; 0x10) != 0) {</pre>
<pre>              local_58 = 2;</pre>
<pre>            }</pre>
<pre>            if (*(short *)(param_1 + 0x7fae) == 10) {</pre>
<pre>              uVar24 = (uint)**(byte **)(param_1 + 0x7fc8);</pre>
<pre>              iVar10 = uVar24 + 1;</pre>
<pre>              if (uVar24 == 0) {</pre>
<pre>                iVar10 = 0;</pre>
<pre>              }</pre>
<pre>              iVar10 = SameDomainLabel(*(byte **)(param_1 + 0x7fc8) + iVar10,"\n_keepalive");</pre>
<pre>              if (iVar10 == 0) goto LAB_0044a96c;</pre>
<pre>            }</pre>
<pre>            else {</pre>
<pre>LAB_0044a96c:</pre>
<pre>              FUN_0043e3a4(param_1,local_4c,*(undefined4 *)(param_1 + 0x2164));</pre>
<pre>              FUN_0043e3a4(param_1,local_4c,*(undefined4 *)(param_1 + 0x2160));</pre>
<pre>            }</pre>
<pre>            in_stack_fffffb58 = (int *)0x0;</pre>
<pre>            mDNS_SetupResourceRecord</pre>
<pre>                      (pvVar5,0,param_8,*(undefined2 *)(param_1 + 0x7fae),</pre>
<pre>                       *(undefined4 *)(param_1 + 0x7fb4),local_58,0,FUN_0043c28c,pvVar5);</pre>
<pre>            uVar24 = DomainNameLengthLimit</pre>
<pre>                               (*(int *)(param_1 + 0x7fc8),*(int *)(param_1 + 0x7fc8) + 0x100);</pre>
<pre>            if (uVar24 &lt; 0x101) {</pre>
<pre>              mDNSPlatformMemCopy((void *)((int)pvVar5 + 0x178),*(void **)(param_1 + 0x7fc8),uVar24)</pre>
<pre>              ;</pre>
<pre>            }</pre>
<pre>            else {</pre>
<pre>              *(undefined *)((int)pvVar5 + 0x178) = 0;</pre>
<pre>            }</pre>
<pre>            uVar7 = GetRDLength(local_40,0);</pre>
<pre>            *(undefined2 *)((int)pvVar5 + 0x10) = uVar7;</pre>
<pre>            **(undefined2 **)((int)pvVar5 + 0x24) = (short)__n;</pre>
<pre>            mDNSPlatformMemCopy((void *)(*(int *)((int)pvVar5 + 0x24) + 4),</pre>
<pre>                                (void *)(*(int *)(param_1 + 0x7fcc) + 4),__n);</pre>
<pre>            *(undefined *)((int)pvVar5 + 0x4a) = 1;</pre>
<pre><span class="green"><span class="green">            memcpy((void *)((int)pvVar5 + 0x4c),local_4c,0x14)</span></span></span></pre>
<pre>            if (*(short *)(param_1 + 0x7fae) == 0xc) {</pre>
<pre>              uVar25 = *(undefined4 *)(param_1 + 0x7fc8);</pre>
<pre>              iVar10 = CountLabels(uVar25);</pre>
<pre>              if (-1 &lt; iVar10 + -2) {</pre>
<pre>                uVar25 = SkipLeadingLabels(uVar25);</pre>
<pre>                iVar10 = SameDomainName(uVar25,&amp;DAT_004543a4);</pre>
<pre>                if (iVar10 == 0) {</pre>
<pre>                  iVar10 = SameDomainName(uVar25,&amp;DAT_0045d038);</pre>
<pre>                  if (iVar10 != 0) {</pre>
<pre>                    local_38 = *(char **)(param_1 + 0x7fc8);</pre>
<pre>                    iVar10 = CountLabels(local_38);</pre>
<pre>                    if (-1 &lt; iVar10 + -0x22) {</pre>
<pre>                      pcVar12 = (char *)SkipLeadingLabels(local_38);</pre>
<pre>                      iVar10 = 0x10;</pre>
<pre>LAB_0044ad64:</pre>
<pre>                      if (*pcVar12 == '\x01') {</pre>
<pre>                        uVar24 = (uint)(byte)pcVar12[1];</pre>
<pre>                        uVar17 = uVar24 - 0x30;</pre>
<pre>                        if (((9 &lt; (uVar17 &amp; 0xff)) &amp;&amp;</pre>
<pre>                            (uVar17 = uVar24 - 0x37, 5 &lt; (uVar24 - 0x41 &amp; 0xff))) &amp;&amp;</pre>
<pre>                           (uVar17 = uVar24 - 0x57, 5 &lt; (uVar24 - 0x61 &amp; 0xff))) {</pre>
<pre>                          uVar17 = 0xffffffff;</pre>
<pre>                        }</pre>
<pre>                        if (pcVar12[2] == '\x01') {</pre>
<pre>                          uVar24 = (uint)(byte)pcVar12[3];</pre>
<pre>                          uVar15 = uVar24 - 0x30;</pre>
<pre>                          if (((9 &lt; (uVar15 &amp; 0xff)) &amp;&amp;</pre>
<pre>                              (uVar15 = uVar24 - 0x37, 5 &lt; (uVar24 - 0x41 &amp; 0xff))) &amp;&amp;</pre>
<pre>                             (uVar15 = uVar24 - 0x57, 5 &lt; (uVar24 - 0x61 &amp; 0xff))) {</pre>
<pre>                            uVar15 = 0xffffffff;</pre>
<pre>                          }</pre>
<pre>                          if ((-1 &lt; (int)uVar17) &amp;&amp; (-1 &lt; (int)uVar15)) {</pre>
<pre>                            *(byte *)((int)pvVar5 + iVar10 + 99) =</pre>
<pre>                                 (byte)(uVar15 &lt;&lt; 4) | (byte)uVar17;</pre>
<pre>                            if (iVar10 + -1 != 0) goto code_r0x0044ae28;</pre>
<pre>                            uVar25 = 6;</pre>
<pre>LAB_0044ae34:</pre>
<pre>                            *(undefined4 *)((int)pvVar5 + 0x60) = uVar25;</pre>
<pre>                          }</pre>
<pre>                        }</pre>
<pre>                      }</pre>
<pre>                      goto LAB_0044ae38;</pre>
<pre>                    }</pre>
<pre>                    pcVar4 = "GetIPFromName: Need 34 labels in IPv6 reverse mapping name %##s";</pre>
<pre>                    pcVar12 = local_38;</pre>
<pre>LAB_0044ad38:</pre>
<pre>                    LogMsgWithLevel(0,pcVar4,pcVar12);</pre>
<pre>                  }</pre>
<pre>                }</pre>
<pre>                else {</pre>
<pre>                  pcVar12 = *(char **)(param_1 + 0x7fc8);</pre>
<pre>                  iVar10 = CountLabels(pcVar12);</pre>
<pre>                  local_5c = iVar10 - 6;</pre>
<pre>                  if ((int)local_5c &lt; 0) {</pre>
<pre>                    pcVar4 = "GetIPFromName: Need six labels in IPv4 reverse mapping name %##s";</pre>
<pre>                    goto LAB_0044ad38;</pre>
<pre>                  }</pre>
<pre>                  pbVar6 = (byte *)SkipLeadingLabels(pcVar12,iVar10 + -3);</pre>
<pre>                  iVar10 = 0;</pre>
<pre>                  if ((*pbVar6 - 1 &amp; 0xff) &lt; 3) {</pre>
<pre>                    iVar11 = 1;</pre>
<pre>                    do {</pre>
<pre>                      pbVar13 = pbVar6 + iVar11;</pre>
<pre>                      if ((int)(uint)*pbVar6 &lt; iVar11) {</pre>
<pre>                        if (iVar10 &lt; 0x100) {</pre>
<pre>                          *(char *)((int)pvVar5 + 100) = (char)iVar10;</pre>
<pre>                          local_54 = (int)pvVar5 + 100;</pre>
<pre>                          pbVar6 = (byte *)SkipLeadingLabels(pcVar12,local_5c + 2);</pre>
<pre>                          iVar10 = 0;</pre>
<pre>                          if ((*pbVar6 - 1 &amp; 0xff) &lt; 3) {</pre>
<pre>                            iVar11 = 1;</pre>
<pre>                            goto LAB_0044ac04;</pre>
<pre>                          }</pre>
<pre>                        }</pre>
<pre>                        break;</pre>
<pre>                      }</pre>
<pre>                      iVar11 = iVar11 + 1;</pre>
<pre>                      iVar10 = (*pbVar13 - 0x30) + iVar10 * 10;</pre>
<pre>                    } while ((*pbVar13 - 0x30 &amp; 0xff) &lt; 10);</pre>
<pre>                  }</pre>
<pre>                }</pre>
<pre>              }</pre>
<pre>              goto LAB_0044ae38;</pre>
<pre>            }</pre>
<pre>            goto LAB_0044ae6c;</pre>
<pre>          }</pre>
<pre>          *(byte *)(param_1 + 0x5cb3) = *(byte *)(param_1 + 0x5cb3) | 5;</pre>
<pre>        }</pre>
<pre>        if ((*(byte *)(param_1 + 0x5cb3) &amp; 0xf) == 0) {</pre>
<pre>          in_stack_fffffb58 = (int *)0x0;</pre>
<pre>          mDNS_SetupResourceRecord(auStack_3e4,0,0,0x29,0x1194,0x20,0,0,0);</pre>
<pre>          local_3d2 = 0x18;</pre>
<pre>          local_3d4 = 0x18;</pre>
<pre>          local_3dc = 0x5a0;</pre>
<pre>          *(undefined2 *)(local_3c0 + 4) = 2;</pre>
<pre>          *(uint *)(local_3c0 + 8) = local_48;</pre>
<pre>          iVar3 = PutResourceRecordTTLWithLimit</pre>
<pre>                            (param_1 + 0x5cb0,iVar3,param_1 + 0x5cba,auStack_3e0,local_3d8,</pre>
<pre>                             param_1 + 0x7fa8);</pre>
<pre>        }</pre>
<pre>        else {</pre>
<pre>          LogMsgWithLevel(0,"Refusing sleep proxy registration from %#a:%d: Out of memory",param_4,</pre>
<pre>                          uVar23);</pre>
<pre>          FUN_0043cad4(param_1,&amp;uStack_478,*(undefined4 *)(param_1 + 0x2164));</pre>
<pre>          FUN_0043cad4(param_1,&amp;uStack_478,*(undefined4 *)(param_1 + 0x2160));</pre>
<pre>        }</pre>
<pre>      }</pre>
<pre>      if (iVar3 != 0) {</pre>
<pre>        mDNSSendDNSMessage(param_1,param_1 + 0x5cb0,iVar3,param_8,*(undefined4 *)(param_1 + 0x2aa8),</pre>
<pre>                           param_4,(uint)in_stack_fffffb58 &amp; 0xffff | (uint)param_5._0_2_ &lt;&lt; 0x10,0,</pre>
<pre>                           0,0);</pre>
<pre>      }</pre>
<pre>      FUN_0042b424(param_1);</pre>
<pre>    }</pre>
<pre>  }</pre>
<pre>  else if (pcVar12 == (char *)0xa8) {</pre>
<pre>    if (param_8 != (int *)0x0) {</pre>
<pre>      local_2c = (ushort *)0x80;</pre>
<pre>      iVar10 = 0xe10;</pre>
<pre>      iVar3 = LocateOptRR(param_2,param_3,8);</pre>
<pre>      if (iVar3 != 0) {</pre>
<pre>        iVar3 = GetLargeResourceRecord(param_1,param_2,iVar3,param_3,0,local_2c,param_1 + 0x7fa8);</pre>
<pre>        if (((iVar3 == 0) || (*(char *)(param_1 + 0x7fac) == -0x10)) ||</pre>
<pre>           (*(short *)(param_1 + 0x7fae) != 0x29)) {</pre>
<pre>          iVar10 = 0xe10;</pre>
<pre>          *(undefined *)(param_1 + 0x7fac) = 0;</pre>
<pre>        }</pre>
<pre>        else {</pre>
<pre>          pcVar12 = "Sleep Proxy granted lease time %4d seconds, updateid %d, InterfaceID %p";</pre>
<pre>          psVar21 = (short *)(*(int *)(param_1 + 0x7fcc) + 4);</pre>
<pre>          psVar28 = (short *)((int)psVar21 + (uint)*(ushort *)(param_1 + 0x7fb8));</pre>
<pre>          for (; psVar21 &lt; psVar28; psVar21 = psVar21 + 0xc) {</pre>
<pre>            if ((*psVar21 == 2) &amp;&amp; (iVar10 = *(int *)(psVar21 + 2), mDNS_LoggingEnabled != 0)) {</pre>
<pre>              local_38 = pcVar12;</pre>
<pre>              LogMsgWithLevel(2,pcVar12,iVar10,*param_2,param_8);</pre>
<pre>              pcVar12 = local_38;</pre>
<pre>            }</pre>
<pre>          }</pre>
<pre>          *(undefined *)(param_1 + 0x7fac) = 0;</pre>
<pre>        }</pre>
<pre>      }</pre>
<pre>      iVar3 = *(int *)(param_1 + 0x216c);</pre>
<pre>      if (iVar3 != 0) {</pre>
<pre>        uVar25 = GetRRDisplayString_rdb(iVar3 + 4,*(int *)(iVar3 + 0x24) + 4,param_1 + 0x2f);</pre>
<pre>        LogMsgWithLevel(0,"mDNSCoreReceiveUpdateR ERROR m-&gt;CurrentRecord already set %s",uVar25);</pre>
<pre>      }</pre>
<pre>      *(undefined4 *)(param_1 + 0x216c) = *(undefined4 *)(param_1 + 0x2160);</pre>
<pre>      local_60 = param_1 + 0x2f;</pre>
<pre>      while (puVar22 = *(undefined4 **)(param_1 + 0x216c), puVar22 != (undefined4 *)0x0) {</pre>
<pre>        if ((((int *)puVar22[7] == param_8) ||</pre>
<pre>            (((int *)puVar22[7] == (int *)0x0 &amp;&amp;</pre>
<pre>             ((*(char *)((int)puVar22 + 0x4a) != '\0' ||</pre>
<pre>              (iVar3 = IsLocalDomain(puVar22[8]), iVar3 != 0)))))) &amp;&amp;</pre>
<pre>           (*(ushort *)((int)puVar22 + 0xf2) == *param_2)) {</pre>
<pre>          uVar23 = mDNSPlatformInterfaceIndexfromInterfaceID(param_1,param_8,1);</pre>
<pre>          if (uVar23 &lt; 0x40) {</pre>
<pre>            puVar22[(uVar23 &gt;&gt; 5) + 0x3d] = ~(1 &lt;&lt; (uVar23 &amp; 0x1f)) &amp; puVar22[(uVar23 &gt;&gt; 5) + 0x3d];</pre>
<pre>          }</pre>
<pre>          if ((puVar22[0x3e] == 0) &amp;&amp; (puVar22[0x3d] == 0)) {</pre>
<pre>            *(undefined2 *)((int)puVar22 + 0xf2) = 0;</pre>
<pre>          }</pre>
<pre>          iVar3 = iVar10 * mDNSPlatformOneSecond + *(int *)(param_1 + 0x234);</pre>
<pre>          if (iVar3 == 0) {</pre>
<pre>            iVar3 = 1;</pre>
<pre>          }</pre>
<pre>          puVar22[0x3b] = iVar3;</pre>
<pre>          if (mDNS_LoggingEnabled != 0) {</pre>
<pre>            local_30 = puVar22[0x3e];</pre>
<pre>            local_38 = "registered";</pre>
<pre>            if (*(int *)((int)puVar22 + 0x4e) != 0) {</pre>
<pre>              local_38 = "transferred";</pre>
<pre>            }</pre>
<pre>            local_34 = puVar22[0x3d];</pre>
<pre>            local_2c = (ushort *)(uint)*(ushort *)((int)puVar22 + 0xf2);</pre>
<pre>            uVar25 = GetRRDisplayString_rdb(puVar22 + 1,puVar22[9] + 4,local_60);</pre>
<pre>            LogMsgWithLevel(2,"Sleep Proxy %s record %5d 0x%x 0x%x (%d) %s",local_38,iVar10,local_30</pre>
<pre>                            ,local_34,local_2c,uVar25);</pre>
<pre>          }</pre>
<pre>          if (*(int *)((int)puVar22 + 0x4e) != 0) {</pre>
<pre><span class="green"><span class="green">            memcpy((void *)((int)puVar22 + 0x4e),&amp;zeroEthAddr,6)</span></span></span></pre>
<pre>            *(undefined *)(puVar22 + 0x22) = 0;</pre>
<pre>            mDNS_Deregister_internal(param_1,puVar22,0);</pre>
<pre>          }</pre>
<pre>        }</pre>
<pre>        if (*(undefined4 **)(param_1 + 0x216c) == puVar22) {</pre>
<pre>          *(undefined4 *)(param_1 + 0x216c) = *puVar22;</pre>
<pre>        }</pre>
<pre>      }</pre>
<pre>      for (puVar22 = *(undefined4 **)(param_1 + 0x2174); puVar22 != (undefined4 *)0x0;</pre>
<pre>          puVar22 = (undefined4 *)*puVar22) {</pre>
<pre>        if ((int *)puVar22[0x548] == param_8) {</pre>
<pre>          iVar3 = (int)puVar22 + 0x1552;</pre>
<pre>          goto LAB_0044b418;</pre>
<pre>        }</pre>
<pre>      }</pre>
<pre>      iVar3 = 0;</pre>
<pre>LAB_0044b418:</pre>
<pre>      mDNSPlatformMemCopy(auStack_464,param_4,0x14);</pre>
<pre>      mDNSPlatformStoreSPSMACAddr(auStack_464,iVar3);</pre>
<pre>    }</pre>
<pre>    if (*(int *)(param_1 + 0x284) != 0) {</pre>
<pre>      *(undefined4 *)(param_1 + 0x2a4) = *(undefined4 *)(param_1 + 0x234);</pre>
<pre>    }</pre>
<pre>  }</pre>
<pre>  else {</pre>
<pre>    LogMsgWithLevel(0,</pre>
<pre>                    "Unknown DNS packet type %02X%02X from %#-15a:%-5d to %#-15a:%-5d length %d on %p (ignored)"</pre>
<pre>                    ,*(undefined *)(param_2 + 1),*(undefined *)((int)param_2 + 3),param_4,uVar23,</pre>
<pre>                    param_6,uVar24,local_60,param_8);</pre>
<pre>    if (mDNS_LoggingEnabled != 0) {</pre>
<pre>      uVar23 = 0;</pre>
<pre>      while ((int)uVar23 &lt; (int)local_60) {</pre>
<pre>        puVar18 = (undefined *)((int)param_2 + uVar23);</pre>
<pre><span class="green">        iVar3 = mDNS_snprintf(auStack_464,0x80,&amp;DAT_0045d240,uVar23)</span></span></pre>
<pre>        puVar14 = auStack_464 + iVar3;</pre>
<pre>        do {</pre>
<pre>          bVar2 = (int)uVar23 &lt; (int)local_60;</pre>
<pre>          uVar23 = uVar23 + 1;</pre>
<pre>          if (bVar2) {</pre>
<pre><span class="green">            iVar3 = mDNS_snprintf(puVar14,0x80," %02X",*puVar18)</span></span></pre>
<pre>            puVar14 = puVar14 + iVar3;</pre>
<pre>          }</pre>
<pre>          puVar18 = puVar18 + 1;</pre>
<pre>        } while ((uVar23 &amp; 0xf) != 0);</pre>
<pre>        if (mDNS_LoggingEnabled != 0) {</pre>
<pre>          LogMsgWithLevel(3,"%s",auStack_464);</pre>
<pre>        }</pre>
<pre>      }</pre>
<pre>    }</pre>
<pre>  }</pre>
<pre>  pcVar26 = mDNS_Unlock_;</pre>
<pre>  pcVar12 = "mDNSCoreReceive";</pre>
<pre>LAB_0044b574:</pre>
<pre>  (*pcVar26)(param_1,pcVar12);</pre>
<pre>  return;</pre>
<pre>  while( true ) {</pre>
<pre>    iVar11 = iVar11 + 1;</pre>
<pre>    iVar10 = (*pbVar13 - 0x30) + iVar10 * 10;</pre>
<pre>    if (9 &lt; (*pbVar13 - 0x30 &amp; 0xff)) break;</pre>
<pre>LAB_0044ac04:</pre>
<pre>    pbVar13 = pbVar6 + iVar11;</pre>
<pre>    if ((int)(uint)*pbVar6 &lt; iVar11) {</pre>
<pre>      if (iVar10 &lt; 0x100) {</pre>
<pre>        *(char *)(local_54 + 1) = (char)iVar10;</pre>
<pre>        pbVar6 = (byte *)SkipLeadingLabels(pcVar12,local_5c + 1);</pre>
<pre>        iVar10 = 0;</pre>
<pre>        if ((*pbVar6 - 1 &amp; 0xff) &lt; 3) {</pre>
<pre>          iVar11 = 1;</pre>
<pre>          goto LAB_0044ac80;</pre>
<pre>        }</pre>
<pre>      }</pre>
<pre>      break;</pre>
<pre>    }</pre>
<pre>  }</pre>
<pre>  goto LAB_0044ae38;</pre>
<pre>  while( true ) {</pre>
<pre>    iVar11 = iVar11 + 1;</pre>
<pre>    iVar10 = (*pbVar13 - 0x30) + iVar10 * 10;</pre>
<pre>    if (9 &lt; (*pbVar13 - 0x30 &amp; 0xff)) break;</pre>
<pre>LAB_0044ac80:</pre>
<pre>    pbVar13 = pbVar6 + iVar11;</pre>
<pre>    if ((int)(uint)*pbVar6 &lt; iVar11) {</pre>
<pre>      if (iVar10 &lt; 0x100) {</pre>
<pre>        *(char *)(local_54 + 2) = (char)iVar10;</pre>
<pre>        pbVar6 = (byte *)SkipLeadingLabels(pcVar12,local_5c);</pre>
<pre>        iVar10 = 0;</pre>
<pre>        if ((*pbVar6 - 1 &amp; 0xff) &lt; 3) {</pre>
<pre>          iVar11 = 1;</pre>
<pre>          goto LAB_0044acfc;</pre>
<pre>        }</pre>
<pre>      }</pre>
<pre>      break;</pre>
<pre>    }</pre>
<pre>  }</pre>
<pre>  goto LAB_0044ae38;</pre>
<pre>  while( true ) {</pre>
<pre>    iVar11 = iVar11 + 1;</pre>
<pre>    iVar10 = (*pbVar13 - 0x30) + iVar10 * 10;</pre>
<pre>    if (9 &lt; (*pbVar13 - 0x30 &amp; 0xff)) break;</pre>
<pre>LAB_0044acfc:</pre>
<pre>    pbVar13 = pbVar6 + iVar11;</pre>
<pre>    if ((int)(uint)*pbVar6 &lt; iVar11) {</pre>
<pre>      if (iVar10 &lt; 0x100) {</pre>
<pre>        *(char *)(local_54 + 3) = (char)iVar10;</pre>
<pre>        uVar25 = 4;</pre>
<pre>        goto LAB_0044ae34;</pre>
<pre>      }</pre>
<pre>      break;</pre>
<pre>    }</pre>
<pre>  }</pre>
<pre>LAB_0044ae38:</pre>
<pre>  if (*(int *)((int)pvVar5 + 0x60) != 0) {</pre>
<pre>    if ((*(int **)(param_1 + 0x2aa4) != (int *)0x0) &amp;&amp; (*(int **)(param_1 + 0x2aa4) != param_8)) {</pre>
<pre>      mDNSPlatformUpdateProxyList(param_1);</pre>
<pre>    }</pre>
<pre>    *(int **)(param_1 + 0x2aa4) = param_8;</pre>
<pre>  }</pre>
<pre>LAB_0044ae6c:</pre>
<pre>  *(undefined4 *)((int)pvVar5 + 0x74) = *(undefined4 *)(param_1 + 0x234);</pre>
<pre>  iVar10 = local_48 * mDNSPlatformOneSecond + *(int *)(param_1 + 0x234);</pre>
<pre>  *(int *)((int)pvVar5 + 0x78) = iVar10;</pre>
<pre>  if (0 &lt; *(int *)(param_1 + 0x25c) - iVar10) {</pre>
<pre>    *(int *)(param_1 + 0x25c) = iVar10;</pre>
<pre>  }</pre>
<pre>  *(undefined4 *)((int)pvVar5 + 0x80) = 0;</pre>
<pre>  mDNS_Register_internal(param_1,pvVar5);</pre>
<pre>  *(int *)(param_1 + 0x38e0) = *(int *)(param_1 + 0x38e0) + 1;</pre>
<pre>  FUN_0042f54c(param_1);</pre>
<pre>  if (mDNS_LoggingEnabled != 0) {</pre>
<pre>    uVar20 = *(undefined4 *)(param_1 + 0x38e0);</pre>
<pre>    uVar25 = GetRRDisplayString_rdb((int)pvVar5 + 4,*(int *)((int)pvVar5 + 0x24) + 4,local_3c);</pre>
<pre>    LogMsgWithLevel(2,"SPS Registered %4d %X %s",uVar20,local_58,uVar25);</pre>
<pre>  }</pre>
<pre>LAB_0044af1c:</pre>
<pre>  *(undefined *)(param_1 + 0x7fac) = 0;</pre>
<pre>  local_50 = local_50 + 1;</pre>
<pre>  goto LAB_0044af2c;</pre>
<pre>code_r0x0044ae28:</pre>
<pre>  pcVar12 = pcVar12 + 4;</pre>
<pre>  iVar10 = iVar10 + -1;</pre>
<pre>  goto LAB_0044ad64;</pre>
<pre>}</pre>
<br />
  <!-- content end -->
</div>

<a href="https://github.com/e-m-b-a/emba" title="github.com/e-m-b-a/emba" target="_blank">
  <div id="buttonInfo" class="rectButtonVisible">
    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" transform="translate(2 2)"><g stroke="white" stroke-linecap="round" stroke-linejoin="round"><circle cx="8.5" cy="8.5" r="8"/><path d="M8.5 12.5v-4h-1"/><path d="M7.5 12.5h2"/></g><circle cx="8.5" cy="5.5" fill="white" r="1"/></g></svg>
  </div>
</a>
<div id="buttonBack" class="nonClickable rectButtonVisible"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><path d="M9.5 14.5l4-4l-4-4" fill="none" stroke="#444" stroke-linecap="round" stroke-linejoin="round"/></svg></div>
<div id="buttonForward" class="nonClickable rectButtonVisible"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><path d="M11.5 14.5l-4-4l4-4" fill="none" stroke="#444" stroke-linecap="round" stroke-linejoin="round"/></svg></div> 
<div id="buttonDown" class="rectButton" onclick="scrollDown()"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="#fff" stroke-linecap="round" stroke-linejoin="round"><path d="M14.5 6.5l-4 4l-4-4"/><path d="M14.5 10.5l-4 4l-4-4"/></g></svg></div>
<div id="buttonUp" class="rectButton" onclick="scrollUp()"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="#fff" stroke-linecap="round" stroke-linejoin="round"><path d="M6.5 14.5l4-4l4 4"/><path d="M6.5 10.5l4-4l4 4"/></g></svg></div> 

<script>
window.onload = function () {
  var buttons = document.getElementsByClassName("rectButton");
  for (let i=0; i<buttons.length; i++) {
    buttons[i].style.visibility = "visible";
  }
  var buttonDown = document.getElementById("buttonDown");
  buttonDown.classList.add('rectButtonVisible');
  buttonDown.classList.remove('rectButton');

  var buttonUp = document.getElementById("buttonUp");
  buttonUp.classList.add('rectButtonVisible');
  buttonUp.classList.remove('rectButton');
    
  var buttonSizer = document.getElementById("buttonSizer");
  buttonSizer.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="white" stroke-linecap="round" stroke-linejoin="round"><path d="M9.5 16.5v-4.978l-5-.022"/><path d="M18.5 2.5l-7 7"/><path d="M16.5 9.5l-5 .023V4.5"/><path d="M9.5 11.5l-7 7"/></g></svg>';
  if (document.getElementById("buttonTime") !== null) {
    var buttonTime = document.getElementById("buttonTime");
    buttonTime.style.bottom = "50px";
  }
  document.getElementById("expand").value = "+ Show more results";
  document.getElementById("expand").className += " expand";
  var embarkButton = document.getElementById("embark");
  if ( !(embarkButton.href.includes("embarkBackUrl")) ) {
    embarkButton.classList.remove('hidden');
    document.getElementById("logoImage").src = "./../../style/embark.svg";
    document.getElementById("logo").style.background = "#2d2d2d";
  }
}

function openNav() {
  document.getElementById("sidenav").style.width = "250px";
  document.getElementById("main").style.marginLeft = "250px";
  document.getElementById("nav").style.visibility = "visible";
}

function closeNav() {
  document.getElementById("sidenav").style.width = "50px";
  document.getElementById("sidenav").scrollTop = 0;
  document.getElementById("main").style.marginLeft = "50px";
  document.getElementById("nav").style.visibility = "hidden";
}

function scrollDown() {
  window.scrollTo(0,document.body.scrollHeight);
}

function scrollUp() {
  window.scrollTo(0,0);
}

function buttonNav() {
  var button = document.getElementById("buttonSizer");
  if ( button.classList.contains('buttonOpen') ) {
    button.classList.remove('buttonOpen');
    button.classList.add('buttonClose');
    button.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="white" stroke-linecap="round" stroke-linejoin="round"><path d="M9.5 16.5v-4.978l-5-.022"/><path d="M18.5 2.5l-7 7"/><path d="M16.5 9.5l-5 .023V4.5"/><path d="M9.5 11.5l-7 7"/></g></svg>';
    openNav();
  } else if( button.classList.contains('buttonClose') ) {
    button.classList.remove('buttonClose');
    button.classList.add('buttonOpen');
    button.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="white" stroke-linecap="round" stroke-linejoin="round"><path d="M18.5 7.5v-5h-5"/><path d="M18.5 2.5l-6 5.929"/><path d="M7.5 18.5l-5 .023V13.5"/><path d="M8.5 12.5l-6 6"/></g></svg>';
    closeNav();
  };
}

// the following function is currently not used
// it is for future extensions
function overlay_output(link) {
  var rawfile = new XMLHttpRequest();
  rawfile.open('GET', link, false);
  rawfile.overrideMimeType("text");
  rawfile.onreadystatechange = function()
  {
    alert(rawfile.responseText);
    //console.log(rawfile.responseText);
  }
  rawfile.send(null);
}

document.onkeydown = function(e) {
    switch (e.keyCode) {
      case 37:
        document.getElementById("buttonForward").parentNode.click(); 
        break;
      case 39:
        document.getElementById("buttonBack").parentNode.click();       
        break;
    }
};
</script>

</body>
</html>
