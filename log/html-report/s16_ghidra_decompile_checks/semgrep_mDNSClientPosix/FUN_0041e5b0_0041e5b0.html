<!-- 
EMBA - EMBEDDED LINUX ANALYZER

Copyright 2020-2023 Siemens AG
Copyright 2020-2024 Siemens Energy AG

EMBA comes with ABSOLUTELY NO WARRANTY. This is free software, and you are
welcome to redistribute it under the terms of the GNU General Public License.
See LICENSE file for usage of this software.

EMBA is licensed under GPLv3

Author(s) and contributors from the EMBA project are listed here: https://github.com/e-m-b-a/emba/blob/master/CONTRIBUTORS.md
-->

<!-- Used icons: https://github.com/CoreyGinnivan/system-uicons -->
 
<!DOCTYPE html>
<html lang="en">
<head>
  <title>EMBA firmware report</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="./../../style/style.css" type="text/css">
  <link rel="icon" type="image/png" href="./../../style/favicon.png">
</head>
<body>

<div id="sidenav" class="side">
  <div id="logo">
    <a class="inherit" href="./../../index.html"><img class="inherit" id="logoImage" src="./../../style/emba.svg" alt="logo"></a>
  </div>
  <div id="nav">
      <a id="embark" class="hidden" href="{{ embarkBackUrl }}">&laquo; Back to EMBArk</a> <!-- nosem -->
      <a class="backButton" href="./../../index.html">&laquo; Back to main</a>
<a class="modul" href="./../semgrep_mDNSClientPosix.html" title="./../semgrep_mDNSClientPosix.html" >&laquo; Back to semgrep_mDNSClientPosix</a>
      <!-- navigation start -->
      <!-- navigation end -->
      <input id="expand" class="expand_njs hidden" type="button" value="More results:" onclick="this.value=this.value=='+ Show more results'?'- Hide more results':'+ Show more results';">
      <div class="expand_area">
        <!-- etc start -->
        <!-- etc end -->
      </div>
  </div>
  <a href="TIMELINK"><div id="buttonTimeInvisible" class="rectButton"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="white" stroke-linecap="round" stroke-linejoin="round" transform="matrix(-1 0 0 1 19 2)"><circle cx="8.5" cy="8.5" r="8"/><path d="M8.5 5.5v4H5"/></g></svg></div></a>
  <div id="buttonSizer" class="rectButton buttonClose" onclick="buttonNav()"></div>
</div>
<div id="main" class="main">
  <!-- content start -->
<br />
<pre>/* WARNING: Type propagation algorithm not settling */</pre>
<br />
<pre>bool FUN_0041e5b0(int param_1,ushort *param_2,ushort *param_3,int param_4,ushort param_5)</pre>
<br />
<pre>{</pre>
<pre>  ushort uVar1;</pre>
<pre>  ushort uVar2;</pre>
<pre>  uint uVar3;</pre>
<pre>  undefined *puVar4;</pre>
<pre>  byte *pbVar5;</pre>
<pre>  bool bVar6;</pre>
<pre>  uint uVar7;</pre>
<pre>  undefined *puVar8;</pre>
<pre>  char *pcVar9;</pre>
<pre>  ushort *puVar10;</pre>
<pre>  ushort *puVar11;</pre>
<pre>  int iVar12;</pre>
<pre>  byte *pbVar13;</pre>
<pre>  undefined *puVar14;</pre>
<pre>  byte *pbVar15;</pre>
<pre>  size_t __n;</pre>
<pre>  ushort local_134 [128];</pre>
<pre>  ushort auStack_34 [2];</pre>
<pre>  undefined *local_30;</pre>
<pre>  ushort *local_2c;</pre>
<pre>  </pre>
<pre>  uVar3 = (uint)*(ushort *)(param_4 + 6);</pre>
<pre>  pbVar13 = (byte *)(param_4 + 0x74);</pre>
<pre>  pbVar15 = (byte *)(uint)param_5;</pre>
<pre>  if (uVar3 == 0x15) goto LAB_0041eb70;</pre>
<pre>  if (0x15 &lt; uVar3) {</pre>
<pre>    if (uVar3 == 0x29) {</pre>
<pre>      *(undefined2 *)(param_4 + 0x10) = 0;</pre>
<pre>      local_30 = (undefined *)(*(int *)(param_4 + 0x24) + 0x2004);</pre>
<pre>      puVar14 = (undefined *)(*(int *)(param_4 + 0x24) + 4);</pre>
<pre>      while (param_2 &lt; param_3) {</pre>
<pre>        puVar8 = puVar14 + 0x18;</pre>
<pre>        puVar10 = param_2 + 2;</pre>
<pre>        if (local_30 &lt;= puVar8) break;</pre>
<pre>        if (param_3 &lt; puVar10) {</pre>
<pre>          if (mDNS_LoggingEnabled == 0) goto LAB_004200c8;</pre>
<pre>          pcVar9 = "SetRData: OPT RDATA ptr + 4 &gt; end";</pre>
<pre>          goto LAB_0041f4f4;</pre>
<pre>        }</pre>
<pre>        uVar1 = *param_2;</pre>
<pre>        puVar14[1] = (char)uVar1;</pre>
<pre>        *puVar14 = (char)(uVar1 &gt;&gt; 8);</pre>
<pre>        uVar2 = param_2[1];</pre>
<pre>        uVar3 = (uint)uVar2;</pre>
<pre>        puVar14[2] = (char)(uVar2 &gt;&gt; 8);</pre>
<pre>        puVar14[3] = (char)uVar2;</pre>
<pre>        if (param_3 &lt; (ushort *)((int)puVar10 + uVar3)) {</pre>
<pre>          if (mDNS_LoggingEnabled == 0) goto LAB_004200c8;</pre>
<pre>          pcVar9 = "SetRData: ptr + opt-&gt;optlen &gt; end";</pre>
<pre>          goto LAB_0041f4f4;</pre>
<pre>        }</pre>
<pre>        puVar4 = puVar14;</pre>
<pre>        if (uVar1 == 2) {</pre>
<pre>          if (uVar3 == 4) {</pre>
<pre>            uVar3 = (uint)*(byte *)((int)param_2 + 7) | (uint)*(byte *)puVar10 &lt;&lt; 0x18 |</pre>
<pre>                    (uint)*(byte *)((int)param_2 + 5) &lt;&lt; 0x10 | (uint)*(byte *)(param_2 + 3) &lt;&lt; 8;</pre>
<pre>            *(uint *)(puVar14 + 4) = uVar3;</pre>
<pre>            if (mDNSPlatformOneSecond == 0) {</pre>
<pre>              trap(0x1c00);</pre>
<pre>            }</pre>
<pre>            if (0x70000000 / mDNSPlatformOneSecond &lt; uVar3) {</pre>
<pre>              *(uint *)(puVar14 + 4) = 0x70000000 / mDNSPlatformOneSecond;</pre>
<pre>            }</pre>
<pre>LAB_0041f778:</pre>
<pre>            puVar4 = puVar14 + 0x18;</pre>
<pre>          }</pre>
<pre>        }</pre>
<pre>        else if (uVar1 &lt; 3) {</pre>
<pre>          if ((uVar1 == 1) &amp;&amp; (uVar3 == 0x12)) {</pre>
<pre>            uVar1 = *puVar10;</pre>
<pre>            puVar14[5] = (char)uVar1;</pre>
<pre>            puVar14[4] = (char)(uVar1 &gt;&gt; 8);</pre>
<pre>            uVar1 = param_2[3];</pre>
<pre>            puVar14[7] = (char)uVar1;</pre>
<pre>            puVar14[6] = (char)(uVar1 &gt;&gt; 8);</pre>
<pre>            uVar1 = param_2[4];</pre>
<pre>            puVar14[9] = (char)uVar1;</pre>
<pre>            puVar14[8] = (char)(uVar1 &gt;&gt; 8);</pre>
<pre>            mDNSPlatformMemCopy(puVar14 + 0xc,param_2 + 5,8);</pre>
<pre>            uVar3 = (uint)*(byte *)(param_2 + 9) &lt;&lt; 0x18 |</pre>
<pre>                    (uint)*(byte *)((int)param_2 + 0x13) &lt;&lt; 0x10 |</pre>
<pre>                    (uint)*(byte *)((int)param_2 + 0x15) | (uint)*(byte *)(param_2 + 10) &lt;&lt; 8;</pre>
<pre>            *(uint *)(puVar14 + 0x14) = uVar3;</pre>
<pre>            if (mDNSPlatformOneSecond == 0) {</pre>
<pre>              trap(0x1c00);</pre>
<pre>            }</pre>
<pre>            if (0x70000000 / mDNSPlatformOneSecond &lt; uVar3) {</pre>
<pre>              *(uint *)(puVar14 + 0x14) = 0x70000000 / mDNSPlatformOneSecond;</pre>
<pre>            }</pre>
<pre>            goto LAB_0041f778;</pre>
<pre>          }</pre>
<pre>        }</pre>
<pre>        else if (uVar1 == 4) {</pre>
<pre>          if ((((uVar3 == 8) || (uVar3 == 0xe)) || (uVar3 == 0x12)) || (uVar3 == 0x14)) {</pre>
<pre>            local_2c = param_2 + 3;</pre>
<pre>            puVar14[4] = *(byte *)puVar10;</pre>
<pre>            puVar14[5] = *(byte *)((int)param_2 + 5);</pre>
<pre>            mDNSPlatformMemCopy(puVar14 + 6,local_2c,6);</pre>
<pre>            mDNSPlatformMemCopy(puVar14 + 0xc,local_2c,6);</pre>
<pre>            puVar14[0x12] = 0;</pre>
<pre>            puVar14[0x13] = 0;</pre>
<pre>            puVar14[0x14] = 0;</pre>
<pre>            puVar14[0x15] = 0;</pre>
<pre>            puVar14[0x16] = 0;</pre>
<pre>            puVar14[0x17] = 0;</pre>
<pre>            if (0xd &lt; *(ushort *)(puVar14 + 2)) {</pre>
<pre>              mDNSPlatformMemCopy(puVar14 + 0xc,param_2 + 6,6);</pre>
<pre>              if (0xe &lt; *(ushort *)(puVar14 + 2)) {</pre>
<pre>                mDNSPlatformMemCopy(puVar14 + 0x12,param_2 + 9,*(ushort *)(puVar14 + 2) - 0xe);</pre>
<pre>              }</pre>
<pre>            }</pre>
<pre>            goto LAB_0041f778;</pre>
<pre>          }</pre>
<pre>        }</pre>
<pre>        else if (uVar1 == 0xfde9) {</pre>
<pre>          puVar4 = puVar8;</pre>
<pre>          if (uVar3 == 5) {</pre>
<pre>            puVar14[4] = *(byte *)puVar10;</pre>
<pre>            *(uint *)(puVar14 + 8) =</pre>
<pre>                 (uint)*(byte *)((int)param_2 + 5) &lt;&lt; 0x18 | (uint)*(byte *)(param_2 + 3) &lt;&lt; 0x10 |</pre>
<pre>                 (uint)*(byte *)(param_2 + 4) | (uint)*(byte *)((int)param_2 + 7) &lt;&lt; 8;</pre>
<pre>          }</pre>
<pre>          else {</pre>
<pre>            puVar14[4] = 0xff;</pre>
<pre>            *(undefined4 *)(puVar14 + 8) = 0xffffffff;</pre>
<pre>          }</pre>
<pre>        }</pre>
<pre>        param_2 = (ushort *)((int)puVar10 + (uint)*(ushort *)(puVar14 + 2));</pre>
<pre>        puVar14 = puVar4;</pre>
<pre>      }</pre>
<pre>      *(short *)(param_4 + 0x10) = (short)puVar14 - ((short)*(undefined4 *)(param_4 + 0x24) + 4);</pre>
<pre>      if (param_2 == param_3) {</pre>
<pre>        return true;</pre>
<pre>      }</pre>
<pre>      if (mDNS_LoggingEnabled != 0) {</pre>
<pre>        pcVar9 = "SetRData: Malformed OptRdata";</pre>
<pre>        goto LAB_0041f4f4;</pre>
<pre>      }</pre>
<pre>    }</pre>
<pre>    else {</pre>
<pre>      pbVar5 = pbVar15;</pre>
<pre>      if (uVar3 &lt; 0x2a) {</pre>
<pre>        if (uVar3 == 0x1d) goto LAB_004200a4;</pre>
<pre>        if (uVar3 &lt; 0x1e) {</pre>
<pre>          if (uVar3 != 0x1a) {</pre>
<pre>            uVar7 = 0x17;</pre>
<pre>            if (uVar3 == 0x1c) {</pre>
<pre>              if (pbVar15 != (byte *)0x10) {</pre>
<pre>                return false;</pre>
<pre>              }</pre>
<pre>              pbVar15 = (byte *)0x10;</pre>
<pre>              goto LAB_004200b8;</pre>
<pre>            }</pre>
<pre>LAB_0041e71c:</pre>
<pre>            if (uVar3 == uVar7) goto LAB_0041e7b8;</pre>
<pre>            goto LAB_004200a4;</pre>
<pre>          }</pre>
<pre>          if (pbVar15 &lt; (byte *)0x4) {</pre>
<pre>            return false;</pre>
<pre>          }</pre>
<pre>          local_2c = param_2 + 1;</pre>
<pre>          *(ushort *)(param_4 + 0x74) = *param_2;</pre>
<pre>          if (param_1 == 0) {</pre>
<pre>            puVar10 = local_2c;</pre>
<pre>            do {</pre>
<pre>              if (param_2 + 0x81 &lt;= puVar10) {</pre>
<pre>                *(undefined *)(param_4 + 0x76) = 0;</pre>
<pre>                goto LAB_0041eedc;</pre>
<pre>              }</pre>
<pre>              uVar3 = (uint)*(byte *)puVar10;</pre>
<pre>              if (0x3f &lt; uVar3) {</pre>
<pre>                *(undefined *)(param_4 + 0x76) = 0;</pre>
<pre>                goto LAB_0041eedc;</pre>
<pre>              }</pre>
<pre>              puVar10 = (ushort *)((int)puVar10 + uVar3 + 1);</pre>
<pre>            } while (uVar3 != 0);</pre>
<pre>            uVar3 = (uint)((int)puVar10 + (-(int)local_2c - (uVar3 + 1)) + 1) &amp; 0xffff;</pre>
<pre>            if (uVar3 &lt; 0x101) {</pre>
<pre>              mDNSPlatformMemCopy((void *)(param_4 + 0x76),local_2c,uVar3);</pre>
<pre>            }</pre>
<pre>            else {</pre>
<pre>              *(undefined *)(param_4 + 0x76) = 0;</pre>
<pre>            }</pre>
<pre>LAB_0041eedc:</pre>
<pre>            pbVar15 = (byte *)(param_4 + 0x76);</pre>
<pre>            do {</pre>
<pre>              if ((byte *)(param_4 + 0x176) &lt;= pbVar15) {</pre>
<pre>LAB_0041ef20:</pre>
<pre>                uVar3 = 0x101;</pre>
<pre>                goto LAB_0041ef24;</pre>
<pre>              }</pre>
<pre>              uVar3 = (uint)*pbVar15;</pre>
<pre>              if (0x3f &lt; uVar3) goto LAB_0041ef20;</pre>
<pre>              pbVar15 = pbVar15 + uVar3 + 1;</pre>
<pre>            } while (uVar3 != 0);</pre>
<pre>            uVar3 = (uint)(pbVar15 + (-(int)(byte *)(param_4 + 0x76) - (uVar3 + 1)) + 1) &amp; 0xffff;</pre>
<pre>LAB_0041ef24:</pre>
<pre>            local_2c = (ushort *)((int)local_2c + uVar3);</pre>
<pre>          }</pre>
<pre>          else {</pre>
<pre>            local_2c = (ushort *)FUN_0041b774(param_1,local_2c,param_3,param_4 + 0x76);</pre>
<pre>          }</pre>
<pre>          if (local_2c == (ushort *)0x0) {</pre>
<pre>            return false;</pre>
<pre>          }</pre>
<pre>          iVar12 = param_4 + 0x176;</pre>
<pre>          if (param_1 != 0) goto LAB_0041ef3c;</pre>
<pre>          pbVar15 = (byte *)local_2c;</pre>
<pre>          do {</pre>
<pre>            if ((byte *)((int)local_2c + 0x100) &lt;= pbVar15) {</pre>
<pre>              *(undefined *)(param_4 + 0x176) = 0;</pre>
<pre>              goto LAB_0041efd0;</pre>
<pre>            }</pre>
<pre>            uVar3 = (uint)*pbVar15;</pre>
<pre>            if (0x3f &lt; uVar3) {</pre>
<pre>              *(undefined *)(param_4 + 0x176) = 0;</pre>
<pre>              goto LAB_0041efd0;</pre>
<pre>            }</pre>
<pre>            pbVar15 = pbVar15 + uVar3 + 1;</pre>
<pre>          } while (uVar3 != 0);</pre>
<pre>          if (((uint)(pbVar15 + (-(int)local_2c - (uVar3 + 1)) + 1) &amp; 0xffff) &lt; 0x101) {</pre>
<pre>            mDNSPlatformMemCopy((void *)(param_4 + 0x176),local_2c,</pre>
<pre>                                (uint)(pbVar15 + (-(int)local_2c - (uVar3 + 1)) + 1) &amp; 0xffff);</pre>
<pre>          }</pre>
<pre>          else {</pre>
<pre>            *(undefined *)(param_4 + 0x176) = 0;</pre>
<pre>          }</pre>
<pre>LAB_0041efd0:</pre>
<pre>          pbVar13 = (byte *)(param_4 + 0x176);</pre>
<pre>          pbVar15 = pbVar13;</pre>
<pre>          do {</pre>
<pre>            if ((byte *)(param_4 + 0x276) &lt;= pbVar15) goto LAB_0041f014;</pre>
<pre>            uVar3 = (uint)*pbVar15;</pre>
<pre>            if (0x3f &lt; uVar3) goto LAB_0041f014;</pre>
<pre>            pbVar15 = pbVar15 + uVar3 + 1;</pre>
<pre>          } while (uVar3 != 0);</pre>
<pre>          pbVar15 = pbVar15 + -(uVar3 + 1);</pre>
<pre>LAB_0041efe8:</pre>
<pre>          uVar3 = (uint)(pbVar15 + (1 - (int)pbVar13)) &amp; 0xffff;</pre>
<pre>LAB_0041f018:</pre>
<pre>          local_2c = (ushort *)((int)local_2c + uVar3);</pre>
<pre>LAB_0041f020:</pre>
<pre>          return local_2c == param_3;</pre>
<pre>        }</pre>
<pre>        if (uVar3 != 0x23) {</pre>
<pre>          if (0x23 &lt; uVar3) {</pre>
<pre>            uVar7 = 0x27;</pre>
<pre>            if (uVar3 == 0x24) goto LAB_0041eb70;</pre>
<pre>            goto LAB_0041e71c;</pre>
<pre>          }</pre>
<pre>          if (uVar3 != 0x21) goto LAB_004200a4;</pre>
<pre>          if (pbVar15 &lt; (byte *)0x7) {</pre>
<pre>            return false;</pre>
<pre>          }</pre>
<pre>          puVar10 = param_2 + 3;</pre>
<pre>          *(ushort *)(param_4 + 0x74) = *param_2;</pre>
<pre>          *(ushort *)(param_4 + 0x76) = param_2[1];</pre>
<pre>          *(byte *)(param_4 + 0x78) = *(byte *)(param_2 + 2);</pre>
<pre>          *(byte *)(param_4 + 0x79) = *(byte *)((int)param_2 + 5);</pre>
<pre>          if (param_1 == 0) {</pre>
<pre>            puVar11 = puVar10;</pre>
<pre>            do {</pre>
<pre>              if (param_2 + 0x83 &lt;= puVar11) {</pre>
<pre>                *(undefined *)(param_4 + 0x7a) = 0;</pre>
<pre>                goto LAB_0041f120;</pre>
<pre>              }</pre>
<pre>              uVar3 = (uint)*(byte *)puVar11;</pre>
<pre>              if (0x3f &lt; uVar3) {</pre>
<pre>                *(undefined *)(param_4 + 0x7a) = 0;</pre>
<pre>                goto LAB_0041f120;</pre>
<pre>              }</pre>
<pre>              puVar11 = (ushort *)((int)puVar11 + uVar3 + 1);</pre>
<pre>            } while (uVar3 != 0);</pre>
<pre>            uVar3 = (uint)((int)puVar11 + (-(int)puVar10 - (uVar3 + 1)) + 1) &amp; 0xffff;</pre>
<pre>            if (uVar3 &lt; 0x101) {</pre>
<pre>              mDNSPlatformMemCopy((void *)(param_4 + 0x7a),puVar10,uVar3);</pre>
<pre>            }</pre>
<pre>            else {</pre>
<pre>              *(undefined *)(param_4 + 0x7a) = 0;</pre>
<pre>            }</pre>
<pre>LAB_0041f120:</pre>
<pre>            pbVar13 = (byte *)(param_4 + 0x7a);</pre>
<pre>            pbVar15 = pbVar13;</pre>
<pre>            do {</pre>
<pre>              if ((byte *)(param_4 + 0x17a) &lt;= pbVar15) goto LAB_0041f164;</pre>
<pre>              uVar3 = (uint)*pbVar15;</pre>
<pre>              if (0x3f &lt; uVar3) goto LAB_0041f164;</pre>
<pre>              pbVar15 = pbVar15 + uVar3 + 1;</pre>
<pre>            } while (uVar3 != 0);</pre>
<pre>            pbVar15 = pbVar15 + -(uVar3 + 1);</pre>
<pre>LAB_0041f138:</pre>
<pre>            uVar3 = (uint)(pbVar15 + (1 - (int)pbVar13)) &amp; 0xffff;</pre>
<pre>            goto LAB_0041f168;</pre>
<pre>          }</pre>
<pre>          param_4 = param_4 + 0x7a;</pre>
<pre>          goto LAB_0041f090;</pre>
<pre>        }</pre>
<pre>        if ((byte *)0x7 &lt; pbVar15) {</pre>
<pre>          puVar10 = (ushort *)((int)param_2 + *(byte *)(param_2 + 2) + 5);</pre>
<pre>          if (puVar10 &lt; param_3) {</pre>
<pre>            puVar10 = (ushort *)((int)puVar10 + *(byte *)puVar10 + 1);</pre>
<pre>            if (puVar10 &lt; param_3) {</pre>
<pre>              puVar10 = (ushort *)((int)puVar10 + *(byte *)puVar10 + 1);</pre>
<pre>              if (puVar10 &lt; param_3) {</pre>
<pre>                if (param_1 == 0) {</pre>
<pre>                  puVar11 = puVar10;</pre>
<pre>                  do {</pre>
<pre>                    if (puVar10 + 0x80 &lt;= puVar11) {</pre>
<pre>                      local_134[0]._0_1_ = 0;</pre>
<pre>                      goto LAB_0041f2ac;</pre>
<pre>                    }</pre>
<pre>                    uVar3 = (uint)*(byte *)puVar11;</pre>
<pre>                    if (0x3f &lt; uVar3) {</pre>
<pre>                      local_134[0]._0_1_ = 0;</pre>
<pre>                      goto LAB_0041f2ac;</pre>
<pre>                    }</pre>
<pre>                    puVar11 = (ushort *)((int)puVar11 + uVar3 + 1);</pre>
<pre>                  } while (uVar3 != 0);</pre>
<pre>                  uVar3 = (uint)((int)puVar11 + (-(int)puVar10 - (uVar3 + 1)) + 1) &amp; 0xffff;</pre>
<pre>                  if (uVar3 &lt; 0x101) {</pre>
<pre>                    mDNSPlatformMemCopy(local_134,puVar10,uVar3);</pre>
<pre>                  }</pre>
<pre>                  else {</pre>
<pre>                    local_134[0]._0_1_ = 0;</pre>
<pre>                  }</pre>
<pre>LAB_0041f2ac:</pre>
<pre>                  puVar11 = local_134;</pre>
<pre>                  do {</pre>
<pre>                    if (auStack_34 &lt;= puVar11) {</pre>
<pre>LAB_0041f2fc:</pre>
<pre>                      uVar3 = 0x101;</pre>
<pre>                      goto LAB_0041f300;</pre>
<pre>                    }</pre>
<pre>                    uVar3 = (uint)*(byte *)puVar11;</pre>
<pre>                    if (0x3f &lt; uVar3) goto LAB_0041f2fc;</pre>
<pre>                    puVar11 = (ushort *)((int)puVar11 + uVar3 + 1);</pre>
<pre>                  } while (uVar3 != 0);</pre>
<pre>                  uVar3 = (uint)((int)puVar11 + (-(int)local_134 - (uVar3 + 1)) + 1) &amp; 0xffff;</pre>
<pre>LAB_0041f300:</pre>
<pre>                  puVar11 = (ushort *)((int)puVar10 + uVar3);</pre>
<pre>                }</pre>
<pre>                else {</pre>
<pre>                  puVar11 = (ushort *)FUN_0041b774(param_1,puVar10,param_3,local_134);</pre>
<pre>                }</pre>
<pre>                if (puVar11 == param_3) {</pre>
<pre>                  puVar11 = local_134;</pre>
<pre>                  do {</pre>
<pre>                    if (auStack_34 &lt;= puVar11) {</pre>
<pre>LAB_0041f36c:</pre>
<pre>                      uVar3 = 0x101;</pre>
<pre>                      goto LAB_0041f370;</pre>
<pre>                    }</pre>
<pre>                    uVar3 = (uint)*(byte *)puVar11;</pre>
<pre>                    if (0x3f &lt; uVar3) goto LAB_0041f36c;</pre>
<pre>                    puVar11 = (ushort *)((int)puVar11 + uVar3 + 1);</pre>
<pre>                  } while (uVar3 != 0);</pre>
<pre>                  uVar3 = (uint)((int)puVar11 + (-(int)local_134 - (uVar3 + 1)) + 1) &amp; 0xffff;</pre>
<pre>LAB_0041f370:</pre>
<pre><span class="green">                  __n = (int)puVar10 - (int)param_2</span></span></pre>
<pre>                  puVar10 = (ushort *)(uVar3 + __n &amp; 0xffff);</pre>
<pre>                  *(short *)(param_4 + 0x10) = (short)puVar10;</pre>
<pre>                  if (puVar10 &lt; (ushort *)0x2001) {</pre>
<pre>                    mDNSPlatformMemCopy(pbVar13,param_2,__n);</pre>
<pre>                    puVar10 = local_134;</pre>
<pre>                    do {</pre>
<pre>                      if (auStack_34 &lt;= puVar10) goto LAB_0041f43c;</pre>
<pre>                      uVar3 = (uint)*(byte *)puVar10;</pre>
<pre>                      if (0x3f &lt; uVar3) goto LAB_0041f43c;</pre>
<pre>                      puVar10 = (ushort *)((int)puVar10 + uVar3 + 1);</pre>
<pre>                    } while (uVar3 != 0);</pre>
<pre>                    pbVar15 = (byte *)((uint)((int)puVar10 + (-(int)local_134 - (uVar3 + 1)) + 1) &amp;</pre>
<pre>                                      0xffff);</pre>
<pre>                    if ((byte *)0x100 &lt; pbVar15) {</pre>
<pre>LAB_0041f43c:</pre>
<pre>                      pbVar13[__n] = 0;</pre>
<pre>                      return true;</pre>
<pre>                    }</pre>
<pre>                    pbVar13 = pbVar13 + __n;</pre>
<pre>                    param_2 = local_134;</pre>
<pre>                    goto LAB_004200b8;</pre>
<pre>                  }</pre>
<pre>                  param_3 = local_134;</pre>
<pre>                  if (mDNS_LoggingEnabled != 0) {</pre>
<pre>                    pcVar9 = </pre>
<pre>                    "SetRData: Malformed NAPTR rdlength %d, rr-&gt;resrec.rdlength %d, bmaplen %d, name %##s"</pre>
<pre>                    ;</pre>
<pre>                    goto LAB_0041fbd8;</pre>
<pre>                  }</pre>
<pre>                }</pre>
<pre>                else if (mDNS_LoggingEnabled != 0) {</pre>
<pre>                  pcVar9 = "SetRData: Malformed NAPTR RDATA name";</pre>
<pre>                  goto LAB_0041f4f4;</pre>
<pre>                }</pre>
<pre>              }</pre>
<pre>              else if (mDNS_LoggingEnabled != 0) {</pre>
<pre>                pcVar9 = "SetRData: Malformed NAPTR regexp";</pre>
<pre>                goto LAB_0041f4f4;</pre>
<pre>              }</pre>
<pre>            }</pre>
<pre>            else if (mDNS_LoggingEnabled != 0) {</pre>
<pre>              pcVar9 = "SetRData: Malformed NAPTR service";</pre>
<pre>              goto LAB_0041f4f4;</pre>
<pre>            }</pre>
<pre>          }</pre>
<pre>          else if (mDNS_LoggingEnabled != 0) {</pre>
<pre>            pcVar9 = "SetRData: Malformed NAPTR flags";</pre>
<pre>            goto LAB_0041f4f4;</pre>
<pre>          }</pre>
<pre>        }</pre>
<pre>      }</pre>
<pre>      else if (uVar3 == 0x30) {</pre>
<pre>        if ((byte *)0x4 &lt; pbVar15) {</pre>
<pre>          *(ushort *)(param_4 + 0x10) = param_5;</pre>
<pre>          goto LAB_004200b8;</pre>
<pre>        }</pre>
<pre>        if (mDNS_LoggingEnabled != 0) {</pre>
<pre>          pcVar9 = "SetRData: DNSKEY too small length %d";</pre>
<pre>          goto LAB_00420060;</pre>
<pre>        }</pre>
<pre>      }</pre>
<pre>      else if (uVar3 &lt; 0x31) {</pre>
<pre>        if (uVar3 == 0x2e) {</pre>
<pre>          if (pbVar15 &lt; (byte *)0x13) {</pre>
<pre>            if (mDNS_LoggingEnabled != 0) {</pre>
<pre>              pcVar9 = "SetRData: RRSIG too small length %d";</pre>
<pre>              goto LAB_00420060;</pre>
<pre>            }</pre>
<pre>          }</pre>
<pre>          else {</pre>
<pre>            puVar10 = param_2 + 9;</pre>
<pre>            if (param_1 == 0) {</pre>
<pre>              puVar11 = puVar10;</pre>
<pre>              do {</pre>
<pre>                if (param_2 + 0x89 &lt;= puVar11) {</pre>
<pre>                  local_134[0]._0_1_ = 0;</pre>
<pre>                  goto LAB_0041ff1c;</pre>
<pre>                }</pre>
<pre>                uVar3 = (uint)*(byte *)puVar11;</pre>
<pre>                if (0x3f &lt; uVar3) {</pre>
<pre>                  local_134[0]._0_1_ = 0;</pre>
<pre>                  goto LAB_0041ff1c;</pre>
<pre>                }</pre>
<pre>                puVar11 = (ushort *)((int)puVar11 + uVar3 + 1);</pre>
<pre>              } while (uVar3 != 0);</pre>
<pre>              uVar3 = (uint)((int)puVar11 + (-(int)puVar10 - (uVar3 + 1)) + 1) &amp; 0xffff;</pre>
<pre>              if (uVar3 &lt; 0x101) {</pre>
<pre>                mDNSPlatformMemCopy(local_134,puVar10,uVar3);</pre>
<pre>              }</pre>
<pre>              else {</pre>
<pre>                local_134[0]._0_1_ = 0;</pre>
<pre>              }</pre>
<pre>LAB_0041ff1c:</pre>
<pre>              puVar11 = local_134;</pre>
<pre>              do {</pre>
<pre>                if (auStack_34 &lt;= puVar11) {</pre>
<pre>LAB_0041ff6c:</pre>
<pre>                  uVar3 = 0x101;</pre>
<pre>                  goto LAB_0041ff70;</pre>
<pre>                }</pre>
<pre>                uVar3 = (uint)*(byte *)puVar11;</pre>
<pre>                if (0x3f &lt; uVar3) goto LAB_0041ff6c;</pre>
<pre>                puVar11 = (ushort *)((int)puVar11 + uVar3 + 1);</pre>
<pre>              } while (uVar3 != 0);</pre>
<pre>              uVar3 = (uint)((int)puVar11 + (-(int)local_134 - (uVar3 + 1)) + 1) &amp; 0xffff;</pre>
<pre>LAB_0041ff70:</pre>
<pre>              pbVar5 = (byte *)((int)puVar10 + uVar3);</pre>
<pre>            }</pre>
<pre>            else {</pre>
<pre>              pbVar5 = (byte *)FUN_0041b774(param_1,puVar10,param_3,local_134);</pre>
<pre>            }</pre>
<pre>            if (pbVar5 == (byte *)0x0) {</pre>
<pre>              if (mDNS_LoggingEnabled != 0) {</pre>
<pre>                pcVar9 = "SetRData: Malformed RRSIG record";</pre>
<pre>LAB_0041f4f4:</pre>
<pre>                LogMsgWithLevel(3,pcVar9);</pre>
<pre>                return false;</pre>
<pre>              }</pre>
<pre>            }</pre>
<pre>            else {</pre>
<pre>              puVar11 = local_134;</pre>
<pre>              do {</pre>
<pre>                if (auStack_34 &lt;= puVar11) {</pre>
<pre>LAB_0041ffdc:</pre>
<pre>                  uVar3 = 0x101;</pre>
<pre>                  goto LAB_0041ffe0;</pre>
<pre>                }</pre>
<pre>                uVar3 = (uint)*(byte *)puVar11;</pre>
<pre>                if (0x3f &lt; uVar3) goto LAB_0041ffdc;</pre>
<pre>                puVar11 = (ushort *)((int)puVar11 + uVar3 + 1);</pre>
<pre>              } while (uVar3 != 0);</pre>
<pre>              uVar3 = (uint)((int)puVar11 + (-(int)local_134 - (uVar3 + 1)) + 1) &amp; 0xffff;</pre>
<pre>LAB_0041ffe0:</pre>
<pre>              if ((int)pbVar5 - (int)puVar10 == uVar3) {</pre>
<pre>                if (pbVar5 + 1 &lt; param_3) goto LAB_004200a4;</pre>
<pre>                if (mDNS_LoggingEnabled != 0) {</pre>
<pre>                  pcVar9 = "SetRData: Not enough bytes for signature type %d";</pre>
<pre>                  pbVar15 = (byte *)(uint)*(ushort *)(param_4 + 6);</pre>
<pre>                  goto LAB_00420060;</pre>
<pre>                }</pre>
<pre>              }</pre>
<pre>              else if (mDNS_LoggingEnabled != 0) {</pre>
<pre>                pcVar9 = "SetRData: Malformed RRSIG record, signer name compression";</pre>
<pre>                goto LAB_0041f4f4;</pre>
<pre>              }</pre>
<pre>            }</pre>
<pre>          }</pre>
<pre>        }</pre>
<pre>        else if (uVar3 &lt; 0x2f) {</pre>
<pre>          if ((uVar3 != 0x2b) || ((byte *)0x4 &lt; pbVar15)) goto LAB_004200a4;</pre>
<pre>          if (mDNS_LoggingEnabled != 0) {</pre>
<pre>            pcVar9 = "SetRData: DS too small length %d";</pre>
<pre>            goto LAB_00420060;</pre>
<pre>          }</pre>
<pre>        }</pre>
<pre>        else {</pre>
<pre>          if (param_1 == 0) {</pre>
<pre>            puVar10 = param_2;</pre>
<pre>            do {</pre>
<pre>              if (param_2 + 0x80 &lt;= puVar10) {</pre>
<pre>                local_134[0]._0_1_ = 0;</pre>
<pre>                goto LAB_0041f8d8;</pre>
<pre>              }</pre>
<pre>              uVar3 = (uint)*(byte *)puVar10;</pre>
<pre>              if (0x3f &lt; uVar3) {</pre>
<pre>                local_134[0]._0_1_ = 0;</pre>
<pre>                goto LAB_0041f8d8;</pre>
<pre>              }</pre>
<pre>              puVar10 = (ushort *)((int)puVar10 + uVar3 + 1);</pre>
<pre>            } while (uVar3 != 0);</pre>
<pre>            uVar3 = (uint)((int)puVar10 + (-(int)param_2 - (uVar3 + 1)) + 1) &amp; 0xffff;</pre>
<pre>            if (uVar3 &lt; 0x101) {</pre>
<pre>              mDNSPlatformMemCopy(local_134,param_2,uVar3);</pre>
<pre>            }</pre>
<pre>            else {</pre>
<pre>              local_134[0]._0_1_ = 0;</pre>
<pre>            }</pre>
<pre>LAB_0041f8d8:</pre>
<pre>            puVar10 = local_134;</pre>
<pre>            do {</pre>
<pre>              if (auStack_34 &lt;= puVar10) {</pre>
<pre>LAB_0041f928:</pre>
<pre>                uVar3 = 0x101;</pre>
<pre>                goto LAB_0041f92c;</pre>
<pre>              }</pre>
<pre>              uVar3 = (uint)*(byte *)puVar10;</pre>
<pre>              if (0x3f &lt; uVar3) goto LAB_0041f928;</pre>
<pre>              puVar10 = (ushort *)((int)puVar10 + uVar3 + 1);</pre>
<pre>            } while (uVar3 != 0);</pre>
<pre>            uVar3 = (uint)((int)puVar10 + (-(int)local_134 - (uVar3 + 1)) + 1) &amp; 0xffff;</pre>
<pre>LAB_0041f92c:</pre>
<pre>            puVar11 = (ushort *)((int)param_2 + uVar3);</pre>
<pre>          }</pre>
<pre>          else {</pre>
<pre>            puVar11 = (ushort *)FUN_0041b774();</pre>
<pre>          }</pre>
<pre>          if (puVar11 == (ushort *)0x0) {</pre>
<pre>            if (mDNS_LoggingEnabled != 0) {</pre>
<pre>              pcVar9 = "SetRData: Malformed NSEC nextname";</pre>
<pre>              goto LAB_0041f4f4;</pre>
<pre>            }</pre>
<pre>          }</pre>
<pre>          else {</pre>
<pre>            puVar10 = local_134;</pre>
<pre>            do {</pre>
<pre>              if (auStack_34 &lt;= puVar10) {</pre>
<pre>LAB_0041f998:</pre>
<pre>                uVar3 = 0x101;</pre>
<pre>                goto LAB_0041f99c;</pre>
<pre>              }</pre>
<pre>              uVar3 = (uint)*(byte *)puVar10;</pre>
<pre>              if (0x3f &lt; uVar3) goto LAB_0041f998;</pre>
<pre>              puVar10 = (ushort *)((int)puVar10 + uVar3 + 1);</pre>
<pre>            } while (uVar3 != 0);</pre>
<pre>            uVar3 = (uint)((int)puVar10 + (-(int)local_134 - (uVar3 + 1)) + 1) &amp; 0xffff;</pre>
<pre>LAB_0041f99c:</pre>
<pre>            pbVar15 = (byte *)((int)param_2 + ((int)pbVar15 - (int)puVar11));</pre>
<pre>            puVar10 = (ushort *)FUN_0041ccd4(puVar11,param_3,pbVar15);</pre>
<pre>            if (puVar10 != (ushort *)0x0) {</pre>
<pre>              if (puVar10 == param_3) {</pre>
<pre>                puVar10 = local_134;</pre>
<pre>                do {</pre>
<pre>                  if (auStack_34 &lt;= puVar10) {</pre>
<pre>LAB_0041fa28:</pre>
<pre>                    uVar7 = 0x101;</pre>
<pre>                    goto LAB_0041fa2c;</pre>
<pre>                  }</pre>
<pre>                  uVar7 = (uint)*(byte *)puVar10;</pre>
<pre>                  if (0x3f &lt; uVar7) goto LAB_0041fa28;</pre>
<pre>                  puVar10 = (ushort *)((int)puVar10 + uVar7 + 1);</pre>
<pre>                } while (uVar7 != 0);</pre>
<pre>                uVar7 = (uint)((int)puVar10 + (-(int)local_134 - (uVar7 + 1)) + 1) &amp; 0xffff;</pre>
<pre>LAB_0041fa2c:</pre>
<pre>                puVar10 = (ushort *)((uint)(pbVar15 + uVar7) &amp; 0xffff);</pre>
<pre>                *(short *)(param_4 + 0x10) = (short)puVar10;</pre>
<pre>                if (puVar10 &lt; (ushort *)0x2001) {</pre>
<pre>                  puVar10 = local_134;</pre>
<pre>                  do {</pre>
<pre>                    if (auStack_34 &lt;= puVar10) {</pre>
<pre>                      *(undefined *)(param_4 + 0x74) = 0;</pre>
<pre>                      goto LAB_0041fae8;</pre>
<pre>                    }</pre>
<pre>                    uVar7 = (uint)*(byte *)puVar10;</pre>
<pre>                    if (0x3f &lt; uVar7) {</pre>
<pre>                      *(undefined *)(param_4 + 0x74) = 0;</pre>
<pre>                      goto LAB_0041fae8;</pre>
<pre>                    }</pre>
<pre>                    puVar10 = (ushort *)((int)puVar10 + uVar7 + 1);</pre>
<pre>                  } while (uVar7 != 0);</pre>
<pre>                  uVar7 = (uint)((int)puVar10 + (-(int)local_134 - (uVar7 + 1)) + 1) &amp; 0xffff;</pre>
<pre>                  if (uVar7 &lt; 0x101) {</pre>
<pre>                    mDNSPlatformMemCopy(pbVar13,local_134,uVar7);</pre>
<pre>                  }</pre>
<pre>                  else {</pre>
<pre>                    *(undefined *)(param_4 + 0x74) = 0;</pre>
<pre>                  }</pre>
<pre>LAB_0041fae8:</pre>
<pre>                  pbVar13 = pbVar13 + uVar3;</pre>
<pre>                  param_2 = puVar11;</pre>
<pre>                  goto LAB_004200b8;</pre>
<pre>                }</pre>
<pre>                param_3 = local_134;</pre>
<pre>                if (mDNS_LoggingEnabled != 0) {</pre>
<pre>                  pcVar9 = </pre>
<pre>                  "SetRData: Malformed NSEC rdlength %d, rr-&gt;resrec.rdlength %d, bmaplen %d, name %##s"</pre>
<pre>                  ;</pre>
<pre>                  goto LAB_0041fbd8;</pre>
<pre>                }</pre>
<pre>              }</pre>
<pre>              else if (mDNS_LoggingEnabled != 0) {</pre>
<pre>                pcVar9 = "SetRData: Malformed NSEC length not right";</pre>
<pre>                goto LAB_0041f4f4;</pre>
<pre>              }</pre>
<pre>            }</pre>
<pre>          }</pre>
<pre>        }</pre>
<pre>      }</pre>
<pre>      else if (uVar3 == 0x32) {</pre>
<pre>        if (pbVar15 &lt; (byte *)0x6) {</pre>
<pre>          if (mDNS_LoggingEnabled != 0) {</pre>
<pre>            pcVar9 = "SetRData: NSEC3 too small length %d";</pre>
<pre>LAB_00420060:</pre>
<pre>            LogMsgWithLevel(3,pcVar9,pbVar15);</pre>
<pre>            return false;</pre>
<pre>          }</pre>
<pre>        }</pre>
<pre>        else if ((byte *)(uint)*(byte *)param_2 == (byte *)0x1) {</pre>
<pre>          if (param_2[1] &lt; 0x9c5) {</pre>
<pre>            pbVar5 = (byte *)(uint)*(byte *)(param_2 + 2);</pre>
<pre>            puVar10 = (ushort *)((int)param_2 + (int)(pbVar5 + 5));</pre>
<pre>            if (puVar10 &lt; param_3) {</pre>
<pre>              pbVar5 = (byte *)(uint)*(byte *)puVar10;</pre>
<pre>              if (pbVar5 == (byte *)0x0) {</pre>
<pre>                if (mDNS_LoggingEnabled != 0) {</pre>
<pre>                  pcVar9 = "SetRData: hashLength zero";</pre>
<pre>                  goto LAB_0041f4f4;</pre>
<pre>                }</pre>
<pre>              }</pre>
<pre>              else {</pre>
<pre>                puVar10 = (ushort *)((int)puVar10 + (int)(pbVar5 + 1));</pre>
<pre>                if (puVar10 &lt;= param_3) {</pre>
<pre>                  iVar12 = FUN_0041ccd4(puVar10,param_3,</pre>
<pre>                                        (byte *)((int)param_2 + ((int)pbVar15 - (int)puVar10)));</pre>
<pre>                  if (iVar12 == 0) {</pre>
<pre>                    return false;</pre>
<pre>                  }</pre>
<pre>                  goto LAB_004200a4;</pre>
<pre>                }</pre>
<pre>                if (mDNS_LoggingEnabled != 0) {</pre>
<pre>                  pcVar9 = "SetRData: nsec3 too small, at hashLength %d, p %p, end %p";</pre>
<pre>                  goto LAB_0041fbd8;</pre>
<pre>                }</pre>
<pre>              }</pre>
<pre>            }</pre>
<pre>            else if (mDNS_LoggingEnabled != 0) {</pre>
<pre>              pcVar9 = "SetRData: nsec3 too small, at saltlength %d, p %p, end %p";</pre>
<pre>LAB_0041fbd8:</pre>
<pre>              LogMsgWithLevel(3,pcVar9,pbVar5,puVar10,param_3);</pre>
<pre>              return false;</pre>
<pre>            }</pre>
<pre>          }</pre>
<pre>          else if (mDNS_LoggingEnabled != 0) {</pre>
<pre>            pcVar9 = "SetRData: nsec3 iteration count %d too big";</pre>
<pre>            pbVar15 = (byte *)(uint)param_2[1];</pre>
<pre>            goto LAB_00420060;</pre>
<pre>          }</pre>
<pre>        }</pre>
<pre>        else if (mDNS_LoggingEnabled != 0) {</pre>
<pre>          pcVar9 = "SetRData: nsec3 alg %d not supported";</pre>
<pre>          pbVar15 = (byte *)(uint)*(byte *)param_2;</pre>
<pre>          goto LAB_00420060;</pre>
<pre>        }</pre>
<pre>      }</pre>
<pre>      else {</pre>
<pre>        if ((uVar3 &lt; 0x32) || (1 &lt; uVar3 - 0xf9)) goto LAB_004200a4;</pre>
<pre>        if (param_1 == 0) {</pre>
<pre>          puVar10 = param_2;</pre>
<pre>          do {</pre>
<pre>            if (param_2 + 0x80 &lt;= puVar10) {</pre>
<pre>              local_134[0]._0_1_ = 0;</pre>
<pre>              goto LAB_0041fcf4;</pre>
<pre>            }</pre>
<pre>            uVar3 = (uint)*(byte *)puVar10;</pre>
<pre>            if (0x3f &lt; uVar3) {</pre>
<pre>              local_134[0]._0_1_ = 0;</pre>
<pre>              goto LAB_0041fcf4;</pre>
<pre>            }</pre>
<pre>            puVar10 = (ushort *)((int)puVar10 + uVar3 + 1);</pre>
<pre>          } while (uVar3 != 0);</pre>
<pre>          uVar3 = (uint)((int)puVar10 + (-(int)param_2 - (uVar3 + 1)) + 1) &amp; 0xffff;</pre>
<pre>          if (uVar3 &lt; 0x101) {</pre>
<pre>            mDNSPlatformMemCopy(local_134,param_2,uVar3);</pre>
<pre>          }</pre>
<pre>          else {</pre>
<pre>            local_134[0]._0_1_ = 0;</pre>
<pre>          }</pre>
<pre>LAB_0041fcf4:</pre>
<pre>          puVar10 = local_134;</pre>
<pre>          do {</pre>
<pre>            if (auStack_34 &lt;= puVar10) {</pre>
<pre>LAB_0041fd44:</pre>
<pre>              uVar3 = 0x101;</pre>
<pre>              goto LAB_0041fd48;</pre>
<pre>            }</pre>
<pre>            uVar3 = (uint)*(byte *)puVar10;</pre>
<pre>            if (0x3f &lt; uVar3) goto LAB_0041fd44;</pre>
<pre>            puVar10 = (ushort *)((int)puVar10 + uVar3 + 1);</pre>
<pre>          } while (uVar3 != 0);</pre>
<pre>          uVar3 = (uint)((int)puVar10 + (-(int)local_134 - (uVar3 + 1)) + 1) &amp; 0xffff;</pre>
<pre>LAB_0041fd48:</pre>
<pre>          param_2 = (ushort *)((int)param_2 + uVar3);</pre>
<pre>        }</pre>
<pre>        else {</pre>
<pre>          param_2 = (ushort *)FUN_0041b774();</pre>
<pre>        }</pre>
<pre>        if (param_2 != (ushort *)0x0) {</pre>
<pre>          puVar10 = local_134;</pre>
<pre>          do {</pre>
<pre>            if (auStack_34 &lt;= puVar10) {</pre>
<pre>LAB_0041fdb8:</pre>
<pre>              uVar3 = 0x101;</pre>
<pre>              goto LAB_0041fdbc;</pre>
<pre>            }</pre>
<pre>            uVar3 = (uint)*(byte *)puVar10;</pre>
<pre>            if (0x3f &lt; uVar3) goto LAB_0041fdb8;</pre>
<pre>            puVar10 = (ushort *)((int)puVar10 + uVar3 + 1);</pre>
<pre>          } while (uVar3 != 0);</pre>
<pre>          uVar3 = (uint)((int)puVar10 + (-(int)local_134 - (uVar3 + 1)) + 1) &amp; 0xffff;</pre>
<pre>LAB_0041fdbc:</pre>
<pre>          pbVar15 = (byte *)((int)param_3 - (int)param_2);</pre>
<pre>          *(short *)(param_4 + 0x10) = (short)uVar3 + (short)pbVar15;</pre>
<pre>          puVar10 = local_134;</pre>
<pre>          do {</pre>
<pre>            if (auStack_34 &lt;= puVar10) {</pre>
<pre>              *(undefined *)(param_4 + 0x74) = 0;</pre>
<pre>              goto LAB_0041fe4c;</pre>
<pre>            }</pre>
<pre>            uVar7 = (uint)*(byte *)puVar10;</pre>
<pre>            if (0x3f &lt; uVar7) {</pre>
<pre>              *(undefined *)(param_4 + 0x74) = 0;</pre>
<pre>              goto LAB_0041fe4c;</pre>
<pre>            }</pre>
<pre>            puVar10 = (ushort *)((int)puVar10 + uVar7 + 1);</pre>
<pre>          } while (uVar7 != 0);</pre>
<pre>          uVar7 = (uint)((int)puVar10 + (-(int)local_134 - (uVar7 + 1)) + 1) &amp; 0xffff;</pre>
<pre>          if (uVar7 &lt; 0x101) {</pre>
<pre>            local_2c = param_2;</pre>
<pre>            mDNSPlatformMemCopy(pbVar13,local_134,uVar7);</pre>
<pre>            param_2 = local_2c;</pre>
<pre>          }</pre>
<pre>          else {</pre>
<pre>            *(undefined *)(param_4 + 0x74) = 0;</pre>
<pre>          }</pre>
<pre>LAB_0041fe4c:</pre>
<pre>          pbVar13 = pbVar13 + uVar3;</pre>
<pre>          goto LAB_004200b8;</pre>
<pre>        }</pre>
<pre>        if (mDNS_LoggingEnabled != 0) {</pre>
<pre>          pcVar9 = "SetRData: Malformed name for TSIG/TKEY type %d";</pre>
<pre>          pbVar15 = (byte *)(uint)*(ushort *)(param_4 + 6);</pre>
<pre>          goto LAB_00420060;</pre>
<pre>        }</pre>
<pre>      }</pre>
<pre>    }</pre>
<pre>    goto LAB_004200c8;</pre>
<pre>  }</pre>
<pre>  if (uVar3 == 0xc) goto LAB_0041e7b8;</pre>
<pre>  if (0xc &lt; uVar3) {</pre>
<pre>    if (uVar3 != 0x10) {</pre>
<pre>      if (uVar3 &lt; 0x11) {</pre>
<pre>        if (uVar3 == 0xe) {</pre>
<pre>LAB_0041ec5c:</pre>
<pre>          if (param_1 == 0) {</pre>
<pre>            puVar10 = param_2;</pre>
<pre>            do {</pre>
<pre>              if (param_2 + 0x80 &lt;= puVar10) {</pre>
<pre>                *(undefined *)(param_4 + 0x74) = 0;</pre>
<pre>                goto LAB_0041ed00;</pre>
<pre>              }</pre>
<pre>              uVar3 = (uint)*(byte *)puVar10;</pre>
<pre>              if (0x3f &lt; uVar3) {</pre>
<pre>                *(undefined *)(param_4 + 0x74) = 0;</pre>
<pre>                goto LAB_0041ed00;</pre>
<pre>              }</pre>
<pre>              puVar10 = (ushort *)((int)puVar10 + uVar3 + 1);</pre>
<pre>            } while (uVar3 != 0);</pre>
<pre>            uVar3 = (uint)((int)puVar10 + (-(int)param_2 - (uVar3 + 1)) + 1) &amp; 0xffff;</pre>
<pre>            if (uVar3 &lt; 0x101) {</pre>
<pre>              mDNSPlatformMemCopy(pbVar13,param_2,uVar3);</pre>
<pre>            }</pre>
<pre>            else {</pre>
<pre>              *(undefined *)(param_4 + 0x74) = 0;</pre>
<pre>            }</pre>
<pre>LAB_0041ed00:</pre>
<pre>            pbVar15 = pbVar13;</pre>
<pre>            do {</pre>
<pre>              if ((byte *)(param_4 + 0x174) &lt;= pbVar15) {</pre>
<pre>LAB_0041ed40:</pre>
<pre>                uVar3 = 0x101;</pre>
<pre>                goto LAB_0041ed44;</pre>
<pre>              }</pre>
<pre>              uVar3 = (uint)*pbVar15;</pre>
<pre>              if (0x3f &lt; uVar3) goto LAB_0041ed40;</pre>
<pre>              pbVar15 = pbVar15 + uVar3 + 1;</pre>
<pre>            } while (uVar3 != 0);</pre>
<pre>            uVar3 = (uint)(pbVar15 + (-(int)pbVar13 - (uVar3 + 1)) + 1) &amp; 0xffff;</pre>
<pre>LAB_0041ed44:</pre>
<pre>            local_2c = (ushort *)((int)param_2 + uVar3);</pre>
<pre>          }</pre>
<pre>          else {</pre>
<pre>            local_2c = (ushort *)FUN_0041b774(param_1,param_2,param_3,pbVar13);</pre>
<pre>          }</pre>
<pre>          if (local_2c == (ushort *)0x0) {</pre>
<pre>            return false;</pre>
<pre>          }</pre>
<pre>          iVar12 = param_4 + 0x174;</pre>
<pre>          if (param_1 != 0) {</pre>
<pre>LAB_0041ef3c:</pre>
<pre>            local_2c = (ushort *)FUN_0041b774(param_1,local_2c,param_3,iVar12);</pre>
<pre>            goto LAB_0041f020;</pre>
<pre>          }</pre>
<pre>          pbVar15 = (byte *)local_2c;</pre>
<pre>          do {</pre>
<pre>            if ((byte *)((int)local_2c + 0x100) &lt;= pbVar15) {</pre>
<pre>              *(undefined *)(param_4 + 0x174) = 0;</pre>
<pre>              goto LAB_0041ede0;</pre>
<pre>            }</pre>
<pre>            uVar3 = (uint)*pbVar15;</pre>
<pre>            if (0x3f &lt; uVar3) {</pre>
<pre>              *(undefined *)(param_4 + 0x174) = 0;</pre>
<pre>              goto LAB_0041ede0;</pre>
<pre>            }</pre>
<pre>            pbVar15 = pbVar15 + uVar3 + 1;</pre>
<pre>          } while (uVar3 != 0);</pre>
<pre>          if (((uint)(pbVar15 + (-(int)local_2c - (uVar3 + 1)) + 1) &amp; 0xffff) &lt; 0x101) {</pre>
<pre>            mDNSPlatformMemCopy((void *)(param_4 + 0x174),local_2c,</pre>
<pre>                                (uint)(pbVar15 + (-(int)local_2c - (uVar3 + 1)) + 1) &amp; 0xffff);</pre>
<pre>          }</pre>
<pre>          else {</pre>
<pre>            *(undefined *)(param_4 + 0x174) = 0;</pre>
<pre>          }</pre>
<pre>LAB_0041ede0:</pre>
<pre>          pbVar13 = (byte *)(param_4 + 0x174);</pre>
<pre>          for (pbVar15 = pbVar13; pbVar15 &lt; (byte *)(param_4 + 0x274); pbVar15 = pbVar15 + uVar3 + 1</pre>
<pre>              ) {</pre>
<pre>            uVar3 = (uint)*pbVar15;</pre>
<pre>            if (0x3f &lt; uVar3) {</pre>
<pre>              uVar3 = 0x101;</pre>
<pre>              goto LAB_0041f018;</pre>
<pre>            }</pre>
<pre>            if (uVar3 == 0) goto LAB_0041efe8;</pre>
<pre>          }</pre>
<pre>LAB_0041f014:</pre>
<pre>          uVar3 = 0x101;</pre>
<pre>          goto LAB_0041f018;</pre>
<pre>        }</pre>
<pre>        if (0xe &lt; uVar3) goto LAB_0041eb70;</pre>
<pre>      }</pre>
<pre>      else {</pre>
<pre>        if (uVar3 == 0x12) {</pre>
<pre>LAB_0041eb70:</pre>
<pre>          if (pbVar15 &lt; (byte *)0x3) {</pre>
<pre>            return false;</pre>
<pre>          }</pre>
<pre>          puVar10 = param_2 + 1;</pre>
<pre>          *(ushort *)(param_4 + 0x74) = *param_2;</pre>
<pre>          if (param_1 == 0) {</pre>
<pre>            puVar11 = puVar10;</pre>
<pre>            do {</pre>
<pre>              if (param_2 + 0x81 &lt;= puVar11) {</pre>
<pre>                *(undefined *)(param_4 + 0x76) = 0;</pre>
<pre>                goto LAB_0041ec20;</pre>
<pre>              }</pre>
<pre>              uVar3 = (uint)*(byte *)puVar11;</pre>
<pre>              if (0x3f &lt; uVar3) {</pre>
<pre>                *(undefined *)(param_4 + 0x76) = 0;</pre>
<pre>                goto LAB_0041ec20;</pre>
<pre>              }</pre>
<pre>              puVar11 = (ushort *)((int)puVar11 + uVar3 + 1);</pre>
<pre>            } while (uVar3 != 0);</pre>
<pre>            uVar3 = (uint)((int)puVar11 + (-(int)puVar10 - (uVar3 + 1)) + 1) &amp; 0xffff;</pre>
<pre>            if (uVar3 &lt; 0x101) {</pre>
<pre>              mDNSPlatformMemCopy((void *)(param_4 + 0x76),puVar10,uVar3);</pre>
<pre>            }</pre>
<pre>            else {</pre>
<pre>              *(undefined *)(param_4 + 0x76) = 0;</pre>
<pre>            }</pre>
<pre>LAB_0041ec20:</pre>
<pre>            pbVar13 = (byte *)(param_4 + 0x76);</pre>
<pre>            for (pbVar15 = pbVar13; pbVar15 &lt; (byte *)(param_4 + 0x176);</pre>
<pre>                pbVar15 = pbVar15 + uVar3 + 1) {</pre>
<pre>              uVar3 = (uint)*pbVar15;</pre>
<pre>              if (0x3f &lt; uVar3) {</pre>
<pre>                uVar3 = 0x101;</pre>
<pre>                goto LAB_0041f168;</pre>
<pre>              }</pre>
<pre>              if (uVar3 == 0) goto LAB_0041f138;</pre>
<pre>            }</pre>
<pre>LAB_0041f164:</pre>
<pre>            uVar3 = 0x101;</pre>
<pre>LAB_0041f168:</pre>
<pre>            puVar10 = (ushort *)((int)puVar10 + uVar3);</pre>
<pre>            goto LAB_0041f170;</pre>
<pre>          }</pre>
<pre>          param_4 = param_4 + 0x76;</pre>
<pre>LAB_0041f090:</pre>
<pre>          puVar10 = (ushort *)FUN_0041b774(param_1,puVar10,param_3,param_4);</pre>
<pre>LAB_0041f170:</pre>
<pre>          return puVar10 == param_3;</pre>
<pre>        }</pre>
<pre>        if (uVar3 &lt; 0x13) goto LAB_0041ec5c;</pre>
<pre>      }</pre>
<pre>    }</pre>
<pre>LAB_004200a4:</pre>
<pre>    *(ushort *)(param_4 + 0x10) = param_5;</pre>
<pre>LAB_004200b8:</pre>
<pre>    mDNSPlatformMemCopy(pbVar13,param_2,(size_t)pbVar15);</pre>
<pre>    return true;</pre>
<pre>  }</pre>
<pre>  if (uVar3 == 6) {</pre>
<pre>    if (param_1 == 0) {</pre>
<pre>      puVar10 = param_2;</pre>
<pre>      do {</pre>
<pre>        if (param_2 + 0x80 &lt;= puVar10) {</pre>
<pre>          *(undefined *)(param_4 + 0x74) = 0;</pre>
<pre>          goto LAB_0041e944;</pre>
<pre>        }</pre>
<pre>        uVar3 = (uint)*(byte *)puVar10;</pre>
<pre>        if (0x3f &lt; uVar3) {</pre>
<pre>          *(undefined *)(param_4 + 0x74) = 0;</pre>
<pre>          goto LAB_0041e944;</pre>
<pre>        }</pre>
<pre>        puVar10 = (ushort *)((int)puVar10 + uVar3 + 1);</pre>
<pre>      } while (uVar3 != 0);</pre>
<pre>      uVar3 = (uint)((int)puVar10 + (-(int)param_2 - (uVar3 + 1)) + 1) &amp; 0xffff;</pre>
<pre>      if (uVar3 &lt; 0x101) {</pre>
<pre>        mDNSPlatformMemCopy(pbVar13,param_2,uVar3);</pre>
<pre>      }</pre>
<pre>      else {</pre>
<pre>        *(undefined *)(param_4 + 0x74) = 0;</pre>
<pre>      }</pre>
<pre>LAB_0041e944:</pre>
<pre>      pbVar15 = pbVar13;</pre>
<pre>      do {</pre>
<pre>        if ((byte *)(param_4 + 0x174) &lt;= pbVar15) {</pre>
<pre>LAB_0041e984:</pre>
<pre>          uVar3 = 0x101;</pre>
<pre>          goto LAB_0041e988;</pre>
<pre>        }</pre>
<pre>        uVar3 = (uint)*pbVar15;</pre>
<pre>        if (0x3f &lt; uVar3) goto LAB_0041e984;</pre>
<pre>        pbVar15 = pbVar15 + uVar3 + 1;</pre>
<pre>      } while (uVar3 != 0);</pre>
<pre>      uVar3 = (uint)(pbVar15 + (-(int)pbVar13 - (uVar3 + 1)) + 1) &amp; 0xffff;</pre>
<pre>LAB_0041e988:</pre>
<pre>      local_2c = (ushort *)((int)param_2 + uVar3);</pre>
<pre>    }</pre>
<pre>    else {</pre>
<pre>      local_2c = (ushort *)FUN_0041b774();</pre>
<pre>    }</pre>
<pre>    if (local_2c == (ushort *)0x0) {</pre>
<pre>      return false;</pre>
<pre>    }</pre>
<pre>    if (param_1 == 0) {</pre>
<pre>      pbVar15 = (byte *)local_2c;</pre>
<pre>      do {</pre>
<pre>        if ((byte *)((int)local_2c + 0x100) &lt;= pbVar15) {</pre>
<pre>          *(undefined *)(param_4 + 0x174) = 0;</pre>
<pre>          goto LAB_0041ea34;</pre>
<pre>        }</pre>
<pre>        uVar3 = (uint)*pbVar15;</pre>
<pre>        if (0x3f &lt; uVar3) {</pre>
<pre>          *(undefined *)(param_4 + 0x174) = 0;</pre>
<pre>          goto LAB_0041ea34;</pre>
<pre>        }</pre>
<pre>        pbVar15 = pbVar15 + uVar3 + 1;</pre>
<pre>      } while (uVar3 != 0);</pre>
<pre>      if (((uint)(pbVar15 + (-(int)local_2c - (uVar3 + 1)) + 1) &amp; 0xffff) &lt; 0x101) {</pre>
<pre>        mDNSPlatformMemCopy((void *)(param_4 + 0x174),local_2c,</pre>
<pre>                            (uint)(pbVar15 + (-(int)local_2c - (uVar3 + 1)) + 1) &amp; 0xffff);</pre>
<pre>      }</pre>
<pre>      else {</pre>
<pre>        *(undefined *)(param_4 + 0x174) = 0;</pre>
<pre>      }</pre>
<pre>LAB_0041ea34:</pre>
<pre>      pbVar15 = (byte *)(param_4 + 0x174);</pre>
<pre>      do {</pre>
<pre>        if ((byte *)(param_4 + 0x274) &lt;= pbVar15) {</pre>
<pre>LAB_0041ea78:</pre>
<pre>          uVar3 = 0x101;</pre>
<pre>          goto LAB_0041ea7c;</pre>
<pre>        }</pre>
<pre>        uVar3 = (uint)*pbVar15;</pre>
<pre>        if (0x3f &lt; uVar3) goto LAB_0041ea78;</pre>
<pre>        pbVar15 = pbVar15 + uVar3 + 1;</pre>
<pre>      } while (uVar3 != 0);</pre>
<pre>      uVar3 = (uint)(pbVar15 + (-(int)(byte *)(param_4 + 0x174) - (uVar3 + 1)) + 1) &amp; 0xffff;</pre>
<pre>LAB_0041ea7c:</pre>
<pre>      pbVar15 = (byte *)((int)local_2c + uVar3);</pre>
<pre>    }</pre>
<pre>    else {</pre>
<pre>      pbVar15 = (byte *)FUN_0041b774(param_1,local_2c,param_3,param_4 + 0x174);</pre>
<pre>    }</pre>
<pre>    if ((pbVar15 != (byte *)0x0) &amp;&amp; (param_3 == (ushort *)(pbVar15 + 0x14))) {</pre>
<pre>      *(uint *)(param_4 + 0x274) =</pre>
<pre>           (uint)pbVar15[3] | (uint)*pbVar15 &lt;&lt; 0x18 | (uint)pbVar15[1] &lt;&lt; 0x10 |</pre>
<pre>           (uint)pbVar15[2] &lt;&lt; 8;</pre>
<pre>      *(uint *)(param_4 + 0x278) =</pre>
<pre>           (uint)pbVar15[4] &lt;&lt; 0x18 | (uint)pbVar15[5] &lt;&lt; 0x10 | (uint)pbVar15[7] |</pre>
<pre>           (uint)pbVar15[6] &lt;&lt; 8;</pre>
<pre>      *(uint *)(param_4 + 0x27c) =</pre>
<pre>           (uint)pbVar15[8] &lt;&lt; 0x18 | (uint)pbVar15[9] &lt;&lt; 0x10 | (uint)pbVar15[0xb] |</pre>
<pre>           (uint)pbVar15[10] &lt;&lt; 8;</pre>
<pre>      *(uint *)(param_4 + 0x280) =</pre>
<pre>           (uint)pbVar15[0xc] &lt;&lt; 0x18 | (uint)pbVar15[0xd] &lt;&lt; 0x10 | (uint)pbVar15[0xf] |</pre>
<pre>           (uint)pbVar15[0xe] &lt;&lt; 8;</pre>
<pre>      *(uint *)(param_4 + 0x284) =</pre>
<pre>           (uint)pbVar15[0x10] &lt;&lt; 0x18 | (uint)pbVar15[0x11] &lt;&lt; 0x10 | (uint)pbVar15[0x13] |</pre>
<pre>           (uint)pbVar15[0x12] &lt;&lt; 8;</pre>
<pre>      return true;</pre>
<pre>    }</pre>
<pre>LAB_004200c8:</pre>
<pre>    bVar6 = false;</pre>
<pre>  }</pre>
<pre>  else {</pre>
<pre>    if (uVar3 &lt; 7) {</pre>
<pre>      if (uVar3 == 1) {</pre>
<pre>        if (pbVar15 == (byte *)0x4) {</pre>
<pre>          *(byte *)(param_4 + 0x74) = *(byte *)param_2;</pre>
<pre>          *(byte *)(param_4 + 0x75) = *(byte *)((int)param_2 + 1);</pre>
<pre>          *(byte *)(param_4 + 0x76) = *(byte *)(param_2 + 1);</pre>
<pre>          *(byte *)(param_4 + 0x77) = *(byte *)((int)param_2 + 3);</pre>
<pre>          return true;</pre>
<pre>        }</pre>
<pre>        goto LAB_004200c8;</pre>
<pre>      }</pre>
<pre>      if (uVar3 == 0) goto LAB_004200a4;</pre>
<pre>    }</pre>
<pre>    else if (9 &lt; uVar3) goto LAB_004200a4;</pre>
<pre>LAB_0041e7b8:</pre>
<pre>    if (param_1 == 0) {</pre>
<pre>      puVar10 = param_2;</pre>
<pre>      do {</pre>
<pre>        if (param_2 + 0x80 &lt;= puVar10) {</pre>
<pre>          *(undefined *)(param_4 + 0x74) = 0;</pre>
<pre>          goto LAB_0041e854;</pre>
<pre>        }</pre>
<pre>        uVar3 = (uint)*(byte *)puVar10;</pre>
<pre>        if (0x3f &lt; uVar3) {</pre>
<pre>          *(undefined *)(param_4 + 0x74) = 0;</pre>
<pre>          goto LAB_0041e854;</pre>
<pre>        }</pre>
<pre>        puVar10 = (ushort *)((int)puVar10 + uVar3 + 1);</pre>
<pre>      } while (uVar3 != 0);</pre>
<pre>      uVar3 = (uint)((int)puVar10 + (-(int)param_2 - (uVar3 + 1)) + 1) &amp; 0xffff;</pre>
<pre>      if (uVar3 &lt; 0x101) {</pre>
<pre>        mDNSPlatformMemCopy(pbVar13,param_2,uVar3);</pre>
<pre>      }</pre>
<pre>      else {</pre>
<pre>        *(undefined *)(param_4 + 0x74) = 0;</pre>
<pre>      }</pre>
<pre>LAB_0041e854:</pre>
<pre>      pbVar15 = pbVar13;</pre>
<pre>      do {</pre>
<pre>        if ((byte *)(param_4 + 0x174) &lt;= pbVar15) {</pre>
<pre>LAB_0041e894:</pre>
<pre>          uVar3 = 0x101;</pre>
<pre>          goto LAB_0041e898;</pre>
<pre>        }</pre>
<pre>        uVar3 = (uint)*pbVar15;</pre>
<pre>        if (0x3f &lt; uVar3) goto LAB_0041e894;</pre>
<pre>        pbVar15 = pbVar15 + uVar3 + 1;</pre>
<pre>      } while (uVar3 != 0);</pre>
<pre>      uVar3 = (uint)(pbVar15 + (-(int)pbVar13 - (uVar3 + 1)) + 1) &amp; 0xffff;</pre>
<pre>LAB_0041e898:</pre>
<pre>      param_2 = (ushort *)((int)param_2 + uVar3);</pre>
<pre>    }</pre>
<pre>    else {</pre>
<pre>      param_2 = (ushort *)FUN_0041b774(param_1,param_2,param_3,pbVar13);</pre>
<pre>    }</pre>
<pre>    bVar6 = param_2 == param_3;</pre>
<pre>  }</pre>
<pre>  return bVar6;</pre>
<pre>}</pre>
<br />
  <!-- content end -->
</div>

<a href="https://github.com/e-m-b-a/emba" title="github.com/e-m-b-a/emba" target="_blank">
  <div id="buttonInfo" class="rectButtonVisible">
    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" transform="translate(2 2)"><g stroke="white" stroke-linecap="round" stroke-linejoin="round"><circle cx="8.5" cy="8.5" r="8"/><path d="M8.5 12.5v-4h-1"/><path d="M7.5 12.5h2"/></g><circle cx="8.5" cy="5.5" fill="white" r="1"/></g></svg>
  </div>
</a>
<div id="buttonBack" class="nonClickable rectButtonVisible"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><path d="M9.5 14.5l4-4l-4-4" fill="none" stroke="#444" stroke-linecap="round" stroke-linejoin="round"/></svg></div>
<div id="buttonForward" class="nonClickable rectButtonVisible"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><path d="M11.5 14.5l-4-4l4-4" fill="none" stroke="#444" stroke-linecap="round" stroke-linejoin="round"/></svg></div> 
<div id="buttonDown" class="rectButton" onclick="scrollDown()"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="#fff" stroke-linecap="round" stroke-linejoin="round"><path d="M14.5 6.5l-4 4l-4-4"/><path d="M14.5 10.5l-4 4l-4-4"/></g></svg></div>
<div id="buttonUp" class="rectButton" onclick="scrollUp()"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="#fff" stroke-linecap="round" stroke-linejoin="round"><path d="M6.5 14.5l4-4l4 4"/><path d="M6.5 10.5l4-4l4 4"/></g></svg></div> 

<script>
window.onload = function () {
  var buttons = document.getElementsByClassName("rectButton");
  for (let i=0; i<buttons.length; i++) {
    buttons[i].style.visibility = "visible";
  }
  var buttonDown = document.getElementById("buttonDown");
  buttonDown.classList.add('rectButtonVisible');
  buttonDown.classList.remove('rectButton');

  var buttonUp = document.getElementById("buttonUp");
  buttonUp.classList.add('rectButtonVisible');
  buttonUp.classList.remove('rectButton');
    
  var buttonSizer = document.getElementById("buttonSizer");
  buttonSizer.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="white" stroke-linecap="round" stroke-linejoin="round"><path d="M9.5 16.5v-4.978l-5-.022"/><path d="M18.5 2.5l-7 7"/><path d="M16.5 9.5l-5 .023V4.5"/><path d="M9.5 11.5l-7 7"/></g></svg>';
  if (document.getElementById("buttonTime") !== null) {
    var buttonTime = document.getElementById("buttonTime");
    buttonTime.style.bottom = "50px";
  }
  document.getElementById("expand").value = "+ Show more results";
  document.getElementById("expand").className += " expand";
  var embarkButton = document.getElementById("embark");
  if ( !(embarkButton.href.includes("embarkBackUrl")) ) {
    embarkButton.classList.remove('hidden');
    document.getElementById("logoImage").src = "./../../style/embark.svg";
    document.getElementById("logo").style.background = "#2d2d2d";
  }
}

function openNav() {
  document.getElementById("sidenav").style.width = "250px";
  document.getElementById("main").style.marginLeft = "250px";
  document.getElementById("nav").style.visibility = "visible";
}

function closeNav() {
  document.getElementById("sidenav").style.width = "50px";
  document.getElementById("sidenav").scrollTop = 0;
  document.getElementById("main").style.marginLeft = "50px";
  document.getElementById("nav").style.visibility = "hidden";
}

function scrollDown() {
  window.scrollTo(0,document.body.scrollHeight);
}

function scrollUp() {
  window.scrollTo(0,0);
}

function buttonNav() {
  var button = document.getElementById("buttonSizer");
  if ( button.classList.contains('buttonOpen') ) {
    button.classList.remove('buttonOpen');
    button.classList.add('buttonClose');
    button.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="white" stroke-linecap="round" stroke-linejoin="round"><path d="M9.5 16.5v-4.978l-5-.022"/><path d="M18.5 2.5l-7 7"/><path d="M16.5 9.5l-5 .023V4.5"/><path d="M9.5 11.5l-7 7"/></g></svg>';
    openNav();
  } else if( button.classList.contains('buttonClose') ) {
    button.classList.remove('buttonClose');
    button.classList.add('buttonOpen');
    button.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="white" stroke-linecap="round" stroke-linejoin="round"><path d="M18.5 7.5v-5h-5"/><path d="M18.5 2.5l-6 5.929"/><path d="M7.5 18.5l-5 .023V13.5"/><path d="M8.5 12.5l-6 6"/></g></svg>';
    closeNav();
  };
}

// the following function is currently not used
// it is for future extensions
function overlay_output(link) {
  var rawfile = new XMLHttpRequest();
  rawfile.open('GET', link, false);
  rawfile.overrideMimeType("text");
  rawfile.onreadystatechange = function()
  {
    alert(rawfile.responseText);
    //console.log(rawfile.responseText);
  }
  rawfile.send(null);
}

document.onkeydown = function(e) {
    switch (e.keyCode) {
      case 37:
        document.getElementById("buttonForward").parentNode.click(); 
        break;
      case 39:
        document.getElementById("buttonBack").parentNode.click();       
        break;
    }
};
</script>

</body>
</html>
