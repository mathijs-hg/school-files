<!-- 
EMBA - EMBEDDED LINUX ANALYZER

Copyright 2020-2023 Siemens AG
Copyright 2020-2024 Siemens Energy AG

EMBA comes with ABSOLUTELY NO WARRANTY. This is free software, and you are
welcome to redistribute it under the terms of the GNU General Public License.
See LICENSE file for usage of this software.

EMBA is licensed under GPLv3

Author(s) and contributors from the EMBA project are listed here: https://github.com/e-m-b-a/emba/blob/master/CONTRIBUTORS.md
-->

<!-- Used icons: https://github.com/CoreyGinnivan/system-uicons -->
 
<!DOCTYPE html>
<html lang="en">
<head>
  <title>EMBA firmware report</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="./../../style/style.css" type="text/css">
  <link rel="icon" type="image/png" href="./../../style/favicon.png">
</head>
<body>

<div id="sidenav" class="side">
  <div id="logo">
    <a class="inherit" href="./../../index.html"><img class="inherit" id="logoImage" src="./../../style/emba.svg" alt="logo"></a>
  </div>
  <div id="nav">
      <a id="embark" class="hidden" href="{{ embarkBackUrl }}">&laquo; Back to EMBArk</a> <!-- nosem -->
      <a class="backButton" href="./../../index.html">&laquo; Back to main</a>
<a class="modul" href="./../semgrep_mDNSClientPosix.html" title="./../semgrep_mDNSClientPosix.html" >&laquo; Back to semgrep_mDNSClientPosix</a>
      <!-- navigation start -->
      <!-- navigation end -->
      <input id="expand" class="expand_njs hidden" type="button" value="More results:" onclick="this.value=this.value=='+ Show more results'?'- Hide more results':'+ Show more results';">
      <div class="expand_area">
        <!-- etc start -->
        <!-- etc end -->
      </div>
  </div>
  <a href="TIMELINK"><div id="buttonTimeInvisible" class="rectButton"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="white" stroke-linecap="round" stroke-linejoin="round" transform="matrix(-1 0 0 1 19 2)"><circle cx="8.5" cy="8.5" r="8"/><path d="M8.5 5.5v4H5"/></g></svg></div></a>
  <div id="buttonSizer" class="rectButton buttonClose" onclick="buttonNav()"></div>
</div>
<div id="main" class="main">
  <!-- content start -->
<br />
<pre>undefined4 FUN_00436018(int param_1)</pre>
<br />
<pre>{</pre>
<pre>  undefined4 *puVar1;</pre>
<pre>  ushort uVar2;</pre>
<pre>  bool bVar3;</pre>
<pre>  undefined4 *puVar4;</pre>
<pre>  int iVar5;</pre>
<pre>  undefined4 uVar6;</pre>
<pre>  int iVar7;</pre>
<pre>  undefined4 *puVar8;</pre>
<pre>  char *pcVar9;</pre>
<pre>  undefined *puVar10;</pre>
<pre>  uint uVar11;</pre>
<pre>  int iVar12;</pre>
<pre>  int iVar13;</pre>
<pre>  void *__ptr;</pre>
<pre>  void **ppvVar14;</pre>
<pre>  int iVar15;</pre>
<pre>  int iVar16;</pre>
<pre>  code *pcVar17;</pre>
<pre>  undefined *puVar18;</pre>
<pre>  undefined4 *local_1a0;</pre>
<pre>  undefined4 local_19c;</pre>
<pre>  undefined4 local_198;</pre>
<pre>  undefined4 local_194;</pre>
<pre>  uint local_190;</pre>
<pre>  undefined auStack_180 [4];</pre>
<pre>  int local_17c;</pre>
<pre>  int local_178;</pre>
<pre>  int local_174;</pre>
<pre>  int local_170;</pre>
<pre>  undefined4 local_16c;</pre>
<pre>  int local_168;</pre>
<pre>  undefined auStack_158 [256];</pre>
<pre>  undefined2 local_58 [2];</pre>
<pre>  undefined4 *local_54;</pre>
<pre>  int local_50;</pre>
<pre>  int local_4c;</pre>
<pre>  uint local_48;</pre>
<pre>  uint local_44;</pre>
<pre>  uint local_40;</pre>
<pre>  int local_3c;</pre>
<pre>  char *local_38;</pre>
<pre>  uint local_34;</pre>
<pre>  char *local_30;</pre>
<pre>  int local_2c;</pre>
<pre>  </pre>
<pre>  local_4c = *(int *)(param_1 + 0x2190);</pre>
<pre>  uDNS_SetupWABQueries();</pre>
<pre>  mDNS_Lock_(param_1,"uDNS_SetupDNSConfig");</pre>
<pre>  for (puVar4 = *(undefined4 **)(param_1 + 0x2190); puVar4 != (undefined4 *)0x0;</pre>
<pre>      puVar4 = (undefined4 *)*puVar4) {</pre>
<pre>    puVar4[0x4c] = 0;</pre>
<pre>    NumUnicastDNSServers = NumUnicastDNSServers + -1;</pre>
<pre>    puVar4[9] = puVar4[9] | 1;</pre>
<pre>  }</pre>
<pre>  for (puVar4 = *(undefined4 **)(param_1 + 0x2194); puVar4 != (undefined4 *)0x0;</pre>
<pre>      puVar4 = (undefined4 *)*puVar4) {</pre>
<pre>    puVar4[2] = puVar4[2] | 1;</pre>
<pre>  }</pre>
<pre>  iVar5 = mDNSPlatformSetDNSConfig(param_1,1,0,auStack_158,0,0,1);</pre>
<pre>  puVar4 = (undefined4 *)(param_1 + 0x2194);</pre>
<pre>  if (iVar5 == 0) {</pre>
<pre>    for (puVar4 = *(undefined4 **)(param_1 + 0x2190); puVar4 != (undefined4 *)0x0;</pre>
<pre>        puVar4 = (undefined4 *)*puVar4) {</pre>
<pre>      puVar4[0x4c] = 0;</pre>
<pre>      NumUnicastDNSServers = NumUnicastDNSServers + '\x01';</pre>
<pre>      puVar4[9] = puVar4[9] &amp; 0xfffffffe;</pre>
<pre>    }</pre>
<pre>    for (puVar4 = *(undefined4 **)(param_1 + 0x2194); puVar4 != (undefined4 *)0x0;</pre>
<pre>        puVar4 = (undefined4 *)*puVar4) {</pre>
<pre>      puVar4[2] = puVar4[2] &amp; 0xfffffffe;</pre>
<pre>    }</pre>
<pre>    mDNS_Unlock_(param_1,"uDNS_SetupDNSConfig");</pre>
<pre>    if (mDNS_LoggingEnabled == 0) {</pre>
<pre>      return 0;</pre>
<pre>    }</pre>
<pre>    iVar5 = 3;</pre>
<pre>    pcVar17 = LogMsgWithLevel;</pre>
<pre>    pcVar9 = "uDNS_SetupDNSConfig: No configuration change";</pre>
<pre>  }</pre>
<pre>  else {</pre>
<pre>    while (puVar8 = (undefined4 *)*puVar4, puVar8 != (undefined4 *)0x0) {</pre>
<pre>      if ((puVar8[2] &amp; 1) == 0) {</pre>
<pre>        puVar8[2] = puVar8[2] &amp; 0xfffffffd;</pre>
<pre>        puVar4 = (undefined4 *)*puVar4;</pre>
<pre>      }</pre>
<pre>      else {</pre>
<pre>        *puVar4 = *puVar8;</pre>
<pre>        mDNSPlatformMemFree(puVar8);</pre>
<pre>      }</pre>
<pre>    }</pre>
<pre>    bVar3 = false;</pre>
<pre>    for (puVar4 = *(undefined4 **)(param_1 + 0x2ac); puVar4 != (undefined4 *)0x0;</pre>
<pre>        puVar4 = (undefined4 *)*puVar4) {</pre>
<pre>      if ((*(short *)((int)puVar4 + 0x152) != 0) &amp;&amp; (puVar4[0xf] == 0)) {</pre>
<pre>        SetValidDNSServers(param_1,puVar4);</pre>
<pre>        *(undefined2 *)((int)puVar4 + 0xea) = 0;</pre>
<pre>        iVar5 = GetServerForQuestion(param_1,puVar4);</pre>
<pre>        iVar15 = puVar4[0x37];</pre>
<pre>        if (iVar15 == iVar5) {</pre>
<pre>          for (puVar8 = (undefined4 *)*puVar4; puVar8 != (undefined4 *)0x0;</pre>
<pre>              puVar8 = (undefined4 *)*puVar8) {</pre>
<pre>            if ((undefined4 *)puVar8[0xf] == puVar4) {</pre>
<pre>              puVar8[0x38] = puVar4[0x38];</pre>
<pre>              puVar8[0x39] = puVar4[0x39];</pre>
<pre>              puVar8[0x37] = puVar4[0x37];</pre>
<pre>            }</pre>
<pre>          }</pre>
<pre>        }</pre>
<pre>        else {</pre>
<pre>          if (mDNS_LoggingEnabled != 0) {</pre>
<pre>            if (iVar15 == 0) {</pre>
<pre>              uVar2 = 0;</pre>
<pre>              local_2c = 0;</pre>
<pre>            }</pre>
<pre>            else {</pre>
<pre>              uVar2 = *(ushort *)(iVar15 + 0x20);</pre>
<pre>              local_2c = iVar15 + 0xc;</pre>
<pre>            }</pre>
<pre>            local_38 = (char *)(iVar15 + 0x30);</pre>
<pre>            if (iVar15 == 0) {</pre>
<pre>              local_38 = "";</pre>
<pre>            }</pre>
<pre>            local_40 = (uint)(uVar2 &gt;&gt; 8);</pre>
<pre>            local_34 = uVar2 &amp; 0xff;</pre>
<pre>            if (iVar5 == 0) {</pre>
<pre>              uVar2 = 0;</pre>
<pre>              local_3c = 0;</pre>
<pre>            }</pre>
<pre>            else {</pre>
<pre>              uVar2 = *(ushort *)(iVar5 + 0x20);</pre>
<pre>              local_3c = iVar5 + 0xc;</pre>
<pre>            }</pre>
<pre>            local_48 = (uint)(uVar2 &gt;&gt; 8);</pre>
<pre>            local_30 = (char *)(iVar5 + 0x30);</pre>
<pre>            if (iVar5 == 0) {</pre>
<pre>              local_30 = "";</pre>
<pre>            }</pre>
<pre>            local_44 = uVar2 &amp; 0xff;</pre>
<pre>            uVar6 = DNSTypeName(*(undefined2 *)(puVar4 + 0x95));</pre>
<pre>            LogMsgWithLevel(3,</pre>
<pre>                            "uDNS_SetupDNSConfig: Updating DNS Server from %#a:%d (%##s) to %#a:%d (%##s) for question %##s (%s) (scope:%p)"</pre>
<pre>                            ,local_2c,local_40 &lt;&lt; 8 | local_34,local_38,local_3c,</pre>
<pre>                            local_48 &lt;&lt; 8 | local_44,local_30,puVar4 + 0x55,uVar6,puVar4[0x4d]);</pre>
<pre>          }</pre>
<pre>          local_30 = (char *)(uint)*(byte *)(puVar4 + 0x2f);</pre>
<pre>          uVar11 = FUN_00427d54(param_1,puVar4,iVar5);</pre>
<pre>          if (local_30 == (char *)uVar11) {</pre>
<pre>            DNSServerChangeForQuestion(param_1,puVar4,iVar5);</pre>
<pre>            *(undefined *)(puVar4 + 0x3b) = 0;</pre>
<pre>            mDNS_NewMessageID(local_58,param_1);</pre>
<pre>            *(undefined2 *)((int)puVar4 + 0x152) = local_58[0];</pre>
<pre>            if (((*(char *)(puVar4 + 0x97) == '\0') || (*(char *)(puVar4 + 0x2f) == '\0')) &amp;&amp;</pre>
<pre>               (*(char *)((int)puVar4 + 0x12e) == '\0')) {</pre>
<pre>              FUN_0042c3ac(param_1,puVar4,1);</pre>
<pre>              for (puVar8 = (undefined4 *)*puVar4; puVar8 != (undefined4 *)0x0;</pre>
<pre>                  puVar8 = (undefined4 *)*puVar8) {</pre>
<pre>                if ((undefined4 *)puVar8[0xf] == puVar4) {</pre>
<pre>                  FUN_0042c3ac(param_1,puVar8,1);</pre>
<pre>                }</pre>
<pre>              }</pre>
<pre>            }</pre>
<pre>          }</pre>
<pre>          else {</pre>
<pre>            *(char *)(puVar4 + 0x2f) = (char)uVar11;</pre>
<pre>            *(undefined *)((int)puVar4 + 0x113) = 1;</pre>
<pre>            for (puVar8 = (undefined4 *)*puVar4; bVar3 = true, puVar8 != (undefined4 *)0x0;</pre>
<pre>                puVar8 = (undefined4 *)*puVar8) {</pre>
<pre>              if ((undefined4 *)puVar8[0xf] == puVar4) {</pre>
<pre>                *(undefined *)((int)puVar8 + 0x113) = 1;</pre>
<pre>              }</pre>
<pre>            }</pre>
<pre>          }</pre>
<pre>        }</pre>
<pre>      }</pre>
<pre>    }</pre>
<pre>    if (bVar3) {</pre>
<pre>      iVar5 = *(int *)(param_1 + 0x2c0);</pre>
<pre>      local_1a0 = (undefined4 *)0x0;</pre>
<pre>      if (iVar5 != 0) {</pre>
<pre>        uVar6 = DNSTypeName(*(undefined2 *)(iVar5 + 0x254));</pre>
<pre>        LogMsgWithLevel(0,</pre>
<pre>                        "RestartUnicastQuestions: ERROR!! m-&gt;RestartQuestion already set: %##s (%s)"</pre>
<pre>                        ,iVar5 + 0x154,uVar6);</pre>
<pre>      }</pre>
<pre>      *(undefined4 *)(param_1 + 0x2c0) = *(undefined4 *)(param_1 + 0x2ac);</pre>
<pre>      while (puVar4 = *(undefined4 **)(param_1 + 0x2c0), puVar4 != (undefined4 *)0x0) {</pre>
<pre>        *(undefined4 *)(param_1 + 0x2c0) = *puVar4;</pre>
<pre>        if (*(char *)((int)puVar4 + 0x113) != '\0') {</pre>
<pre>          if (*(short *)((int)puVar4 + 0x152) == 0) {</pre>
<pre>            uVar6 = DNSTypeName(*(undefined2 *)(puVar4 + 0x95));</pre>
<pre>            LogMsgWithLevel(0,</pre>
<pre>                            "RestartUnicastQuestions: ERROR!! Restart set for multicast question %##s (%s)"</pre>
<pre>                            ,puVar4 + 0x55,uVar6);</pre>
<pre>          }</pre>
<pre>          *(undefined *)((int)puVar4 + 0x113) = 0;</pre>
<pre>          FUN_00435ef0(param_1,puVar4,&amp;local_1a0);</pre>
<pre>        }</pre>
<pre>      }</pre>
<pre>      while (puVar4 = local_1a0, local_1a0 != (undefined4 *)0x0) {</pre>
<pre>        puVar8 = (undefined4 *)*local_1a0;</pre>
<pre>        *local_1a0 = 0;</pre>
<pre>        if (mDNS_LoggingEnabled != 0) {</pre>
<pre>          puVar1 = local_1a0 + 0x95;</pre>
<pre>          local_1a0 = puVar8;</pre>
<pre>          uVar6 = DNSTypeName(*(undefined2 *)puVar1,puVar4);</pre>
<pre>          LogMsgWithLevel(3,"RestartUnicastQuestions: Start question %p %##s (%s)",puVar4,</pre>
<pre>                          puVar4 + 0x55,uVar6);</pre>
<pre>          puVar8 = local_1a0;</pre>
<pre>        }</pre>
<pre>        local_1a0 = puVar8;</pre>
<pre>        mDNS_StartQuery_internal(param_1,puVar4);</pre>
<pre>      }</pre>
<pre>    }</pre>
<pre>    local_50 = param_1 + 0x7cc;</pre>
<pre>    iVar15 = param_1 + 0x2f;</pre>
<pre>    iVar5 = param_1;</pre>
<pre>    do {</pre>
<pre>      for (local_54 = *(undefined4 **)(iVar5 + 0x2e0); local_54 != (undefined4 *)0x0;</pre>
<pre>          local_54 = (undefined4 *)*local_54) {</pre>
<pre>        for (puVar4 = (undefined4 *)local_54[2]; puVar4 != (undefined4 *)0x0;</pre>
<pre>            puVar4 = (undefined4 *)*puVar4) {</pre>
<pre>          if (puVar4[7] == 0) {</pre>
<pre>            iVar16 = puVar4[0x11];</pre>
<pre>            local_30 = (char *)puVar4[8];</pre>
<pre>            iVar13 = 0;</pre>
<pre>            if (iVar16 == 0) {</pre>
<pre>              uVar6 = 0xffffffff;</pre>
<pre>            }</pre>
<pre>            else {</pre>
<pre>              uVar6 = *(undefined4 *)(iVar16 + 0x130);</pre>
<pre>              iVar13 = *(int *)(iVar16 + 0x134);</pre>
<pre>            }</pre>
<pre>            if ((iVar13 == -3) || (iVar13 == -2)) {</pre>
<pre>              iVar13 = 0;</pre>
<pre>            }</pre>
<pre>            else if (iVar13 != 0) {</pre>
<pre>              for (puVar8 = *(undefined4 **)(param_1 + 0x2174); puVar8 != (undefined4 *)0x0;</pre>
<pre>                  puVar8 = (undefined4 *)*puVar8) {</pre>
<pre>                if (puVar8[0x548] == iVar13) {</pre>
<pre>                  puVar10 = (undefined *)((int)puVar8 + 0x1552);</pre>
<pre>                  goto LAB_00436674;</pre>
<pre>                }</pre>
<pre>              }</pre>
<pre>            }</pre>
<pre>            puVar10 = (undefined *)0x0;</pre>
<pre>LAB_00436674:</pre>
<pre>            local_198 = 0xffffffff;</pre>
<pre>            local_19c = 0xffffffff;</pre>
<pre>            puVar18 = (undefined *)0xffffffff;</pre>
<pre>            iVar16 = 0;</pre>
<pre>            uVar11 = 1;</pre>
<pre>            iVar12 = FUN_0042820c(param_1,local_30,iVar13,uVar6,0xffffffff,0xffffffff,0,1);</pre>
<pre>            if (iVar12 == 0) {</pre>
<pre>              if (mDNS_LoggingEnabled != 0) {</pre>
<pre>                if (puVar10 == (undefined *)0x0) {</pre>
<pre>                  puVar10 = &amp;DAT_00455450;</pre>
<pre>                }</pre>
<pre>                LogMsgWithLevel(3,</pre>
<pre>                                "GetServerForName: no DNS server (Scope %s:%p) found for name %##s",</pre>
<pre>                                puVar10,iVar13,local_30);</pre>
<pre>              }</pre>
<pre>            }</pre>
<pre>            else {</pre>
<pre>              iVar7 = 0;</pre>
<pre>              if (mDNS_LoggingEnabled != 0) {</pre>
<pre>                if (*(int *)(iVar12 + 0x130) != 0) {</pre>
<pre>                  iVar7 = *(int *)(iVar12 + 0x130) - *(int *)(param_1 + 0x234);</pre>
<pre>                }</pre>
<pre>                puVar18 = puVar10;</pre>
<pre>                if (puVar10 == (undefined *)0x0) {</pre>
<pre>                  puVar18 = &amp;DAT_00455450;</pre>
<pre>                }</pre>
<pre>                uVar11 = (uint)local_30;</pre>
<pre>                LogMsgWithLevel(3,</pre>
<pre>                                "GetServerForName: DNS server %#a:%d (Penalty Time Left %d) (Scope %s:%p) found for name %##s"</pre>
<pre>                                ,iVar12 + 0xc,</pre>
<pre>                                (uint)(*(ushort *)(iVar12 + 0x20) &gt;&gt; 8) &lt;&lt; 8 |</pre>
<pre>                                *(ushort *)(iVar12 + 0x20) &amp; 0xff,iVar7,puVar18,iVar13,local_30);</pre>
<pre>                iVar16 = iVar13;</pre>
<pre>              }</pre>
<pre>              if (iVar12 != puVar4[10]) {</pre>
<pre>                iVar13 = puVar4[0x11];</pre>
<pre>                if (((iVar13 == 0) || (*(char *)(iVar13 + 0x266) != '\0')) ||</pre>
<pre>                   ((*(char *)(iVar13 + 0xcc) != '\0' ||</pre>
<pre>                    ((*(char *)(iVar13 + 0x267) != '\0' &amp;&amp; (*(char *)(iVar13 + 0x268) != '\0'))))))</pre>
<pre>                {</pre>
<pre>                  if (mDNS_LoggingEnabled != 0) {</pre>
<pre>                    uVar6 = GetRRDisplayString_rdb(puVar4 + 1,puVar4[9] + 4,iVar15);</pre>
<pre>                    iVar13 = puVar4[10] + 0xc;</pre>
<pre>                    if (puVar4[10] == 0) {</pre>
<pre>                      iVar13 = 0;</pre>
<pre>                    }</pre>
<pre>                    LogMsgWithLevel(3,</pre>
<pre>                                    "uDNS_SetupDNSConfig: Purging Resourcerecord %s, New DNS server %#a , Old DNS server %#a"</pre>
<pre>                                    ,uVar6,iVar12 + 0xc,iVar13,puVar18,iVar16,uVar11);</pre>
<pre>                  }</pre>
<pre>                  mDNS_PurgeCacheResourceRecord(param_1,puVar4);</pre>
<pre>                }</pre>
<pre>                else {</pre>
<pre>                  if (mDNS_LoggingEnabled != 0) {</pre>
<pre>                    uVar6 = GetRRDisplayString_rdb(puVar4 + 1,puVar4[9] + 4,iVar15);</pre>
<pre>                    iVar13 = puVar4[10] + 0xc;</pre>
<pre>                    if (puVar4[10] == 0) {</pre>
<pre>                      iVar13 = 0;</pre>
<pre>                    }</pre>
<pre>                    LogMsgWithLevel(3,</pre>
<pre>                                    "uDNS_SetupDNSConfig: Purging/Reconfirming Resourcerecord %s, New DNS server %#a, Old DNS server %#a"</pre>
<pre>                                    ,uVar6,iVar12 + 0xc,iVar13,puVar18,iVar16,uVar11);</pre>
<pre>                  }</pre>
<pre>                  FUN_004292f4(param_1,puVar4,iVar12,0);</pre>
<pre>                }</pre>
<pre>              }</pre>
<pre>            }</pre>
<pre>          }</pre>
<pre>        }</pre>
<pre>      }</pre>
<pre>      iVar5 = iVar5 + 4;</pre>
<pre>      ppvVar14 = (void **)(param_1 + 0x2190);</pre>
<pre>    } while (iVar5 != local_50);</pre>
<pre>    while (__ptr = *ppvVar14, __ptr != (void *)0x0) {</pre>
<pre>      if ((*(uint *)((int)__ptr + 0x24) &amp; 1) == 0) {</pre>
<pre>        *(uint *)((int)__ptr + 0x24) = *(uint *)((int)__ptr + 0x24) &amp; 0xfffffffd;</pre>
<pre>        ppvVar14 = (void **)*ppvVar14;</pre>
<pre>      }</pre>
<pre>      else {</pre>
<pre>        iVar16 = (int)__ptr + 0xc;</pre>
<pre>        iVar5 = param_1;</pre>
<pre>        do {</pre>
<pre>          for (local_54 = *(undefined4 **)(iVar5 + 0x2e0); local_54 != (undefined4 *)0x0;</pre>
<pre>              local_54 = (undefined4 *)*local_54) {</pre>
<pre>            for (puVar4 = (undefined4 *)local_54[2]; puVar4 != (undefined4 *)0x0;</pre>
<pre>                puVar4 = (undefined4 *)*puVar4) {</pre>
<pre>              if ((puVar4[7] == 0) &amp;&amp; ((void *)puVar4[10] == __ptr)) {</pre>
<pre>                iVar13 = puVar4[0x11];</pre>
<pre>                if (iVar13 == 0) {</pre>
<pre>                  if (mDNS_LoggingEnabled != 0) {</pre>
<pre>                    LogMsgWithLevel(3,</pre>
<pre>                                    "uDNS_SetupDNSConfig: Cache Record %##s has no Active question, Record\'s DNSServer Address %#a, Server to be deleted %#a"</pre>
<pre>                                    ,puVar4[8],iVar16,iVar16);</pre>
<pre>                  }</pre>
<pre>LAB_00436a44:</pre>
<pre>                  puVar4[10] = 0;</pre>
<pre>                }</pre>
<pre>                else {</pre>
<pre>                  if (*(void **)(iVar13 + 0xdc) == __ptr) {</pre>
<pre>                    local_2c = GetRRDisplayString_rdb(puVar4 + 1,puVar4[9] + 4,iVar15);</pre>
<pre>                    uVar6 = DNSTypeName(*(undefined2 *)(iVar13 + 0x254));</pre>
<pre>                    LogMsgWithLevel(0,</pre>
<pre>                                    "uDNS_SetupDNSConfig: ERROR!! Cache Record %s  Active question %##s (%s) (scope:%p) poining to DNSServer Address %#a to be freed"</pre>
<pre>                                    ,local_2c,iVar13 + 0x154,uVar6,*(undefined4 *)(iVar13 + 0x134),</pre>
<pre>                                    iVar16);</pre>
<pre>                    *(undefined4 *)(iVar13 + 0xdc) = 0;</pre>
<pre>                    *(undefined4 *)(iVar13 + 0xe0) = 0;</pre>
<pre>                    *(undefined4 *)(iVar13 + 0xe4) = 0;</pre>
<pre>                    goto LAB_00436a44;</pre>
<pre>                  }</pre>
<pre>                  if (mDNS_LoggingEnabled != 0) {</pre>
<pre>                    local_2c = GetRRDisplayString_rdb(puVar4 + 1,puVar4[9] + 4,iVar15);</pre>
<pre>                    uVar6 = DNSTypeName(*(undefined2 *)(iVar13 + 0x254));</pre>
<pre>                    iVar12 = *(int *)(iVar13 + 0xdc) + 0xc;</pre>
<pre>                    if (*(int *)(iVar13 + 0xdc) == 0) {</pre>
<pre>                      iVar12 = 0;</pre>
<pre>                    }</pre>
<pre>                    LogMsgWithLevel(3,</pre>
<pre>                                    "uDNS_SetupDNSConfig: Cache Record %s,  Active question %##s (%s) (scope:%p), pointing to DNSServer %#a (to be deleted), resetting to  question\'s DNSServer Address %#a"</pre>
<pre>                                    ,local_2c,iVar13 + 0x154,uVar6,*(undefined4 *)(iVar13 + 0x134),</pre>
<pre>                                    iVar16,iVar12);</pre>
<pre>                  }</pre>
<pre>                  puVar4[10] = *(undefined4 *)(iVar13 + 0xdc);</pre>
<pre>                }</pre>
<pre>                FUN_004292f4(param_1,puVar4,__ptr,1);</pre>
<pre>              }</pre>
<pre>            }</pre>
<pre>          }</pre>
<pre>          iVar5 = iVar5 + 4;</pre>
<pre>        } while (iVar5 != local_50);</pre>
<pre>                    /* WARNING: Load size is inaccurate */</pre>
<pre>        *ppvVar14 = **ppvVar14;</pre>
<pre>        if (mDNS_LoggingEnabled != 0) {</pre>
<pre>          LogMsgWithLevel(3,"uDNS_SetupDNSConfig: Deleting server %p %#a:%d (%##s) %d",__ptr,iVar16,</pre>
<pre>                          *(undefined2 *)((int)__ptr + 0x20),(int)__ptr + 0x30,NumUnicastDNSServers)</pre>
<pre>          ;</pre>
<pre>        }</pre>
<pre>        mDNSPlatformMemFree(__ptr);</pre>
<pre>      }</pre>
<pre>    }</pre>
<pre>    uVar11 = 0;</pre>
<pre>    iVar5 = param_1;</pre>
<pre>    if ((local_4c != 0) != (*(int *)(param_1 + 0x2190) != 0)) {</pre>
<pre>      do {</pre>
<pre>        for (puVar4 = *(undefined4 **)(iVar5 + 0x2e0); puVar4 != (undefined4 *)0x0;</pre>
<pre>            puVar4 = (undefined4 *)*puVar4) {</pre>
<pre>          for (puVar8 = (undefined4 *)puVar4[2]; puVar8 != (undefined4 *)0x0;</pre>
<pre>              puVar8 = (undefined4 *)*puVar8) {</pre>
<pre>            if (puVar8[7] == 0) {</pre>
<pre>              local_34 = uVar11 + 1;</pre>
<pre>              mDNS_PurgeCacheResourceRecord(param_1,puVar8);</pre>
<pre>              uVar11 = local_34;</pre>
<pre>            }</pre>
<pre>          }</pre>
<pre>        }</pre>
<pre>        iVar5 = iVar5 + 4;</pre>
<pre>      } while (iVar5 != local_50);</pre>
<pre>      if (mDNS_LoggingEnabled != 0) {</pre>
<pre>        if (*(int *)(param_1 + 0x2190) == 0) {</pre>
<pre>          pcVar9 = "No DNS servers";</pre>
<pre>        }</pre>
<pre>        else {</pre>
<pre>          pcVar9 = "DNS server became";</pre>
<pre>        }</pre>
<pre>        LogMsgWithLevel(3,</pre>
<pre>                        "uDNS_SetupDNSConfig: %s available; purged %d unicast DNS records from cache"</pre>
<pre>                        ,pcVar9);</pre>
<pre>      }</pre>
<pre>      FUN_0042c704(param_1);</pre>
<pre>    }</pre>
<pre>    iVar5 = param_1 + 0x27f8;</pre>
<pre>    iVar15 = SameDomainName(auStack_158,iVar5);</pre>
<pre>    if (iVar15 == 0) {</pre>
<pre>      if (*(char *)(param_1 + 0x27f8) != '\0') {</pre>
<pre>        mDNS_RemoveDynDNSHostName(param_1,iVar5);</pre>
<pre>      }</pre>
<pre>      uVar11 = DomainNameLengthLimit(auStack_158,local_58);</pre>
<pre>      if (uVar11 &lt; 0x101) {</pre>
<pre>        mDNSPlatformMemCopy((void *)(param_1 + 0x27f8),auStack_158,uVar11);</pre>
<pre>      }</pre>
<pre>      else {</pre>
<pre>        *(undefined *)(param_1 + 0x27f8) = 0;</pre>
<pre>      }</pre>
<pre>      if (*(char *)(param_1 + 0x27f8) != '\0') {</pre>
<pre>        mDNSPlatformDynDNSHostNameStatusChanged(iVar5,1);</pre>
<pre>        mDNS_AddDynDNSHostName(param_1,iVar5,FUN_00427d38,0);</pre>
<pre>      }</pre>
<pre>    }</pre>
<pre>    mDNS_Unlock_(param_1,"uDNS_SetupDNSConfig");</pre>
<pre>    puVar4 = &amp;local_194;</pre>
<pre><span class="green"><span class="green">    memcpy(&amp;local_16c,zeroAddr,0x14)</span></span></span></pre>
<pre><span class="green"><span class="green">    memcpy(auStack_180,&amp;local_16c,0x14)</span></span></span></pre>
<pre><span class="green"><span class="green">    memcpy(puVar4,auStack_180,0x14)</span></span></span></pre>
<pre>    local_194 = 4;</pre>
<pre>    local_16c = 4;</pre>
<pre>    iVar15 = mDNSPlatformGetPrimaryInterface(param_1,puVar4,auStack_180,&amp;local_16c);</pre>
<pre>    if (iVar15 == 0) {</pre>
<pre>      if (local_190 == 0) {</pre>
<pre>        puVar4 = (undefined4 *)0x0;</pre>
<pre>      }</pre>
<pre>      if ((local_190 &amp; 0xffff0000) != 0xa9fe0000) {</pre>
<pre>        if ((local_178 != 0) ||</pre>
<pre>           (((puVar10 = auStack_180, local_17c == 0 &amp;&amp; (local_174 == 0)) &amp;&amp;</pre>
<pre>            (puVar10 = (undefined *)0x0, local_170 != 0)))) {</pre>
<pre>          puVar10 = auStack_180;</pre>
<pre>        }</pre>
<pre>        puVar8 = &amp;local_16c;</pre>
<pre>        if (local_168 == 0) {</pre>
<pre>          puVar8 = (undefined4 *)0x0;</pre>
<pre>        }</pre>
<pre>        mDNS_SetPrimaryInterfaceInfo(param_1,puVar4,puVar10,puVar8);</pre>
<pre>        return 0;</pre>
<pre>      }</pre>
<pre>    }</pre>
<pre>    mDNS_SetPrimaryInterfaceInfo(param_1,0,0,0);</pre>
<pre>    if (*(char *)(param_1 + 0x27f8) == '\0') {</pre>
<pre>      return 0;</pre>
<pre>    }</pre>
<pre>    pcVar17 = mDNSPlatformDynDNSHostNameStatusChanged;</pre>
<pre>    pcVar9 = (char *)0x1;</pre>
<pre>  }</pre>
<pre>  (*pcVar17)(iVar5,pcVar9);</pre>
<pre>  return 0;</pre>
<pre>}</pre>
<br />
  <!-- content end -->
</div>

<a href="https://github.com/e-m-b-a/emba" title="github.com/e-m-b-a/emba" target="_blank">
  <div id="buttonInfo" class="rectButtonVisible">
    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" transform="translate(2 2)"><g stroke="white" stroke-linecap="round" stroke-linejoin="round"><circle cx="8.5" cy="8.5" r="8"/><path d="M8.5 12.5v-4h-1"/><path d="M7.5 12.5h2"/></g><circle cx="8.5" cy="5.5" fill="white" r="1"/></g></svg>
  </div>
</a>
<div id="buttonBack" class="nonClickable rectButtonVisible"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><path d="M9.5 14.5l4-4l-4-4" fill="none" stroke="#444" stroke-linecap="round" stroke-linejoin="round"/></svg></div>
<div id="buttonForward" class="nonClickable rectButtonVisible"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><path d="M11.5 14.5l-4-4l4-4" fill="none" stroke="#444" stroke-linecap="round" stroke-linejoin="round"/></svg></div> 
<div id="buttonDown" class="rectButton" onclick="scrollDown()"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="#fff" stroke-linecap="round" stroke-linejoin="round"><path d="M14.5 6.5l-4 4l-4-4"/><path d="M14.5 10.5l-4 4l-4-4"/></g></svg></div>
<div id="buttonUp" class="rectButton" onclick="scrollUp()"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="#fff" stroke-linecap="round" stroke-linejoin="round"><path d="M6.5 14.5l4-4l4 4"/><path d="M6.5 10.5l4-4l4 4"/></g></svg></div> 

<script>
window.onload = function () {
  var buttons = document.getElementsByClassName("rectButton");
  for (let i=0; i<buttons.length; i++) {
    buttons[i].style.visibility = "visible";
  }
  var buttonDown = document.getElementById("buttonDown");
  buttonDown.classList.add('rectButtonVisible');
  buttonDown.classList.remove('rectButton');

  var buttonUp = document.getElementById("buttonUp");
  buttonUp.classList.add('rectButtonVisible');
  buttonUp.classList.remove('rectButton');
    
  var buttonSizer = document.getElementById("buttonSizer");
  buttonSizer.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="white" stroke-linecap="round" stroke-linejoin="round"><path d="M9.5 16.5v-4.978l-5-.022"/><path d="M18.5 2.5l-7 7"/><path d="M16.5 9.5l-5 .023V4.5"/><path d="M9.5 11.5l-7 7"/></g></svg>';
  if (document.getElementById("buttonTime") !== null) {
    var buttonTime = document.getElementById("buttonTime");
    buttonTime.style.bottom = "50px";
  }
  document.getElementById("expand").value = "+ Show more results";
  document.getElementById("expand").className += " expand";
  var embarkButton = document.getElementById("embark");
  if ( !(embarkButton.href.includes("embarkBackUrl")) ) {
    embarkButton.classList.remove('hidden');
    document.getElementById("logoImage").src = "./../../style/embark.svg";
    document.getElementById("logo").style.background = "#2d2d2d";
  }
}

function openNav() {
  document.getElementById("sidenav").style.width = "250px";
  document.getElementById("main").style.marginLeft = "250px";
  document.getElementById("nav").style.visibility = "visible";
}

function closeNav() {
  document.getElementById("sidenav").style.width = "50px";
  document.getElementById("sidenav").scrollTop = 0;
  document.getElementById("main").style.marginLeft = "50px";
  document.getElementById("nav").style.visibility = "hidden";
}

function scrollDown() {
  window.scrollTo(0,document.body.scrollHeight);
}

function scrollUp() {
  window.scrollTo(0,0);
}

function buttonNav() {
  var button = document.getElementById("buttonSizer");
  if ( button.classList.contains('buttonOpen') ) {
    button.classList.remove('buttonOpen');
    button.classList.add('buttonClose');
    button.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="white" stroke-linecap="round" stroke-linejoin="round"><path d="M9.5 16.5v-4.978l-5-.022"/><path d="M18.5 2.5l-7 7"/><path d="M16.5 9.5l-5 .023V4.5"/><path d="M9.5 11.5l-7 7"/></g></svg>';
    openNav();
  } else if( button.classList.contains('buttonClose') ) {
    button.classList.remove('buttonClose');
    button.classList.add('buttonOpen');
    button.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="white" stroke-linecap="round" stroke-linejoin="round"><path d="M18.5 7.5v-5h-5"/><path d="M18.5 2.5l-6 5.929"/><path d="M7.5 18.5l-5 .023V13.5"/><path d="M8.5 12.5l-6 6"/></g></svg>';
    closeNav();
  };
}

// the following function is currently not used
// it is for future extensions
function overlay_output(link) {
  var rawfile = new XMLHttpRequest();
  rawfile.open('GET', link, false);
  rawfile.overrideMimeType("text");
  rawfile.onreadystatechange = function()
  {
    alert(rawfile.responseText);
    //console.log(rawfile.responseText);
  }
  rawfile.send(null);
}

document.onkeydown = function(e) {
    switch (e.keyCode) {
      case 37:
        document.getElementById("buttonForward").parentNode.click(); 
        break;
      case 39:
        document.getElementById("buttonBack").parentNode.click();       
        break;
    }
};
</script>

</body>
</html>
