<!-- 
EMBA - EMBEDDED LINUX ANALYZER

Copyright 2020-2023 Siemens AG
Copyright 2020-2024 Siemens Energy AG

EMBA comes with ABSOLUTELY NO WARRANTY. This is free software, and you are
welcome to redistribute it under the terms of the GNU General Public License.
See LICENSE file for usage of this software.

EMBA is licensed under GPLv3

Author(s) and contributors from the EMBA project are listed here: https://github.com/e-m-b-a/emba/blob/master/CONTRIBUTORS.md
-->

<!-- Used icons: https://github.com/CoreyGinnivan/system-uicons -->
 
<!DOCTYPE html>
<html lang="en">
<head>
  <title>EMBA firmware report</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="./../../style/style.css" type="text/css">
  <link rel="icon" type="image/png" href="./../../style/favicon.png">
</head>
<body>

<div id="sidenav" class="side">
  <div id="logo">
    <a class="inherit" href="./../../index.html"><img class="inherit" id="logoImage" src="./../../style/emba.svg" alt="logo"></a>
  </div>
  <div id="nav">
      <a id="embark" class="hidden" href="{{ embarkBackUrl }}">&laquo; Back to EMBArk</a> <!-- nosem -->
      <a class="backButton" href="./../../index.html">&laquo; Back to main</a>
<a class="modul" href="./../semgrep_iwcontrol.html" title="./../semgrep_iwcontrol.html" >&laquo; Back to semgrep_iwcontrol</a>
      <!-- navigation start -->
      <!-- navigation end -->
      <input id="expand" class="expand_njs hidden" type="button" value="More results:" onclick="this.value=this.value=='+ Show more results'?'- Hide more results':'+ Show more results';">
      <div class="expand_area">
        <!-- etc start -->
        <!-- etc end -->
      </div>
  </div>
  <a href="TIMELINK"><div id="buttonTimeInvisible" class="rectButton"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="white" stroke-linecap="round" stroke-linejoin="round" transform="matrix(-1 0 0 1 19 2)"><circle cx="8.5" cy="8.5" r="8"/><path d="M8.5 5.5v4H5"/></g></svg></div></a>
  <div id="buttonSizer" class="rectButton buttonClose" onclick="buttonNav()"></div>
</div>
<div id="main" class="main">
  <!-- content start -->
<br />
<pre>/* WARNING: Type propagation algorithm not settling */</pre>
<pre>/* WARNING: Could not reconcile some variable overlaps */</pre>
<br />
<pre>undefined4 FUN_00403bb8(int param_1,int param_2)</pre>
<br />
<pre>{</pre>
<pre>  bool bVar1;</pre>
<pre>  int iVar2;</pre>
<pre>  int iVar3;</pre>
<pre>  int iVar4;</pre>
<pre>  int *piVar5;</pre>
<pre>  int iVar6;</pre>
<pre>  size_t sVar7;</pre>
<pre>  FILE *pFVar8;</pre>
<pre>  undefined4 uVar9;</pre>
<pre>  char *pcVar10;</pre>
<pre>  char *pcVar11;</pre>
<pre>  char *pcVar12;</pre>
<pre>  char **ppcVar13;</pre>
<pre>  longlong lVar14;</pre>
<pre>  undefined8 local_a8;</pre>
<pre>  char *apcStack_a0 [4];</pre>
<pre>  char **local_90;</pre>
<pre>  undefined2 local_8c;</pre>
<pre>  ushort local_8a;</pre>
<pre>  char *local_80 [16];</pre>
<pre>  char **local_40;</pre>
<pre>  char *local_3c;</pre>
<pre>  undefined8 *local_38;</pre>
<pre>  undefined *local_34;</pre>
<pre>  undefined8 local_30;</pre>
<pre>  </pre>
<pre><span class="green">  iVar2 = sockets_open()</span></span></pre>
<pre>  if (iVar2 &lt; 0) {</pre>
<pre>    perror("socket");</pre>
<pre>    iVar2 = -1;</pre>
<pre>  }</pre>
<pre>  else {</pre>
<pre>    if (param_1 == 1) {</pre>
<pre>      FUN_00403adc(iVar2);</pre>
<pre>    }</pre>
<pre>    else {</pre>
<pre>      pcVar10 = *(char **)(param_2 + 4);</pre>
<pre>      iVar3 = strncmp(pcVar10,"-h",9);</pre>
<pre>      if ((iVar3 == 0) || (iVar3 = strcmp(pcVar10,"--help"), iVar3 == 0)) {</pre>
<pre>        FUN_00402830();</pre>
<pre>      }</pre>
<pre>      else {</pre>
<pre>        if (param_1 != 2) {</pre>
<pre>          param_1 = param_1 + -2;</pre>
<pre><span class="green"><span class="green"><span class="green">          strncpy((char *)apcStack_a0,pcVar10,0x10)</span></span></span></span></pre>
<pre>          param_2 = param_2 + 8;</pre>
<pre>          if (param_1 &lt; 1) {</pre>
<pre>            FUN_00402830();</pre>
<pre>          }</pre>
<pre>          iVar3 = 0;</pre>
<pre>LAB_00405684:</pre>
<pre>          do {</pre>
<pre>            while( true ) {</pre>
<pre>              if (param_1 &lt;= iVar3) {</pre>
<pre>                uVar9 = 0;</pre>
<pre>                goto LAB_00405694;</pre>
<pre>              }</pre>
<pre>              pcVar11 = *(char **)(param_2 + iVar3 * 4);</pre>
<pre>              iVar4 = strcasecmp(pcVar11,"nwid");</pre>
<pre>              if (iVar4 != 0) break;</pre>
<pre>LAB_00403d58:</pre>
<pre>              if (param_1 &lt;= iVar3 + 1) {</pre>
<pre>                FUN_00402830();</pre>
<pre>              }</pre>
<pre>              pcVar11 = *(char **)(param_2 + (iVar3 + 1) * 4);</pre>
<pre>              iVar4 = strcasecmp(pcVar11,"off");</pre>
<pre>              if (iVar4 == 0) {</pre>
<pre>LAB_00403dc0:</pre>
<pre>                local_8c = 1;</pre>
<pre>              }</pre>
<pre>              else {</pre>
<pre>                iVar4 = strcasecmp(pcVar11,"any");</pre>
<pre>                if (iVar4 == 0) goto LAB_00403dc0;</pre>
<pre>                iVar4 = strcasecmp(pcVar11,"on");</pre>
<pre>                if (iVar4 == 0) {</pre>
<pre>                  iVar4 = ioctl(iVar2,0x8b03,apcStack_a0);</pre>
<pre>                  pFVar8 = stderr;</pre>
<pre>                  if (iVar4 &lt; 0) {</pre>
<pre>                    piVar5 = __errno_location();</pre>
<pre>                    pcVar10 = strerror(*piVar5);</pre>
<pre>                    pcVar11 = "SIOCGIWNWID: %s\n";</pre>
<pre>                    goto LAB_00403f08;</pre>
<pre>                  }</pre>
<pre><span class="green"><span class="green"><span class="green">                  strncpy((char *)apcStack_a0,pcVar10,0x10)</span></span></span></span></pre>
<pre>                  local_8c = 0;</pre>
<pre>                }</pre>
<pre>                else {</pre>
<pre><span class="green">                  iVar4 = sscanf(pcVar11,"%lX",&amp;local_90)</span></span></pre>
<pre>                  if (iVar4 == 1) {</pre>
<pre>                    local_8c = 0;</pre>
<pre>                  }</pre>
<pre>                  else {</pre>
<pre>                    FUN_00402830();</pre>
<pre>                  }</pre>
<pre>                }</pre>
<pre>              }</pre>
<pre>              local_8c = CONCAT11(1,(undefined)local_8c);</pre>
<pre>              iVar4 = ioctl(iVar2,0x8b02,apcStack_a0);</pre>
<pre>              pFVar8 = stderr;</pre>
<pre>              iVar3 = iVar3 + 2;</pre>
<pre>              if (iVar4 &lt; 0) {</pre>
<pre>                piVar5 = __errno_location();</pre>
<pre>                pcVar10 = strerror(*piVar5);</pre>
<pre>                pcVar11 = "SIOCSIWNWID: %s\n";</pre>
<pre>                goto LAB_00403f08;</pre>
<pre>              }</pre>
<pre>            }</pre>
<pre>            iVar4 = strcasecmp(pcVar11,"domain");</pre>
<pre>            if (iVar4 == 0) goto LAB_00403d58;</pre>
<pre>            iVar4 = strncmp(pcVar11,"sens",4);</pre>
<pre>            if (iVar4 != 0) {</pre>
<pre>              iVar4 = strncmp(pcVar11,"enc",3);</pre>
<pre>              if (iVar4 == 0) {</pre>
<pre>LAB_00404034:</pre>
<pre>                iVar4 = iVar3 + 1;</pre>
<pre>                if (param_1 &lt;= iVar4) {</pre>
<pre>                  FUN_00402830();</pre>
<pre>                }</pre>
<pre>                local_40 = (char **)(param_2 + iVar4 * 4);</pre>
<pre>                pcVar11 = *local_40;</pre>
<pre>                iVar6 = strcasecmp(pcVar11,"on");</pre>
<pre>                if (iVar6 == 0) {</pre>
<pre>                  local_90 = local_80;</pre>
<pre>                  local_8c = 0;</pre>
<pre>                  local_8a = 0;</pre>
<pre>                  iVar3 = ioctl(iVar2,0x8b2b,apcStack_a0);</pre>
<pre>                  pFVar8 = stderr;</pre>
<pre>                  if (iVar3 &lt; 0) {</pre>
<pre>                    piVar5 = __errno_location();</pre>
<pre>                    pcVar10 = strerror(*piVar5);</pre>
<pre>                    pcVar11 = "SIOCGIWENCODE: %s\n";</pre>
<pre>                    goto LAB_00403f08;</pre>
<pre>                  }</pre>
<pre><span class="green"><span class="green"><span class="green">                  strncpy((char *)apcStack_a0,pcVar10,0x10)</span></span></span></span></pre>
<pre>                  local_8a = local_8a &amp; 0x7fff;</pre>
<pre>                }</pre>
<pre>                else {</pre>
<pre>                  local_90 = (char **)0x0;</pre>
<pre>                  local_8a = 0;</pre>
<pre>                  local_8c = 0;</pre>
<pre>                  iVar6 = strncmp(pcVar11,"s:",2);</pre>
<pre>                  if (iVar6 == 0) {</pre>
<pre><span class="green">                    sVar7 = strlen(pcVar11 + 2)</span></span></pre>
<pre>                    local_8c = (ushort)(sVar7 &amp; 0xffff);</pre>
<pre>                    if (0x40 &lt; (sVar7 &amp; 0xffff)) {</pre>
<pre>                      local_8c = 0x40;</pre>
<pre>                    }</pre>
<pre>                    local_30._4_4_ = local_80;</pre>
<pre><span class="green"><span class="green">                    strncpy((char *)local_30._4_4_,*local_40 + 2,(uint)local_8c)</span></span></span></pre>
<pre>                    local_90 = local_30._4_4_;</pre>
<pre>LAB_00404304:</pre>
<pre>                    bVar1 = true;</pre>
<pre>                    iVar4 = iVar3 + 2;</pre>
<pre>                  }</pre>
<pre>                  else {</pre>
<pre>                    sVar7 = strlen(pcVar11);</pre>
<pre><span class="green"><span class="green">                    local_3c = (char *)malloc(sVar7 + 1)</span></span></span></pre>
<pre>                    if (local_3c == (char *)0x0) {</pre>
<pre>                      fputs("Setting key : Malloc failed (string too long ?)\n",stderr);</pre>
<pre>                      goto LAB_00403f10;</pre>
<pre>                    }</pre>
<pre>                    local_38 = &amp;local_a8;</pre>
<pre>                    pcVar11 = *local_40;</pre>
<pre>                    local_40 = (char **)0x0;</pre>
<pre><span class="green"><span class="green">                    strcpy(local_3c,pcVar11)</span></span></span></pre>
<pre>                    local_34 = (undefined *)local_80;</pre>
<pre><span class="green">                    pcVar11 = strtok(local_3c,"-:;.,")</span></span></pre>
<pre>                    for (; (pcVar11 != (char *)0x0 &amp;&amp; (local_40 != (char **)0x40));</pre>
<pre>                        local_40 = (char **)((int)local_40 + 1)) {</pre>
<pre><span class="green">                      iVar6 = sscanf(pcVar11,"%2X",local_38)</span></span></pre>
<pre>                      if (iVar6 != 1) {</pre>
<pre>                        bVar1 = false;</pre>
<pre>                        goto LAB_004042d0;</pre>
<pre>                      }</pre>
<pre>                      pcVar12 = pcVar11 + 2;</pre>
<pre>                      local_34[(int)local_40] = (char)((ulonglong)local_a8 &gt;&gt; 0x20);</pre>
<pre>                      sVar7 = strlen(pcVar11);</pre>
<pre>                      if (sVar7 &lt; 3) {</pre>
<pre><span class="green">                        pcVar12 = strtok((char *)0x0,"-:;.,")</span></span></pre>
<pre>                      }</pre>
<pre>                      pcVar11 = pcVar12;</pre>
<pre>                    }</pre>
<pre>                    bVar1 = true;</pre>
<pre>LAB_004042d0:</pre>
<pre>                    free(local_3c);</pre>
<pre>                    if (bVar1) {</pre>
<pre>                      local_90 = local_80;</pre>
<pre>                      local_8c = (ushort)local_40;</pre>
<pre>                      goto LAB_00404304;</pre>
<pre>                    }</pre>
<pre>                  }</pre>
<pre>                  if (iVar4 &lt; param_1) {</pre>
<pre><span class="green">                    iVar3 = sscanf(*(char **)(param_2 + iVar4 * 4),"[%d]",&amp;local_a8)</span></span></pre>
<pre>                    iVar6 = iVar4 &lt;&lt; 2;</pre>
<pre>                    if (iVar3 == 1) {</pre>
<pre>                      if (local_a8 &lt; 0x100000000) {</pre>
<pre>LAB_0040436c:</pre>
<pre>                        iVar6 = iVar4 &lt;&lt; 2;</pre>
<pre>                        goto LAB_00404370;</pre>
<pre>                      }</pre>
<pre>                      iVar6 = iVar4 &lt;&lt; 2;</pre>
<pre>                      if (0xfeffffffff &lt; local_a8) goto LAB_00404370;</pre>
<pre>                      iVar4 = iVar4 + 1;</pre>
<pre>                      local_8a = (ushort)((ulonglong)local_a8 &gt;&gt; 0x20) | local_8a;</pre>
<pre>                      if (iVar4 &lt; param_1) {</pre>
<pre>                        bVar1 = true;</pre>
<pre>                        goto LAB_0040436c;</pre>
<pre>                      }</pre>
<pre>                    }</pre>
<pre>                    else {</pre>
<pre>LAB_00404370:</pre>
<pre>                      local_30._4_4_ = (char **)(param_2 + iVar6);</pre>
<pre>                      iVar3 = strcasecmp(*local_30._4_4_,"off");</pre>
<pre>                      if (iVar3 == 0) {</pre>
<pre>                        local_8a = local_8a | 0x8000;</pre>
<pre>                      }</pre>
<pre>                      iVar3 = strcasecmp(*local_30._4_4_,"open");</pre>
<pre>                      if (iVar3 == 0) {</pre>
<pre>                        local_8a = local_8a | 0x2000;</pre>
<pre>                      }</pre>
<pre>                      iVar3 = strncasecmp(*local_30._4_4_,"restricted",5);</pre>
<pre>                      if (iVar3 == 0) {</pre>
<pre>                        local_8a = local_8a | 0x4000;</pre>
<pre>                      }</pre>
<pre>                      if ((local_8a &amp; 0xff00) == 0) goto LAB_00404420;</pre>
<pre>                      iVar4 = iVar4 + 1;</pre>
<pre>                    }</pre>
<pre>                  }</pre>
<pre>                  else {</pre>
<pre>LAB_00404420:</pre>
<pre>                    if (!bVar1) {</pre>
<pre>                      FUN_00402830();</pre>
<pre>                    }</pre>
<pre>                  }</pre>
<pre>                  iVar4 = iVar4 + -1;</pre>
<pre>                }</pre>
<pre>                iVar6 = ioctl(iVar2,0x8b2a,apcStack_a0);</pre>
<pre>                pFVar8 = stderr;</pre>
<pre>                iVar3 = iVar4 + 1;</pre>
<pre>                if (-1 &lt; iVar6) goto LAB_00405684;</pre>
<pre>                piVar5 = __errno_location();</pre>
<pre>                local_30._0_4_ = (char *)*piVar5;</pre>
<pre>                pcVar10 = strerror((int)local_30._0_4_);</pre>
<pre>                pcVar11 = "SIOCSIWENCODE(%d): %s\n";</pre>
<pre>              }</pre>
<pre>              else {</pre>
<pre>                iVar4 = strcmp(pcVar11,"key");</pre>
<pre>                if (iVar4 == 0) goto LAB_00404034;</pre>
<pre>                iVar4 = strcasecmp(pcVar11,"essid");</pre>
<pre>                if (iVar4 == 0) {</pre>
<pre>                  iVar4 = iVar3 + 1;</pre>
<pre>                  if (param_1 &lt;= iVar4) {</pre>
<pre>                    FUN_00402830();</pre>
<pre>                  }</pre>
<pre>                  pcVar11 = *(char **)(param_2 + iVar4 * 4);</pre>
<pre>                  iVar6 = strcasecmp(pcVar11,"off");</pre>
<pre>                  if (iVar6 == 0) {</pre>
<pre>LAB_0040451c:</pre>
<pre>                    local_8a = 0;</pre>
<pre>                    local_80[0]._0_1_ = '\0';</pre>
<pre>                  }</pre>
<pre>                  else {</pre>
<pre>                    iVar6 = strcasecmp(pcVar11,"any");</pre>
<pre>                    if (iVar6 == 0) goto LAB_0040451c;</pre>
<pre>                    iVar6 = strcasecmp(pcVar11,"on");</pre>
<pre>                    if (iVar6 == 0) {</pre>
<pre>                      local_8c = 0;</pre>
<pre>                      local_8a = 0;</pre>
<pre>                      local_90 = local_80;</pre>
<pre>                      iVar3 = ioctl(iVar2,0x8b1b,apcStack_a0);</pre>
<pre>                      pFVar8 = stderr;</pre>
<pre>                      if (iVar3 &lt; 0) {</pre>
<pre>                        piVar5 = __errno_location();</pre>
<pre>                        pcVar10 = strerror(*piVar5);</pre>
<pre>                        pcVar11 = "SIOCGIWESSID: %s\n";</pre>
<pre>                        goto LAB_00403f08;</pre>
<pre>                      }</pre>
<pre><span class="green"><span class="green"><span class="green">                      strncpy((char *)apcStack_a0,pcVar10,0x10)</span></span></span></span></pre>
<pre>                      local_a8._0_4_ = (char **)0x1;</pre>
<pre>                      iVar3 = iVar4;</pre>
<pre>LAB_00404690:</pre>
<pre>                      iVar4 = iVar3;</pre>
<pre>                      local_8a = (ushort)local_a8._0_4_;</pre>
<pre>                    }</pre>
<pre>                    else {</pre>
<pre>                      sVar7 = strlen(pcVar11);</pre>
<pre>                      if (sVar7 &lt; 0x21) {</pre>
<pre>                        local_8a = 1;</pre>
<pre>                        iVar3 = iVar3 + 2;</pre>
<pre><span class="green"><span class="green">                        strcpy((char *)local_80,pcVar11)</span></span></span></pre>
<pre>                        if (iVar3 &lt; param_1) {</pre>
<pre><span class="green">                          iVar6 = sscanf(*(char **)(param_2 + iVar3 * 4),"[%d]",&amp;local_a8)</span></span></pre>
<pre>                          if (((iVar6 == 1) &amp;&amp; (0xffffffff &lt; local_a8)) &amp;&amp; (local_a8 &lt; 0xff00000000)</pre>
<pre>                             ) goto LAB_00404690;</pre>
<pre>                        }</pre>
<pre>                      }</pre>
<pre>                      else {</pre>
<pre>                        fprintf(stderr,"ESSID too long (max %d): ``%s\'\'\n",0x20,pcVar11);</pre>
<pre>                        FUN_00402830();</pre>
<pre>                      }</pre>
<pre>                    }</pre>
<pre>                  }</pre>
<pre>                  local_90 = local_80;</pre>
<pre>                  sVar7 = strlen((char *)local_90);</pre>
<pre>                  local_8c = (short)sVar7 + 1;</pre>
<pre>                  iVar6 = ioctl(iVar2,0x8b1a,apcStack_a0);</pre>
<pre>                  pFVar8 = stderr;</pre>
<pre>                  iVar3 = iVar4 + 1;</pre>
<pre>                  if (iVar6 &lt; 0) {</pre>
<pre>                    piVar5 = __errno_location();</pre>
<pre>                    pcVar10 = strerror(*piVar5);</pre>
<pre>                    pcVar11 = "SIOCSIWESSID: %s\n";</pre>
<pre>                    goto LAB_00403f08;</pre>
<pre>                  }</pre>
<pre>                  goto LAB_00405684;</pre>
<pre>                }</pre>
<pre>                iVar4 = strcasecmp(pcVar11,"ap");</pre>
<pre>                if (iVar4 == 0) {</pre>
<pre>                  if (param_1 &lt;= iVar3 + 1) {</pre>
<pre>                    FUN_00402830();</pre>
<pre>                  }</pre>
<pre>                  iVar4 = check_addr_type(iVar2,pcVar10);</pre>
<pre>                  if (iVar4 &lt; 0) {</pre>
<pre>                    pcVar11 = "%-8.8s  Interface doesn\'t support MAC &amp; IP addresses\n";</pre>
<pre>                    pFVar8 = stderr;</pre>
<pre>                    goto LAB_00403f08;</pre>
<pre>                  }</pre>
<pre>                  iVar4 = in_addr(iVar2,pcVar10,*(undefined4 *)(param_2 + (iVar3 + 1) * 4),&amp;local_90</pre>
<pre>                                 );</pre>
<pre>                  if (iVar4 &lt; 0) {</pre>
<pre>                    FUN_00402830();</pre>
<pre>                  }</pre>
<pre>                  iVar4 = ioctl(iVar2,0x8b14,apcStack_a0);</pre>
<pre>                  pFVar8 = stderr;</pre>
<pre>                  if (iVar4 &lt; 0) {</pre>
<pre>                    piVar5 = __errno_location();</pre>
<pre>                    pcVar10 = strerror(*piVar5);</pre>
<pre>                    pcVar11 = "SIOCSIWAP: %s\n";</pre>
<pre>                    goto LAB_00403f08;</pre>
<pre>                  }</pre>
<pre>                  iVar3 = iVar3 + 3;</pre>
<pre>                  goto LAB_00405684;</pre>
<pre>                }</pre>
<pre>                iVar4 = strncmp(pcVar11,"nick",4);</pre>
<pre>                if (iVar4 == 0) {</pre>
<pre>                  if (param_1 &lt;= iVar3 + 1) {</pre>
<pre>                    FUN_00402830();</pre>
<pre>                  }</pre>
<pre>                  ppcVar13 = (char **)(param_2 + (iVar3 + 1) * 4);</pre>
<pre>                  local_30._0_4_ = *ppcVar13;</pre>
<pre>                  sVar7 = strlen(local_30._0_4_);</pre>
<pre>                  if (0x20 &lt; sVar7) {</pre>
<pre>                    fprintf(stderr,"Name too long (max %d) : ``%s\'\'\n",0x20,local_30._0_4_);</pre>
<pre>                    FUN_00402830();</pre>
<pre>                  }</pre>
<pre>                  local_90 = (char **)*ppcVar13;</pre>
<pre>                  sVar7 = strlen((char *)local_90);</pre>
<pre>                  local_8c = (short)sVar7 + 1;</pre>
<pre>                  iVar4 = ioctl(iVar2,0x8b1c,apcStack_a0);</pre>
<pre>                  pFVar8 = stderr;</pre>
<pre>                  iVar3 = iVar3 + 2;</pre>
<pre>                  if (iVar4 &lt; 0) {</pre>
<pre>                    piVar5 = __errno_location();</pre>
<pre>                    pcVar10 = strerror(*piVar5);</pre>
<pre>                    pcVar11 = "SIOCSIWNICKN: %s\n";</pre>
<pre>                    goto LAB_00403f08;</pre>
<pre>                  }</pre>
<pre>                  goto LAB_00405684;</pre>
<pre>                }</pre>
<pre>                iVar4 = strncmp(pcVar11,"bit",3);</pre>
<pre>                if (iVar4 == 0) {</pre>
<pre>LAB_0040497c:</pre>
<pre>                  local_30._0_4_ = (char *)((ulonglong)local_30 &gt;&gt; 0x20);</pre>
<pre>                  iVar4 = iVar3 + 1;</pre>
<pre>                  if (param_1 &lt;= iVar4) {</pre>
<pre>                    FUN_00402830();</pre>
<pre>                  }</pre>
<pre>                  ppcVar13 = (char **)(param_2 + iVar4 * 4);</pre>
<pre>                  local_30._4_4_ = (char **)*ppcVar13;</pre>
<pre>                  iVar6 = strcasecmp((char *)local_30._4_4_,"auto");</pre>
<pre>                  if (iVar6 == 0) {</pre>
<pre>                    local_90 = (char **)0xffffffff;</pre>
<pre>                    local_8c = local_8c &amp; 0xff;</pre>
<pre>                  }</pre>
<pre>                  else {</pre>
<pre>                    iVar6 = strcasecmp((char *)local_30._4_4_,"fixed");</pre>
<pre>                    if (iVar6 == 0) {</pre>
<pre>                      iVar3 = ioctl(iVar2,0x8b21,apcStack_a0);</pre>
<pre>                      pFVar8 = stderr;</pre>
<pre>                      if (iVar3 &lt; 0) {</pre>
<pre>                        piVar5 = __errno_location();</pre>
<pre>                        pcVar10 = strerror(*piVar5);</pre>
<pre>                        pcVar11 = "SIOCGIWRATE: %s\n";</pre>
<pre>                        goto LAB_00403f08;</pre>
<pre>                      }</pre>
<pre><span class="green"><span class="green"><span class="green">                      strncpy((char *)apcStack_a0,pcVar10,0x10)</span></span></span></span></pre>
<pre>                      iVar3 = iVar4;</pre>
<pre>LAB_00404c18:</pre>
<pre>                      iVar4 = iVar3;</pre>
<pre>                      local_8c = CONCAT11(1,(undefined)local_8c);</pre>
<pre>                    }</pre>
<pre>                    else {</pre>
<pre><span class="green">                      iVar6 = sscanf((char *)local_30._4_4_,"%lg",&amp;local_a8)</span></span></pre>
<pre>                      if (iVar6 != 1) {</pre>
<pre>                        FUN_00402830();</pre>
<pre>                      }</pre>
<pre>                      pcVar11 = index(*ppcVar13,0x47);</pre>
<pre>                      lVar14 = local_a8;</pre>
<pre>                      if (pcVar11 != (char *)0x0) {</pre>
<pre>                        lVar14 = __muldf3(local_a8._0_4_,local_a8._4_4_,0x41cdcd65,0);</pre>
<pre>                      }</pre>
<pre>                      local_a8 = lVar14;</pre>
<pre>                      pcVar11 = index(*ppcVar13,0x4d);</pre>
<pre>                      lVar14 = local_a8;</pre>
<pre>                      if (pcVar11 != (char *)0x0) {</pre>
<pre>                        lVar14 = __muldf3(local_a8._0_4_,local_a8._4_4_,0x412e8480,0);</pre>
<pre>                      }</pre>
<pre>                      local_a8 = lVar14;</pre>
<pre>                      pcVar11 = index(*ppcVar13,0x6b);</pre>
<pre>                      lVar14 = local_a8;</pre>
<pre>                      if (pcVar11 != (char *)0x0) {</pre>
<pre>                        lVar14 = __muldf3(local_a8._0_4_,local_a8._4_4_,0x408f4000,0);</pre>
<pre>                      }</pre>
<pre>                      local_a8._0_4_ = (char **)((ulonglong)lVar14 &gt;&gt; 0x20);</pre>
<pre>                      local_a8._4_4_ = (undefined4)lVar14;</pre>
<pre>                      iVar3 = iVar3 + 2;</pre>
<pre>                      local_a8 = lVar14;</pre>
<pre>                      local_90 = (char **)__fixdfsi(local_a8._0_4_,local_a8._4_4_);</pre>
<pre>                      local_8c = CONCAT11(1,(undefined)local_8c);</pre>
<pre>                      if (iVar3 &lt; param_1) {</pre>
<pre>                        iVar6 = strcasecmp(*(char **)(param_2 + iVar3 * 4),"auto");</pre>
<pre>                        if (iVar6 == 0) {</pre>
<pre>                          local_8c = local_8c &amp; 0xff;</pre>
<pre>                          iVar4 = iVar3;</pre>
<pre>                        }</pre>
<pre>                      }</pre>
<pre>                      iVar3 = iVar4 + 1;</pre>
<pre>                      if (iVar3 &lt; param_1) {</pre>
<pre>                        iVar6 = strcasecmp(*(char **)(param_2 + iVar3 * 4),"fixed");</pre>
<pre>                        if (iVar6 == 0) goto LAB_00404c18;</pre>
<pre>                      }</pre>
<pre>                    }</pre>
<pre>                  }</pre>
<pre>                  iVar6 = ioctl(iVar2,0x8b20,apcStack_a0);</pre>
<pre>                  pFVar8 = stderr;</pre>
<pre>                  iVar3 = iVar4 + 1;</pre>
<pre>                  if (iVar6 &lt; 0) {</pre>
<pre>                    piVar5 = __errno_location();</pre>
<pre>                    pcVar10 = strerror(*piVar5);</pre>
<pre>                    pcVar11 = "SIOCSIWRATE: %s\n";</pre>
<pre>                    goto LAB_00403f08;</pre>
<pre>                  }</pre>
<pre>                  goto LAB_00405684;</pre>
<pre>                }</pre>
<pre>                iVar4 = strcmp(pcVar11,"rate");</pre>
<pre>                if (iVar4 == 0) goto LAB_0040497c;</pre>
<pre>                iVar4 = strncasecmp(pcVar11,"rts",3);</pre>
<pre>                if (iVar4 == 0) {</pre>
<pre>                  if (param_1 &lt;= iVar3 + 1) {</pre>
<pre>                    FUN_00402830();</pre>
<pre>                  }</pre>
<pre>                  local_40 = *(char ***)(param_2 + (iVar3 + 1) * 4);</pre>
<pre>                  local_90 = (char **)0xffffffff;</pre>
<pre>                  local_8c = 0x100;</pre>
<pre>                  iVar4 = strcasecmp((char *)local_40,"off");</pre>
<pre>                  if (iVar4 == 0) {</pre>
<pre>                    local_8c = CONCAT11(local_8c._0_1_,1);</pre>
<pre>                  }</pre>
<pre>                  else {</pre>
<pre>                    iVar4 = strcasecmp((char *)local_40,"auto");</pre>
<pre>                    if (iVar4 == 0) {</pre>
<pre>                      local_8c = local_8c &amp; 0xff;</pre>
<pre>                    }</pre>
<pre>                    else {</pre>
<pre>                      iVar4 = strcasecmp((char *)local_40,"fixed");</pre>
<pre>                      if (iVar4 == 0) {</pre>
<pre>                        local_30._4_4_ = apcStack_a0;</pre>
<pre>                        iVar4 = ioctl(iVar2,0x8b23,local_30._4_4_);</pre>
<pre>                        pFVar8 = stderr;</pre>
<pre>                        if (iVar4 &lt; 0) {</pre>
<pre>                          piVar5 = __errno_location();</pre>
<pre>                          pcVar10 = strerror(*piVar5);</pre>
<pre>                          pcVar11 = "SIOCGIWRTS: %s\n";</pre>
<pre>                          goto LAB_00403f08;</pre>
<pre>                        }</pre>
<pre><span class="green"><span class="green"><span class="green">                        strncpy((char *)local_30._4_4_,pcVar10,0x10)</span></span></span></span></pre>
<pre>                        local_8c = CONCAT11(1,(undefined)local_8c);</pre>
<pre>                      }</pre>
<pre>                      else {</pre>
<pre><span class="green">                        iVar4 = sscanf((char *)local_40,"%ld",&amp;local_90)</span></span></pre>
<pre>                        if (iVar4 != 1) {</pre>
<pre>                          FUN_00402830();</pre>
<pre>                        }</pre>
<pre>                      }</pre>
<pre>                    }</pre>
<pre>                  }</pre>
<pre>                  iVar4 = ioctl(iVar2,0x8b22,apcStack_a0);</pre>
<pre>                  pFVar8 = stderr;</pre>
<pre>                  iVar3 = iVar3 + 2;</pre>
<pre>                  if (iVar4 &lt; 0) {</pre>
<pre>                    piVar5 = __errno_location();</pre>
<pre>                    pcVar10 = strerror(*piVar5);</pre>
<pre>                    pcVar11 = "SIOCSIWRTS: %s\n";</pre>
<pre>                    goto LAB_00403f08;</pre>
<pre>                  }</pre>
<pre>                  goto LAB_00405684;</pre>
<pre>                }</pre>
<pre>                iVar4 = strncmp(pcVar11,"frag",4);</pre>
<pre>                if (iVar4 == 0) {</pre>
<pre>                  if (param_1 &lt;= iVar3 + 1) {</pre>
<pre>                    FUN_00402830();</pre>
<pre>                  }</pre>
<pre>                  local_40 = *(char ***)(param_2 + (iVar3 + 1) * 4);</pre>
<pre>                  local_90 = (char **)0xffffffff;</pre>
<pre>                  local_8c = 0x100;</pre>
<pre>                  iVar4 = strcasecmp((char *)local_40,"off");</pre>
<pre>                  if (iVar4 == 0) {</pre>
<pre>                    local_8c = CONCAT11(local_8c._0_1_,1);</pre>
<pre>                  }</pre>
<pre>                  else {</pre>
<pre>                    iVar4 = strcasecmp((char *)local_40,"auto");</pre>
<pre>                    if (iVar4 == 0) {</pre>
<pre>                      local_8c = local_8c &amp; 0xff;</pre>
<pre>                    }</pre>
<pre>                    else {</pre>
<pre>                      iVar4 = strcasecmp((char *)local_40,"fixed");</pre>
<pre>                      if (iVar4 == 0) {</pre>
<pre>                        local_30._4_4_ = apcStack_a0;</pre>
<pre>                        iVar4 = ioctl(iVar2,0x8b25,local_30._4_4_);</pre>
<pre>                        pFVar8 = stderr;</pre>
<pre>                        if (iVar4 &lt; 0) {</pre>
<pre>                          piVar5 = __errno_location();</pre>
<pre>                          pcVar10 = strerror(*piVar5);</pre>
<pre>                          pcVar11 = "SIOCGIWFRAG: %s\n";</pre>
<pre>                          goto LAB_00403f08;</pre>
<pre>                        }</pre>
<pre><span class="green"><span class="green"><span class="green">                        strncpy((char *)local_30._4_4_,pcVar10,0x10)</span></span></span></span></pre>
<pre>                        local_8c = CONCAT11(1,(undefined)local_8c);</pre>
<pre>                      }</pre>
<pre>                      else {</pre>
<pre><span class="green">                        iVar4 = sscanf((char *)local_40,"%ld",&amp;local_90)</span></span></pre>
<pre>                        if (iVar4 != 1) {</pre>
<pre>                          FUN_00402830();</pre>
<pre>                        }</pre>
<pre>                      }</pre>
<pre>                    }</pre>
<pre>                  }</pre>
<pre>                  iVar4 = ioctl(iVar2,0x8b24,apcStack_a0);</pre>
<pre>                  pFVar8 = stderr;</pre>
<pre>                  iVar3 = iVar3 + 2;</pre>
<pre>                  if (iVar4 &lt; 0) {</pre>
<pre>                    piVar5 = __errno_location();</pre>
<pre>                    pcVar10 = strerror(*piVar5);</pre>
<pre>                    pcVar11 = "SIOCSIWFRAG: %s\n";</pre>
<pre>                    goto LAB_00403f08;</pre>
<pre>                  }</pre>
<pre>                  goto LAB_00405684;</pre>
<pre>                }</pre>
<pre>                iVar4 = strcmp(pcVar11,"mode");</pre>
<pre>                if (iVar4 == 0) {</pre>
<pre>                  if (param_1 &lt;= iVar3 + 1) {</pre>
<pre>                    FUN_00402830();</pre>
<pre>                  }</pre>
<pre>                  local_40 = (char **)(param_2 + (iVar3 + 1) * 4);</pre>
<pre><span class="green">                  iVar4 = sscanf(*local_40,"%d",&amp;local_a8)</span></span></pre>
<pre>                  if (iVar4 != 1) {</pre>
<pre>                    local_a8._0_4_ = (char **)0x0;</pre>
<pre>                    do {</pre>
<pre>                      iVar4 = (int)local_a8._0_4_;</pre>
<pre>                      if (5 &lt; (int)local_a8._0_4_) break;</pre>
<pre>                      iVar6 = strncasecmp(*local_40,(&amp;PTR_DAT_00418150)[(int)local_a8._0_4_],3);</pre>
<pre>                      local_a8._0_4_ = (char **)(iVar4 + 1);</pre>
<pre>                    } while (iVar6 != 0);</pre>
<pre>                  }</pre>
<pre>                  local_a8._0_4_ = (char **)((ulonglong)local_a8 &gt;&gt; 0x20);</pre>
<pre>                  if (5 &lt; local_a8._0_4_) {</pre>
<pre>                    FUN_00402830();</pre>
<pre>                  }</pre>
<pre>                  local_a8._0_4_ = (char **)((ulonglong)local_a8 &gt;&gt; 0x20);</pre>
<pre>                  local_90 = local_a8._0_4_;</pre>
<pre>                  iVar4 = ioctl(iVar2,0x8b06,apcStack_a0);</pre>
<pre>                  pFVar8 = stderr;</pre>
<pre>                  iVar3 = iVar3 + 2;</pre>
<pre>                  if (iVar4 &lt; 0) {</pre>
<pre>                    piVar5 = __errno_location();</pre>
<pre>                    pcVar10 = strerror(*piVar5);</pre>
<pre>                    pcVar11 = "SIOCSIWMODE: %s\n";</pre>
<pre>                    goto LAB_00403f08;</pre>
<pre>                  }</pre>
<pre>                  goto LAB_00405684;</pre>
<pre>                }</pre>
<pre>                iVar4 = strncmp(pcVar11,"power",3);</pre>
<pre>                if (iVar4 != 0) {</pre>
<pre>                  fprintf(stderr,"Invalid argument : %s\n",pcVar11);</pre>
<pre>                  FUN_00402830();</pre>
<pre>                  goto LAB_00403f10;</pre>
<pre>                }</pre>
<pre>                iVar4 = iVar3 + 1;</pre>
<pre>                if (param_1 &lt;= iVar4) {</pre>
<pre>                  FUN_00402830();</pre>
<pre>                }</pre>
<pre>                pcVar11 = *(char **)(param_2 + iVar4 * 4);</pre>
<pre>                iVar6 = strcasecmp(pcVar11,"off");</pre>
<pre>                if (iVar6 == 0) {</pre>
<pre>                  local_8c = CONCAT11(local_8c._0_1_,1);</pre>
<pre>                }</pre>
<pre>                else {</pre>
<pre>                  iVar6 = strcasecmp(pcVar11,"on");</pre>
<pre>                  if (iVar6 == 0) {</pre>
<pre>                    iVar3 = ioctl(iVar2,0x8b2d,apcStack_a0);</pre>
<pre>                    pFVar8 = stderr;</pre>
<pre>                    if (iVar3 &lt; 0) {</pre>
<pre>                      piVar5 = __errno_location();</pre>
<pre>                      pcVar10 = strerror(*piVar5);</pre>
<pre>                      pcVar11 = "SIOCGIWPOWER: %s\n";</pre>
<pre>                      goto LAB_00403f08;</pre>
<pre>                    }</pre>
<pre><span class="green"><span class="green"><span class="green">                    strncpy((char *)apcStack_a0,pcVar10,0x10)</span></span></span></span></pre>
<pre>                    local_8c = local_8c &amp; 0xff00;</pre>
<pre>                  }</pre>
<pre>                  else {</pre>
<pre>                    local_8a = 0;</pre>
<pre>                    local_8c = local_8c &amp; 0xff00;</pre>
<pre>                    iVar6 = strcasecmp(pcVar11,"min");</pre>
<pre>                    if (iVar6 == 0) {</pre>
<pre>                      local_8a = 1;</pre>
<pre>LAB_004052f0:</pre>
<pre>                      iVar4 = iVar3 + 2;</pre>
<pre>                      if (param_1 &lt;= iVar4) {</pre>
<pre>                        FUN_00402830();</pre>
<pre>                      }</pre>
<pre>                    }</pre>
<pre>                    else {</pre>
<pre>                      iVar6 = strcasecmp(pcVar11,"max");</pre>
<pre>                      if (iVar6 == 0) {</pre>
<pre>                        local_8a = 2;</pre>
<pre>                        goto LAB_004052f0;</pre>
<pre>                      }</pre>
<pre>                    }</pre>
<pre>                    pcVar11 = *(char **)(param_2 + iVar4 * 4);</pre>
<pre>                    iVar3 = strcasecmp(pcVar11,"period");</pre>
<pre>                    if (iVar3 == 0) {</pre>
<pre>                      local_8a = local_8a | 0x1000;</pre>
<pre>LAB_00405370:</pre>
<pre>                      iVar4 = iVar4 + 1;</pre>
<pre>                      if (param_1 &lt;= iVar4) {</pre>
<pre>                        FUN_00402830();</pre>
<pre>                      }</pre>
<pre>                      iVar6 = iVar4 * 4;</pre>
<pre>                    }</pre>
<pre>                    else {</pre>
<pre>                      iVar3 = strcasecmp(pcVar11,"timeout");</pre>
<pre>                      iVar6 = iVar4 &lt;&lt; 2;</pre>
<pre>                      if (iVar3 == 0) {</pre>
<pre>                        local_8a = local_8a | 0x2000;</pre>
<pre>                        goto LAB_00405370;</pre>
<pre>                      }</pre>
<pre>                    }</pre>
<pre>                    ppcVar13 = (char **)(param_2 + iVar6);</pre>
<pre>                    local_40 = (char **)0x0;</pre>
<pre><span class="green">                    iVar3 = sscanf(*ppcVar13,"%lg",&amp;local_a8)</span></span></pre>
<pre>                    if (iVar3 == 1) {</pre>
<pre>                      lVar14 = __muldf3(local_a8._0_4_,local_a8._4_4_,0x412e8480,0);</pre>
<pre>                      local_a8 = lVar14;</pre>
<pre>                      local_30 = lVar14;</pre>
<pre>                      pcVar11 = index(*ppcVar13,0x75);</pre>
<pre>                      lVar14 = local_a8;</pre>
<pre>                      if (pcVar11 != (char *)0x0) {</pre>
<pre>                        lVar14 = __divdf3(local_30._0_4_,local_30._4_4_,0x412e8480,0);</pre>
<pre>                      }</pre>
<pre>                      local_a8 = lVar14;</pre>
<pre>                      pcVar11 = index(*ppcVar13,0x6d);</pre>
<pre>                      lVar14 = local_a8;</pre>
<pre>                      if (pcVar11 != (char *)0x0) {</pre>
<pre>                        lVar14 = __divdf3(local_a8._0_4_,local_a8._4_4_,0x408f4000,0);</pre>
<pre>                      }</pre>
<pre>                      local_a8._0_4_ = (char **)((ulonglong)lVar14 &gt;&gt; 0x20);</pre>
<pre>                      local_a8._4_4_ = (undefined4)lVar14;</pre>
<pre>                      local_a8 = lVar14;</pre>
<pre>                      local_90 = (char **)__fixdfsi(local_a8._0_4_,local_a8._4_4_);</pre>
<pre>                      if ((local_8a &amp; 0xf000) == 0) {</pre>
<pre>                        local_8a = local_8a | 0x1000;</pre>
<pre>                      }</pre>
<pre>                      iVar4 = iVar4 + 1;</pre>
<pre>                      local_40 = (char **)0x1;</pre>
<pre>                    }</pre>
<pre>                    if (iVar4 &lt; param_1) {</pre>
<pre>                      ppcVar13 = (char **)(param_2 + iVar4 * 4);</pre>
<pre>                      iVar3 = strcasecmp(*ppcVar13,"all");</pre>
<pre>                      if (iVar3 == 0) {</pre>
<pre>                        local_8a = local_8a | 0x300;</pre>
<pre>                      }</pre>
<pre>                      iVar3 = strncasecmp(*ppcVar13,"unicast",4);</pre>
<pre>                      if (iVar3 == 0) {</pre>
<pre>                        local_8a = local_8a | 0x100;</pre>
<pre>                      }</pre>
<pre>                      iVar3 = strncasecmp(*ppcVar13,"multicast",5);</pre>
<pre>                      if (iVar3 == 0) {</pre>
<pre>                        local_8a = local_8a | 0x200;</pre>
<pre>                      }</pre>
<pre>                      iVar3 = strncasecmp(*ppcVar13,"force",5);</pre>
<pre>                      if (iVar3 == 0) {</pre>
<pre>                        local_8a = local_8a | 0x400;</pre>
<pre>                      }</pre>
<pre>                      iVar3 = strcasecmp(*ppcVar13,"repeat");</pre>
<pre>                      if (iVar3 == 0) {</pre>
<pre>                        local_8a = local_8a | 0x800;</pre>
<pre>                      }</pre>
<pre>                      if ((local_8a &amp; 0xf00) == 0) goto LAB_004055c0;</pre>
<pre>                      iVar4 = iVar4 + 1;</pre>
<pre>                    }</pre>
<pre>                    else {</pre>
<pre>LAB_004055c0:</pre>
<pre>                      if (local_40 == (char **)0x0) {</pre>
<pre>                        FUN_00402830();</pre>
<pre>                      }</pre>
<pre>                    }</pre>
<pre>                    iVar4 = iVar4 + -1;</pre>
<pre>                  }</pre>
<pre>                }</pre>
<pre>                iVar6 = ioctl(iVar2,0x8b2c,apcStack_a0);</pre>
<pre>                pFVar8 = stderr;</pre>
<pre>                iVar3 = iVar4 + 1;</pre>
<pre>                if (-1 &lt; iVar6) goto LAB_00405684;</pre>
<pre>                piVar5 = __errno_location();</pre>
<pre>                local_30._0_4_ = (char *)*piVar5;</pre>
<pre>                pcVar10 = strerror((int)local_30._0_4_);</pre>
<pre>                pcVar11 = "SIOCSIWPOWER(%d): %s\n";</pre>
<pre>              }</pre>
<pre>              fprintf(pFVar8,pcVar11,local_30._0_4_,pcVar10);</pre>
<pre>              goto LAB_00403f10;</pre>
<pre>            }</pre>
<pre>            if (param_1 &lt;= iVar3 + 1) {</pre>
<pre>              FUN_00402830();</pre>
<pre>            }</pre>
<pre><span class="green">            iVar4 = sscanf(*(char **)(param_2 + (iVar3 + 1) * 4),"%d",&amp;local_90)</span></span></pre>
<pre>            if (iVar4 != 1) {</pre>
<pre>              FUN_00402830();</pre>
<pre>            }</pre>
<pre>            iVar4 = ioctl(iVar2,0x8b08,apcStack_a0);</pre>
<pre>            pFVar8 = stderr;</pre>
<pre>            iVar3 = iVar3 + 2;</pre>
<pre>            if (iVar4 &lt; 0) {</pre>
<pre>              piVar5 = __errno_location();</pre>
<pre>              pcVar10 = strerror(*piVar5);</pre>
<pre>              pcVar11 = "SIOCSIWSENS: %s\n";</pre>
<pre>LAB_00403f08:</pre>
<pre>              fprintf(pFVar8,pcVar11,pcVar10);</pre>
<pre>LAB_00403f10:</pre>
<pre>              uVar9 = 0xffffffff;</pre>
<pre>LAB_00405694:</pre>
<pre>              close(iVar2);</pre>
<pre>              return uVar9;</pre>
<pre>            }</pre>
<pre>          } while( true );</pre>
<pre>        }</pre>
<pre>        FUN_00402978(iVar2,pcVar10);</pre>
<pre>      }</pre>
<pre>    }</pre>
<pre>    close(iVar2);</pre>
<pre>    iVar2 = 0;</pre>
<pre>  }</pre>
<pre>                    /* WARNING: Subroutine does not return */</pre>
<pre>  exit(iVar2);</pre>
<pre>}</pre>
<br />
  <!-- content end -->
</div>

<a href="https://github.com/e-m-b-a/emba" title="github.com/e-m-b-a/emba" target="_blank">
  <div id="buttonInfo" class="rectButtonVisible">
    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" transform="translate(2 2)"><g stroke="white" stroke-linecap="round" stroke-linejoin="round"><circle cx="8.5" cy="8.5" r="8"/><path d="M8.5 12.5v-4h-1"/><path d="M7.5 12.5h2"/></g><circle cx="8.5" cy="5.5" fill="white" r="1"/></g></svg>
  </div>
</a>
<div id="buttonBack" class="nonClickable rectButtonVisible"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><path d="M9.5 14.5l4-4l-4-4" fill="none" stroke="#444" stroke-linecap="round" stroke-linejoin="round"/></svg></div>
<div id="buttonForward" class="nonClickable rectButtonVisible"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><path d="M11.5 14.5l-4-4l4-4" fill="none" stroke="#444" stroke-linecap="round" stroke-linejoin="round"/></svg></div> 
<div id="buttonDown" class="rectButton" onclick="scrollDown()"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="#fff" stroke-linecap="round" stroke-linejoin="round"><path d="M14.5 6.5l-4 4l-4-4"/><path d="M14.5 10.5l-4 4l-4-4"/></g></svg></div>
<div id="buttonUp" class="rectButton" onclick="scrollUp()"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="#fff" stroke-linecap="round" stroke-linejoin="round"><path d="M6.5 14.5l4-4l4 4"/><path d="M6.5 10.5l4-4l4 4"/></g></svg></div> 

<script>
window.onload = function () {
  var buttons = document.getElementsByClassName("rectButton");
  for (let i=0; i<buttons.length; i++) {
    buttons[i].style.visibility = "visible";
  }
  var buttonDown = document.getElementById("buttonDown");
  buttonDown.classList.add('rectButtonVisible');
  buttonDown.classList.remove('rectButton');

  var buttonUp = document.getElementById("buttonUp");
  buttonUp.classList.add('rectButtonVisible');
  buttonUp.classList.remove('rectButton');
    
  var buttonSizer = document.getElementById("buttonSizer");
  buttonSizer.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="white" stroke-linecap="round" stroke-linejoin="round"><path d="M9.5 16.5v-4.978l-5-.022"/><path d="M18.5 2.5l-7 7"/><path d="M16.5 9.5l-5 .023V4.5"/><path d="M9.5 11.5l-7 7"/></g></svg>';
  if (document.getElementById("buttonTime") !== null) {
    var buttonTime = document.getElementById("buttonTime");
    buttonTime.style.bottom = "50px";
  }
  document.getElementById("expand").value = "+ Show more results";
  document.getElementById("expand").className += " expand";
  var embarkButton = document.getElementById("embark");
  if ( !(embarkButton.href.includes("embarkBackUrl")) ) {
    embarkButton.classList.remove('hidden');
    document.getElementById("logoImage").src = "./../../style/embark.svg";
    document.getElementById("logo").style.background = "#2d2d2d";
  }
}

function openNav() {
  document.getElementById("sidenav").style.width = "250px";
  document.getElementById("main").style.marginLeft = "250px";
  document.getElementById("nav").style.visibility = "visible";
}

function closeNav() {
  document.getElementById("sidenav").style.width = "50px";
  document.getElementById("sidenav").scrollTop = 0;
  document.getElementById("main").style.marginLeft = "50px";
  document.getElementById("nav").style.visibility = "hidden";
}

function scrollDown() {
  window.scrollTo(0,document.body.scrollHeight);
}

function scrollUp() {
  window.scrollTo(0,0);
}

function buttonNav() {
  var button = document.getElementById("buttonSizer");
  if ( button.classList.contains('buttonOpen') ) {
    button.classList.remove('buttonOpen');
    button.classList.add('buttonClose');
    button.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="white" stroke-linecap="round" stroke-linejoin="round"><path d="M9.5 16.5v-4.978l-5-.022"/><path d="M18.5 2.5l-7 7"/><path d="M16.5 9.5l-5 .023V4.5"/><path d="M9.5 11.5l-7 7"/></g></svg>';
    openNav();
  } else if( button.classList.contains('buttonClose') ) {
    button.classList.remove('buttonClose');
    button.classList.add('buttonOpen');
    button.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="white" stroke-linecap="round" stroke-linejoin="round"><path d="M18.5 7.5v-5h-5"/><path d="M18.5 2.5l-6 5.929"/><path d="M7.5 18.5l-5 .023V13.5"/><path d="M8.5 12.5l-6 6"/></g></svg>';
    closeNav();
  };
}

// the following function is currently not used
// it is for future extensions
function overlay_output(link) {
  var rawfile = new XMLHttpRequest();
  rawfile.open('GET', link, false);
  rawfile.overrideMimeType("text");
  rawfile.onreadystatechange = function()
  {
    alert(rawfile.responseText);
    //console.log(rawfile.responseText);
  }
  rawfile.send(null);
}

document.onkeydown = function(e) {
    switch (e.keyCode) {
      case 37:
        document.getElementById("buttonForward").parentNode.click(); 
        break;
      case 39:
        document.getElementById("buttonBack").parentNode.click();       
        break;
    }
};
</script>

</body>
</html>
