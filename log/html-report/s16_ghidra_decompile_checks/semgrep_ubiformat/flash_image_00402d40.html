<!-- 
EMBA - EMBEDDED LINUX ANALYZER

Copyright 2020-2023 Siemens AG
Copyright 2020-2024 Siemens Energy AG

EMBA comes with ABSOLUTELY NO WARRANTY. This is free software, and you are
welcome to redistribute it under the terms of the GNU General Public License.
See LICENSE file for usage of this software.

EMBA is licensed under GPLv3

Author(s) and contributors from the EMBA project are listed here: https://github.com/e-m-b-a/emba/blob/master/CONTRIBUTORS.md
-->

<!-- Used icons: https://github.com/CoreyGinnivan/system-uicons -->
 
<!DOCTYPE html>
<html lang="en">
<head>
  <title>EMBA firmware report</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="./../../style/style.css" type="text/css">
  <link rel="icon" type="image/png" href="./../../style/favicon.png">
</head>
<body>

<div id="sidenav" class="side">
  <div id="logo">
    <a class="inherit" href="./../../index.html"><img class="inherit" id="logoImage" src="./../../style/emba.svg" alt="logo"></a>
  </div>
  <div id="nav">
      <a id="embark" class="hidden" href="{{ embarkBackUrl }}">&laquo; Back to EMBArk</a> <!-- nosem -->
      <a class="backButton" href="./../../index.html">&laquo; Back to main</a>
<a class="modul" href="./../semgrep_ubiformat.html" title="./../semgrep_ubiformat.html" >&laquo; Back to semgrep_ubiformat</a>
      <!-- navigation start -->
      <!-- navigation end -->
      <input id="expand" class="expand_njs hidden" type="button" value="More results:" onclick="this.value=this.value=='+ Show more results'?'- Hide more results':'+ Show more results';">
      <div class="expand_area">
        <!-- etc start -->
        <!-- etc end -->
      </div>
  </div>
  <a href="TIMELINK"><div id="buttonTimeInvisible" class="rectButton"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="white" stroke-linecap="round" stroke-linejoin="round" transform="matrix(-1 0 0 1 19 2)"><circle cx="8.5" cy="8.5" r="8"/><path d="M8.5 5.5v4H5"/></g></svg></div></a>
  <div id="buttonSizer" class="rectButton buttonClose" onclick="buttonNav()"></div>
</div>
<div id="main" class="main">
  <!-- content start -->
<br />
<pre>int flash_image(libmtd_t libmtd,mtd_dev_info *mtd,ubigen_info *ui,ubi_scan_info *si)</pre>
<br />
<pre>{</pre>
<pre>  char cVar1;</pre>
<pre>  uint uVar2;</pre>
<pre>  char *pcVar3;</pre>
<pre>  int iVar4;</pre>
<pre>  int iVar5;</pre>
<pre>  int *piVar6;</pre>
<pre>  undefined4 uVar7;</pre>
<pre>  int iVar8;</pre>
<pre>  uint uVar9;</pre>
<pre>  uint uVar10;</pre>
<pre>  int iVar11;</pre>
<pre>  undefined4 *puVar12;</pre>
<pre>  uint32_t uVar13;</pre>
<pre>  uint uVar14;</pre>
<pre>  uint *ss;</pre>
<pre>  undefined4 *puVar15;</pre>
<pre>  int iVar16;</pre>
<pre>  uint *puVar17;</pre>
<pre>  undefined4 uVar18;</pre>
<pre>  undefined4 uVar19;</pre>
<pre>  code *pcVar20;</pre>
<pre>  undefined *puVar21;</pre>
<pre>  DItype DVar22;</pre>
<pre>  undefined4 in_stack_fffffee8;</pre>
<pre>  undefined4 in_stack_fffffeec;</pre>
<pre>  undefined4 in_stack_fffffef0;</pre>
<pre>  undefined4 in_stack_fffffef4;</pre>
<pre>  int iStack_108;</pre>
<pre>  undefined4 uStack_104;</pre>
<pre>  undefined *local_100 [2];</pre>
<pre>  stat st;</pre>
<pre>  int local_48;</pre>
<pre>  int local_44;</pre>
<pre>  int local_40;</pre>
<pre>  uint32_t _x;</pre>
<pre>  undefined *local_2c;</pre>
<pre>  </pre>
<pre>  pcVar3 = args.image;</pre>
<pre>  local_100[0] = &amp;_gp;</pre>
<pre>  iVar4 = strcmp(args.image,"-");</pre>
<pre>  if (iVar4 == 0) {</pre>
<pre>    if (((uint)args.image_sz | args.image_sz._4_4_) == 0) {</pre>
<pre>      (**(code **)(local_100[0] + -0x7e90))</pre>
<pre>                (**(undefined4 **)(local_100[0] + -0x7ee8),</pre>
<pre>                 "%s: error!: must use \'-S\' with non-zero value when reading from stdin\n",</pre>
<pre>                 "ubiformat");</pre>
<pre>      return -1;</pre>
<pre>    }</pre>
<pre>    iVar4 = (**(code **)(local_100[0] + -0x7ee0))(0);</pre>
<pre>    if (-1 &lt; iVar4) {</pre>
<pre>LAB_00402dec:</pre>
<pre>      DVar22 = __divdi3(CONCAT44(in_stack_fffffeec,in_stack_fffffee8),</pre>
<pre>                        CONCAT44(in_stack_fffffef4,in_stack_fffffef0));</pre>
<pre>      local_40 = (int)DVar22;</pre>
<pre>      if (si-&gt;good_cnt &lt; local_40) {</pre>
<pre>        puVar12 = *(undefined4 **)(local_100[0] + -0x7ee8);</pre>
<pre>        puVar15 = (undefined4 *)(**(code **)(local_100[0] + -0x7ef0))();</pre>
<pre>        uVar18 = *puVar15;</pre>
<pre>        (**(code **)(local_100[0] + -0x7e90))</pre>
<pre>                  (*puVar12,"%s: error!: file \"%s\" is too large (%lld bytes)\n","ubiformat",</pre>
<pre>                   args.image);</pre>
<pre>        uVar7 = *puVar12;</pre>
<pre>        (**(code **)(local_100[0] + -0x7e58))(uVar18);</pre>
<pre>        (**(code **)(local_100[0] + -0x7e90))(uVar7,"%*serror %d (%s)\n",0xb,&amp;DAT_0040e38c);</pre>
<pre>out_close:</pre>
<pre>        (**(code **)(local_100[0] + -0x7f10))(iVar4);</pre>
<pre>        return -1;</pre>
<pre>      }</pre>
<pre>      DVar22 = __moddi3(CONCAT44(in_stack_fffffeec,in_stack_fffffee8),</pre>
<pre>                        CONCAT44(in_stack_fffffef4,in_stack_fffffef0));</pre>
<pre>      if (DVar22 == 0) {</pre>
<pre>        if ((args._0_4_ &amp; 4) != 0) {</pre>
<pre>          (**(code **)(local_100[0] + -0x7e50))</pre>
<pre>                    ("%s: will write %d eraseblocks\n","ubiformat",local_40);</pre>
<pre>        }</pre>
<pre>        puVar21 = local_100[0];</pre>
<pre>        if (mtd-&gt;eb_cnt &lt; 1) {</pre>
<pre>          iVar16 = 0;</pre>
<pre>LAB_00403010:</pre>
<pre>          if ((args._0_4_ &amp; 6) == 0) {</pre>
<pre>            (**(code **)(puVar21 + -0x7e44))(10);</pre>
<pre>            puVar21 = local_100[0];</pre>
<pre>          }</pre>
<pre>          (**(code **)(puVar21 + -0x7f10))(iVar4);</pre>
<pre>          return iVar16 + 1;</pre>
<pre>        }</pre>
<pre>        local_48 = 0;</pre>
<pre>        local_44 = 0;</pre>
<pre>        iVar16 = 0;</pre>
<pre>        uVar9 = args._0_4_;</pre>
<pre>LAB_00402e94:</pre>
<pre>        iVar8 = -(mtd-&gt;eb_size + 0xeU &amp; 0xfffffff8);</pre>
<pre>        ss = (uint *)((int)local_100 + iVar8);</pre>
<pre>        if ((uVar9 &amp; 6) == 0) {</pre>
<pre>          DVar22 = __divdi3(*(DItype *)((int)&amp;st + iVar8 + -0x20),</pre>
<pre>                            *(DItype *)((int)&amp;st + iVar8 + -0x18));</pre>
<pre>          (**(code **)(local_100[0] + -0x7e50))</pre>
<pre>                    ("\rubiformat: flashing eraseblock %d -- %2lld %% complete  ",iVar16,(int)DVar22</pre>
<pre>                     ,(int)((ulonglong)DVar22 &gt;&gt; 0x20));</pre>
<pre>          (**(code **)(local_100[0] + -0x7e80))(**(undefined4 **)(local_100[0] + -0x7e54));</pre>
<pre>          uVar13 = si-&gt;ec[iVar16];</pre>
<pre>          uVar9 = args._0_4_;</pre>
<pre>          puVar21 = local_100[0];</pre>
<pre>        }</pre>
<pre>        else {</pre>
<pre>          uVar13 = si-&gt;ec[iVar16];</pre>
<pre>        }</pre>
<pre>        if (uVar13 != 0xfffffffc) {</pre>
<pre>          if ((uVar9 &amp; 4) != 0) {</pre>
<pre>            (**(code **)(puVar21 + -0x7e50))("%s: eraseblock %d: erase","ubiformat",iVar16);</pre>
<pre>            (**(code **)(local_100[0] + -0x7e80))(**(undefined4 **)(local_100[0] + -0x7e54));</pre>
<pre>          }</pre>
<pre>          iVar5 = mtd_erase(libmtd,mtd,args.node_fd,iVar16);</pre>
<pre>          if (iVar5 == 0) {</pre>
<pre>            if (local_48 == 0) {</pre>
<pre>              iVar5 = mtd-&gt;eb_size;</pre>
<pre>              puVar17 = ss;</pre>
<pre>joined_r0x00403434:</pre>
<pre>              for (; iVar5 != 0; iVar5 = iVar5 - iVar11) {</pre>
<pre>                iVar11 = (**(code **)(local_100[0] + -0x7ea8))(iVar4,puVar17,iVar5);</pre>
<pre>                if (iVar11 == 0) {</pre>
<pre>                  puVar15 = *(undefined4 **)(local_100[0] + -0x7ee8);</pre>
<pre>                  (**(code **)(local_100[0] + -0x7e90))</pre>
<pre>                            (*puVar15,"%s: error!: eof reached; %zu bytes remaining\n","ubiformat",</pre>
<pre>                             iVar5);</pre>
<pre>                  goto LAB_004036a0;</pre>
<pre>                }</pre>
<pre>                if (iVar11 &lt; 1) goto LAB_00403494;</pre>
<pre>                puVar17 = (uint *)((int)puVar17 + iVar11);</pre>
<pre>              }</pre>
<pre>            }</pre>
<pre>            uVar9 = (uint)args.ec;</pre>
<pre>            uVar2 = args.ec._4_4_;</pre>
<pre>            if ((args._0_4_ &amp; 8) == 0) {</pre>
<pre>              if ((int)si-&gt;ec[iVar16] &lt; 0) {</pre>
<pre>                uVar9 = *(uint *)&amp;si-&gt</span>ean_ec;</pre>
<pre>                uVar2 = *(uint *)((int)&amp;si-&gt</span>ean_ec + 4);</pre>
<pre>              }</pre>
<pre>              else {</pre>
<pre>                uVar9 = si-&gt;ec[iVar16] + 1;</pre>
<pre>                uVar2 = 0;</pre>
<pre>              }</pre>
<pre>            }</pre>
<pre>            if ((args._0_4_ &amp; 4) != 0) {</pre>
<pre>              (**(code **)(local_100[0] + -0x7e50))(", change EC to %lld");</pre>
<pre>              (**(code **)(local_100[0] + -0x7e80))(**(undefined4 **)(local_100[0] + -0x7e54));</pre>
<pre>            }</pre>
<pre>            uVar10 = *ss;</pre>
<pre>            uVar14 = ui-&gt;image_seq;</pre>
<pre>            if ((uVar10 &gt;&gt; 0x18 | uVar10 &lt;&lt; 0x18 | (uVar10 &amp; 0xff00) &lt;&lt; 8 | (uVar10 &amp; 0xff0000) &gt;&gt; 8</pre>
<pre>                ) == 0x55424923) {</pre>
<pre>              uVar13 = mtd_crc32(0xffffffff,ss,0x3c);</pre>
<pre>              uVar10 = *(uint *)((int)&amp;st + iVar8 + 0x34);</pre>
<pre>              uVar10 = uVar10 &gt;&gt; 0x18 | uVar10 &lt;&lt; 0x18 | (uVar10 &amp; 0xff00) &lt;&lt; 8 |</pre>
<pre>                       (uVar10 &amp; 0xff0000) &gt;&gt; 8;</pre>
<pre>              if (uVar13 == uVar10) {</pre>
<pre>                *(uint *)((int)&amp;st + iVar8 + 4) =</pre>
<pre>                     uVar9 &gt;&gt; 0x18 | uVar9 &lt;&lt; 0x18 | (uVar9 &amp; 0xff00) &lt;&lt; 8 | (uVar9 &amp; 0xff0000) &gt;&gt; 8</pre>
<pre>                ;</pre>
<pre>                *(uint *)((int)&amp;st + iVar8 + 0x10) =</pre>
<pre>                     uVar14 &gt;&gt; 0x18 | uVar14 &lt;&lt; 0x18 | (uVar14 &amp; 0xff00) &lt;&lt; 8 |</pre>
<pre>                     (uVar14 &amp; 0xff0000) &gt;&gt; 8;</pre>
<pre>                *(uint *)((int)&amp;st + iVar8) =</pre>
<pre>                     uVar2 &gt;&gt; 0x18 | uVar2 &lt;&lt; 0x18 | (uVar2 &amp; 0xff00) &lt;&lt; 8 | (uVar2 &amp; 0xff0000) &gt;&gt; 8</pre>
<pre>                ;</pre>
<pre>                uVar13 = mtd_crc32(0xffffffff,ss,0x3c);</pre>
<pre>                *(uint32_t *)((int)&amp;st + iVar8 + 0x34) =</pre>
<pre>                     uVar13 &gt;&gt; 0x18 | uVar13 &lt;&lt; 0x18 | (uVar13 &amp; 0xff00) &lt;&lt; 8 |</pre>
<pre>                     (uVar13 &amp; 0xff0000) &gt;&gt; 8;</pre>
<pre>                if ((args._0_4_ &amp; 4) != 0) {</pre>
<pre>                  (**(code **)(local_100[0] + -0x7e70))(", write data");</pre>
<pre>                  (**(code **)(local_100[0] + -0x7e80))(**(undefined4 **)(local_100[0] + -0x7e54));</pre>
<pre>                }</pre>
<pre>                iVar5 = mtd-&gt;eb_size + -1;</pre>
<pre>                if (-1 &lt; iVar5) {</pre>
<pre><span class="green">                  cVar1 = *(char *)((int)ss + iVar5)</span></span></pre>
<pre>                  while (cVar1 == -1) {</pre>
<pre>                    iVar5 = iVar5 + -1;</pre>
<pre>                    if (iVar5 == -1) break;</pre>
<pre><span class="green">                    cVar1 = *(char *)((int)ss + iVar5)</span></span></pre>
<pre>                  }</pre>
<pre>                }</pre>
<pre>                iVar11 = mtd-&gt</span>in_io_size;</pre>
<pre>                *(undefined4 *)((int)&amp;st + iVar8 + -0x20) = 0;</pre>
<pre>                if (iVar11 == 0) {</pre>
<pre>                  trap(0x1c00);</pre>
<pre>                }</pre>
<pre>                *(uint **)((int)&amp;st + iVar8 + -0x1c) = ss;</pre>
<pre>                *(undefined4 *)((int)&amp;st + iVar8 + -0x14) = 0;</pre>
<pre>                *(undefined4 *)((int)&amp;iStack_108 + iVar8) = 0;</pre>
<pre>                *(undefined4 *)((int)&amp;uStack_104 + iVar8) = 0;</pre>
<pre>                *(int *)((int)&amp;st + iVar8 + -0x18) = iVar11 * ((iVar5 + iVar11) / iVar11);</pre>
<pre>                iVar5 = mtd_write(libmtd,mtd,args.node_fd,iVar16,*(int *)((int)&amp;st + iVar8 + -0x20),</pre>
<pre>                                  *(void **)((int)&amp;st + iVar8 + -0x1c),</pre>
<pre>                                  *(int *)((int)&amp;st + iVar8 + -0x18),</pre>
<pre>                                  *(void **)((int)&amp;st + iVar8 + -0x14),</pre>
<pre>                                  *(int *)((int)&amp;iStack_108 + iVar8),</pre>
<pre>                                  *(uint8_t *)((int)&amp;uStack_104 + iVar8));</pre>
<pre>                if (iVar5 == 0) {</pre>
<pre>                  local_44 = local_44 + 1;</pre>
<pre>                  puVar21 = local_100[0];</pre>
<pre>                  if (local_40 &lt;= local_44) goto LAB_00403010;</pre>
<pre>                  local_48 = 0;</pre>
<pre>                  uVar9 = args._0_4_;</pre>
<pre>                }</pre>
<pre>                else {</pre>
<pre>                  local_2c = &amp;DAT_00410000;</pre>
<pre>                  piVar6 = (int *)(**(code **)(local_100[0] + -0x7ef0))();</pre>
<pre>                  iVar5 = *piVar6;</pre>
<pre>                  (**(code **)(local_100[0] + -0x7e90))</pre>
<pre>                            (**(undefined4 **)(local_100[0] + -0x7ee8),</pre>
<pre>                             "%s: error!: cannot write eraseblock %d\n","ubiformat",iVar16);</pre>
<pre>                  _x = **(uint32_t **)(local_100[0] + -0x7ee8);</pre>
<pre>                  uVar7 = (**(code **)(local_100[0] + -0x7e58))(iVar5);</pre>
<pre>                  puVar21 = local_100[0];</pre>
<pre>                  *(undefined4 *)((int)&amp;st + iVar8 + -0x1c) = uVar7;</pre>
<pre>                  *(int *)((int)&amp;st + iVar8 + -0x20) = iVar5;</pre>
<pre>                  (**(code **)(puVar21 + -0x7e90))(_x,"%*serror %d (%s)\n",0xb,local_2c + -0x1c74);</pre>
<pre>                  if (*piVar6 != 5) goto out_close;</pre>
<pre>                  iVar8 = mtd_torture(libmtd,mtd,args.node_fd,iVar16);</pre>
<pre>                  if (iVar8 != 0) {</pre>
<pre>                    iVar8 = mark_bad(mtd,si,iVar16);</pre>
<pre>                    if (iVar8 == 0) {</pre>
<pre>                      local_48 = 1;</pre>
<pre>                      uVar9 = args._0_4_;</pre>
<pre>                      puVar21 = local_100[0];</pre>
<pre>                      goto LAB_00402fe4;</pre>
<pre>                    }</pre>
<pre>                    goto out_close;</pre>
<pre>                  }</pre>
<pre>                  local_48 = 1;</pre>
<pre>                  uVar9 = args._0_4_;</pre>
<pre>                  puVar21 = local_100[0];</pre>
<pre>                }</pre>
<pre>                goto LAB_00402fe4;</pre>
<pre>              }</pre>
<pre>              puVar15 = *(undefined4 **)(local_100[0] + -0x7ee8);</pre>
<pre>              pcVar20 = *(code **)(local_100[0] + -0x7e90);</pre>
<pre>              uVar7 = *puVar15;</pre>
<pre>              *(uint *)((int)&amp;st + iVar8 + -0x20) = uVar10;</pre>
<pre>              (*pcVar20)(uVar7,"%s: error!: bad CRC %#08x, should be %#08x\n\n","ubiformat",uVar13);</pre>
<pre>            }</pre>
<pre>            else {</pre>
<pre>              puVar15 = *(undefined4 **)(local_100[0] + -0x7ee8);</pre>
<pre>              pcVar20 = *(code **)(local_100[0] + -0x7e90);</pre>
<pre>              uVar7 = *puVar15;</pre>
<pre>              *(undefined4 *)((int)&amp;st + iVar8 + -0x20) = 0x55424923;</pre>
<pre>              (*pcVar20)(uVar7,"%s: error!: bad UBI magic %#08x, should be %#08x\n","ubiformat");</pre>
<pre>            }</pre>
<pre>            uVar7 = *puVar15;</pre>
<pre>            pcVar20 = *(code **)(local_100[0] + -0x7e90);</pre>
<pre>            *(char **)((int)&amp;st + iVar8 + -0x20) = args.image;</pre>
<pre>            (*pcVar20)(uVar7,"%s: error!: bad EC header at eraseblock %d of \"%s\"\n","ubiformat",</pre>
<pre>                       local_44);</pre>
<pre>            goto out_close;</pre>
<pre>          }</pre>
<pre>          if ((args._0_4_ &amp; 2) == 0) {</pre>
<pre>            (**(code **)(local_100[0] + -0x7e44))(10);</pre>
<pre>          }</pre>
<pre>          local_2c = &amp;DAT_00410000;</pre>
<pre>          piVar6 = (int *)(**(code **)(local_100[0] + -0x7ef0))();</pre>
<pre>          iVar5 = *piVar6;</pre>
<pre>          (**(code **)(local_100[0] + -0x7e90))</pre>
<pre>                    (**(undefined4 **)(local_100[0] + -0x7ee8),</pre>
<pre>                     "%s: error!: failed to erase eraseblock %d\n","ubiformat",iVar16);</pre>
<pre>          _x = **(uint32_t **)(local_100[0] + -0x7ee8);</pre>
<pre>          uVar7 = (**(code **)(local_100[0] + -0x7e58))(iVar5);</pre>
<pre>          puVar21 = local_100[0];</pre>
<pre>          *(undefined4 *)((int)&amp;st + iVar8 + -0x1c) = uVar7;</pre>
<pre>          *(int *)((int)&amp;st + iVar8 + -0x20) = iVar5;</pre>
<pre>          (**(code **)(puVar21 + -0x7e90))(_x,"%*serror %d (%s)\n",0xb,local_2c + -0x1c74);</pre>
<pre>          if ((*piVar6 != 5) ||</pre>
<pre>             (iVar8 = mark_bad(mtd,si,iVar16), uVar9 = args._0_4_, puVar21 = local_100[0],</pre>
<pre>             iVar8 != 0)) goto out_close;</pre>
<pre>        }</pre>
<pre>LAB_00402fe4:</pre>
<pre>        iVar16 = iVar16 + 1;</pre>
<pre>        if (mtd-&gt;eb_cnt &lt;= iVar16) goto LAB_00403010;</pre>
<pre>        goto LAB_00402e94;</pre>
<pre>      }</pre>
<pre>      puVar12 = *(undefined4 **)(local_100[0] + -0x7ee8);</pre>
<pre>      iVar4 = -1;</pre>
<pre>      puVar15 = (undefined4 *)(**(code **)(local_100[0] + -0x7ef0))();</pre>
<pre>      uVar7 = *puVar15;</pre>
<pre>      (**(code **)(local_100[0] + -0x7e90))</pre>
<pre>                (*puVar12,</pre>
<pre>                 "%s: error!: file \"%s\" (size %lld bytes) is not multiple of eraseblock size (%d bytes)\n"</pre>
<pre>                 ,"ubiformat",args.image);</pre>
<pre>      uVar18 = *puVar12;</pre>
<pre>      (**(code **)(local_100[0] + -0x7e58))(uVar7);</pre>
<pre>      pcVar20 = *(code **)(local_100[0] + -0x7e90);</pre>
<pre>      goto LAB_00403944;</pre>
<pre>    }</pre>
<pre>    puVar15 = *(undefined4 **)(local_100[0] + -0x7ee8);</pre>
<pre>    iVar4 = -1;</pre>
<pre>    puVar12 = (undefined4 *)(**(code **)(local_100[0] + -0x7ef0))();</pre>
<pre>    uVar7 = *puVar12;</pre>
<pre>    (**(code **)(local_100[0] + -0x7e90))(*puVar15,"%s: error!: failed to dup stdin\n","ubiformat");</pre>
<pre>  }</pre>
<pre>  else {</pre>
<pre>    iVar16 = (**(code **)(local_100[0] + -0x7e5c))(pcVar3,&amp;st);</pre>
<pre>    iVar4 = -1;</pre>
<pre>    if (iVar16 == 0) {</pre>
<pre>      iVar4 = (**(code **)(local_100[0] + -0x7ed4))(args.image,0);</pre>
<pre>      if (iVar4 != -1) {</pre>
<pre>        if (iVar4 &lt; 0) {</pre>
<pre>          return iVar4;</pre>
<pre>        }</pre>
<pre>        goto LAB_00402dec;</pre>
<pre>      }</pre>
<pre>      pcVar20 = *(code **)(local_100[0] + -0x7ef0);</pre>
<pre>      puVar15 = *(undefined4 **)(local_100[0] + -0x7ee8);</pre>
<pre>    }</pre>
<pre>    else {</pre>
<pre>      pcVar20 = *(code **)(local_100[0] + -0x7ef0);</pre>
<pre>      puVar15 = *(undefined4 **)(local_100[0] + -0x7ee8);</pre>
<pre>    }</pre>
<pre>    puVar12 = (undefined4 *)(*pcVar20)();</pre>
<pre>    uVar7 = *puVar12;</pre>
<pre>    (**(code **)(local_100[0] + -0x7e90))</pre>
<pre>              (*puVar15,"%s: error!: cannot open \"%s\"\n","ubiformat",args.image);</pre>
<pre>  }</pre>
<pre>  uVar18 = *puVar15;</pre>
<pre>  (**(code **)(local_100[0] + -0x7e58))(uVar7);</pre>
<pre>  pcVar20 = *(code **)(local_100[0] + -0x7e90);</pre>
<pre>LAB_00403944:</pre>
<pre>  (*pcVar20)(uVar18,"%*serror %d (%s)\n",0xb,&amp;DAT_0040e38c);</pre>
<pre>  return iVar4;</pre>
<pre>LAB_00403494:</pre>
<pre>  piVar6 = (int *)(**(code **)(local_100[0] + -0x7ef0))();</pre>
<pre>  iVar11 = *piVar6;</pre>
<pre>  if ((iVar11 != 4) &amp;&amp; (iVar11 != 0xb)) {</pre>
<pre>    puVar15 = *(undefined4 **)(local_100[0] + -0x7ee8);</pre>
<pre>    (**(code **)(local_100[0] + -0x7e90))</pre>
<pre>              (*puVar15,"%s: error!: reading failed; %zu bytes remaining\n","ubiformat",iVar5);</pre>
<pre>    uVar18 = *puVar15;</pre>
<pre>    uVar7 = (**(code **)(local_100[0] + -0x7e58))(iVar11);</pre>
<pre>    pcVar20 = *(code **)(local_100[0] + -0x7e90);</pre>
<pre>    *(int *)((int)&amp;st + iVar8 + -0x20) = iVar11;</pre>
<pre>    *(undefined4 *)((int)&amp;st + iVar8 + -0x1c) = uVar7;</pre>
<pre>    (*pcVar20)(uVar18,"%*serror %d (%s)\n",0xb,&amp;DAT_0040e38c);</pre>
<pre>LAB_004036a0:</pre>
<pre>    puVar12 = (undefined4 *)(**(code **)(local_100[0] + -0x7ef0))();</pre>
<pre>    uVar7 = *puVar15;</pre>
<pre>    pcVar20 = *(code **)(local_100[0] + -0x7e90);</pre>
<pre>    uVar19 = *puVar12;</pre>
<pre>    *(char **)((int)&amp;st + iVar8 + -0x20) = args.image;</pre>
<pre>    (*pcVar20)(uVar7,"%s: error!: failed to read eraseblock %d from \"%s\"\n","ubiformat",local_44);</pre>
<pre>    uVar18 = *puVar15;</pre>
<pre>    uVar7 = (**(code **)(local_100[0] + -0x7e58))(uVar19);</pre>
<pre>    puVar21 = local_100[0];</pre>
<pre>    *(undefined4 *)((int)&amp;st + iVar8 + -0x20) = uVar19;</pre>
<pre>    *(undefined4 *)((int)&amp;st + iVar8 + -0x1c) = uVar7;</pre>
<pre>    (**(code **)(puVar21 + -0x7e90))(uVar18,"%*serror %d (%s)\n",0xb,&amp;DAT_0040e38c);</pre>
<pre>    goto out_close;</pre>
<pre>  }</pre>
<pre>  goto joined_r0x00403434;</pre>
<pre>}</pre>
<br />
<pre>[ASK_GPT] 39c301da203b0290</pre>
  <!-- content end -->
</div>

<a href="https://github.com/e-m-b-a/emba" title="github.com/e-m-b-a/emba" target="_blank">
  <div id="buttonInfo" class="rectButtonVisible">
    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" transform="translate(2 2)"><g stroke="white" stroke-linecap="round" stroke-linejoin="round"><circle cx="8.5" cy="8.5" r="8"/><path d="M8.5 12.5v-4h-1"/><path d="M7.5 12.5h2"/></g><circle cx="8.5" cy="5.5" fill="white" r="1"/></g></svg>
  </div>
</a>
<div id="buttonBack" class="nonClickable rectButtonVisible"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><path d="M9.5 14.5l4-4l-4-4" fill="none" stroke="#444" stroke-linecap="round" stroke-linejoin="round"/></svg></div>
<div id="buttonForward" class="nonClickable rectButtonVisible"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><path d="M11.5 14.5l-4-4l4-4" fill="none" stroke="#444" stroke-linecap="round" stroke-linejoin="round"/></svg></div> 
<div id="buttonDown" class="rectButton" onclick="scrollDown()"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="#fff" stroke-linecap="round" stroke-linejoin="round"><path d="M14.5 6.5l-4 4l-4-4"/><path d="M14.5 10.5l-4 4l-4-4"/></g></svg></div>
<div id="buttonUp" class="rectButton" onclick="scrollUp()"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="#fff" stroke-linecap="round" stroke-linejoin="round"><path d="M6.5 14.5l4-4l4 4"/><path d="M6.5 10.5l4-4l4 4"/></g></svg></div> 

<script>
window.onload = function () {
  var buttons = document.getElementsByClassName("rectButton");
  for (let i=0; i<buttons.length; i++) {
    buttons[i].style.visibility = "visible";
  }
  var buttonDown = document.getElementById("buttonDown");
  buttonDown.classList.add('rectButtonVisible');
  buttonDown.classList.remove('rectButton');

  var buttonUp = document.getElementById("buttonUp");
  buttonUp.classList.add('rectButtonVisible');
  buttonUp.classList.remove('rectButton');
    
  var buttonSizer = document.getElementById("buttonSizer");
  buttonSizer.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="white" stroke-linecap="round" stroke-linejoin="round"><path d="M9.5 16.5v-4.978l-5-.022"/><path d="M18.5 2.5l-7 7"/><path d="M16.5 9.5l-5 .023V4.5"/><path d="M9.5 11.5l-7 7"/></g></svg>';
  if (document.getElementById("buttonTime") !== null) {
    var buttonTime = document.getElementById("buttonTime");
    buttonTime.style.bottom = "50px";
  }
  document.getElementById("expand").value = "+ Show more results";
  document.getElementById("expand").className += " expand";
  var embarkButton = document.getElementById("embark");
  if ( !(embarkButton.href.includes("embarkBackUrl")) ) {
    embarkButton.classList.remove('hidden');
    document.getElementById("logoImage").src = "./../../style/embark.svg";
    document.getElementById("logo").style.background = "#2d2d2d";
  }
}

function openNav() {
  document.getElementById("sidenav").style.width = "250px";
  document.getElementById("main").style.marginLeft = "250px";
  document.getElementById("nav").style.visibility = "visible";
}

function closeNav() {
  document.getElementById("sidenav").style.width = "50px";
  document.getElementById("sidenav").scrollTop = 0;
  document.getElementById("main").style.marginLeft = "50px";
  document.getElementById("nav").style.visibility = "hidden";
}

function scrollDown() {
  window.scrollTo(0,document.body.scrollHeight);
}

function scrollUp() {
  window.scrollTo(0,0);
}

function buttonNav() {
  var button = document.getElementById("buttonSizer");
  if ( button.classList.contains('buttonOpen') ) {
    button.classList.remove('buttonOpen');
    button.classList.add('buttonClose');
    button.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="white" stroke-linecap="round" stroke-linejoin="round"><path d="M9.5 16.5v-4.978l-5-.022"/><path d="M18.5 2.5l-7 7"/><path d="M16.5 9.5l-5 .023V4.5"/><path d="M9.5 11.5l-7 7"/></g></svg>';
    openNav();
  } else if( button.classList.contains('buttonClose') ) {
    button.classList.remove('buttonClose');
    button.classList.add('buttonOpen');
    button.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="white" stroke-linecap="round" stroke-linejoin="round"><path d="M18.5 7.5v-5h-5"/><path d="M18.5 2.5l-6 5.929"/><path d="M7.5 18.5l-5 .023V13.5"/><path d="M8.5 12.5l-6 6"/></g></svg>';
    closeNav();
  };
}

// the following function is currently not used
// it is for future extensions
function overlay_output(link) {
  var rawfile = new XMLHttpRequest();
  rawfile.open('GET', link, false);
  rawfile.overrideMimeType("text");
  rawfile.onreadystatechange = function()
  {
    alert(rawfile.responseText);
    //console.log(rawfile.responseText);
  }
  rawfile.send(null);
}

document.onkeydown = function(e) {
    switch (e.keyCode) {
      case 37:
        document.getElementById("buttonForward").parentNode.click(); 
        break;
      case 39:
        document.getElementById("buttonBack").parentNode.click();       
        break;
    }
};
</script>

</body>
</html>
