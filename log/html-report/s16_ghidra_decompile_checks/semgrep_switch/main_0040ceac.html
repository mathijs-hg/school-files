<!-- 
EMBA - EMBEDDED LINUX ANALYZER

Copyright 2020-2023 Siemens AG
Copyright 2020-2024 Siemens Energy AG

EMBA comes with ABSOLUTELY NO WARRANTY. This is free software, and you are
welcome to redistribute it under the terms of the GNU General Public License.
See LICENSE file for usage of this software.

EMBA is licensed under GPLv3

Author(s) and contributors from the EMBA project are listed here: https://github.com/e-m-b-a/emba/blob/master/CONTRIBUTORS.md
-->

<!-- Used icons: https://github.com/CoreyGinnivan/system-uicons -->
 
<!DOCTYPE html>
<html lang="en">
<head>
  <title>EMBA firmware report</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="./../../style/style.css" type="text/css">
  <link rel="icon" type="image/png" href="./../../style/favicon.png">
</head>
<body>

<div id="sidenav" class="side">
  <div id="logo">
    <a class="inherit" href="./../../index.html"><img class="inherit" id="logoImage" src="./../../style/emba.svg" alt="logo"></a>
  </div>
  <div id="nav">
      <a id="embark" class="hidden" href="{{ embarkBackUrl }}">&laquo; Back to EMBArk</a> <!-- nosem -->
      <a class="backButton" href="./../../index.html">&laquo; Back to main</a>
<a class="modul" href="./../semgrep_switch.html" title="./../semgrep_switch.html" >&laquo; Back to semgrep_switch</a>
      <!-- navigation start -->
      <!-- navigation end -->
      <input id="expand" class="expand_njs hidden" type="button" value="More results:" onclick="this.value=this.value=='+ Show more results'?'- Hide more results':'+ Show more results';">
      <div class="expand_area">
        <!-- etc start -->
        <!-- etc end -->
      </div>
  </div>
  <a href="TIMELINK"><div id="buttonTimeInvisible" class="rectButton"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="white" stroke-linecap="round" stroke-linejoin="round" transform="matrix(-1 0 0 1 19 2)"><circle cx="8.5" cy="8.5" r="8"/><path d="M8.5 5.5v4H5"/></g></svg></div></a>
  <div id="buttonSizer" class="rectButton buttonClose" onclick="buttonNav()"></div>
</div>
<div id="main" class="main">
  <!-- content start -->
<br />
<pre>bool main(int param_1,undefined4 *param_2)</pre>
<br />
<pre>{</pre>
<pre>  bool bVar1;</pre>
<pre>  int iVar2;</pre>
<pre>  ulong uVar3;</pre>
<pre>  ulong uVar4;</pre>
<pre>  undefined *puVar5;</pre>
<pre>  undefined *puVar6;</pre>
<pre>  ulong uVar7;</pre>
<pre>  uint uVar8;</pre>
<pre>  int local_90;</pre>
<pre>  int local_8c;</pre>
<pre>  uint local_88;</pre>
<pre>  ulong local_84;</pre>
<pre>  ulong local_30;</pre>
<pre>  uint local_2c;</pre>
<pre>  uint local_28;</pre>
<pre>  uint local_24;</pre>
<pre>  ulong local_20;</pre>
<pre>  ulong local_1c;</pre>
<pre>  ulong local_18;</pre>
<pre>  uint local_14;</pre>
<pre>  uint local_10 [2];</pre>
<pre>  </pre>
<pre>  switch_init();</pre>
<pre>  if (param_1 &lt; 2) {</pre>
<pre>    usage(*param_2);</pre>
<pre>  }</pre>
<pre>  else {</pre>
<pre>    iVar2 = strcmp((char *)param_2[1],"phy2");</pre>
<pre>    if (iVar2 == 0) {</pre>
<pre>      if (param_1 &lt; 4) {</pre>
<pre>        fwrite("usage: switch phy2 port reg [value]\n",1,0x24,stderr);</pre>
<pre>        return true;</pre>
<pre>      }</pre>
<pre>      uVar3 = strtoul((char *)param_2[2],(char **)0x0,0);</pre>
<pre>      uVar4 = strtoul((char *)param_2[3],(char **)0x0,0);</pre>
<pre>      if (param_1 &lt; 5) {</pre>
<pre>        local_30 = 0;</pre>
<pre><span class="green">        mii_read(uVar3,uVar4,&amp;local_30)</span></span></pre>
<pre>        printf("port %d reg %d, value %04x\n",uVar3,uVar4,local_30);</pre>
<pre>      }</pre>
<pre>      else {</pre>
<pre>        local_30 = strtoul((char *)param_2[4],(char **)0x0,0);</pre>
<pre>        mii_write(uVar3,uVar4,local_30);</pre>
<pre>      }</pre>
<pre>    }</pre>
<pre>    else {</pre>
<pre>      iVar2 = strcmp((char *)param_2[1],"phy_power");</pre>
<pre>      if (iVar2 == 0) {</pre>
<pre>        local_2c = 0;</pre>
<pre>        if (param_1 &lt; 4) {</pre>
<pre>          fwrite("usage: switch phy_power {on|off}\n",1,0x21,stderr);</pre>
<pre>          return true;</pre>
<pre>        }</pre>
<pre>        uVar3 = strtoul((char *)param_2[2],(char **)0x0,0);</pre>
<pre>        if (4 &lt; uVar3) {</pre>
<pre>          fwrite("port range is 0-4\n",1,0x12,stderr);</pre>
<pre>          return true;</pre>
<pre>        }</pre>
<pre><span class="green">        mii_read(uVar3,0,&amp;local_2c)</span></span></pre>
<pre>        iVar2 = strcmp((char *)param_2[3],"on");</pre>
<pre>        if (iVar2 == 0) {</pre>
<pre>          local_2c = local_2c &amp; 0xfffff7ff;</pre>
<pre>        }</pre>
<pre>        else {</pre>
<pre>          iVar2 = strcmp((char *)param_2[3],"off");</pre>
<pre>          if (iVar2 != 0) {</pre>
<pre>            fwrite("usage: switch phy_power {on|off}\n",1,0x21,stderr);</pre>
<pre>            return true;</pre>
<pre>          }</pre>
<pre>          local_2c = local_2c | 0x800;</pre>
<pre>        }</pre>
<pre>        mii_write(uVar3,0,local_2c);</pre>
<pre>      }</pre>
<pre>      else {</pre>
<pre>        iVar2 = strcmp((char *)param_2[1],"phy_media_type");</pre>
<pre>        if (iVar2 == 0) {</pre>
<pre>          local_28 = 0;</pre>
<pre>          if (param_1 &lt; 3) {</pre>
<pre>            fwrite("phy_media_type port [auto|1000MFD|1000MHD|100MFD|100MHD|10MFD|10MHD]\n",1,0x45,</pre>
<pre>                   stderr);</pre>
<pre>            return true;</pre>
<pre>          }</pre>
<pre>          uVar3 = strtoul((char *)param_2[2],(char **)0x0,0);</pre>
<pre>          if (4 &lt; uVar3) {</pre>
<pre>            fwrite("port range is 0-4\n",1,0x12,stderr);</pre>
<pre>            return true;</pre>
<pre>          }</pre>
<pre><span class="green">          mii_read(uVar3,0,&amp;local_28)</span></span></pre>
<pre>          if (param_1 &lt; 4) {</pre>
<pre>            if ((local_28 &amp; 0x1000) == 0) {</pre>
<pre>              if ((local_28 &amp; 0x40) == 0) {</pre>
<pre>                if ((local_28 &amp; 0x2000) == 0) {</pre>
<pre>                  puVar5 = &amp;UNK_00411d40;</pre>
<pre>                }</pre>
<pre>                else {</pre>
<pre>                  puVar5 = &amp;DAT_00411d38;</pre>
<pre>                }</pre>
<pre>              }</pre>
<pre>              else {</pre>
<pre>                puVar5 = &amp;UNK_00411d44;</pre>
<pre>              }</pre>
<pre>              if ((local_28 &amp; 0x100) == 0) {</pre>
<pre>                puVar6 = &amp;DAT_00411d50;</pre>
<pre>              }</pre>
<pre>              else {</pre>
<pre>                puVar6 = &amp;DAT_00411d4c;</pre>
<pre>              }</pre>
<pre>              printf("%s%s\n",puVar5,puVar6);</pre>
<pre>            }</pre>
<pre>            else {</pre>
<pre>              puts("auto");</pre>
<pre>            }</pre>
<pre>          }</pre>
<pre>          else {</pre>
<pre>            iVar2 = strcmp((char *)param_2[3],"auto");</pre>
<pre>            if (iVar2 == 0) {</pre>
<pre>              local_28 = local_28 | 0x3040;</pre>
<pre>            }</pre>
<pre>            else {</pre>
<pre>              local_28 = local_28 &amp; 0xffffefff;</pre>
<pre>              iVar2 = strcmp((char *)param_2[3],"1000MFD");</pre>
<pre>              if (iVar2 == 0) {</pre>
<pre>                local_28 = local_28 &amp; 0xffffdfff | 0x140;</pre>
<pre>              }</pre>
<pre>              else {</pre>
<pre>                iVar2 = strcmp((char *)param_2[3],"1000MHD");</pre>
<pre>                if (iVar2 == 0) {</pre>
<pre>                  local_28 = local_28 &amp; 0xffffdeff | 0x40;</pre>
<pre>                }</pre>
<pre>                else {</pre>
<pre>                  iVar2 = strcmp((char *)param_2[3],"100MFD");</pre>
<pre>                  if (iVar2 == 0) {</pre>
<pre>                    local_28 = local_28 &amp; 0xffffffbf | 0x2100;</pre>
<pre>                  }</pre>
<pre>                  else {</pre>
<pre>                    iVar2 = strcmp((char *)param_2[3],"100MHD");</pre>
<pre>                    if (iVar2 == 0) {</pre>
<pre>                      local_28 = local_28 &amp; 0xfffffebf | 0x2000;</pre>
<pre>                    }</pre>
<pre>                    else {</pre>
<pre>                      iVar2 = strcmp((char *)param_2[3],"10MFD");</pre>
<pre>                      if (iVar2 == 0) {</pre>
<pre>                        local_28 = local_28 &amp; 0xffffdfbf | 0x100;</pre>
<pre>                      }</pre>
<pre>                      else {</pre>
<pre>                        iVar2 = strcmp((char *)param_2[3],"10MHD");</pre>
<pre>                        if (iVar2 != 0) {</pre>
<pre>                          fprintf(stderr,"unsupported media type: %s\n",param_2[3]);</pre>
<pre>                          return true;</pre>
<pre>                        }</pre>
<pre>                        local_28 = local_28 &amp; 0xffffdebf;</pre>
<pre>                      }</pre>
<pre>                    }</pre>
<pre>                  }</pre>
<pre>                }</pre>
<pre>              }</pre>
<pre>            }</pre>
<pre>            mii_write(uVar3,0,local_28);</pre>
<pre>          }</pre>
<pre>        }</pre>
<pre>        else {</pre>
<pre>          iVar2 = strcmp((char *)param_2[1],"phy_link_status");</pre>
<pre>          if (iVar2 == 0) {</pre>
<pre>            local_84 = 0xff;</pre>
<pre>            local_24 = 0;</pre>
<pre>            bVar1 = false;</pre>
<pre>            if (2 &lt; param_1) {</pre>
<pre>              local_84 = strtoul((char *)param_2[2],(char **)0x0,0);</pre>
<pre>            }</pre>
<pre>            for (local_88 = 0; local_88 &lt; 5; local_88 = local_88 + 1) {</pre>
<pre>              if ((1 &lt;&lt; (local_88 &amp; 0x1f) &amp; local_84) != 0) {</pre>
<pre><span class="green">                reg_read(local_88 * 0x100 + 0x3008,&amp;local_24)</span></span></pre>
<pre>                printf("port %d ",local_88);</pre>
<pre>                if ((local_24 &amp; 1) == 0) {</pre>
<pre>                  puts("Link DOWN");</pre>
<pre>                }</pre>
<pre>                else {</pre>
<pre>                  bVar1 = true;</pre>
<pre>                  if ((local_24 &amp; 8) == 0) {</pre>
<pre>                    if ((local_24 &amp; 4) == 0) {</pre>
<pre>                      puVar5 = &amp;UNK_00411d40;</pre>
<pre>                    }</pre>
<pre>                    else {</pre>
<pre>                      puVar5 = &amp;DAT_00411d38;</pre>
<pre>                    }</pre>
<pre>                  }</pre>
<pre>                  else {</pre>
<pre>                    puVar5 = &amp;UNK_00411d44;</pre>
<pre>                  }</pre>
<pre>                  if ((local_24 &amp; 2) == 0) {</pre>
<pre>                    puVar6 = &amp;DAT_00411d50;</pre>
<pre>                  }</pre>
<pre>                  else {</pre>
<pre>                    puVar6 = &amp;DAT_00411d4c;</pre>
<pre>                  }</pre>
<pre>                  printf("Link UP %s%s\n",puVar5,puVar6);</pre>
<pre>                }</pre>
<pre>              }</pre>
<pre>            }</pre>
<pre>            switch_fini();</pre>
<pre>            return !bVar1;</pre>
<pre>          }</pre>
<pre>          if (param_1 == 2) {</pre>
<pre>            iVar2 = strncmp((char *)param_2[1],"dump",5);</pre>
<pre>            if (iVar2 == 0) {</pre>
<pre>              table_dump();</pre>
<pre>            }</pre>
<pre>            else {</pre>
<pre>              iVar2 = strncmp((char *)param_2[1],"clear",6);</pre>
<pre>              if (iVar2 == 0) {</pre>
<pre>                table_clear();</pre>
<pre>                puts("done.");</pre>
<pre>              }</pre>
<pre>              else {</pre>
<pre>                iVar2 = strncmp((char *)param_2[1],"phy",4);</pre>
<pre>                if (iVar2 == 0) {</pre>
<pre>                  phy_dump(0x20);</pre>
<pre>                }</pre>
<pre>                else {</pre>
<pre>                  usage(*param_2);</pre>
<pre>                }</pre>
<pre>              }</pre>
<pre>            }</pre>
<pre>          }</pre>
<pre>          else {</pre>
<pre>            iVar2 = strncmp((char *)param_2[1],"add",4);</pre>
<pre>            if (iVar2 == 0) {</pre>
<pre>              table_add(param_1,param_2);</pre>
<pre>            }</pre>
<pre>            else {</pre>
<pre>              iVar2 = strncmp((char *)param_2[1],"mymac",4);</pre>
<pre>              if (iVar2 == 0) {</pre>
<pre>                table_add(param_1,param_2);</pre>
<pre>              }</pre>
<pre>              else {</pre>
<pre>                iVar2 = strncmp((char *)param_2[1],"filt",5);</pre>
<pre>                if (iVar2 == 0) {</pre>
<pre>                  table_add(param_1,param_2);</pre>
<pre>                }</pre>
<pre>                else {</pre>
<pre>                  iVar2 = strncmp((char *)param_2[1],"del",4);</pre>
<pre>                  if (iVar2 == 0) {</pre>
<pre>                    iVar2 = strncmp((char *)param_2[4],"fid",4);</pre>
<pre>                    if (iVar2 == 0) {</pre>
<pre>                      table_del_fid(param_1,param_2);</pre>
<pre>                    }</pre>
<pre>                    else {</pre>
<pre>                      iVar2 = strncmp((char *)param_2[4],"vid",4);</pre>
<pre>                      if (iVar2 == 0) {</pre>
<pre>                        table_del_vid(param_1,param_2);</pre>
<pre>                      }</pre>
<pre>                      else {</pre>
<pre>                        usage(*param_2);</pre>
<pre>                      }</pre>
<pre>                    }</pre>
<pre>                  }</pre>
<pre>                  else {</pre>
<pre>                    iVar2 = strncmp((char *)param_2[1],"search",7);</pre>
<pre>                    if (iVar2 == 0) {</pre>
<pre>                      iVar2 = strncmp((char *)param_2[4],"fid",4);</pre>
<pre>                      if (iVar2 == 0) {</pre>
<pre>                        table_search_mac_fid(param_1,param_2);</pre>
<pre>                      }</pre>
<pre>                      else {</pre>
<pre>                        iVar2 = strncmp((char *)param_2[4],"vid",4);</pre>
<pre>                        if (iVar2 == 0) {</pre>
<pre>                          table_search_mac_vid(param_1,param_2);</pre>
<pre>                        }</pre>
<pre>                        else {</pre>
<pre>                          usage(*param_2);</pre>
<pre>                        }</pre>
<pre>                      }</pre>
<pre>                    }</pre>
<pre>                    else {</pre>
<pre>                      iVar2 = strncmp((char *)param_2[1],"phy",4);</pre>
<pre>                      if (iVar2 == 0) {</pre>
<pre>                        if (param_1 == 3) {</pre>
<pre>                          iVar2 = strncmp((char *)param_2[2],"mt7530",7);</pre>
<pre>                          if (iVar2 == 0) {</pre>
<pre>                            dump_gphy();</pre>
<pre>                          }</pre>
<pre>                          else {</pre>
<pre>                            uVar3 = strtoul((char *)param_2[2],(char **)0x0,10);</pre>
<pre>                            phy_dump(uVar3);</pre>
<pre>                          }</pre>
<pre>                        }</pre>
<pre>                        else {</pre>
<pre>                          phy_dump(0x20);</pre>
<pre>                        }</pre>
<pre>                      }</pre>
<pre>                      else {</pre>
<pre>                        iVar2 = strncmp((char *)param_2[1],"sip",5);</pre>
<pre>                        if (iVar2 == 0) {</pre>
<pre>                          if (param_1 &lt; 3) {</pre>
<pre>                            usage(*param_2);</pre>
<pre>                          }</pre>
<pre>                          iVar2 = strncmp((char *)param_2[2],"dump",5);</pre>
<pre>                          if (iVar2 == 0) {</pre>
<pre>                            sip_dump();</pre>
<pre>                          }</pre>
<pre>                          else {</pre>
<pre>                            iVar2 = strncmp((char *)param_2[2],"add",4);</pre>
<pre>                            if (iVar2 == 0) {</pre>
<pre>                              sip_add(param_1,param_2);</pre>
<pre>                            }</pre>
<pre>                            else {</pre>
<pre>                              iVar2 = strncmp((char *)param_2[2],"del",4);</pre>
<pre>                              if (iVar2 == 0) {</pre>
<pre>                                sip_del(param_1,param_2);</pre>
<pre>                              }</pre>
<pre>                              else {</pre>
<pre>                                iVar2 = strncmp((char *)param_2[2],"clear",6);</pre>
<pre>                                if (iVar2 == 0) {</pre>
<pre>                                  sip_clear();</pre>
<pre>                                }</pre>
<pre>                                else {</pre>
<pre>                                  usage(*param_2);</pre>
<pre>                                }</pre>
<pre>                              }</pre>
<pre>                            }</pre>
<pre>                          }</pre>
<pre>                        }</pre>
<pre>                        else {</pre>
<pre>                          iVar2 = strncmp((char *)param_2[1],"dip",4);</pre>
<pre>                          if (iVar2 == 0) {</pre>
<pre>                            if (param_1 &lt; 3) {</pre>
<pre>                              usage(*param_2);</pre>
<pre>                            }</pre>
<pre>                            iVar2 = strncmp((char *)param_2[2],"dump",5);</pre>
<pre>                            if (iVar2 == 0) {</pre>
<pre>                              dip_dump();</pre>
<pre>                            }</pre>
<pre>                            else {</pre>
<pre>                              iVar2 = strncmp((char *)param_2[2],"add",4);</pre>
<pre>                              if (iVar2 == 0) {</pre>
<pre>                                dip_add(param_1,param_2);</pre>
<pre>                              }</pre>
<pre>                              else {</pre>
<pre>                                iVar2 = strncmp((char *)param_2[2],"del",4);</pre>
<pre>                                if (iVar2 == 0) {</pre>
<pre>                                  dip_del(param_1,param_2);</pre>
<pre>                                }</pre>
<pre>                                else {</pre>
<pre>                                  iVar2 = strncmp((char *)param_2[2],"clear",6);</pre>
<pre>                                  if (iVar2 == 0) {</pre>
<pre>                                    dip_clear();</pre>
<pre>                                  }</pre>
<pre>                                  else {</pre>
<pre>                                    usage(*param_2);</pre>
<pre>                                  }</pre>
<pre>                                }</pre>
<pre>                              }</pre>
<pre>                            }</pre>
<pre>                          }</pre>
<pre>                          else {</pre>
<pre>                            iVar2 = strncmp((char *)param_2[1],"mirror",7);</pre>
<pre>                            if (iVar2 == 0) {</pre>
<pre>                              if (param_1 &lt; 3) {</pre>
<pre>                                usage(*param_2);</pre>
<pre>                              }</pre>
<pre>                              iVar2 = strncmp((char *)param_2[2],"monitor",8);</pre>
<pre>                              if (iVar2 == 0) {</pre>
<pre>                                set_mirror_to(param_1,param_2);</pre>
<pre>                              }</pre>
<pre>                              else {</pre>
<pre>                                iVar2 = strncmp((char *)param_2[2],"target",7);</pre>
<pre>                                if (iVar2 == 0) {</pre>
<pre>                                  set_mirror_from(param_1,param_2);</pre>
<pre>                                }</pre>
<pre>                                else {</pre>
<pre>                                  usage(*param_2);</pre>
<pre>                                }</pre>
<pre>                              }</pre>
<pre>                            }</pre>
<pre>                            else {</pre>
<pre>                              iVar2 = strncmp((char *)param_2[1],"acl",4);</pre>
<pre>                              if (iVar2 == 0) {</pre>
<pre>                                if (param_1 &lt; 3) {</pre>
<pre>                                  usage(*param_2);</pre>
<pre>                                }</pre>
<pre>                                iVar2 = strncmp((char *)param_2[2],"dip",4);</pre>
<pre>                                if (iVar2 == 0) {</pre>
<pre>                                  iVar2 = strncmp((char *)param_2[3],"add",4);</pre>
<pre>                                  if (iVar2 == 0) {</pre>
<pre>                                    acl_dip_add(param_1,param_2);</pre>
<pre>                                  }</pre>
<pre>                                  else {</pre>
<pre>                                    iVar2 = strncmp((char *)param_2[3],"modup",6);</pre>
<pre>                                    if (iVar2 == 0) {</pre>
<pre>                                      acl_dip_modify(param_1,param_2);</pre>
<pre>                                    }</pre>
<pre>                                    else {</pre>
<pre>                                      iVar2 = strncmp((char *)param_2[3],"pppoe",6);</pre>
<pre>                                      if (iVar2 == 0) {</pre>
<pre>                                        acl_dip_pppoe(param_1,param_2);</pre>
<pre>                                      }</pre>
<pre>                                      else {</pre>
<pre>                                        iVar2 = strncmp((char *)param_2[3],"trtcm",4);</pre>
<pre>                                        if (iVar2 == 0) {</pre>
<pre>                                          acl_dip_trtcm(param_1,param_2);</pre>
<pre>                                        }</pre>
<pre>                                        else {</pre>
<pre>                                          iVar2 = strncmp((char *)param_2[3],"meter",6);</pre>
<pre>                                          if (iVar2 == 0) {</pre>
<pre>                                            acl_dip_meter(param_1,param_2);</pre>
<pre>                                          }</pre>
<pre>                                          else {</pre>
<pre>                                            usage(*param_2);</pre>
<pre>                                          }</pre>
<pre>                                        }</pre>
<pre>                                      }</pre>
<pre>                                    }</pre>
<pre>                                  }</pre>
<pre>                                }</pre>
<pre>                                else {</pre>
<pre>                                  iVar2 = strncmp((char *)param_2[2],"etype",6);</pre>
<pre>                                  if (iVar2 == 0) {</pre>
<pre>                                    iVar2 = strncmp((char *)param_2[3],"add",4);</pre>
<pre>                                    if (iVar2 == 0) {</pre>
<pre>                                      acl_ethertype(param_1,param_2);</pre>
<pre>                                    }</pre>
<pre>                                    else {</pre>
<pre>                                      usage(*param_2);</pre>
<pre>                                    }</pre>
<pre>                                  }</pre>
<pre>                                  else {</pre>
<pre>                                    iVar2 = strncmp((char *)param_2[2],"port",5);</pre>
<pre>                                    if (iVar2 == 0) {</pre>
<pre>                                      iVar2 = strncmp((char *)param_2[3],"add",4);</pre>
<pre>                                      if (iVar2 == 0) {</pre>
<pre>                                        acl_sp_add(param_1,param_2);</pre>
<pre>                                      }</pre>
<pre>                                      else {</pre>
<pre>                                        usage(*param_2);</pre>
<pre>                                      }</pre>
<pre>                                    }</pre>
<pre>                                    else {</pre>
<pre>                                      iVar2 = strncmp((char *)param_2[2],"L4",5);</pre>
<pre>                                      if (iVar2 == 0) {</pre>
<pre>                                        iVar2 = strncmp((char *)param_2[3],"add",4);</pre>
<pre>                                        if (iVar2 == 0) {</pre>
<pre>                                          acl_l4_add(param_1,param_2);</pre>
<pre>                                        }</pre>
<pre>                                        else {</pre>
<pre>                                          usage(*param_2);</pre>
<pre>                                        }</pre>
<pre>                                      }</pre>
<pre>                                    }</pre>
<pre>                                  }</pre>
<pre>                                }</pre>
<pre>                              }</pre>
<pre>                              else {</pre>
<pre>                                iVar2 = strncmp((char *)param_2[1],"vlan",5);</pre>
<pre>                                if (iVar2 == 0) {</pre>
<pre>                                  if (param_1 &lt; 3) {</pre>
<pre>                                    usage(*param_2);</pre>
<pre>                                  }</pre>
<pre>                                  iVar2 = strncmp((char *)param_2[2],"dump",5);</pre>
<pre>                                  if (iVar2 == 0) {</pre>
<pre>                                    vlan_dump();</pre>
<pre>                                  }</pre>
<pre>                                  else {</pre>
<pre>                                    iVar2 = strncmp((char *)param_2[2],"set",4);</pre>
<pre>                                    if (iVar2 == 0) {</pre>
<pre>                                      vlan_set(param_1,param_2);</pre>
<pre>                                    }</pre>
<pre>                                    else {</pre>
<pre>                                      iVar2 = strncmp((char *)param_2[2],"clear",4);</pre>
<pre>                                      if (iVar2 == 0) {</pre>
<pre>                                        vlan_clear(param_1,param_2);</pre>
<pre>                                      }</pre>
<pre>                                      else {</pre>
<pre>                                        usage(*param_2);</pre>
<pre>                                      }</pre>
<pre>                                    }</pre>
<pre>                                  }</pre>
<pre>                                }</pre>
<pre>                                else {</pre>
<pre>                                  iVar2 = strncmp((char *)param_2[1],"reg",4);</pre>
<pre>                                  if (iVar2 == 0) {</pre>
<pre>                                    local_20 = 0;</pre>
<pre>                                    if (param_1 &lt; 4) {</pre>
<pre>                                      usage(*param_2);</pre>
<pre>                                    }</pre>
<pre>                                    if (*(char *)param_2[2] == 'r') {</pre>
<pre>                                      uVar3 = strtoul((char *)param_2[3],(char **)0x0,0x10);</pre>
<pre><span class="green">                                      reg_read(uVar3,&amp;local_20)</span></span></pre>
<pre>                                      printf("switch reg read offset=%x, value=%x\n",uVar3,local_20)</pre>
<pre>                                      ;</pre>
<pre>                                    }</pre>
<pre>                                    else if (*(char *)param_2[2] == 'w') {</pre>
<pre>                                      if (param_1 != 5) {</pre>
<pre>                                        usage(*param_2);</pre>
<pre>                                      }</pre>
<pre>                                      uVar3 = strtoul((char *)param_2[3],(char **)0x0,0x10);</pre>
<pre>                                      local_20 = strtoul((char *)param_2[4],(char **)0x0,0x10);</pre>
<pre>                                      printf("switch reg write offset=%x, value=%x\n",uVar3,local_20</pre>
<pre>                                            );</pre>
<pre>                                      reg_write(uVar3,local_20);</pre>
<pre>                                    }</pre>
<pre>                                    else if (*(char *)param_2[2] == 'd') {</pre>
<pre>                                      uVar3 = strtoul((char *)param_2[3],(char **)0x0,0x10);</pre>
<pre>                                      for (local_90 = 0; local_90 &lt; 0x10; local_90 = local_90 + 1) {</pre>
<pre>                                        printf("0x%08x: ",local_90 * 0x10 + uVar3);</pre>
<pre>                                        for (local_8c = 0; local_8c &lt; 4; local_8c = local_8c + 1) {</pre>
<pre><span class="green">                                          reg_read((local_90 * 4 + local_8c) * 4 + uVar3,&amp;local_20)</span></span></pre>
<pre>                                          printf(" 0x%08x",local_20);</pre>
<pre>                                        }</pre>
<pre>                                        putchar(10);</pre>
<pre>                                      }</pre>
<pre>                                    }</pre>
<pre>                                    else {</pre>
<pre>                                      usage(*param_2);</pre>
<pre>                                    }</pre>
<pre>                                  }</pre>
<pre>                                  else {</pre>
<pre>                                    iVar2 = strncmp((char *)param_2[1],"TrReg",4);</pre>
<pre>                                    if (iVar2 == 0) {</pre>
<pre>                                      local_1c = 0;</pre>
<pre>                                      local_18 = 0;</pre>
<pre>                                      if (param_1 &lt; 4) {</pre>
<pre>                                        usage(*param_2);</pre>
<pre>                                      }</pre>
<pre>                                      if (*(char *)param_2[2] == 'r') {</pre>
<pre>                                        reg_write_tr(0x1f,0x52b5);</pre>
<pre>                                        uVar3 = strtoul((char *)param_2[3],(char **)0x0,0x10);</pre>
<pre>                                        uVar4 = strtoul((char *)param_2[4],(char **)0x0,0x10);</pre>
<pre>                                        uVar7 = strtoul((char *)param_2[5],(char **)0x0,0x10);</pre>
<pre>                                        printf("ch_addr = %x, node_addr=%x, data_addr=%x\n",uVar3,</pre>
<pre>                                               uVar4,uVar7);</pre>
<pre>                                        uVar8 = uVar3 &lt;&lt; 0xb | 0xa000 | uVar4 &lt;&lt; 7 | uVar7 &lt;&lt; 1;</pre>
<pre>                                        reg_write_tr(0x10,uVar8);</pre>
<pre>                                        reg_read_tr(0x11,&amp;local_1c);</pre>
<pre>                                        reg_read_tr(0x12,&amp;local_18);</pre>
<pre>                                        printf("switch TrReg read Tr_reg_control=%x, value_H=%x, value_L=%x\n"</pre>
<pre>                                               ,uVar8,local_18,local_1c);</pre>
<pre>                                      }</pre>
<pre>                                      else if (*(char *)param_2[2] == 'w') {</pre>
<pre>                                        reg_write_tr(0x1f,0x52b5);</pre>
<pre>                                        uVar3 = strtoul((char *)param_2[3],(char **)0x0,0x10);</pre>
<pre>                                        uVar4 = strtoul((char *)param_2[4],(char **)0x0,0x10);</pre>
<pre>                                        uVar7 = strtoul((char *)param_2[5],(char **)0x0,0x10);</pre>
<pre>                                        local_18 = strtoul((char *)param_2[6],(char **)0x0,0x10);</pre>
<pre>                                        local_1c = strtoul((char *)param_2[7],(char **)0x0,0x10);</pre>
<pre>                                        printf("ch_addr = %x, node_addr=%x, data_addr=%x\n",uVar3,</pre>
<pre>                                               uVar4,uVar7);</pre>
<pre>                                        uVar8 = uVar3 &lt;&lt; 0xb | 0x8000 | uVar4 &lt;&lt; 7 | uVar7 &lt;&lt; 1;</pre>
<pre>                                        reg_write_tr(0x11,local_1c);</pre>
<pre>                                        reg_write_tr(0x12,local_18);</pre>
<pre>                                        reg_write_tr(0x10,uVar8);</pre>
<pre>                                        printf("switch TrReg Write Tr_reg_control=%x, value_H=%x, value_L=%x\n"</pre>
<pre>                                               ,uVar8,local_18,local_1c);</pre>
<pre>                                      }</pre>
<pre>                                      else {</pre>
<pre>                                        usage(*param_2);</pre>
<pre>                                      }</pre>
<pre>                                    }</pre>
<pre>                                    else {</pre>
<pre>                                      iVar2 = strncmp((char *)param_2[1],"ingress-rate",6);</pre>
<pre>                                      if (iVar2 == 0) {</pre>
<pre>                                        if (*(char *)(param_2[2] + 1) == 'n') {</pre>
<pre>                                          uVar3 = strtoul((char *)param_2[3],(char **)0x0,0);</pre>
<pre>                                          uVar4 = strtoul((char *)param_2[4],(char **)0x0,0);</pre>
<pre>                                          ingress_rate_set(1,uVar3,uVar4);</pre>
<pre>                                          printf("switch port=%d, bw=%d\n",uVar3,uVar4);</pre>
<pre>                                        }</pre>
<pre>                                        else if (*(char *)(param_2[2] + 1) == 'f') {</pre>
<pre>                                          if (param_1 != 4) {</pre>
<pre>                                            usage(*param_2);</pre>
<pre>                                          }</pre>
<pre>                                          uVar3 = strtoul((char *)param_2[3],(char **)0x0,0);</pre>
<pre>                                          ingress_rate_set(0,uVar3,0);</pre>
<pre>                                          printf("switch port=%d ingress rate limit off\n",uVar3);</pre>
<pre>                                        }</pre>
<pre>                                        else {</pre>
<pre>                                          usage(*param_2);</pre>
<pre>                                        }</pre>
<pre>                                      }</pre>
<pre>                                      else {</pre>
<pre>                                        iVar2 = strncmp((char *)param_2[1],"egress-rate",6);</pre>
<pre>                                        if (iVar2 == 0) {</pre>
<pre>                                          if (*(char *)(param_2[2] + 1) == 'n') {</pre>
<pre>                                            uVar3 = strtoul((char *)param_2[3],(char **)0x0,0);</pre>
<pre>                                            uVar4 = strtoul((char *)param_2[4],(char **)0x0,0);</pre>
<pre>                                            egress_rate_set(1,uVar3,uVar4);</pre>
<pre>                                            printf("switch port=%d, bw=%d\n",uVar3,uVar4);</pre>
<pre>                                          }</pre>
<pre>                                          else if (*(char *)(param_2[2] + 1) == 'f') {</pre>
<pre>                                            if (param_1 != 4) {</pre>
<pre>                                              usage(*param_2);</pre>
<pre>                                            }</pre>
<pre>                                            uVar3 = strtoul((char *)param_2[3],(char **)0x0,0);</pre>
<pre>                                            egress_rate_set(0,uVar3,0);</pre>
<pre>                                            printf("switch port=%d egress rate limit off\n",uVar3);</pre>
<pre>                                          }</pre>
<pre>                                          else {</pre>
<pre>                                            usage(*param_2);</pre>
<pre>                                          }</pre>
<pre>                                        }</pre>
<pre>                                        else {</pre>
<pre>                                          iVar2 = strncmp((char *)param_2[1],"tag",4);</pre>
<pre>                                          if (iVar2 == 0) {</pre>
<pre>                                            local_14 = 0;</pre>
<pre>                                            uVar3 = strtoul((char *)param_2[3],(char **)0x0,0);</pre>
<pre>                                            iVar2 = uVar3 * 0x100 + 0x2004;</pre>
<pre><span class="green">                                            reg_read(iVar2,&amp;local_14)</span></span></pre>
<pre>                                            if (*(char *)(param_2[2] + 1) == 'n') {</pre>
<pre>                                              local_14 = local_14 | 0x20000000;</pre>
<pre>                                              reg_write(iVar2,local_14);</pre>
<pre>                                              printf("tag vid at port %d\n",uVar3);</pre>
<pre>                                            }</pre>
<pre>                                            else if (*(char *)(param_2[2] + 1) == 'f') {</pre>
<pre>                                              local_14 = local_14 &amp; 0xc0ffffff;</pre>
<pre>                                              reg_write(iVar2,local_14);</pre>
<pre>                                              printf("untag vid at port %d\n",uVar3);</pre>
<pre>                                            }</pre>
<pre>                                            else {</pre>
<pre>                                              usage(*param_2);</pre>
<pre>                                            }</pre>
<pre>                                          }</pre>
<pre>                                          else {</pre>
<pre>                                            iVar2 = strncmp((char *)param_2[1],"pvid",5);</pre>
<pre>                                            if (iVar2 == 0) {</pre>
<pre>                                              local_10[0] = 0;</pre>
<pre>                                              uVar3 = strtoul((char *)param_2[2],(char **)0x0,0);</pre>
<pre>                                              uVar4 = strtoul((char *)param_2[3],(char **)0x0,0);</pre>
<pre>                                              iVar2 = uVar3 * 0x100 + 0x2014;</pre>
<pre><span class="green">                                              reg_read(iVar2,local_10)</span></span></pre>
<pre>                                              local_10[0] = local_10[0] &amp; 0xfffff000 | uVar4;</pre>
<pre>                                              reg_write(iVar2,local_10[0]);</pre>
<pre>                                              printf("Set port %d pvid %d.\n",uVar3,uVar4);</pre>
<pre>                                            }</pre>
<pre>                                            else {</pre>
<pre>                                              iVar2 = strncmp((char *)param_2[1],"igmpsnoop",10);</pre>
<pre>                                              if (iVar2 == 0) {</pre>
<pre>                                                if (param_1 &lt; 3) {</pre>
<pre>                                                  usage(*param_2);</pre>
<pre>                                                }</pre>
<pre>                                                iVar2 = strncmp((char *)param_2[2],"on",3);</pre>
<pre>                                                if (iVar2 == 0) {</pre>
<pre>                                                  igmp_on(param_1,param_2);</pre>
<pre>                                                }</pre>
<pre>                                                else {</pre>
<pre>                                                  iVar2 = strncmp((char *)param_2[2],"off",4);</pre>
<pre>                                                  if (iVar2 == 0) {</pre>
<pre>                                                    igmp_off();</pre>
<pre>                                                  }</pre>
<pre>                                                  else {</pre>
<pre>                                                    iVar2 = strncmp((char *)param_2[2],"enable",7);</pre>
<pre>                                                    if (iVar2 == 0) {</pre>
<pre>                                                      igmp_enable(param_1,param_2);</pre>
<pre>                                                    }</pre>
<pre>                                                    else {</pre>
<pre>                                                      iVar2 = strncmp((char *)param_2[2],"disable",8</pre>
<pre>                                                                     );</pre>
<pre>                                                      if (iVar2 == 0) {</pre>
<pre>                                                        igmp_disable(param_1,param_2);</pre>
<pre>                                                      }</pre>
<pre>                                                      else {</pre>
<pre>                                                        usage(*param_2);</pre>
<pre>                                                      }</pre>
<pre>                                                    }</pre>
<pre>                                                  }</pre>
<pre>                                                }</pre>
<pre>                                              }</pre>
<pre>                                              else {</pre>
<pre>                                                iVar2 = strncmp((char *)param_2[1],"crossover",10);</pre>
<pre>                                                if (iVar2 == 0) {</pre>
<pre>                                                  if (param_1 &lt; 4) {</pre>
<pre>                                                    usage(*param_2);</pre>
<pre>                                                  }</pre>
<pre>                                                  else {</pre>
<pre>                                                    phy_crossover(param_1,param_2);</pre>
<pre>                                                  }</pre>
<pre>                                                }</pre>
<pre>                                                else {</pre>
<pre>                                                  usage(*param_2);</pre>
<pre>                                                }</pre>
<pre>                                              }</pre>
<pre>                                            }</pre>
<pre>                                          }</pre>
<pre>                                        }</pre>
<pre>                                      }</pre>
<pre>                                    }</pre>
<pre>                                  }</pre>
<pre>                                }</pre>
<pre>                              }</pre>
<pre>                            }</pre>
<pre>                          }</pre>
<pre>                        }</pre>
<pre>                      }</pre>
<pre>                    }</pre>
<pre>                  }</pre>
<pre>                }</pre>
<pre>              }</pre>
<pre>            }</pre>
<pre>          }</pre>
<pre>        }</pre>
<pre>      }</pre>
<pre>    }</pre>
<pre>  }</pre>
<pre>  switch_fini();</pre>
<pre>  return false;</pre>
<pre>}</pre>
<br />
<pre>[ASK_GPT] 07bb861d99403546</pre>
  <!-- content end -->
</div>

<a href="https://github.com/e-m-b-a/emba" title="github.com/e-m-b-a/emba" target="_blank">
  <div id="buttonInfo" class="rectButtonVisible">
    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" transform="translate(2 2)"><g stroke="white" stroke-linecap="round" stroke-linejoin="round"><circle cx="8.5" cy="8.5" r="8"/><path d="M8.5 12.5v-4h-1"/><path d="M7.5 12.5h2"/></g><circle cx="8.5" cy="5.5" fill="white" r="1"/></g></svg>
  </div>
</a>
<div id="buttonBack" class="nonClickable rectButtonVisible"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><path d="M9.5 14.5l4-4l-4-4" fill="none" stroke="#444" stroke-linecap="round" stroke-linejoin="round"/></svg></div>
<div id="buttonForward" class="nonClickable rectButtonVisible"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><path d="M11.5 14.5l-4-4l4-4" fill="none" stroke="#444" stroke-linecap="round" stroke-linejoin="round"/></svg></div> 
<div id="buttonDown" class="rectButton" onclick="scrollDown()"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="#fff" stroke-linecap="round" stroke-linejoin="round"><path d="M14.5 6.5l-4 4l-4-4"/><path d="M14.5 10.5l-4 4l-4-4"/></g></svg></div>
<div id="buttonUp" class="rectButton" onclick="scrollUp()"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="#fff" stroke-linecap="round" stroke-linejoin="round"><path d="M6.5 14.5l4-4l4 4"/><path d="M6.5 10.5l4-4l4 4"/></g></svg></div> 

<script>
window.onload = function () {
  var buttons = document.getElementsByClassName("rectButton");
  for (let i=0; i<buttons.length; i++) {
    buttons[i].style.visibility = "visible";
  }
  var buttonDown = document.getElementById("buttonDown");
  buttonDown.classList.add('rectButtonVisible');
  buttonDown.classList.remove('rectButton');

  var buttonUp = document.getElementById("buttonUp");
  buttonUp.classList.add('rectButtonVisible');
  buttonUp.classList.remove('rectButton');
    
  var buttonSizer = document.getElementById("buttonSizer");
  buttonSizer.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="white" stroke-linecap="round" stroke-linejoin="round"><path d="M9.5 16.5v-4.978l-5-.022"/><path d="M18.5 2.5l-7 7"/><path d="M16.5 9.5l-5 .023V4.5"/><path d="M9.5 11.5l-7 7"/></g></svg>';
  if (document.getElementById("buttonTime") !== null) {
    var buttonTime = document.getElementById("buttonTime");
    buttonTime.style.bottom = "50px";
  }
  document.getElementById("expand").value = "+ Show more results";
  document.getElementById("expand").className += " expand";
  var embarkButton = document.getElementById("embark");
  if ( !(embarkButton.href.includes("embarkBackUrl")) ) {
    embarkButton.classList.remove('hidden');
    document.getElementById("logoImage").src = "./../../style/embark.svg";
    document.getElementById("logo").style.background = "#2d2d2d";
  }
}

function openNav() {
  document.getElementById("sidenav").style.width = "250px";
  document.getElementById("main").style.marginLeft = "250px";
  document.getElementById("nav").style.visibility = "visible";
}

function closeNav() {
  document.getElementById("sidenav").style.width = "50px";
  document.getElementById("sidenav").scrollTop = 0;
  document.getElementById("main").style.marginLeft = "50px";
  document.getElementById("nav").style.visibility = "hidden";
}

function scrollDown() {
  window.scrollTo(0,document.body.scrollHeight);
}

function scrollUp() {
  window.scrollTo(0,0);
}

function buttonNav() {
  var button = document.getElementById("buttonSizer");
  if ( button.classList.contains('buttonOpen') ) {
    button.classList.remove('buttonOpen');
    button.classList.add('buttonClose');
    button.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="white" stroke-linecap="round" stroke-linejoin="round"><path d="M9.5 16.5v-4.978l-5-.022"/><path d="M18.5 2.5l-7 7"/><path d="M16.5 9.5l-5 .023V4.5"/><path d="M9.5 11.5l-7 7"/></g></svg>';
    openNav();
  } else if( button.classList.contains('buttonClose') ) {
    button.classList.remove('buttonClose');
    button.classList.add('buttonOpen');
    button.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="white" stroke-linecap="round" stroke-linejoin="round"><path d="M18.5 7.5v-5h-5"/><path d="M18.5 2.5l-6 5.929"/><path d="M7.5 18.5l-5 .023V13.5"/><path d="M8.5 12.5l-6 6"/></g></svg>';
    closeNav();
  };
}

// the following function is currently not used
// it is for future extensions
function overlay_output(link) {
  var rawfile = new XMLHttpRequest();
  rawfile.open('GET', link, false);
  rawfile.overrideMimeType("text");
  rawfile.onreadystatechange = function()
  {
    alert(rawfile.responseText);
    //console.log(rawfile.responseText);
  }
  rawfile.send(null);
}

document.onkeydown = function(e) {
    switch (e.keyCode) {
      case 37:
        document.getElementById("buttonForward").parentNode.click(); 
        break;
      case 39:
        document.getElementById("buttonBack").parentNode.click();       
        break;
    }
};
</script>

</body>
</html>
