<br />
<pre>undefined4 getCmdResults(char *param_1,char *param_2,char *param_3,size_t param_4)</pre>
<br />
<pre>{</pre>
<pre>  FILE *__stream;</pre>
<pre>  size_t sVar1;</pre>
<pre>  size_t sVar2;</pre>
<pre>  char *pcVar3;</pre>
<pre>  undefined4 local_418;</pre>
<pre>  char acStack_410 [1024];</pre>
<pre>  </pre>
<pre><span class="green">  memset(acStack_410,0,0x400)</span></span></pre>
<pre>  local_418 = 0;</pre>
<pre>  memset(param_3,0,param_4);</pre>
<pre><span class="green"><span class="green">  __stream = popen(param_1,"r")</span></span></span></pre>
<pre>  if (__stream == (FILE *)0x0) {</pre>
<pre>    local_418 = 0xffffffff;</pre>
<pre>  }</pre>
<pre>  else {</pre>
<pre>    do {</pre>
<pre>      while( true ) {</pre>
<pre><span class="green">        pcVar3 = fgets(acStack_410,0x400,__stream)</span></span></pre>
<pre>        if (pcVar3 == (char *)0x0) goto LAB_00404b30;</pre>
<pre>        if (param_2 != (char *)0x0) break;</pre>
<pre>        sVar1 = strlen(param_3);</pre>
<pre>        sVar2 = strlen(param_3);</pre>
<pre><span class="green">        strlcpy(param_3 + sVar1,acStack_410,param_4 - sVar2)</span></span></pre>
<pre>      }</pre>
<pre>      pcVar3 = strstr(acStack_410,param_2);</pre>
<pre>    } while (pcVar3 == (char *)0x0);</pre>
<pre><span class="green">    strlcpy(param_3,acStack_410,param_4)</span></span></pre>
<pre>LAB_00404b30:</pre>
<pre>    pclose(__stream);</pre>
<pre>  }</pre>
<pre>  return local_418;</pre>
<pre>}</pre>
<br />
<pre>[ASK_GPT] ff4109c76d95ee56</pre>
