<br />
<pre>int process_iwpriv_cmd(char *param_1,char *param_2,size_t param_3)</pre>
<br />
<pre>{</pre>
<pre>  int __fd;</pre>
<pre>  int iVar1;</pre>
<pre>  int local_70;</pre>
<pre>  char *local_5c [2];</pre>
<pre>  undefined auStack_54 [4];</pre>
<pre>  char *local_50;</pre>
<pre>  </pre>
<pre><span class="green">  __fd = iw_sockets_open()</span></span></pre>
<pre>  if (__fd &lt; 0) {</pre>
<pre>    perror("socket");</pre>
<pre>    local_70 = -1;</pre>
<pre>  }</pre>
<pre>  else {</pre>
<pre>    memset(param_2,0,param_3);</pre>
<pre><span class="green"><span class="green">    strncpy(param_2,param_1,param_3 - 1)</span></span></span></pre>
<pre>    iVar1 = SplitString(param_2,local_5c,0x50,&amp;DAT_0040eab4);</pre>
<pre>    iVar1 = strncmp(local_5c[iVar1 + -1],"&amp;",2);</pre>
<pre>    if (iVar1 == 0) {</pre>
<pre><span class="green"><span class="green">      local_70 = system(param_1)</span></span></span></pre>
<pre>    }</pre>
<pre>    else {</pre>
<pre>      iVar1 = strcmp(local_5c[0],"iwpriv");</pre>
<pre>      if ((iVar1 == 0) &amp;&amp; (iVar1 = strncmp(local_5c[1],"ra",2), iVar1 == 0)) {</pre>
<pre>        if (Calibrated == 0) {</pre>
<pre>          iVar1 = SplitString(param_1,local_5c,0x50,&amp;DAT_0040eab4);</pre>
<pre><span class="green">          local_70 = set_private(__fd,auStack_54,iVar1 + -2,local_5c[1],param_2,param_3)</span></span></pre>
<pre>          iVar1 = strncmp(local_50,"bufferWriteBack",0xf);</pre>
<pre>          if (iVar1 == 0) {</pre>
<pre>            Calibrated = 1;</pre>
<pre>            printf("[%s]Calibrated = %d\n","process_iwpriv_cmd",1);</pre>
<pre>          }</pre>
<pre>        }</pre>
<pre>        else {</pre>
<pre>          printf("[%s]Invalid commond! DUT has been calibrated.\n","process_iwpriv_cmd");</pre>
<pre>          local_70 = -1;</pre>
<pre>        }</pre>
<pre>      }</pre>
<pre>      else {</pre>
<pre><span class="green">        local_70 = getCmdResults(param_1,0,param_2,param_3)</span></span></pre>
<pre>      }</pre>
<pre>    }</pre>
<pre>  }</pre>
<pre>  if (0 &lt; __fd) {</pre>
<pre>    close(__fd);</pre>
<pre>  }</pre>
<pre>  return local_70;</pre>
<pre>}</pre>
<br />
<pre>[ASK_GPT] f8959b2af127558d</pre>
