<br />
<pre>/* WARNING: Heritage AFTER dead removal. Example location: s0xfffffc74 : 0x004058b0 */</pre>
<pre>/* WARNING: Restarted to delay deadcode elimination for space: stack */</pre>
<br />
<pre>undefined4 iw_get_range_info(int param_1,char *param_2,undefined4 *param_3)</pre>
<br />
<pre>{</pre>
<pre>  int iVar1;</pre>
<pre>  undefined4 uVar2;</pre>
<pre>  char acStack_4c4 [16];</pre>
<pre>  undefined4 *local_4b4;</pre>
<pre>  ushort local_4b0;</pre>
<pre>  undefined2 local_4ae;</pre>
<pre>  undefined4 local_4a4;</pre>
<pre>  undefined4 local_4a0;</pre>
<pre>  undefined4 local_49c;</pre>
<pre>  undefined auStack_498 [132];</pre>
<pre>  undefined4 local_414;</pre>
<pre>  undefined4 local_410;</pre>
<pre>  undefined auStack_40c [36];</pre>
<pre>  undefined auStack_3e8 [56];</pre>
<pre>  undefined4 local_3b0;</pre>
<pre>  undefined auStack_3ac [32];</pre>
<pre>  byte bStack_38c;</pre>
<pre>  undefined4 local_374;</pre>
<pre>  </pre>
<pre><span class="green">  memset(&amp;local_4a4,0,0x498)</span></span></pre>
<pre>  local_4b4 = &amp;local_4a4;</pre>
<pre>  local_4b0 = 0x498;</pre>
<pre>  local_4ae = 0;</pre>
<pre><span class="green"><span class="green"><span class="green">  strncpy(acStack_4c4,param_2,0x10)</span></span></span></span></pre>
<pre>  iVar1 = ioctl(param_1,0x8b0b,acStack_4c4);</pre>
<pre>  if (iVar1 &lt; 0) {</pre>
<pre>    uVar2 = 0xffffffff;</pre>
<pre>  }</pre>
<pre>  else {</pre>
<pre>    if (local_4b0 &lt; 300) {</pre>
<pre>      bStack_38c = 9;</pre>
<pre>    }</pre>
<pre>    if (bStack_38c &lt; 0x10) {</pre>
<pre><span class="green">      memset(param_3,0,0x24c)</span></span></pre>
<pre>      *param_3 = local_4a4;</pre>
<pre>      param_3[1] = local_4a0;</pre>
<pre>      param_3[2] = local_49c;</pre>
<pre><span class="green"><span class="green">      memcpy(param_3 + 0x4c,auStack_498,0x84)</span></span></span></pre>
<pre>      param_3[10] = local_414;</pre>
<pre>      param_3[0xb] = local_410;</pre>
<pre><span class="green"><span class="green">      memcpy(param_3 + 0xd,auStack_40c,0x24)</span></span></span></pre>
<pre><span class="green"><span class="green">      memcpy(param_3 + 0x2e,auStack_3e8,0x38)</span></span></span></pre>
<pre>      *(undefined4 *)((int)param_3 + 0xf2) = local_3b0;</pre>
<pre><span class="green"><span class="green">      memcpy(param_3 + 0x3e,auStack_3ac,0x38)</span></span></span></pre>
<pre>      param_3[0xc] = local_374;</pre>
<pre>    }</pre>
<pre>    else {</pre>
<pre><span class="green"><span class="green">      memcpy(param_3,&amp;local_4a4,0x24c)</span></span></span></pre>
<pre>    }</pre>
<pre>    if (iw_ignore_version == 0) {</pre>
<pre>      if (*(byte *)(param_3 + 0x46) &lt; 0xb) {</pre>
<pre>        fprintf(stderr,"Warning: Driver for device %s has been compiled with an ancient version\n",</pre>
<pre>                param_2);</pre>
<pre>        fwrite("of Wireless Extension, while this program support version 11 and later.\n",1,0x48,</pre>
<pre>               stderr);</pre>
<pre>        fwrite("Some things may be broken...\n\n",1,0x1e,stderr);</pre>
<pre>      }</pre>
<pre>      if (0x16 &lt; *(byte *)(param_3 + 0x46)) {</pre>
<pre>        fprintf(stderr,"Warning: Driver for device %s has been compiled with version %d\n",param_2,</pre>
<pre>                (uint)*(byte *)(param_3 + 0x46));</pre>
<pre>        fprintf(stderr,"of Wireless Extension, while this program supports up to version %d.\n",0x16</pre>
<pre>               );</pre>
<pre>        fwrite("Some things may be broken...\n\n",1,0x1e,stderr);</pre>
<pre>      }</pre>
<pre>      if ((10 &lt; *(byte *)(param_3 + 0x46)) &amp;&amp;</pre>
<pre>         (*(byte *)(param_3 + 0x46) &lt; *(byte *)((int)param_3 + 0x119))) {</pre>
<pre>        fprintf(stderr,"Warning: Driver for device %s recommend version %d of Wireless Extension,\n"</pre>
<pre>                ,param_2,(uint)*(byte *)((int)param_3 + 0x119));</pre>
<pre>        fprintf(stderr,"but has been compiled with version %d, therefore some driver features\n",</pre>
<pre>                (uint)*(byte *)(param_3 + 0x46));</pre>
<pre>        fwrite("may not be available...\n\n",1,0x19,stderr);</pre>
<pre>      }</pre>
<pre>    }</pre>
<pre>    iw_ignore_version = 1;</pre>
<pre>    uVar2 = 0;</pre>
<pre>  }</pre>
<pre>  return uVar2;</pre>
<pre>}</pre>
<br />
<pre>[ASK_GPT] 682fdd40ecb930f9</pre>
