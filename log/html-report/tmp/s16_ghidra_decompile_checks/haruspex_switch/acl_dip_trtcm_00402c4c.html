<br />
<pre>void acl_dip_trtcm(int param_1,int param_2)</pre>
<br />
<pre>{</pre>
<pre>  size_t sVar1;</pre>
<pre>  ulong uVar2;</pre>
<pre>  ulong uVar3;</pre>
<pre>  ulong uVar4;</pre>
<pre>  ulong uVar5;</pre>
<pre>  uint local_40;</pre>
<pre>  int local_3c;</pre>
<pre>  uint local_24;</pre>
<pre>  uint local_20 [6];</pre>
<pre>  </pre>
<pre>  if (param_1 &lt; 6) {</pre>
<pre>    puts("insufficient arguments!");</pre>
<pre>  }</pre>
<pre>  else if ((*(int *)(param_2 + 0x14) == 0) ||</pre>
<pre><span class="green">          (sVar1 = strlen(*(char **)(param_2 + 0x14)), sVar1 != 8)) {</span></pre>
<pre>    puts("portmap format error, should be of length 7");</pre>
<pre>  }</pre>
<pre>  else {</pre>
<pre>    local_3c = 0;</pre>
<pre>    for (local_40 = 0; local_40 &lt; 7; local_40 = local_40 + 1) {</pre>
<pre>      if ((*(char *)(*(int *)(param_2 + 0x14) + local_40) != '0') &amp;&amp;</pre>
<pre>         (*(char *)(*(int *)(param_2 + 0x14) + local_40) != '1')) {</pre>
<pre>        puts("portmap format error, should be of combination of 0 or 1");</pre>
<pre>        return;</pre>
<pre>      }</pre>
<pre>      local_3c = local_3c +</pre>
<pre>                 (*(char *)(*(int *)(param_2 + 0x14) + local_40) + -0x30 &lt;&lt; (local_40 &amp; 0x1f));</pre>
<pre>    }</pre>
<pre>    str_to_ip(local_20,*(undefined4 *)(param_2 + 0x10));</pre>
<pre>    local_24 = local_20[0] &gt;&gt; 0x10 | 0xffff0000;</pre>
<pre>    reg_write(0x94,local_24);</pre>
<pre>    printf("REG_ESW_VLAN_VAWD1 value is 0x%x\n\r",local_24);</pre>
<pre>    local_24 = local_3c &lt;&lt; 8 | 0xa0010;</pre>
<pre>    reg_write(0x98,local_24);</pre>
<pre>    printf("REG_ESW_VLAN_VAWD2 value is 0x%x\n\r",local_24);</pre>
<pre>    local_24 = 0x80005000;</pre>
<pre>    reg_write(0x90,0x80005000);</pre>
<pre>    printf("REG_ESW_VLAN_VTCR value is 0x%x\n\r\n\r",local_24);</pre>
<pre>    local_40 = 0;</pre>
<pre><span class="green">    while ((local_40 &lt; 0x14 &amp;&amp; (reg_read(0x90,&amp;local_24), (int)local_24 &lt; 0))) {</span></pre>
<pre>      usleep(1000);</pre>
<pre>      local_40 = local_40 + 1;</pre>
<pre>    }</pre>
<pre>    if (local_40 == 0x14) {</pre>
<pre>      puts("timeout.");</pre>
<pre>    }</pre>
<pre>    local_24 = local_20[0] &amp; 0xffff | 0xffff0000;</pre>
<pre>    reg_write(0x94,local_24);</pre>
<pre>    printf("REG_ESW_VLAN_VAWD1 value is 0x%x\n\r",local_24);</pre>
<pre>    local_24 = local_3c &lt;&lt; 8 | 0xa0012;</pre>
<pre>    reg_write(0x98,local_24);</pre>
<pre>    printf("REG_ESW_VLAN_VAWD2 value is 0x%x\n\r",local_24);</pre>
<pre>    local_24 = 0x80005001;</pre>
<pre>    reg_write(0x90,0x80005001);</pre>
<pre>    printf("REG_ESW_VLAN_VTCR value is 0x%x\n\r\n\r",local_24);</pre>
<pre>    local_40 = 0;</pre>
<pre><span class="green">    while ((local_40 &lt; 0x14 &amp;&amp; (reg_read(0x90,&amp;local_24), (int)local_24 &lt; 0))) {</span></pre>
<pre>      usleep(1000);</pre>
<pre>      local_40 = local_40 + 1;</pre>
<pre>    }</pre>
<pre>    if (local_40 == 0x14) {</pre>
<pre>      puts("timeout.");</pre>
<pre>    }</pre>
<pre>    uVar2 = strtoul(*(char **)(param_2 + 0x18),(char **)0x0,0);</pre>
<pre>    uVar3 = strtoul(*(char **)(param_2 + 0x1c),(char **)0x0,0);</pre>
<pre>    uVar4 = strtoul(*(char **)(param_2 + 0x20),(char **)0x0,0);</pre>
<pre>    uVar5 = strtoul(*(char **)(param_2 + 0x24),(char **)0x0,0);</pre>
<pre>    local_24 = uVar3 &lt;&lt; 0x10 | uVar5;</pre>
<pre>    reg_write(0x94,local_24);</pre>
<pre>    printf("REG_ESW_VLAN_VAWD1 value is 0x%x\n\r",local_24);</pre>
<pre>    local_24 = (uVar2 &gt;&gt; 6) &lt;&lt; 0x10 | uVar4 &gt;&gt; 6;</pre>
<pre>    reg_write(0x98,local_24);</pre>
<pre>    printf("REG_ESW_VLAN_VAWD2 value is 0x%x\n\r",local_24);</pre>
<pre>    local_24 = 0x80007000;</pre>
<pre>    reg_write(0x90,0x80007000);</pre>
<pre>    printf("REG_ESW_VLAN_VTCR value is 0x%x\n\r\n\r",local_24);</pre>
<pre>    local_40 = 0;</pre>
<pre><span class="green">    while ((local_40 &lt; 0x14 &amp;&amp; (reg_read(0x90,&amp;local_24), (int)local_24 &lt; 0))) {</span></pre>
<pre>      usleep(1000);</pre>
<pre>      local_40 = local_40 + 1;</pre>
<pre>    }</pre>
<pre>    if (local_40 == 0x14) {</pre>
<pre>      puts("timeout.");</pre>
<pre>    }</pre>
<pre>    local_24 = 3;</pre>
<pre>    reg_write(0x94,3);</pre>
<pre>    printf("REG_ESW_VLAN_VAWD1 value is 0x%x\n\r",local_24);</pre>
<pre>    local_24 = 0;</pre>
<pre>    reg_write(0x98,0);</pre>
<pre>    printf("REG_ESW_VLAN_VAWD2 value is 0x%x\n\r",local_24);</pre>
<pre>    local_24 = 0x80009000;</pre>
<pre>    reg_write(0x90,0x80009000);</pre>
<pre>    printf("REG_ESW_VLAN_VTCR value is 0x%x\n\r\n\r",local_24);</pre>
<pre>    local_40 = 0;</pre>
<pre><span class="green">    while ((local_40 &lt; 0x14 &amp;&amp; (reg_read(0x90,&amp;local_24), (int)local_24 &lt; 0))) {</span></pre>
<pre>      usleep(1000);</pre>
<pre>      local_40 = local_40 + 1;</pre>
<pre>    }</pre>
<pre>    if (local_40 == 0x14) {</pre>
<pre>      puts("timeout.");</pre>
<pre>    }</pre>
<pre>    local_24 = 0;</pre>
<pre>    reg_write(0x94,0);</pre>
<pre>    printf("REG_ESW_VLAN_VAWD1 value is 0x%x\n\r",local_24);</pre>
<pre>    local_24 = 0x14c1;</pre>
<pre>    reg_write(0x98,0x14c1);</pre>
<pre>    printf("REG_ESW_VLAN_VAWD2 value is 0x%x\n\r",local_24);</pre>
<pre>    local_24 = 0x8000b000;</pre>
<pre>    reg_write(0x90,0x8000b000);</pre>
<pre>    printf("REG_ESW_VLAN_VTCR value is 0x%x\n\r\n\r",local_24);</pre>
<pre>    local_40 = 0;</pre>
<pre><span class="green">    while ((local_40 &lt; 0x14 &amp;&amp; (reg_read(0x90,&amp;local_24), (int)local_24 &lt; 0))) {</span></pre>
<pre>      usleep(1000);</pre>
<pre>      local_40 = local_40 + 1;</pre>
<pre>    }</pre>
<pre>    if (local_40 == 0x14) {</pre>
<pre>      puts("timeout.");</pre>
<pre>    }</pre>
<pre>  }</pre>
<pre>  return;</pre>
<pre>}</pre>
<br />
<pre>[ASK_GPT] 8bf44f018411ba35</pre>
