<br />
<pre>void table_dump(undefined4 param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)</pre>
<br />
<pre>{</pre>
<pre>  uint uVar1;</pre>
<pre>  int iVar2;</pre>
<pre>  undefined4 uVar3;</pre>
<pre>  undefined *puVar4;</pre>
<pre>  int local_60;</pre>
<pre>  uint local_58;</pre>
<pre>  undefined4 local_54;</pre>
<pre>  uint local_50;</pre>
<pre>  uint local_4c;</pre>
<pre>  uint auStack_48 [16];</pre>
<pre>  </pre>
<pre>  puVar4 = &amp;_gp;</pre>
<pre>  for (local_60 = 0; local_60 &lt; 8; local_60 = local_60 + 1) {</pre>
<pre><span class="green">    reg_read((local_60 + 0x40) * 4,&amp;local_58,param_3,param_4,puVar4)</span></span></pre>
<pre>    auStack_48[local_60 * 2] = local_58 &amp; 0xfff;</pre>
<pre>    auStack_48[local_60 * 2 + 1] = (int)(local_58 &amp; 0xfff000) &gt;&gt; 0xc;</pre>
<pre>  }</pre>
<pre>  reg_write(0x80,0x8004);</pre>
<pre>  puts("hash  port(0:6)   fid   vid  age   mac-address     filter my_mac");</pre>
<pre>  local_60 = 0;</pre>
<pre>  while( true ) {</pre>
<pre>    if (0x7ff &lt; local_60) {</pre>
<pre>      return;</pre>
<pre>    }</pre>
<pre>    while( true ) {</pre>
<pre><span class="green">      reg_read(0x80,&amp;local_58)</span></span></pre>
<pre>      if (((local_58 &amp; 0x2000) != 0) &amp;&amp; ((local_58 &amp; 0x8000) == 0)) break;</pre>
<pre>      if (((local_58 &amp; 0x4000) != 0) &amp;&amp;</pre>
<pre>         (((local_58 &amp; 0x8000) == 0 &amp;&amp; (((int)local_58 &gt;&gt; 0x10 &amp; 0xfffU) == 0x7ff)))) {</pre>
<pre>        printf("found the last entry %d (not ready)\n",local_60);</pre>
<pre>        return;</pre>
<pre>      }</pre>
<pre>      usleep(5);</pre>
<pre>    }</pre>
<pre>    printf("%03x:   ",(int)local_58 &gt;&gt; 0x10 &amp; 0xfff);</pre>
<pre><span class="green">    reg_read(0x8c,&amp;local_4c)</span></span></pre>
<pre>    uVar1 = (int)local_4c &gt;&gt; 4;</pre>
<pre>    if ((uVar1 &amp; 1) == 0) {</pre>
<pre>      iVar2 = 0x2d;</pre>
<pre>    }</pre>
<pre>    else {</pre>
<pre>      iVar2 = 0x31;</pre>
<pre>    }</pre>
<pre>    putchar(iVar2);</pre>
<pre>    if ((uVar1 &amp; 2) == 0) {</pre>
<pre>      iVar2 = 0x2d;</pre>
<pre>    }</pre>
<pre>    else {</pre>
<pre>      iVar2 = 0x31;</pre>
<pre>    }</pre>
<pre>    putchar(iVar2);</pre>
<pre>    if ((uVar1 &amp; 4) == 0) {</pre>
<pre>      iVar2 = 0x2d;</pre>
<pre>    }</pre>
<pre>    else {</pre>
<pre>      iVar2 = 0x31;</pre>
<pre>    }</pre>
<pre>    putchar(iVar2);</pre>
<pre>    if ((uVar1 &amp; 8) == 0) {</pre>
<pre>      uVar3 = 0x2d;</pre>
<pre>    }</pre>
<pre>    else {</pre>
<pre>      uVar3 = 0x31;</pre>
<pre>    }</pre>
<pre>    printf("%c ",uVar3);</pre>
<pre>    if ((uVar1 &amp; 0x10) == 0) {</pre>
<pre>      iVar2 = 0x2d;</pre>
<pre>    }</pre>
<pre>    else {</pre>
<pre>      iVar2 = 0x31;</pre>
<pre>    }</pre>
<pre>    putchar(iVar2);</pre>
<pre>    if ((uVar1 &amp; 0x20) == 0) {</pre>
<pre>      iVar2 = 0x2d;</pre>
<pre>    }</pre>
<pre>    else {</pre>
<pre>      iVar2 = 0x31;</pre>
<pre>    }</pre>
<pre>    putchar(iVar2);</pre>
<pre>    if ((uVar1 &amp; 0x40) == 0) {</pre>
<pre>      iVar2 = 0x2d;</pre>
<pre>    }</pre>
<pre>    else {</pre>
<pre>      iVar2 = 0x31;</pre>
<pre>    }</pre>
<pre>    putchar(iVar2);</pre>
<pre>    if ((uVar1 &amp; 0x80) == 0) {</pre>
<pre>      iVar2 = 0x2d;</pre>
<pre>    }</pre>
<pre>    else {</pre>
<pre>      iVar2 = 0x31;</pre>
<pre>    }</pre>
<pre>    putchar(iVar2);</pre>
<pre><span class="green">    reg_read(0x88,&amp;local_50)</span></span></pre>
<pre>    printf("   %2d",(int)local_50 &gt;&gt; 0xc &amp; 7);</pre>
<pre>    printf("  %4d",local_50 &amp; 0xfff);</pre>
<pre>    printf(" %4d",local_4c &gt;&gt; 0x18);</pre>
<pre><span class="green">    reg_read(0x84,&amp;local_54)</span></span></pre>
<pre>    printf("  %08x",local_54);</pre>
<pre>    printf("%04x",local_50 &gt;&gt; 0x10);</pre>
<pre>    if (((int)local_4c &gt;&gt; 0x14 &amp; 3U) == 3) {</pre>
<pre>      uVar3 = 0x79;</pre>
<pre>    }</pre>
<pre>    else {</pre>
<pre>      uVar3 = 0x2d;</pre>
<pre>    }</pre>
<pre>    printf("     %c",uVar3);</pre>
<pre>    if ((local_4c &amp; 0x800000) == 0) {</pre>
<pre>      uVar3 = 0x2d;</pre>
<pre>    }</pre>
<pre>    else {</pre>
<pre>      uVar3 = 0x79;</pre>
<pre>    }</pre>
<pre>    printf("     %c\n",uVar3);</pre>
<pre>    if (((local_58 &amp; 0x4000) != 0) &amp;&amp; (((int)local_58 &gt;&gt; 0x10 &amp; 0xfffU) == 0x7ff)) break;</pre>
<pre>    reg_write(0x80,0x8005);</pre>
<pre>    usleep(5);</pre>
<pre>    local_60 = local_60 + 1;</pre>
<pre>  }</pre>
<pre>  printf("end of table %d\n",local_60);</pre>
<pre>  return;</pre>
<pre>}</pre>
<br />
<pre>[ASK_GPT] 961bbfabfcbd3018</pre>
