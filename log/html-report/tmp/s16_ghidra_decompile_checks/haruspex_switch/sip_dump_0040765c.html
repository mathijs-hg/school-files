<br />
<pre>void sip_dump(undefined4 param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)</pre>
<br />
<pre>{</pre>
<pre>  uint uVar1;</pre>
<pre>  int iVar2;</pre>
<pre>  undefined4 uVar3;</pre>
<pre>  undefined *puVar4;</pre>
<pre>  int local_70;</pre>
<pre>  uint local_68;</pre>
<pre>  undefined4 local_64;</pre>
<pre>  undefined4 local_60;</pre>
<pre>  int local_5c;</pre>
<pre>  uint auStack_58 [16];</pre>
<pre>  undefined auStack_18 [16];</pre>
<pre>  </pre>
<pre>  puVar4 = &amp;_gp;</pre>
<pre>  for (local_70 = 0; local_70 &lt; 8; local_70 = local_70 + 1) {</pre>
<pre><span class="green">    reg_read((local_70 + 0x40) * 4,&amp;local_68,param_3,param_4,puVar4)</span></span></pre>
<pre>    auStack_58[local_70 * 2] = local_68 &amp; 0xfff;</pre>
<pre>    auStack_58[local_70 * 2 + 1] = (int)(local_68 &amp; 0xfff000) &gt;&gt; 0xc;</pre>
<pre>  }</pre>
<pre>  reg_write(0x80,0x8204);</pre>
<pre>  puts("hash  port(0:6)   dip-address    sip-address      ATRD");</pre>
<pre>  local_70 = 0;</pre>
<pre>  while( true ) {</pre>
<pre>    if (0x7ff &lt; local_70) {</pre>
<pre>      return;</pre>
<pre>    }</pre>
<pre><span class="green">    while (reg_read(0x80,&amp;local_68), (local_68 &amp; 0x2000) == 0) {</span></pre>
<pre>      if ((local_68 &amp; 0x4000) != 0) {</pre>
<pre>        printf("found the last entry %d (not ready)\n",local_70);</pre>
<pre>        return;</pre>
<pre>      }</pre>
<pre>      usleep(5000);</pre>
<pre>    }</pre>
<pre><span class="green">    reg_read(0x8c,&amp;local_5c)</span></span></pre>
<pre>    printf("%03x:  ",(int)local_68 &gt;&gt; 0x10 &amp; 0xfff);</pre>
<pre>    uVar1 = local_5c &gt;&gt; 4;</pre>
<pre>    if ((uVar1 &amp; 1) == 0) {</pre>
<pre>      iVar2 = 0x2d;</pre>
<pre>    }</pre>
<pre>    else {</pre>
<pre>      iVar2 = 0x31;</pre>
<pre>    }</pre>
<pre>    putchar(iVar2);</pre>
<pre>    if ((uVar1 &amp; 2) == 0) {</pre>
<pre>      iVar2 = 0x2d;</pre>
<pre>    }</pre>
<pre>    else {</pre>
<pre>      iVar2 = 0x31;</pre>
<pre>    }</pre>
<pre>    putchar(iVar2);</pre>
<pre>    if ((uVar1 &amp; 4) == 0) {</pre>
<pre>      iVar2 = 0x2d;</pre>
<pre>    }</pre>
<pre>    else {</pre>
<pre>      iVar2 = 0x31;</pre>
<pre>    }</pre>
<pre>    putchar(iVar2);</pre>
<pre>    if ((uVar1 &amp; 8) == 0) {</pre>
<pre>      iVar2 = 0x2d;</pre>
<pre>    }</pre>
<pre>    else {</pre>
<pre>      iVar2 = 0x31;</pre>
<pre>    }</pre>
<pre>    putchar(iVar2);</pre>
<pre>    if ((uVar1 &amp; 0x10) == 0) {</pre>
<pre>      uVar3 = 0x2d;</pre>
<pre>    }</pre>
<pre>    else {</pre>
<pre>      uVar3 = 0x31;</pre>
<pre>    }</pre>
<pre>    printf(" %c",uVar3);</pre>
<pre>    if ((uVar1 &amp; 0x20) == 0) {</pre>
<pre>      iVar2 = 0x2d;</pre>
<pre>    }</pre>
<pre>    else {</pre>
<pre>      iVar2 = 0x31;</pre>
<pre>    }</pre>
<pre>    putchar(iVar2);</pre>
<pre>    if ((uVar1 &amp; 0x40) == 0) {</pre>
<pre>      iVar2 = 0x2d;</pre>
<pre>    }</pre>
<pre>    else {</pre>
<pre>      iVar2 = 0x31;</pre>
<pre>    }</pre>
<pre>    putchar(iVar2);</pre>
<pre><span class="green">    reg_read(0x88,&amp;local_60)</span></span></pre>
<pre>    ip_to_str(auStack_18,local_60);</pre>
<pre>    printf("   %s",auStack_18);</pre>
<pre><span class="green">    reg_read(0x84,&amp;local_64)</span></span></pre>
<pre>    ip_to_str(auStack_18,local_64);</pre>
<pre>    printf("    %s",auStack_18);</pre>
<pre>    printf("      0x%x\n",local_5c);</pre>
<pre>    if ((local_68 &amp; 0x4000) != 0) break;</pre>
<pre>    reg_write(0x80,0x8205);</pre>
<pre>    usleep(5000);</pre>
<pre>    local_70 = local_70 + 1;</pre>
<pre>  }</pre>
<pre>  printf("end of table %d\n",local_70);</pre>
<pre>  return;</pre>
<pre>}</pre>
<br />
<pre>[ASK_GPT] cd982b4c530371ba</pre>
