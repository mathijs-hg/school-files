<br />
<pre>int dev_read_hex_int(char *patt,int mtd_num,int *value)</pre>
<br />
<pre>{</pre>
<pre>  int iVar1;</pre>
<pre>  size_t sVar2;</pre>
<pre>  int iVar3;</pre>
<pre>  int iVar4;</pre>
<pre>  undefined4 *puVar5;</pre>
<pre>  undefined4 uVar6;</pre>
<pre>  undefined4 uVar7;</pre>
<pre>  undefined4 *puVar8;</pre>
<pre>  undefined4 uVar9;</pre>
<pre>  int iVar10;</pre>
<pre>  code *pcVar11;</pre>
<pre>  uint auStack_70 [4];</pre>
<pre>  undefined *local_60;</pre>
<pre>  uint local_58;</pre>
<pre>  int local_54;</pre>
<pre>  char buf [50];</pre>
<pre>  </pre>
<pre>  local_60 = &amp;_gp;</pre>
<pre>  sVar2 = strlen(patt);</pre>
<pre><span class="green">  iVar1 = -(sVar2 + 0x40 &amp; 0xfffffff8)</span></span></pre>
<pre>  iVar10 = (int)&amp;local_60 + iVar1;</pre>
<pre>  (**(code **)(local_60 + -0x7f70))(iVar10,patt,mtd_num);</pre>
<pre>  iVar3 = (**(code **)(local_60 + -0x7f64))(iVar10,0x80000);</pre>
<pre>  if (iVar3 != -1) {</pre>
<pre>    iVar4 = (**(code **)(local_60 + -0x7f48))(iVar3,buf,0x32);</pre>
<pre>    if (iVar4 == -1) {</pre>
<pre>      puVar8 = *(undefined4 **)(local_60 + -0x7f74);</pre>
<pre>      puVar5 = (undefined4 *)(**(code **)(local_60 + -0x7f78))();</pre>
<pre>      uVar7 = *puVar5;</pre>
<pre>      (**(code **)(local_60 + -0x7f38))(*puVar8,"%s: error!: cannot read \"%s\"\n","libmtd",iVar10);</pre>
<pre>      uVar9 = *puVar8;</pre>
<pre>      uVar6 = (**(code **)(local_60 + -0x7f0c))(uVar7);</pre>
<pre>      pcVar11 = *(code **)(local_60 + -0x7f38);</pre>
<pre>      *(undefined4 *)((int)auStack_70 + iVar1) = uVar7;</pre>
<pre>      *(undefined4 *)((int)auStack_70 + iVar1 + 4) = uVar6;</pre>
<pre>      (*pcVar11)(uVar9,"%*serror %d (%s)\n",8,"");</pre>
<pre>    }</pre>
<pre>    else {</pre>
<pre>      if (iVar4 == 0x32) {</pre>
<pre>        (**(code **)(local_60 + -0x7f38))</pre>
<pre>                  (**(undefined4 **)(local_60 + -0x7f74),</pre>
<pre>                   "%s: error!: contents of \"%s\" is too long\n","libmtd",iVar10);</pre>
<pre>      }</pre>
<pre>      else {</pre>
<pre>        pcVar11 = *(code **)(local_60 + -0x7f54);</pre>
<pre>        buf[iVar4] = '\0';</pre>
<pre>        iVar4 = (*pcVar11)(buf,"%llx\n",&amp;local_58);</pre>
<pre>        if (iVar4 == 1) {</pre>
<pre>          if (-1 &lt; local_54) {</pre>
<pre>            iVar3 = (**(code **)(local_60 + -0x7f94))(iVar3);</pre>
<pre>            if (iVar3 != 0) {</pre>
<pre>              puVar8 = *(undefined4 **)(local_60 + -0x7f74);</pre>
<pre>              puVar5 = (undefined4 *)(**(code **)(local_60 + -0x7f78))();</pre>
<pre>              uVar7 = *puVar5;</pre>
<pre>              (**(code **)(local_60 + -0x7f38))</pre>
<pre>                        (*puVar8,"%s: error!: close failed on \"%s\"\n","libmtd",iVar10);</pre>
<pre>              uVar9 = *puVar8;</pre>
<pre>              uVar6 = (**(code **)(local_60 + -0x7f0c))(uVar7);</pre>
<pre>              pcVar11 = *(code **)(local_60 + -0x7f38);</pre>
<pre>              *(undefined4 *)((int)auStack_70 + iVar1) = uVar7;</pre>
<pre>              *(undefined4 *)((int)auStack_70 + iVar1 + 4) = uVar6;</pre>
<pre>              (*pcVar11)(uVar9,"%*serror %d (%s)\n",8,"");</pre>
<pre>              return -1;</pre>
<pre>            }</pre>
<pre>            if ((uint)(local_58 + 0x80000000 &lt; local_58) + local_54 == 0) {</pre>
<pre>              *value = local_58;</pre>
<pre>              return 0;</pre>
<pre>            }</pre>
<pre>            pcVar11 = *(code **)(local_60 + -0x7f38);</pre>
<pre>            uVar6 = **(undefined4 **)(local_60 + -0x7f74);</pre>
<pre>            *(uint *)((int)auStack_70 + iVar1) = local_58;</pre>
<pre>            *(int *)((int)auStack_70 + iVar1 + 4) = local_54;</pre>
<pre>            *(int *)((int)auStack_70 + iVar1 + 8) = iVar10;</pre>
<pre>            (*pcVar11)(uVar6,"%s: error!: value %lld read from file \"%s\" is out of range\n",</pre>
<pre>                       "libmtd");</pre>
<pre>            puVar5 = (undefined4 *)(**(code **)(local_60 + -0x7f78))();</pre>
<pre>            *puVar5 = 0x16;</pre>
<pre>            return -1;</pre>
<pre>          }</pre>
<pre>          pcVar11 = *(code **)(local_60 + -0x7f38);</pre>
<pre>          uVar6 = **(undefined4 **)(local_60 + -0x7f74);</pre>
<pre>          *(uint *)((int)auStack_70 + iVar1) = local_58;</pre>
<pre>          *(int *)((int)auStack_70 + iVar1 + 4) = local_54;</pre>
<pre>          *(int *)((int)auStack_70 + iVar1 + 8) = iVar10;</pre>
<pre>          (*pcVar11)(uVar6,"%s: error!: negative value %lld in \"%s\"\n","libmtd");</pre>
<pre>        }</pre>
<pre>        else {</pre>
<pre>          (**(code **)(local_60 + -0x7f38))</pre>
<pre>                    (**(undefined4 **)(local_60 + -0x7f74),</pre>
<pre>                     "%s: error!: cannot read integer from \"%s\"\n\n","libmtd",iVar10);</pre>
<pre>        }</pre>
<pre>      }</pre>
<pre>      puVar5 = (undefined4 *)(**(code **)(local_60 + -0x7f78))();</pre>
<pre>      *puVar5 = 0x16;</pre>
<pre>    }</pre>
<pre>    (**(code **)(local_60 + -0x7f94))(iVar3);</pre>
<pre>  }</pre>
<pre>  return -1;</pre>
<pre>}</pre>
<br />
<pre>[ASK_GPT] c6b326b1333f01af</pre>
