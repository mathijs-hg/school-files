<br />
<pre>void ubigen_init_vid_hdr(ubigen_info *ui,ubigen_vol_info *vi,ubi_vid_hdr *hdr,int lnum,void *data,</pre>
<pre>                        int data_size)</pre>
<br />
<pre>{</pre>
<pre>  uint uVar1;</pre>
<pre>  uint32_t uVar2;</pre>
<pre>  uint32_t _x;</pre>
<pre>  </pre>
<pre><span class="green">  memset(hdr,0,0x40)</span></span></pre>
<pre>  hdr-&gt</span>agic = 0x21494255;</pre>
<pre>  hdr-&gt;version = (__u8)ui-&gt;ubi_ver;</pre>
<pre>  hdr-&gt;vol_type = (__u8)vi-&gt;type;</pre>
<pre>  uVar1 = vi-&gt;id;</pre>
<pre>  hdr-&gt;vol_id = uVar1 &gt;&gt; 0x18 | uVar1 &lt;&lt; 0x18 | (uVar1 &amp; 0xff00) &lt;&lt; 8 | (uVar1 &amp; 0xff0000) &gt;&gt; 8;</pre>
<pre>  hdr-&gt;lnum = (uint)lnum &gt;&gt; 0x18 | lnum &lt;&lt; 0x18 | (lnum &amp; 0xff00U) &lt;&lt; 8 | (lnum &amp; 0xff0000U) &gt;&gt; 8;</pre>
<pre>  uVar1 = vi-&gt;data_pad;</pre>
<pre>  hdr-&gt;data_pad = uVar1 &gt;&gt; 0x18 | uVar1 &lt;&lt; 0x18 | (uVar1 &amp; 0xff00) &lt;&lt; 8 | (uVar1 &amp; 0xff0000) &gt;&gt; 8;</pre>
<pre>  hdr-&gt;compat = (__u8)vi-&gt;compat;</pre>
<pre>  if (vi-&gt;type == 2) {</pre>
<pre>    hdr-&gt;data_size =</pre>
<pre>         (uint)data_size &gt;&gt; 0x18 | data_size &lt;&lt; 0x18 | (data_size &amp; 0xff00U) &lt;&lt; 8 |</pre>
<pre>         (data_size &amp; 0xff0000U) &gt;&gt; 8;</pre>
<pre>    uVar1 = vi-&gt;used_ebs;</pre>
<pre>    hdr-&gt;used_ebs = uVar1 &gt;&gt; 0x18 | uVar1 &lt;&lt; 0x18 | (uVar1 &amp; 0xff00) &lt;&lt; 8 | (uVar1 &amp; 0xff0000) &gt;&gt; 8;</pre>
<pre>    uVar2 = mtd_crc32(0xffffffff,data,data_size);</pre>
<pre>    hdr-&gt;data_crc = uVar2 &gt;&gt; 0x18 | uVar2 &lt;&lt; 0x18 | (uVar2 &amp; 0xff00) &lt;&lt; 8 | (uVar2 &amp; 0xff0000) &gt;&gt; 8;</pre>
<pre>  }</pre>
<pre>  uVar2 = mtd_crc32(0xffffffff,hdr,0x3c);</pre>
<pre>  hdr-&gt;hdr_crc = uVar2 &gt;&gt; 0x18 | uVar2 &lt;&lt; 0x18 | (uVar2 &amp; 0xff00) &lt;&lt; 8 | uVar2 &gt;&gt; 8 &amp; 0xff00;</pre>
<pre>  return;</pre>
<pre>}</pre>
<br />
<pre>[ASK_GPT] 02f454c735cd770b</pre>
