<pre>[</span><span class="blue">+</span>] </span><span class="cyan"><span class="bold"><a id="check_decompiled_binary_source_code_for_vulnerabilities">Check decompiled binary source code for vulnerabilities</a></span></pre>
<pre><span class="bold"><hr class="double" /></span></pre>
<pre>The following module tries to decompile the firmware binaries with Ghidra. Afterwards it tests the decompiled sources with semgrep for vulnerabilities.</pre>
<pre>Furhter details about the used approach are documented by </span><span class="orange">0xdea</span> in the following resources:</pre>
<pre>    [*] </span><span class="orange"><a href="https://security.humanativaspa.it/automating-binary-vulnerability-discovery-with-ghidra-and-semgrep/" title="https://security.humanativaspa.it/automating-binary-vulnerability-discovery-with-ghidra-and-semgrep/" target="_blank" >https://security.humanativaspa.it/automating-binary-vulnerability-discovery-with-ghidra-and-semgrep/</a></span></pre>
<pre>    [*] </span><span class="orange"><a href="https://github.com/0xdea/ghidra-scripts/blob/main/Haruspex.java" title="https://github.com/0xdea/ghidra-scripts/blob/main/Haruspex.java" target="_blank" >https://github.com/0xdea/ghidra-scripts/blob/main/Haruspex.java</a></span></pre>
<pre>    [*] </span><span class="orange"><a href="https://github.com/0xdea/semgrep-rules" title="https://github.com/0xdea/semgrep-rules" target="_blank" >https://github.com/0xdea/semgrep-rules</a></span></pre>
<br />
<br />
<a class="reference" href="./s16_ghidra_decompile_checks/semgrep_switch.html" title="./s16_ghidra_decompile_checks/semgrep_switch.html" ><pre>[</span><span class="green">+</span>]</span><span class="green"> Found </span><span class="orange">144 issues</span><span class="green"> in native binary </span><span class="orange">switch</span></span></pre></a>

<a class="reference" href="./s16_ghidra_decompile_checks/semgrep_ated_iwpriv.html" title="./s16_ghidra_decompile_checks/semgrep_ated_iwpriv.html" ><pre>[</span><span class="green">+</span>]</span><span class="green"> Found </span><span class="orange">270 issues</span><span class="green"> in native binary </span><span class="orange">ated_iwpriv</span></span></pre></a>

<a class="reference" href="./s16_ghidra_decompile_checks/semgrep_hw_nat.html" title="./s16_ghidra_decompile_checks/semgrep_hw_nat.html" ><pre>[</span><span class="green">+</span>]</span><span class="green"> Found </span><span class="orange">44 issues</span><span class="green"> in native binary </span><span class="orange">hw_nat</span></span></pre></a>

<a class="reference" href="./s16_ghidra_decompile_checks/semgrep_flash_erase.html" title="./s16_ghidra_decompile_checks/semgrep_flash_erase.html" ><pre>[</span><span class="green">+</span>]</span><span class="green"> Found </span><span class="orange">40 issues</span><span class="green"> in native binary </span><span class="orange">flash_erase</span></span></pre></a>

<a class="reference" href="./s16_ghidra_decompile_checks/semgrep_ubiformat.html" title="./s16_ghidra_decompile_checks/semgrep_ubiformat.html" ><pre>[</span><span class="green">+</span>]</span><span class="green"> Found </span><span class="orange">102 issues</span><span class="green"> in native binary </span><span class="orange">ubiformat</span></span></pre></a>

<br />
<br />
<br />
<br />
<pre></span><span class="blue">==&gt</span></span> </span><span class="cyan"><a id="resultsghidradecompiledcodeanalysisviasemgrep">Results - Ghidra decompiled code analysis via Semgrep</a></span></pre>
<pre><hr class="mono" /></pre>
<pre>[</span><span class="green">+</span>]</span><span class="green"> Found </span><span class="orange">600</span><span class="green"> possible vulnerabilities (</span><span class="orange">via semgrep on Ghidra decompiled code</span><span class="green">) in </span><span class="orange">6</span><span class="green"> tested binaries:</span></span></pre>
<pre>    </span><span class="green">command-injection</span><span class="orange"> - 2 times.</span></pre>
<pre>    </span><span class="green">insecure-api-rand-srand</span><span class="orange"> - 2 times.</span></pre>
<pre>    </span><span class="green">insecure-api-scanf-etc</span><span class="orange"> - 3 times.</span></pre>
<pre>    </span><span class="green">insecure-api-strcpy-stpcpy-strcat</span><span class="orange"> - 6 times.</span></pre>
<pre>    </span><span class="green">integer-truncation</span><span class="orange"> - 4 times.</span></pre>
<pre>    </span><span class="green">integer-wraparound</span><span class="orange"> - 3 times.</span></pre>
<pre>    </span><span class="green">interesting-api-calls</span><span class="orange"> - 363 times.</span></pre>
<pre>    </span><span class="green">pointer-subtraction</span><span class="orange"> - 4 times.</span></pre>
<pre>    </span><span class="green">signed-unsigned-conversion</span><span class="orange"> - 161 times.</span></pre>
<pre>    </span><span class="green">unchecked-ret-malloc-calloc-realloc</span><span class="orange"> - 1 times.</span></pre>
<pre>    </span><span class="green">unchecked-ret-scanf-etc</span><span class="orange"> - 10 times.</span></pre>
<pre>    </span><span class="green">unsafe-ret-snprintf-vsnprintf</span><span class="orange"> - 4 times.</span></pre>
<pre>    </span><span class="green">unterminated-string-strncpy-stpncpy</span><span class="orange"> - 37 times.</span></pre>
<br />
<pre><hr class="mono" /></pre>
<br />
