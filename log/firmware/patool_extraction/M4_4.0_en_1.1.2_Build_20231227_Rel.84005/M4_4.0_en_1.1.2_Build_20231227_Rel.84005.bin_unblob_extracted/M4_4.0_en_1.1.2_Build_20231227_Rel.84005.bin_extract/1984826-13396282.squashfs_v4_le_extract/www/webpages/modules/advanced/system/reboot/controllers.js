!function(n){n.su.moduleManager.define("reboot",{services:["ajax","device","time"],deps:["main"],stores:["rebootListStore"],views:["rebootView"],listeners:{"ev_on_launch":function(e,t,c,s,a,o,n){a.rebootListStore.load()}},init:function(s,e,t,a,o,c){this.configViews({id:"rebootView",items:[{id:"reboot-list-grid",configs:{minLines:0,columns:[{text:n.su.CHAR.FIRMWARE.TYPE,dataIndex:"deviceModel",renderer:function(e){var t,c;switch(e){case"M1300":case"M5":case"M9Plus":case"P7":t="icon-device-m5";break;case"M4":case"E4":case"E4R":case"W2400":case"M3":case"E3":case"M4R":case"HC4":case"AC1200":t="icon-device-m4r";break;case"M3W":t="icon-device-m3w";break;case"X20":case"HX20":case"X50":case"X60":case"X73":case"W6000":case"W3600":t="icon-device-x20";break;case"X68":case"X75":case"XE75":case"XE5300":case"X76":case"X80":case"X3600":t="icon-device-x68";break;case"X90":case"X96":case"X95":case"XE200":case"XE95":case"X5700":case"X80-5G":case"X50-5G":t="icon-device-x90";break;case"X55":case"X25":t="icon-device-x25";break;case"X58-4G":t="icon-device-x58";break;default:t="icon-device-m5"}return c='<a href="javascript:void(0)" class="grid-content-btn" style=\'cursor: default\'>',c+="<span class='icon-device "+t+"'></span>",c+="</a>"}},{text:n.su.CHAR.FIRMWARE.DEVICE_NAME,dataIndex:"nickname",renderer:function(e,t){var c="";return"disconnected"===t.groupStatus&&(c="("+n.su.CHAR.REBOOT.OFFLINE+")"),"custom"!==e?n.su.escapeHtml(e)+c:n.su.escapeHtml(n.su.b64Decode(t.customNickname))+c}},{text:n.su.CHAR.FIRMWARE.MODEL,dataIndex:"deviceModel"},{xtype:"actioncolumn",text:n.su.CHAR.REBOOT.REBOOT,renderer:function(e){return'<span class="icon"></span>','<span class="text"></span>',"</a>",'<a href="javascript:void(0)" class="grid-content-btn grid-content-btn-reboot btn-reboot"><span class="icon"></span><span class="text"></span></a>'}}]}}]}),this.listen({"stores.rebootListStore":{"ev_loaded":function(){for(var e=a.rebootListStore.getData(),t=e.length-1;0<=t;t--)"disconnected"===e[t].groupStatus?a.rebootListStore.disable(e[t].key):s.deviceArr.push({mac:e[t].mac})}}}),this.control({"#reboot-button":{"ev_button_click":function(){o.main.confirm(n.su.CHAR.REBOOT.REBOOT_ALERT,function(){s.startReboot(s.deviceArr)},null,n.su.CHAR.REBOOT.REBOOT)}},"#reboot-list-grid=>.grid-content-btn-reboot":{"ev_grid_action_click":function(e,t){var c=a.rebootListStore.getSubModelBindByKey(t).mac.getValue();o.main.confirm(n.su.CHAR.REBOOT.REBOOT_ALERT,function(){s.startReboot([{mac:c}])},null,n.su.CHAR.REBOOT.REBOOT)}}})}},function(e,t,c,s,a,o){return{deviceArr:[],startReboot:function(e){o.ajax.request({proxy:"rebootProxy",data:{"params":{"mac_list":e}},success:function(e){a.main.startReboot(115e3,function(){localStorage&&localStorage.setItem("token",""),location.href=location.protocol+"//tplinkdeco.net"})}})}}})}(jQuery);