!function(o){o.su=o.su||{},o.su.debug=o.su.debug||{log:function(){},warn:function(){},error:function(){}},o.ajaxSetup({type:"POST",cache:!0,success:function(e,t,i){},error:function(e,t,i){}}),o.su.format={},o.su.format.capitalize=function(e){return(e=e.toLowerCase()).replace(/\b(\w)|\s(\w)/g,function(e){return e.toUpperCase()})},o.su.getAttrObject=function(e,t){if(!(t=t.replace(/[\{,\}]/g,"")))return"";if("true"===t)return!0;if("false"===t)return!1;if(/^\d+$/.test(t))return parseInt(t,10);for(var i=t.split("."),n=e,s=0,a=i.length;s<a;){if(!(n=n[i[s]]))return!1;s++}return n||!1},o.su.formatAttrName=function(e){for(var t=e.split("-"),i=0;i<t.length;i++)0!==i&&(t[i]=t[i].replace(/(\w)/,function(e){return e.toUpperCase()}));return t.join("")},o.su.randomId=function(e){return e+"-"+o.su.guid()},o.su.guid=function(){for(var e,t,i,n=function(e,t,i){return i!==undefined?parseInt(e.toString(),i).toString(t):parseInt(e.toString(),10).toString(t)},s=function(e){return"NaN"!=Number(e).toString()&&0<=e&&e<10?"0"+Math.floor(e):e.toString()},a=new Date,r="",o=n((e=a).getFullYear()+s(e.getMonth()+1)+s(e.getDay()),16),d=n(s((t=a).getHours())+s(t.getMinutes())+s(t.getSeconds())+s(parseInt(t.getMilliseconds()/10,10)),16),l=0;l<9;l++)r+=Math.floor(16*Math.random()).toString(16);for(r+=o,r+=d;r.length<32;)r+=Math.floor(16*Math.random()).toString(16);return(i=r).slice(0,8)+"-"+i.slice(8,12)+"-"+i.slice(12,16)+"-"+i.slice(16,20)+"-"+i.slice(20)},o.su.clone=function(e){var t,i;switch(o.type(e)){case"array":for(t=[],i=0;i<e.length;i++)t[i]=o.su.clone(e[i]);return t;case"object":for(i in t={},e)t[i]=o.su.clone(e[i]);return t;case"null":return null;case"undefined":return undefined;case"function":return e;case"string":case"number":return t=e;case"boolean":return!!e;default:return undefined}},o.su.getDefaultEvent=function(e,t,i){var n=!0;return i===undefined||null===i?i=[]:o.isArray(i)||(i=[i]),{exe:function(){return n&&t.apply(e,i),n},ev:{preventDefault:function(){n=!1}}}},o.su.transSpecialChar=function(e){var t=document.createElement("div");return t.innerText!==undefined?t.innerText=e:t.textContent=e,t.innerHTML},o.su.escapeHtml=function(e){var t=e.toString();return t=(t=(t=(t=(t=(t=t.replace(/\&/g,"&amp;")).replace(/</g,"&lt;")).replace(/\>/g,"&gt;")).replace(/\"/g,"&quot;")).replace(/\'/g,"&#x27;")).replace(/\//g,"&#x2F;")},o.su.inherit=function(e,t){if("function"!=typeof e||"function"!=typeof t)return!1;var i=function(){};i.prototype=e.prototype,t.prototype=new i,(t.prototype.constructor=t).superclass=e.prototype},o.su.getCookie=function(){for(var e,t,i=document.cookie;0<i.length;){if(-1==(e=i.indexOf(";"))){if(!0===n(t=i))return-1==(e=t.indexOf("="))?null:s(t.slice(e+1))}else if(!0===n(t=i.slice(0,e)))return-1==(e=t.indexOf("="))?null:s(t.slice(e+1));i=i.slice(e+1)}function n(e){var t=e.indexOf("=");return"COOKIE"==s(e.slice(0,t)).toUpperCase()}function s(e){var t,i,n="",s=e.length;for(t=0;t<s;t++)if(document.all){if(" "!=e.slice(t,t+1))break}else if(" "!=e[t])break;for(i=s-1;0<i;i--)if(document.all){if(" "!=e.slice(i,i+1))break}else if(" "!=e[i])break;return i<t?n:n=e.slice(t,i+1)}return null},o.inArray=function(e,t){if(!o.isArray(t))return-1;for(var i=0,n=t.length;i<n;i++)if(t[i]===e)return i;return-1},o.su.getObjectLength=function(e){var t=0;if(e)for(var i in e)e.hasOwnProperty(i)&&t++;return t},o.su.isEmptyObject=function(e){for(var t in e)return!1;return!0},o.su.isIe=new Function("return !-[1,];")(),o.su.platform=/(iPhone|iPad|iPod|iOS)/i.test(navigator.userAgent)?"ios":/(Android)/i.test(navigator.userAgent)?"android":"pc",o.su.getBrowseVersion=function(){var e,t={},i=navigator.userAgent.toLowerCase();return(e=i.match(/msie ([\d.]+)/))?(t.browse="ie",t.version=e[1]):(e=i.match(/firefox\/([\d.]+)/))?(t.browse="firefox",t.version=e[1]):(e=i.match(/chrome\/([\d.]+)/))?(t.browse="chrome",t.version=e[1]):(e=i.match(/opera.([\d.]+)/))?(t.browse="opera",t.versio=e[1]):(e=i.match(/version\/([\d.]+).*safari/))&&(t.browse="safari",t.version=e[1]),t},o.su.apply=function(e,t,i){var n;if(i&&o.su.apply(e,i),e&&t&&"object"==typeof t)for(n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},o.su.valueEqual=function(e,t){if(e===t)return!0;var i=o.type(e);if(i!==o.type(t))return!1;switch(i){case"array":case"object":return JSON.stringify(e)===JSON.stringify(t);default:return!1}},o.su.isMobile=function(){var e,t=!1;return e=navigator.userAgent||navigator.vendor||window.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)))&&(t=!0),t},o.su.ipToInt=function(e){if(e){var t=e.split(".");return 4!=t.length?-1:/^\s*[0-9]{1,3}\.{1}[0-9]{1,3}\.{1}[0-9]{1,3}\.{1}[0-9]{1,3}\s*$/.test(e)?Number(t[0])*(1<<24)+(Number(t[1])<<16|Number(t[2])<<8|Number(t[3])):-1}},o.su.numToCapacity=function(e,t){var i=e;t=t||3;return 1e15<=e?i=(i/1e15).toFixed(t)+o.su.CHAR.UNIT.PB:1e12<=e?i=(i/1e12).toFixed(t)+o.su.CHAR.UNIT.TB:1e9<=e?i=(i/1e9).toFixed(t)+o.su.CHAR.UNIT.GB:1e6<=e?i=(i/1e6).toFixed(t)+o.su.CHAR.UNIT.MB:1e3<=e&&(i=(i/1e3).toFixed(t)+o.su.CHAR.UNIT.KB),i},o.su.capacityToNum=function(e){var t=o.su.CHAR.UNIT.PB,i=o.su.CHAR.UNIT.TB,n=o.su.CHAR.UNIT.GB,s=o.su.CHAR.UNIT.MB,a=o.su.CHAR.UNIT.KB,r=o.su.CHAR.UNIT.B;return-1<e.indexOf(t)?1e3*e.split(t)[0]*1e3*1e3*1e3:-1<e.indexOf(i)?1e3*e.split(i)[0]*1e3*1e3*1e3:-1<e.indexOf(n)?1e3*e.split(n)[0]*1e3*1e3:-1<e.indexOf(s)?1e3*e.split(s)[0]*1e3:-1<e.indexOf(a)?1e3*e.split(a)[0]:-1<e.indexOf(r)?e.split(a)[0]:void 0},o.su.debounce=function(n,s,a){var r;return function(){var e=this,t=arguments,i=a&&!r;clearTimeout(r),r=setTimeout(function(){r=null,a||n.apply(e,t)},s),i&&n.apply(e,t)}},o.su.throttle=function(i,n,s){var a,r=new Date;return function(){var e=arguments,t=new Date;clearTimeout(a),s<=t-r?(i.apply(this,e),r=t):a=setTimeout(i,n)}},o.su.getMaxZIndex=function(){return Math.max.apply(null,o.map(o("body div:visible"),function(e,t){if("static"!=o(e).css("position")&&0!=o(e).width()&&0!=o(e).height())return parseInt(o(e).css("z-index"),10)||1}))},o.su.filterArrField=function(){var t=Array.prototype.slice.call(arguments),s=new Array(this.length);return o.each(this,function(i,e){var n=e;s[i]={},o.each(t,function(e,t){n[t]!==undefined&&(s[i][t]=n[t])})}),s}}(jQuery),jQuery.su.settings={classManager:{loader:"Loader"},Proxy:{defaultRoot:"root"},Model:{defaultProxy:"IPFProxy",depFields:["proxy"]},Store:{defaultProxy:"IPFProxy",depFields:["proxy"]},AjaxService:{defaultProxy:"IPFProxy"},Loader:{classesPath:"./config/classes.json"}},function(e){var t;e.su=e.su||{},e.su.Observable=((t=function(){this.eventDealer={eventInfo:{}}}).prototype.addListener=function(e,t,i,n){var s=this;if("string"!=typeof e)for(e in n=e)n.hasOwnProperty(e)&&(config=n[e],s.addListener(e,config.fn||config,config.scope||n.scope,config.fn?config:n));else{if(i=i||s,"string"==typeof t){if(!i[t]&&!s[t])throw new Error('No method named "'+t+'"');t=i[t]||s[t]}s.eventDealer.eventInfo[e]?s.eventDealer.eventInfo[e].push({fn:t,scope:i}):s.eventDealer.eventInfo[e]=[{fn:t,scope:i}]}},t.prototype.removeListener=function(e,t,i,n){var s=this;if("string"!=typeof e)for(e in n=e)n.hasOwnProperty(e)&&(config=n[e],s.removeListener(e,config.fn||config,config.scope||n.scope,config.fn?config:n));else{if(i=i||s,"string"==typeof t){if(!i[t]&&!s[t])throw new Error('No method named "'+t+'"');t=i[t]||s[t]}if(!s.eventDealer.eventInfo[e])return!1;for(var a=s.eventDealer.eventInfo[e].length-1;0<=a;a--){var r=s.eventDealer.eventInfo[e][a];r.fn==t&&r.scope==i&&s.eventDealer.eventInfo[e].splice(a,1)}}},t.prototype.one=function(e,t,i){i=i||this,this.eventDealer.eventInfo[e]?this.eventDealer.eventInfo[e].push({fn:t,scope:i,once:!0}):this.eventDealer.eventInfo[e]=[{fn:t,scope:i,once:!0}]},t.prototype.fireEvent=function(e,t){if(this.eventDealer){var i=this.eventDealer.eventInfo[e];if(i)for(var n=i.slice(0),s=0;s<n.length;s++)n[s].fn.apply(n[s].scope,[n].concat(t)),n[s].once&&this.removeListener(e,n[s].fn,n[s].scope)}},t.prototype.clearListeners=function(){this.eventDealer.eventInfo={}},t.prototype.destroy=function(){this.clearListeners(),delete this.eventDealer},t.prototype.trigger=t.prototype.fireEvent,t.prototype.on=t.prototype.addListener,t.prototype.off=t.prototype.removeListener,t)}(jQuery),function(o){o.su.Loader=function(){var e=function(){o.su.Observable.call(this),this._map={},this._fileLoading=[],this._fileLoadedHandlerMap={},this._loadedFileDataMap={},this.addListener("ev_file_loaded",function(e,t){for(var i=this._fileLoadedHandlerMap[t];i&&i.length;)i.shift()(this._loadedFileDataMap[t]);delete this._fileLoadedHandlerMap[t],delete this._loadedFileDataMap[t]})};o.su.inherit(o.su.Observable,e),e.prototype.setPath=function(e){for(var t in e)e.hasOwnProperty(t)&&(this._map[t]=e[t])},e.prototype.has=function(e){return!!this._map[e]},e.prototype.load=function(e,t){var i=this._map[e];if(!i)return!1;n.call(this,i,t)},e.prototype.loadScript=function(e,t){n.call(this,e,{type:"script",success:t})},e.prototype.loadFile=function(e,t){n.call(this,e,{success:t})};var r=function(e,t){this._fileLoadedHandlerMap[e]?this._fileLoadedHandlerMap[e].push(t):this._fileLoadedHandlerMap[e]=[t]},n=function(n,e){var t,s,i=this,a=o.get;e&&(t=e.success,s=e.fail),0<=o.inArray(n,this._fileLoading)?t&&r.call(i,n,t):(t&&r.call(i,n,t),!e.type&&n.match(/\.json/)&&(e.type="json"),a(n,null,null,e.type).done(function(e){var t=o.inArray(n,i._fileLoading);i._fileLoading.splice(t,1),a===o.get&&(i._loadedFileDataMap[n]=e),i.fireEvent("ev_file_loaded",[n])}).fail(function(e,t,i){s&&s(),o.su.debug.error("load file error: ",n,"\n",i)}),this._fileLoading.push(n))};return e}()}(jQuery),function(l){l.su.SUClass=function(){function i(e,t){for(var i in t)t.hasOwnProperty(i);l.extend(e,t)}function t(e,t){"array"!==l.type(t)&&(t=[t]);for(var i=0,n=t.length;i<n;i++)l.inArray(t[i],e)<0&&e.push(t[i])}var r={$className:"",$isClass:!0,$parent:null,$inheritableStatics:null,$depsGatherer:null,$inheritableDepsGatherer:[],$inheritableOnClassDefined:[],inherit:function(e){var t=this;if("function"!=typeof e||"function"!=typeof t)return!1;var i=function(){};i.prototype=e.prototype,t.prototype=new i,(t.prototype.constructor=t).prototype.$parent=e,t.superclass=e.prototype;var n=(t.$parent=e).$inheritableStatics,s=t.$inheritableStatics;if(n)for(var a=0;a<n.length;a++){var r=n[a];t[r]=l.su.clone(n[r]),l.inArray(r,s)<0&&s.push(r)}if(e.$inheritableDepsGatherer){var o=t.$inheritableDepsGatherer;t.$inheritableDepsGatherer=e.$inheritableDepsGatherer.concat(o)}if(e.$inheritableOnClassDefined){o=t.$inheritableOnClassDefined;t.$inheritableOnClassDefined=e.$inheritableOnClassDefined.concat(o)}},setClassName:function(e){this.$className=e},addStatics:function(e){i(this,e)},addInheritableStatics:function(e){for(var t in i(this,e),e)e.hasOwnProperty(t)&&(this.$inheritableStatics[t]=!0)},addProtoMembers:function(e){i(this.prototype,e)},addInheritableDepsGatherers:function(e){t(this.$inheritableDepsGatherer,e)},addInheritableOnClassDefined:function(e){t(this.$inheritableOnClassDefined,e)},create:function(){var e=Array.prototype.slice.call(arguments,0);return l.su.ClassManager.getInstance().getInstantiator(e.length)(this,e)}},o={$instance:null,getInstance:function(e){if(this.$instance)return this.$instance;var t=Array.prototype.slice.call(arguments,0),i=l.su.ClassManager.getInstance().getInstantiator(t.length);return this.$instance=i(this,t)},create:function(e){return this.getInstance(e)}},d={self:null,callParent:function e(){}};return function(e){var t;if(e&&e.hasOwnProperty("constructor"))t=e.constructor;else if(e&&e.extend){var i,n=e.extend;i="string"==l.type(n)?l.su.ClassManager.getInstance().get(e.extend):e.extend,t=function(){i.apply(this,arguments)}}else t=function(){};return function s(e){l.extend(e,r),l.extend(e.prototype,d),e.prototype.self=e}(t),e&&function a(e,t,i){var n=t.name||l.su.randomId("AnonymousClass");if(e.setClassName(n),delete t.name,t.extend){var s=t.extend;"string"==l.type(s)&&(s=l.su.ClassManager.getInstance().get(s)),e.inherit(s),delete t.extend}t.singleton&&(e.addStatics(o),delete t.singleton),t.statics&&(e.addStatics(t.statics),delete t.statics),t.inheritableStatics&&(e.addInheritableStatics(t.inheritableStatics),delete t.inheritableStatics),t.depsGatherer&&(e.$depsGatherer=t.depsGatherer,delete t.depsGatherer),t.inheritableDepsGatherer&&(e.addInheritableDepsGatherers(t.inheritableDepsGatherer),delete t.inheritableDepsGatherer),t.onClassDefined&&(e.$onClassDefined=t.onClassDefined,delete t.onClassDefined),t.inheritableOnClassDefined&&(e.addInheritableOnClassDefined(t.inheritableOnClassDefined),delete t.inheritableOnClassDefined),e.addProtoMembers(t)}(t,e),t}}()}(jQuery),function(h){function o(e,t){var i=h.su.ClassManager.getInstance();return e.create?e.create.apply(e,t):i.getInstantiator(t.length)(e,t)}h.su.ClassManager=function(){var i=function(e){if(null!=i.instance)return instance;h.su.Observable.call(this),this._map={},e&&e.loader&&(this.loader=e.loader),this.settings={},this.definingClasses=[],i.instance=this};function d(e){return"ev_"+e+"_defined"}function e(t){var e,i,n,s,a=this,r=[],o=h.Deferred();if(t.extend){var d=t.extend;"string"==h.type(d)&&(e=h.su.require(d))}if(t.minxins){var l=t.minxins;if("string"==h.type(l)||"array"==h.type(l))i=h.su.require(l),r.push(i);else if("object"==h.type(l)){var c=[];for(var u in l)l.hasOwnProperty(u)&&c.push(l[u]);i=h.su.require(c),r.push(i)}}t.depsGatherer&&(n=t.depsGatherer(t),r.push(n)),t.inheritableDepsGatherer&&(s=t.inheritableDepsGatherer(t),r.push(s));return e?e.done(function(){var e=function(e){for(var t=h.Deferred(),i=a.get(e.extend).$inheritableDepsGatherer,n=[],s=0;s<i.length;s++)n.push(i[s](e));return h.when.apply(this,n).done(function(){t.resolve()}),t.promise()}(t);r.push(e),h.when.apply(this,r).done(function(){o.resolve()})}):h.when.apply(this,r).done(function(){o.resolve()}),o.promise()}h.su.inherit(h.su.Observable,i),i.instance=null,i.getInstance=function(){if(null==i.instance){i.instance=new i;var e=h.su.settings.classManager.loader,t=new h.su[e];i.instance.setLoader(t)}return i.instance},i.prototype.setLoader=function(e){this.loader=e},i.prototype.loadDefine=function(e,t){var i=h.Deferred();if(this.get(e))return t&&t(),i.resolve(),i.promise();(this.one(d(e),function(){t&&t(),i.resolve()}),h.inArray(e,this.definingClasses)<0)&&(this.definingClasses.push(e),this.loader.load(e,{type:"script"}));return i.promise()},i.prototype.get=function(e){if(this._map[e])return this._map[e];var t=h.su[e];return"function"==h.type(t)?t:void 0};return i.prototype.define=function(i,n,s){var a,r=this,o=h.Deferred();return i?n.name=i:a=!0,e.call(this,n).done(function(){var e=new h.su.SUClass(n);if(a||(r._map[i]=e),function(e){if(e.$inheritableOnClassDefined)for(var t=0;t<e.$inheritableOnClassDefined.length;t++)e.$inheritableOnClassDefined[t](e);e.$onClassDefined&&e.$onClassDefined(e)}(e),s&&s(e),!a){var t=h.inArray(i,r.definingClasses);0<=t&&r.definingClasses.splice(t,1),r.trigger(d(i))}o.resolve(e)}),o.promise()},i.prototype.defineSync=function(e,t){var i=new h.su.SUClass(t);this._map[e]=i},i.prototype.instantiators=[],i.prototype.getInstantiator=function(e){var t=this.instantiators,i=t[e];if(!i){for(var n=[],s=0;s<e;s++)n.push("a["+s+"]");(i=t[e]=new Function("c","a","return new c("+n.join(",")+")")).name="SUInstantiator"+e}return i},i}(),h.su.require=function(e,t){var i=h.su.ClassManager.getInstance();i||h.su.debug.error("ClassManager not init"),"string"===h.type(e)&&(e=[e]);for(var n=h.Deferred(),s=[],a=0,r=e.length;a<r;a++){var o=e[a],d=h.Deferred();s.push(d),i.get(o)?d.resolve():i.loadDefine(o,function(e){return function(){e.resolve()}}(d))}return h.when.apply(this,s).done(function(){t&&t(),n.resolve()}),n.promise()},h.su.define=function(){var e=h.su.ClassManager.getInstance();return e||h.su.debug.error("ClassManager not init"),e.define.apply(e,arguments)},h.su.create=function(){var e=arguments[0],i=Array.prototype.slice.call(arguments,1),t=h.type(e),n=h.su.ClassManager.getInstance(),s=h.Deferred();if("string"===t){var a=e;h.su.require(a).done(function(){var e=o(n.get(a),i);s.resolve(e)})}else if("function"===t){var r=o(e,i);s.resolve(r)}else"object"===t&&n.define(null,e).done(function(e){var t=o(e,i);s.resolve(t)});return s.promise()},h.su.createSync=function(){var e=arguments[0],t=Array.prototype.slice.call(arguments,1),i=h.type(e),n=h.su.ClassManager.getInstance();if("string"===i){var s=e,a=n.get(s);return a||h.su.debug.error("class not defined: "+s),o(a,t)}}}(jQuery),jQuery.su.Tree=function(){var e=function(e){var t=new s(e);this._root=t};function s(e){this.data=e,this.value=this.data.mac,this.parent=null,this.children=[]}function a(){this._oldestIndex=1,this._newestIndex=1,this._storage={}}return e.prototype.traverseDF=function(n){!function s(e){for(var t=0,i=e.children.length;t<i;t++)s(e.children[t]);n(e)}(this._root)},e.prototype.traverseBF=function(e){var t=new a;for(t.enqueue(this._root),currentTree=t.dequeue();currentTree;){for(var i=0,n=currentTree.children.length;i<n;i++)t.enqueue(currentTree.children[i]);e(currentTree),currentTree=t.dequeue()}},e.prototype.contains=function(e,t){t.call(this,e)},e.prototype.add=function(e,t){var i=new s(e),n=null;if(this.contains(function(e){e.value===t&&(n=e)},this.traverseBF),!n)throw new Error("Cannot add node to a non-existent parent.");n.children.push(i),i.parent=n},e.prototype.remove=function(e,t,i){var n,s=null;if(this.contains(function(e){e.data===t&&(s=e)},i),!s)throw new Error("Parent does not exist.");if((n=function a(e,t){for(var i,n=0;n<e.length;n++)e[n].data===t&&(i=n);return i}(s.children,e))===undefined)throw new Error("Node to remove does not exist.");return s.children.splice(n,1)},a.prototype.size=function(){return this._newestIndex-this._oldestIndex},a.prototype.enqueue=function(e){this._storage[this._newestIndex]=e,this._newestIndex++},a.prototype.dequeue=function(){var e,t=this._oldestIndex;if(t!==this._newestIndex)return e=this._storage[t],delete this._storage[t],this._oldestIndex++,e},e}(),function(o){o.su.View=function(){var s=function(e,t){o.su.Observable.call(this,t),this._id=o.su.randomId("view"),this._name=e,this._childrenWidgets={},this._DOM="string"==typeof t?o(t):t.clone(),this._container=null,i.call(this)};o.su.inherit(o.su.Observable,s);var r={"WIDGET_RENDERED":"ev_view_widget_rendered","WIDGET_CREATED":"ev_view_widget_created","WIDGET_WILL_DESTROY":"ev_view_widget_will_destroy"},i=function(){var e=this._DOM.find("[widget]");if(0!==e.length)for(var t=0;t<e.length;t++){var i=e[t],n=i.id;n||(i.id=n=o.su.randomId("widget-")),this._childrenWidgets[n]={attributes:s.transWidgetOptions(i.attributes),config:null,instance:null}}};return s.transWidgetOptions=function(e){for(var t={},i=0;i<e.length;i++){var n=e[i].nodeValue;this._name;t[e[i].nodeName]=n}return t},s.prototype.getChild=function(e){return this._childrenWidgets[e].instance},s.prototype.getWidgetsMap=function(){return this._childrenWidgets},s.prototype.getName=function(){return this._name},s.prototype.getID=function(){return this._id},s.prototype.dom=function(){return this._DOM},s.prototype.isEffective=function(){return 0!==o('div[view="{'+this._name+'}"]').length},s.prototype.configChildrenWidgets=function(e){if(e)for(var t=0;t<e.length;t++){var i=e[t].id,n=this._childrenWidgets[i];n&&(n.config=e[t],e[t].model&&(n.attributes["data-bind"]=e[t].model))}},s.prototype.clear=function(){for(var e in this._childrenWidgets)this._childrenWidgets.hasOwnProperty(e)&&this._childrenWidgets[e].instance&&this._childrenWidgets[e].instance._destroy();this._childrenWidgets={}},s.prototype.createChildrenWidgets=function(){for(var e in this._childrenWidgets)if(this._childrenWidgets.hasOwnProperty(e)){var t=e,i=null,n=this._childrenWidgets[t];if(o("#"+t).data("viewObj"))n.instance=o("#"+t).data("viewObj");else{var s=o.extend(!0,{},n.attributes,n.config),a=s.widget;o.su.widgets[a]&&(i=new o.su.widgets[a]({id:t,view:this,settings:s})),n.instance=i}this.fireEvent(r.WIDGET_CREATED,[n,this])}},s.prototype.setContainer=function(e){(this._container=e).load&&e.load(this._DOM)},s.prototype.render=function(){var i=this,n=[],e=o.Deferred();if(0==o.su.getObjectLength(this._childrenWidgets))return e.resolve(),e.promise();var s=o.extend({},this._childrenWidgets);return o.each(s,function(e,t){s.hasOwnProperty(e)&&i._childrenWidgets.hasOwnProperty(e)&&n.push(t.instance.render())}),o.when.apply(this,n).done(function(){i.rendered=!0,e.resolve()}),e.promise()},s.prototype.removeChildWidget=function(e){o.isArray(e)||(e=[e]);for(var t=0;t<e.length;t++){var i=e[t].domId;this.fireEvent(r.WIDGET_WILL_DESTROY,[e[t],this]),this._childrenWidgets[i]=null,delete this._childrenWidgets[i]}},s.prototype.addChildWidget=function(e){o.isArray(e)||(e=[e]);for(var t=0;t<e.length;t++){var i=e[t].domId;this._childrenWidgets[i]||(this._childrenWidgets[i]={instance:e[t],attributes:s.transWidgetOptions(e[t].dom().get(0).attributes)})}},s.prototype.onChildWidgetRendered=function(e){var t=e.domId;this.fireEvent(r.WIDGET_RENDERED,[this._childrenWidgets[t],this])},s.prototype.destroy=function(){s.superclass.destroy.call(this),delete this._id,delete this._name,delete this._childrenWidgets,this._DOM.remove(),delete this._DOM,delete this._container},s.EVENT=r,s}()}(jQuery),function(h){h.su.Controller=function(){var i={xtype:"controller",host:null,views:null,stores:null,models:null,listeners:{"ev_view_unload":function(e,t){var i=this._getView(t);i&&i.clear(),!this.viewsEffective()&&this.autoDestroy&&this.fireEvent("ev_to_destroy",this.name)}},autoDestroy:!0},n=function(e){h.su.Observable.call(this,e);var t=h.extend(!0,{},i,e);(this.settings=t).host&&(t.host=h(t.host),0==t.host.length&&(t.host=null)),this.data={views:{},models:{},stores:{}},this.autoDestroy=t.autoDestroy,this.isController=!0,this.id=h.su.randomId("controller"),this.addListener(t.listeners),this.dataEventsMap={},this.domEventsMap={},this.effectiveViewDatas={},this._init()};h.su.inherit(h.su.Observable,n);n.prototype._getAttrBind=function(e,t){return e=e.replace(/[\{,\}]/g,""),h.su.getAttrObject(this.data.models,e)||h.su.getAttrObject(this.data.stores,e)||h.su.getAttrObject(this.data.stores,e)||h.su.getAttrObject(this.data.views[t],e)};var l=function(e,t){var i=e.instance,n=e.attributes,s=t._name;for(var a in this.effectiveViewDatas[s]||(this.effectiveViewDatas[s]=[]),n)if(n.hasOwnProperty(a)&&a.match(/data-(.+)/g)){var r=this._getAttrBind(n[a],s);r instanceof h.su.DataBind&&(r.bindViewObj(i),this.effectiveViewDatas[s].push({viewObj:i,bind:r}))}},c=function(e,t){var i=e,n=t._name;if(e.dataBind){for(var s=e.dataBind,a=s.length;0<a;a--){s[a-1].unbindViewObj(e);var r=this.effectiveViewDatas[n];if(r)for(var o=r.length;0<o;o--)r[o-1].viewObj===i&&r[o-1].bind===s[a-1]&&r.splice(o-1,1)}e.dataBind=[]}},u=function(e){a.call(this),a.call(this),h.each(this.domEventsMap,function(s,e){h.each(e,function(e,t){for(var i=0;i<t.length;i++){var n=s.split("=>");1==n.length?h(s).on(e,t[i].effectiveHandler):(n.length,h(n[0]).delegate(n[1],e,t[i].effectiveHandler))}})})},a=function(){h.each(this.domEventsMap,function(s,e){h.each(e,function(e,t){for(var i=0;i<t.length;i++){var n=s.split("=>");1==n.length?h(s).off(e,t[i].effectiveHandler):(n.length,h(n[0]).undelegate(n[1],e,t[i].effectiveHandler))}})})};return n.prototype._init=function(){this.initViews(),this.initModels(),this.initStores(),this.initViewData()},n.prototype.launch=function(e){(function(e){if(e)0<=h.inArray(e,this.view)&&this._getView(e).createChildrenWidgets();else for(var t in this.view)if(this.view.hasOwnProperty(t)){var i=this._getView(this.view[t]);i.isEffective()&&i.createChildrenWidgets()}}).call(this),h.when(function(e){var t,i=h.Deferred(),n=this,s=[];if(this.fireEvent("before_render"),e)0<=h.inArray(e,this.view)&&h.when(this._getView(e).render()).done(function(){u.call(n),n.fireEvent("ev_after_view_render",[e]),i.resolve()});else{for(t=0;t<this.view.length;t++)this._getView(this.view[t]).isEffective()&&s.push(this._getView(this.view[t]).render());h.when.apply(this,s).done(function(){u.call(n),n.fireEvent("ev_after_views_render"),i.resolve()})}return i.promise()}.call(this)).done(e)},n.prototype.initViews=function(){var e,t,n=this,i=this.settings;if(this.view=[],this._viewsMap={},i.views)for(var s=0;s<i.views.length;s++){var a=i.views[s];this.view.push(a),e=a,t=h.su.viewManager.init(e),(this._viewsMap[e]=t).addListener(h.su.View.EVENT.WIDGET_RENDERED,function(e,t,i){l.call(n,t,i)}),t.addListener(h.su.View.EVENT.WIDGET_WILL_DESTROY,function(e,t,i){c.call(n,t,i)})}},n.prototype.initModels=function(){var e=this.settings;if(this.model=e.models,this.model)for(var t=0;t<this.model.length;t++)h.su.modelManager.init(this.model[t])},n.prototype.initStores=function(e){e=this.settings;if(this.store=e.stores,this.store)for(var t=0;t<this.store.length;t++)h.su.storeManager.init(this.store[t])},n.prototype.initViewData=function(){var e,s=this;this.settings;if(this.data.stores={},this.data.models={},this.data.views={},this.store)for(e=0;e<this.store.length;e++)this.data.stores[this.store[e]]=new h.su.StoreBind(this._getStore(this.store[e]));if(this.model)for(e=0;e<this.model.length;e++)this.data.models[this.model[e]]=new h.su.ModelBind(this._getModel(this.model[e]));if(this.view)for(e=0;e<this.view.length;e++){var a=this.view[e],t=this._getView(a);this.data.views[a]={},h.each(t.getWidgetsMap(),function(e,t){h.each(t.attributes,function(e,t){if(e.match(/data-(.+)/g)&&!s._getAttrBind(t,a)){var i=new h.su.DataFieldBind(new h.su.DataField),n=t.replace(/[\{,\}]/g,"");s.data.views[a][n]=i}})})}},n.prototype.configViews=function(e){h.isArray(e)||(e=[e]);for(var t=0;t<e.length;t++){var i=e[t],n=i.id,s=i.items;this._getView(n).configChildrenWidgets(s)}},n.prototype.control=function(e){var t=this;for(var i in e)if(e.hasOwnProperty(i))for(var n in e[i])if(e[i].hasOwnProperty(n)){var s=e[i][n];if("string"==typeof s){if(!t[s])throw new Error('No method named "'+s+'"');s=t[s]}var a=function(e){return function(){e.apply(t,arguments)}}(s),r=i.split("=>");if(1==r.length)h(i).on(n,a);else{if(2!==r.length)throw new Error("bindEvent error, incorrect selector format");h(r[0]).delegate(r[1],n,a)}this.domEventsMap[i]||(this.domEventsMap[i]={}),this.domEventsMap[i][n]||(this.domEventsMap[i][n]=[]),this.domEventsMap[i][n].push({effectiveHandler:a,handler:s})}},n.prototype.unControl=function(e){for(var t in e)if(e.hasOwnProperty(t))for(var i in e[t])if(e[t].hasOwnProperty(i)){var n=t.split("=>"),s=e[t][i];if("string"==typeof s){if(!this[s])throw new Error('No method named "'+s+'"');s=this[s]}if(this.domEventsMap[t]&&this.domEventsMap[t][i])for(var a=this.domEventsMap[t][i].length-1;0<=a;a--)if(this.domEventsMap[t][i][a].handler==s){if(1==n.length)h(t).off(i,this.domEventsMap[t][i][a].effectiveHandler);else{if(2!==n.length)throw new Error("bindEvent error, incorrect selector format");h(n[0]).undelegate(n[1],i,this.domEventsMap[t][i][a].effectiveHandler)}this.domEventsMap[t][i].splice(a,1);break}}},n.prototype.listen=function(e){for(var t in e)if(e.hasOwnProperty(t)){var i=h.su.getAttrObject(this.data,t);if(!i){var n=t.split(".");"views"===n[0]&&this.data.views[n[1]]&&n[2]!==undefined&&(i=this.data.views[n[1]][n[2]]=new h.su.DataFieldBind(new h.su.DataField))}for(var s in e[t])if(e[t].hasOwnProperty(s)){var a=e[t][s];if("string"==typeof a){if(!this[a])throw new Error('No method named "'+a+'"');a=this[a]}i.addListener(s,a,this),this.dataEventsMap[t]||(this.dataEventsMap[t]={}),this.dataEventsMap[t][s]||(this.dataEventsMap[t][s]=[]),this.dataEventsMap[t][s].push(a)}}},n.prototype.unListen=function(e){var t;for(var i in e)if(e.hasOwnProperty(i)){var n=h.su.getAttrObject(this.data,i);for(var s in e[i])if(e[i].hasOwnProperty(s)){var a=e[i][s];if("string"==typeof a){if(!this[a])throw new Error('No method named "'+a+'"');a=this[a]}this.dataEventsMap[i]&&this.dataEventsMap[i][s]&&0<=(t=h.inArray(a,this.dataEventsMap[i][s]))&&(n.removeListener(s,a,this),this.dataEventsMap[i][s].splice(t,1))}}},n.prototype.addModel=function(e){var t;h.isArray(e)||(e=[e]);for(var i=0,n=e.length;i<n;i++)if(t=e[i],h.su.modelManager.getStatus(t))h.su.modelManager.init(t),this.model.push(t),this.data.models[t]=new h.su.ModelBind(h.su.modelManager.get(t));else{if(!h.su.storeManager.getStatus(t))throw new Error("model not defined");h.su.storeManager.init(t),this.store.push(t),this.data.stores[t]=new h.su.StoreBind(h.su.storeManager.get(t))}},n.prototype.updateView=function(e,t){var i,n=h.Deferred(),s=this,a=[],r=h.su.viewManager;if(this.fireEvent("before_render"),"string"!=typeof e&&(e,e=null),e){if(this.unbindView(e),0<=h.inArray(e,this.view)){d=(o=this._getView(e))._container;r.removeByID(o.getID()),o=r.init(e),(this._viewsMap[e]=o).addListener(h.su.View.EVENT.WIDGET_RENDERED,function(e,t,i){l.call(s,t,i)}),o.addListener(h.su.View.EVENT.WIDGET_WILL_DESTROY,function(e,t,i){c.call(s,t,i)}),o.setContainer(d),o.createChildrenWidgets(),h.when(o.render()).done(function(){u.call(s),s.fireEvent("ev_after_view_render",[e]),n.resolve()})}}else{for(this.unbindView(),i=0;i<this.view.length;i++){var o,d=(o=this._getView(this.view[i]))._container;r.removeByID(o.getID()),o=r.init(this.view[i]),(this._viewsMap[this.view[i]]=o).addListener(h.su.View.EVENT.WIDGET_RENDERED,function(e,t,i){l.call(s,t,i)}),o.addListener(h.su.View.EVENT.WIDGET_WILL_DESTROY,function(e,t,i){c.call(s,t,i)}),o.setContainer(d),o.createChildrenWidgets(),o.isEffective()&&a.push(o.render())}h.when.apply(this,a).done(function(){u.call(s),s.fireEvent("ev_after_views_render"),n.resolve()})}return n.promise()},n.prototype._getStore=function(e){return 0<=h.inArray(e,this.store)?h.su.storeManager.get(e):null},n.prototype._getModel=function(e){return 0<=h.inArray(e,this.model)?h.su.modelManager.get(e):null},n.prototype._getView=function(e){return e=e||this.view[0],this._viewsMap[e]},n.prototype.getStore=function(e){return this.data.stores[e]},n.prototype.getModel=function(e){return this.data.models[e]},n.prototype.getView=function(e){return this.data.views[e]},n.prototype.viewsEffective=function(){for(var e=0;e<this.view.length;e++)if(!this._getView(this.view[e]).isEffective())return!1;return!0},n.prototype.unbindView=function(e){if(e&&0<=h.inArray(e,this.view)){if(this.effectiveViewDatas[e])for(var t=0;t<this.effectiveViewDatas[e].length;t++){var i=this.effectiveViewDatas[e][t].viewObj;this.effectiveViewDatas[e][t].bind.unbindViewObj(i)}this.effectiveViewDatas[e]=[]}else for(var n=0;n<this.view.length;n++)this.unbindView(this.view[n])},n.prototype.destroy=function(){var s=this;n.superclass.destroy.call(this),a.call(this),h.each(this.dataEventsMap,function(e,t){var n=h.su.getAttrObject(s.data,e);h.each(t,function(e,t){for(var i=0;i<t.length;i++)n.removeListener(e,t[i],s)})});var e=function(e){for(var t in e)e.hasOwnProperty(t)&&e[t].unbind()};for(var t in this.data.views)this.data.views.hasOwnProperty(t)&&e(this.data.views[t]);for(var i in this._viewsMap)this._viewsMap.hasOwnProperty(i)&&h.su.viewManager.removeByID(this._getView(i).getID());e(this.data.models),e(this.data.stores),this.data.views={},this.data.models={},this.data.stores={},this.effectiveViewDatas={}},n}()}(jQuery),function(i){var n,s;i.su.Module=(n={container:null,page:"",controller:null,autoRender:!1,deps:null,service:null,init:function(e){},onLaunch:function(){}},s=function(e){var t=i.extend(!0,{},n,e);this.name=t.name,this.status=s.STATUS.AVAILABLE,this.dataEventsListeners={},this.domEventsListeners={},i.su.Controller.call(this,t)},i.su.inherit(i.su.Controller,s),s.prototype._init=function(){this.data.deps={},this.services={},this.initDeps(),this.initServices();for(var e=0;e<this.deps.length;e++)this.data.deps[this.deps[e]]=this.getDep(this.deps[e]);s.superclass._init.call(this);var t=this.factory.call(this,this,this.data.views,this.data.models,this.data.stores,this.data.deps,this.services);t&&i.extend(this,t),this.settings.init.call(this,this,this.data.views,this.data.models,this.data.stores,this.data.deps,this.services)},s.prototype.initDeps=function(){var e=this.settings;this.deps=e.deps;for(var t=0;t<this.deps.length;t++)i.su.moduleManager.init(this.deps[t])},s.prototype.initServices=function(){var e=this.settings.services;if(e)for(var t=0;t<e.length;t++)this.services[e[t]]=i.su.serviceManager.get(e[t])},s.prototype._getAttrBind=function(e,t){return e=e.replace(/[\{,\}]/g,""),i.su.getAttrObject(this.data.models,e)||i.su.getAttrObject(this.data.stores,e)||i.su.getAttrObject(this.data.views[t],e)||i.su.getAttrObject(this.data.deps,e)},s.prototype.load=function(e){var t=this;this.status==s.STATUS.RUNNING?this.updateView(e):this.launch(function(){t.bindControl(),t.bindListen(),t.status=s.STATUS.RUNNING,e&&e()})},s.prototype.launch=function(e){this.trigger("ev_before_launch");var t=this;s.superclass.launch.call(this,function(){t.trigger("ev_on_launch",[t,t.data.views,t.data.models,t.data.stores,t.data.deps,t.services]),e&&e()})},s.prototype.getDep=function(e){return 0<=i.inArray(e,this.deps)?i.su.moduleManager.query(e):null},s.prototype.getService=function(e){return this.services[e]},s.prototype.destroy=function(){this.fireEvent("ev_before_destroy",[this,this.data.views,this.data.models,this.data.stores,this.data.deps,this.services]),s.superclass.destroy.call(this),this.data.deps={},this.services={},this.status=s.STATUS.DEFINED},s.prototype.control=function(e){this.domEventsListeners=e,this.status===s.STATUS.RUNNING&&this.bindControl()},s.prototype.bindControl=function(){s.superclass.control.call(this,this.domEventsListeners),this.domEventsListeners={}},s.prototype.listen=function(e){this.dataEventsListeners=e,this.status===s.STATUS.RUNNING&&this.bindListen()},s.prototype.bindListen=function(){s.superclass.listen.call(this,this.dataEventsListeners),this.dataEventsListeners={}},s.EVENT={AFTER_RENDER:"afterRender"},s.STATUS={DEFINE_NOT_LOADED:"defineNotLoaded",LOADING_DEFINE:"loadingDefine",DEFINED:"defined",AVAILABLE:"available",RUNNING:"running"},s)}(jQuery),function(){function i(){return this.msg||this.message}$.su.Error=function(e){"string"==typeof e&&(e={msg:e});var t=new Error;return $.su.apply(t,e),t.message=t.message||t.msg,t.toString=i,t},$.su.apply($.su.Error,{ignore:!1,raise:function(e){if("string"==typeof(e=e||{})&&(e={msg:e}),!0!==this.handle(e))throw new $.su.Error(e)},handle:function(){return this.ignore}})}(),$.su.raise=function(){$.su.Error.raise.apply($.su.Error,arguments)},function(o){o.su.Router=function(){var e=function(){o.su.Observable.call(this),this.routerList={},this.modelsMap={},this.helpMap={},this._fileLoading=[],this._fileLoaded=[],this._fileLoadedHandlerMap={},this._loadedFileDataMap={},this.addListener("ev_file_loaded",function(e,t){for(var i=this._fileLoadedHandlerMap[t];i&&i.length;)i.shift()(this._loadedFileDataMap[t])})};o.su.inherit(o.su.Observable,e);var r=function(e,t){this._fileLoadedHandlerMap[e]?this._fileLoadedHandlerMap[e].push(t):this._fileLoadedHandlerMap[e]=[t]},i=function(n,e){var t,s,i=this,a=o.get;e&&("script"===e.type&&(a=o.getScript),t=e.success,s=e.fail),0<=o.inArray(n,this._fileLoaded)?t&&t(this._loadedFileDataMap[n]):0<=o.inArray(n,this._fileLoading)?t&&r.call(i,n,t):(t&&r.call(i,n,t),a(n).done(function(e){var t=o.inArray(n,i._fileLoading);i._fileLoading.splice(t,1),i._fileLoaded.push(n),a===o.get&&(i._loadedFileDataMap[n]=e),i.fireEvent("ev_file_loaded",[n])}).fail(function(e,t,i){s&&s(),o.su.debug.error("load file error: ",n,"\n",i)}),this._fileLoading.push(n))};return e.prototype.loadFile=function(e,t){i.call(this,e,{success:t})},e.prototype.loadScript=function(e,t){i.call(this,e,{type:"script",success:t})},e.prototype.set=function(e){e=e;o.isEmptyObject(e)||(o.each(e,function(e,t){"string"==typeof t.controller&&(t.controller={_default:t.controller}),"string"==typeof t.view&&(t.view={_default:t.view})}),this.routerList=e)},e.prototype.setItem=function(e,t){this.routerList[e]?o.extend(!0,this.routerList[e],t):this.routerList[e]=t,"string"==typeof this.routerList[e].controller&&(this.routerList[e].controller={_default:this.routerList[e].controller}),"string"==typeof this.routerList[e].view&&(this.routerList[e].view={_default:this.routerList[e].view})},e.prototype.query=function(e){return this.routerList[e]},e.prototype.loadController=function(e,t,i){var n,s,a=e;s="function"==typeof t?t:(n=t,i);var r=this.routerList[a];n?r.controller[n]&&this.loadFile.call(this,r.controller[n],s):this.loadFile.call(this,r.controller._default,s)},e.prototype.loadView=function(e,t,i){var n,s,a=e;s="function"==typeof t?t:(n=t,i);var r=this.routerList[a];n&&r.view[n]?r.view[n]&&this.loadFile.call(this,r.view[n],s):this.loadFile.call(this,r.view._default,s)},e.prototype.setModelsPath=function(e){for(var t in e)e.hasOwnProperty(t)&&(this.modelsMap[t]=e[t])},e.prototype.loadModel=function(e,t){if(!this.modelsMap[e])throw new Error('Model "'+e+'" has not declare file path');this.loadFile.call(this,this.modelsMap[e],t)},e.prototype.setHelpPath=function(e){for(var t in e)e.hasOwnProperty(t)&&(this.helpMap[t]=e[t])},e.prototype.loadHelp=function(e,t){var i;i=this.helpMap[e]?this.helpMap[e]:{struct:e+".html",name:e},o.get("./help/"+i.struct,function(e){t(i.name,e)})},e}()}(jQuery),$.su.Application=function(){var e=function(){$.su.Controller.call(this),$.su.modelManager=new $.su.ModelManager,$.su.moduleManager=new $.su.ModuleManager,$.su.storeManager=new $.su.StoreManager,$.su.viewManager=new $.su.ViewManager,$.su.serviceManager=new $.su.ServiceManager,this.modelManager=$.su.modelManager,this.moduleManager=$.su.moduleManager,this.storeManager=$.su.storeManager,this.viewManager=$.su.viewManager,this.serviceManager=$.su.serviceManager,this.container=null};return $.su.inherit($.su.Controller,e),e.prototype.setContainer=function(e){this.container=e},e.prototype.init=function(){},e.prototype.launch=function(e){if(this.container){var t=new $.su.widgets.htmlLoader({id:this.container});$.when(t.render()).done(function(){$.su.moduleManager.load("main",function(){var e=$.su.moduleManager.query("main");e._getView().setContainer(t),e.load()})})}},e}(jQuery),function(e){var t;e.su=e.su||{},e.su.Service=(t=function(){if("object"==typeof this.constructor.instance)return this.constructor.instance;e.su.Observable.call(this),this.constructor.instance=this,e.su.serviceManager.register(this.name,this)},e.su.inherit(e.su.Observable,t),t)}(jQuery),function(v){var g;v.su.Vtype=(g=function(e){if("object"==typeof g.instance)return g.instance;this.name="vtype",v.su.Service.call(this),g.instance=this},v.su.inherit(v.su.Service,g),g.types={email:{regex:/^[a-zA-Z0-9_+.-]+\@([a-zA-Z0-9-]+\.)+[a-zA-Z0-9]{2,4}$/,vtypeText:v.su.CHAR.VTYPETEXT.EMAIL},float_positive:{regex:/^[0-9]\d*(.[0-9]\d*)?$/,vtypeText:v.su.CHAR.VTYPETEXT.NUMBER},float_number:{regex:/^-?[0-9]\d*(.[0-9]\d*)?$/,vtypeText:v.su.CHAR.VTYPETEXT.NUMBER,validator:function(e){return e=parseFloat(e),(null!==this.max||this.max!==undefined)&&e>this.max?null===this.min&&this.min===undefined?v.su.CHAR.VTYPETEXT.NUMBER_MAX.replace("%max",this.max.toString()):v.su.CHAR.VTYPETEXT.NUMBER_MIN_MAX.replace("%min",this.min.toString()).replace("%max",this.max.toString()):null===this.min&&this.min===undefined||!(e<this.min)||(null===this.max&&this.max===undefined?v.su.CHAR.VTYPETEXT.NUMBER_MIN.replace("%min",this.min.toString()):v.su.CHAR.VTYPETEXT.NUMBER_MIN_MAX.replace("%min",this.min.toString()).replace("%max",this.max.toString()))}},number:{regex:/^-?[0-9]\d*$/,vtypeText:v.su.CHAR.VTYPETEXT.NUMBER,minMaxText:v.su.CHAR.VTYPETEXT.NUMBER_MIN_MAX,maxText:v.su.CHAR.VTYPETEXT.NUMBER_MAX,minText:v.su.CHAR.VTYPETEXT.NUMBER_MIN,validator:function(e){return e=parseInt(e,10),null!==this.max&&this.max!==undefined&&e>this.max?null===this.min&&this.min===undefined?this.maxText.replace("%max",this.max.toString()):this.minMaxText.replace("%min",this.min.toString()).replace("%max",this.max.toString()):!(null!==this.min&&this.min!==undefined&&e<this.min)||(null===this.max&&this.max===undefined?this.minText.NUMBER_MIN.replace("%min",this.min.toString()):this.minMaxText.replace("%min",this.min.toString()).replace("%max",this.max.toString()))},keybordHandler:function(e){e.stopPropagation();var t=e.keyCode,i=e.shiftKey,n=e.ctrlKey;if(i)return!1;if(37==t||39==t)return!0;if(38==t||40==t){var s=v(this),a=s.val();if(v.su.vtype.types.number.regex.test(a))if(38==t){if(!(a<(s.hasClass("hour-text")?23:59)))return!1;s.val(parseInt(a,10)+1)}else{if(0==a)return!1;s.val(parseInt(a,10)-1)}else s.val(0)}return!(!n&&(t<48||57<t)&&32<t)&&void 0}},date:{format:"yyyy/MM/dd",validator:function(e){var t;if("MM/dd/yyyy"===this.format){t=/^(0[1-9]|1[0-2])\/(0[1-9]|1[0-9]|2[0-9]|3[0-1])\/([0-9]{4})$/;var i=e.split("/");if(parseInt(i[2],10)<1970)return v.su.CHAR.VTYPETEXT.DATE_INVALID;if(2030<parseInt(i[2],10))return v.su.CHAR.VTYPETEXT.DATE_INVALID}else"yyyy/MM/dd"===this.format&&(t=/^([0-9]{4})\/(0[1-9]|1[0-2])\/(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/);return!1!==t.test(e)||v.su.CHAR.VTYPETEXT.DATE}},ipv6:{isPrefixFlag:!1,regex:/^\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)?\s*$/,vtypeText:v.su.CHAR.VTYPETEXT.IPV6,validator:function(e){if(!new RegExp("^[2-3][0-9A-Fa-f]{1,3}:").test(e))return v.su.CHAR.VTYPETEXT.IPV6_NOT_GLOBAL;var t=new RegExp("::$"),i=new RegExp("^2002:");if(this.isPrefixFlag){if(!t.test(e))return v.su.CHAR.VTYPETEXT.IPV6_NOT_PREFIX;if(i.test(e))return v.su.CHAR.VTYPETEXT.IPV6_PREFIX}else if(t.test(e))return v.su.CHAR.VTYPETEXT.IPV6_NOT_GLOBAL;var n=e.match(/:/g);return!(this.isPrefixFlag&&5<n.length)||v.su.CHAR.VTYPETEXT.IPV6_NOT_PREFIX}},ip:{allowAllZeroFlag:!1,disallowAllZeroText:v.su.CHAR.VTYPETEXT.IP_NO_ALL_ZERO,allowLoopFlag:!1,disallowLoopText:v.su.CHAR.VTYPETEXT.IP_NO_LOOP,allowDTypeFlag:!1,disallowDTypeText:v.su.CHAR.VTYPETEXT.IP_NO_D_TYPE,allowETypeFlag:!1,disallowETypeText:v.su.CHAR.VTYPETEXT.IP_NO_E_TYPE,allowAllOneFlag:!1,disallowAllOneText:v.su.CHAR.VTYPETEXT.IP_NO_ALL_ONE,disallowFirstZeroFlag:!0,disallowFirstZeroText:v.su.CHAR.VTYPETEXT.IP_NO_FIRST_ZERO,disallowFirstAllOneText:v.su.CHAR.VTYPETEXT.IP_NO_FIRST_ALL_ONE,regex:/^(\d{1,2}|1\d\d|2[0-4]\d|25[0-5]|0\d\d)(\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5]|0\d\d)){3}$/,validator:function(e){var t,i,n=e,s=[0,0,0,0];for(i=0;i<3;i++){var a=n.indexOf(".");s[i]=n.substring(0,a),n=t=n.substring(a+1)}for(s[3]=t,i=0;i<4;i++)if(s[i]<0||255<s[i])return!1;if(!this.allowLoopFlag&&127==s[0])return this.disallowLoopText;if(!this.allowDTypeFlag&&224<=s[0]&&s[0]<=239)return this.disallowDTypeText;if(!this.allowETypeFlag&&240<=s[0]&&s[0]<=254)return this.disallowETypeText;if(this.allowAllOneFlag){if(255==s[0]&&255==s[1]&&255==s[2]&&255==s[3]);else if(255==s[0])return this.disallowFirstAllOneText}else{if(255==s[0]&&255==s[1]&&255==s[2]&&255==s[3])return this.disallowAllOneText;if(255==s[0])return this.disallowFirstAllOneText}return this.allowAllZeroFlag||0!=s[0]||0!=s[1]||0!=s[2]||0!=s[3]?!this.disallowFirstZeroFlag||0!=s[0]||0==s[1]&&0==s[2]&&0==s[3]||this.disallowFirstZeroText:this.disallowAllZeroText},vtypeText:v.su.CHAR.VTYPETEXT.IP},ipRange:{validator:function(e){function t(e){var t=e.split(".");return 4!=t.length?-1:/^\s*[0-9]{1,3}\.{1}[0-9]{1,3}\.{1}[0-9]{1,3}\.{1}[0-9]{1,3}\s*$/.test(e)?Number(t[0])*(1<<24)+(Number(t[1])<<16|Number(t[2])<<8|Number(t[3])):-1}var i=/^(\d{1,2}|1\d\d|2[0-4]\d|25[0-5]|0\d\d)(\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5]|0\d\d)){3}$/,n=e.split("-");if(1==n.length)return"0.0.0.0"==(s=n[0])?v.su.SMB_CHAR.VALIDATION.IP_ALL_ZERO:0!=i.test(s)||v.su.SMB_CHAR.VALIDATION.IP_FORMAT;if(2!=n.length)return v.su.SMB_CHAR.VALIDATION.IP_RANGE_NUM;var s=n[0],a=n[1];return 1!=i.test(s)&&0==i.test(s)?v.su.SMB_CHAR.VALIDATION.IP_FORMAT:1!=i.test(a)&&0==i.test(a)?v.su.SMB_CHAR.VALIDATION.IP_FORMAT:!(t(s)>=t(a))||v.su.SMB_CHAR.VALIDATION.IP_RANGE}},portRange:{validator:function(e){function t(e){return 0!=/^[0-9]+$/.test(e)||v.su.CHAR.VTYPETEXT.NUMBER}var i=e.split("-");if(1==i.length){var n=i[0];return Number(n)<1?v.su.SMB_CHAR.VALIDATION.PORT_START_ERR:65535<Number(n)?v.su.SMB_CHAR.VALIDATION.PORT_END_ERR:t(n)}if(2!=i.length)return v.su.SMB_CHAR.VALIDATION.PORT_RANGE_INVALID;n=i[0];var s=i[1];return t(n)&&t(s)?Number(n)<Number(s)?Number(n)<1?v.su.SMB_CHAR.VALIDATION.PORT_START_ERR:!(65535<Number(s))||v.su.SMB_CHAR.VALIDATION.PORT_END_ERR:v.su.SMB_CHAR.VALIDATION.PORT_RANGE_ERR:v.su.SMB_CHAR.VALIDATION.PORT_RANGE_FORMAT}},timeRange:{validator:function(e){function t(e){var t=e.split(":");return data=t[0].toString()+t[1].toString(),data=Number(data),0==data&&(data="0000"),data}function i(e){if(!/^[0-9]{1,2}\:{1}[0-9]{1,2}$/g.test(e))return v.su.SMB_CHAR.VALIDATION.TIME_FORMAT;var t=e.indexOf(":"),i=parseInt(e.slice(0,t),10),n=parseInt(e.slice(t+1),10);return i<0||24<=i?v.su.SMB_CHAR.VALIDATION.TIME_FORMAT:n<0||60<=n?v.su.SMB_CHAR.VALIDATION.TIME_FORMAT:!(24==i&&0<n)||v.su.SMB_CHAR.VALIDATION.TIME_START}function n(e){if(!/^[0-9]{1,2}\:{1}[0-9]{1,2}$/g.test(e))return v.su.SMB_CHAR.VALIDATION.TIME_FORMAT;var t=e.indexOf(":"),i=parseInt(e.slice(0,t),10),n=parseInt(e.slice(t+1),10);return i<0||24<i?v.su.SMB_CHAR.VALIDATION.TIME_FORMAT:n<0||60<=n?v.su.SMB_CHAR.VALIDATION.TIME_FORMAT:(0!=i||0!=n)&&(!(24==i&&0<n)||v.su.SMB_CHAR.VALIDATION.TIME_END)}var s=e.split("-");if(""!=s&&1==s.length)return v.su.SMB_CHAR.VALIDATION.TIME_END;if(2!=s.length)return v.su.SMB_CHAR.VALIDATION.TIME_FORMAT;var a=s[0],r=s[1];return 1==i(a)&&1==n(r)?(a=t(s[0]))<(r=t(s[1]))||v.su.SMB_CHAR.VALIDATION.TIME_RANGE:1!=i(a)?v.su.SMB_CHAR.VALIDATION.TIME_START:1==n(r)||v.su.SMB_CHAR.VALIDATION.TIME_END}},ip_no_zero:{},mac:{regex:/^[a-fA-F\d]{2}\-[a-fA-F\d]{2}\-[a-fA-F\d]{2}\-[a-fA-F\d]{2}\-[a-fA-F\d]{2}\-[a-fA-F\d]{2}$/,disallowAllMultiText:v.su.CHAR.VTYPETEXT.MULTI_MAC,validator:function(e){return/^\s*[0-9A-Fa-f]{1}[13579bdfBDF]{1}(\-[A-Fa-f0-9]{2}){5}\s*$/.test(e)?this.disallowAllMultiText:!/^(0{1,2}-){5}0{1,2}$/.test(e)||this.disallowAllMultiText},vtypeText:v.su.CHAR.VTYPETEXT.MAC},netmask:{allowAllOneFlag:!1,disallowAllOneText:v.su.CHAR.VTYPETEXT.MASK_NO_ALL_ONE,regex:/^(254|252|248|240|224|192|128)\.0\.0\.0$|^(255\.(254|252|248|240|224|192|128|0)\.0\.0)$|^(255\.255\.(254|252|248|240|224|192|128|0)\.0)$|^(255\.255\.255\.(254|252|248|240|224|192|128|0))$|^255.255.255.255$/,vtypeText:v.su.CHAR.VTYPETEXT.MASK,validator:function(e){return"255.255.255.255"!=e||!!this.allowAllOneFlag||this.disallowAllOneText}},string_ip_domain:{regex:/^[A-Za-z0-9\_\-]+\.{1,}/,vtypeText:v.su.CHAR.VTYPETEXT.STRING_DOMAIN,validator:function(e){return!!/^\S+$/.test(e)||v.su.CHAR.VTYPETEXT.STRING_DOMAIN}},string_ip_domain_no_loop:{regex:/^[A-Za-z0-9\_\-]+\.{1,}/,validator:function(e){return"127.0.0.1"!=e||v.su.CHAR.ERROR["00000131"]},vtypeText:v.su.CHAR.VTYPETEXT.STRING_DOMAIN},ip_domain:{regex:/^.+$/,vtypeText:v.su.CHAR.VTYPETEXT.IP_DOMAIN,validator:function(e){return!(!v.su.Vtype.types.ip.regex.test(e)||!v.su.Vtype.types.ip.validator(e))||!!v.su.Vtype.types.domain.regex.test(e)||v.su.CHAR.VTYPETEXT.IP_DOMAIN}},domain:{regex:/^([a-zA-Z0-9]([a-zA-Z0-9\-]{0,61}[a-zA-Z0-9])?\.)+[a-zA-Z]{2,6}$/,vtypeText:v.su.CHAR.VTYPETEXT.DOMAIN},domain_header:{regex:/^[a-zA-Z0-9]([a-zA-Z0-9\-]{0,61}[a-zA-Z0-9]*)$/,vtypeText:v.su.CHAR.VTYPETEXT.DOMAIN},ascii_visible:{regex:/^[\x21-\x7e]+$/,vtypeText:v.su.CHAR.VTYPETEXT.ASCII_VISIBLE},string_visible:{regex:/^\S+$/,vtypeText:v.su.CHAR.VTYPETEXT.STRING_VISIBLE},string_visible_no_comma:{regex:/^\S+$/,vtypeText:v.su.CHAR.VTYPETEXT.STRING_VISIBLE_NO_COMMA,validator:function(e){return!(0<=e.indexOf(","))}},password:{regex:/^[A-Za-z0-9\`\~\!\@\#\$\&\*\(\)\-\=\_\+\[\]\{\}\;\:\'\"\\\|\/\?\.\,<\>\%\^\/\ ]+$/,vtypeText:v.su.CHAR.VTYPETEXT.PWD},portal_password:{regex:/^[A-Za-z0-9_]+$/,vtypeText:v.su.CHAR.ERROR["00000259"],validator:function(e){return!(e.length<8||16<e.length)}},psk_password:{regex:/^([A-Za-z0-9\`\~\!\@\#\$\%\^\&\*\(\)\-\=\_\+\[\]\{\}\;\:\'\"\\\|\/\?\.\,<\>\ ]{8,63}|[0-9a-fA-F]{8,64})$/,vtypeText:v.su.CHAR.ERROR["00000066"]},portal_domain_name:{regex:/((http|ftp|https):\/\/)*(([a-zA-Z0-9\._-]+\.[a-zA-Z]{2,6})|([0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}))(:[0-9]{1,4})*(\/[a-zA-Z0-9\&%_\.\/-~-]*)?/,vtypeText:v.su.CHAR.VTYPETEXT.INVALIDTEXT},protal_title:{regex:/^\S+$/,vtypeText:v.su.CHAR.ERROR["00000256"],validator:function(e){return!(31<e.length)}},protal_content:{vtypeText:v.su.CHAR.ERROR["00000257"],validator:function(e){return!(1023<e.length)||v.su.CHAR.ERROR["00000257"]}},string_visible_allow_blank:{regex:/^(\S|\x20)+$/,vtypeText:v.su.CHAR.VTYPETEXT.STRING_VISIBLE_ALLOW_BLANK},string_visible_describe:{regex:/^[A-Za-z0-9\-\_]+$/,vtypeText:v.su.CHAR.VTYPETEXT.INVALIDTEXT},name:{regex:/^[A-Za-z0-9\_]+$/,vtypeText:v.su.CHAR.VTYPETEXT.NAME},name_special:{regex:/^[A-Za-z0-9\_\-]+$/,vtypeText:v.su.CHAR.VTYPETEXT.NAME,validator:function(e){return!(e.length<4)}},name_with_special_start:{regex:/^[a-zA-Z_]/,vtypeText:v.su.CHAR.VTYPETEXT.NAME_START},name_in_vpn:{regex:/^[a-zA-Z0-9\_][A-Za-z0-9\_\-]{0,14}$/,vtypeText:v.su.CHAR.VTYPETEXT.VPN_NAME_PWD},pwd_in_vpn:{regex:/^[A-Za-z0-9\_\-]{1,15}$/,vtypeText:v.su.CHAR.VTYPETEXT.VPN_NAME_PWD},cloud_username:{regex:/^[\s\S]*?$/,vtypeText:v.su.CHAR.VTYPETEXT.NAME},cloud_email:{regex:/^[a-zA-Z0-9\.\!\#\$\%\&\'\*\+\/\=\?\^\_\`\{\|\}\~\-]+@[a-zA-Z0-9-]+(\.[a-zA-Z0-9-]+)*$/,vtypeText:v.su.CHAR.VTYPETEXT.EMAIL},cloud_pwd:{regex:/^[\x21-\x7E]{6,32}$/,vtypeText:v.su.CHAR.VTYPETEXT.PWD},note:{regex:/^[A-Za-z0-9\`\~\!\@\#\$\%\^\&\*\(\)\-\=\_\+\[\]\{\}\;\:\'\"\\\|\/\?\.\,<\>\ ]*$/,vtypeText:v.su.CHAR.VTYPETEXT.NOTE},sim_pin:{regex:/^[0-9]{4}$/,vtypeText:v.su.CHAR.VTYPETEXT.SIM_PIN},sim_dialnum:{regex:/^[0-9*#]{0,118}$/,vtypeText:v.su.CHAR.VTYPETEXT.SIM_DIALNUM},port:{validator:function(e){var t=/^\s*[0-9]+\s*$/,i=e.toString().split("-"),n=i.length;if(2<n)return v.su.CHAR.VTYPETEXT.PORT_RANGE_FORMAT;for(var s=0;s<n;s++)if(0==i[s].length||!t.test(i[s])||parseInt(i[s],10)<1||65535<parseInt(i[s],10))return v.su.CHAR.VTYPETEXT.PORT_RANGE_OUT;return!0}},time_start:{validator:function(e){if(!/^[0-9]{1,2}\:{1}[0-9]{1,2}$/g.test(e))return v.su.CHAR.VTYPETEXT.TIME_FORMAT;var t=e.indexOf(":"),i=parseInt(e.slice(0,t),10),n=parseInt(e.slice(t+1),10);return i<0||24<=i?v.su.CHAR.VTYPETEXT.TIME_FORMAT:n<0||60<=n?v.su.CHAR.VTYPETEXT.TIME_FORMAT:!(24==i&&0<n)||v.su.CHAR.VTYPETEXT.TIME_START}},time_end:{validator:function(e){if(!/^[0-9]{1,2}\:{1}[0-9]{1,2}$/g.test(e))return v.su.CHAR.VTYPETEXT.TIME_FORMAT;var t=e.indexOf(":"),i=parseInt(e.slice(0,t),10),n=parseInt(e.slice(t+1),10);return i<0||24<i?v.su.CHAR.VTYPETEXT.TIME_FORMAT:n<0||60<=n?v.su.CHAR.VTYPETEXT.TIME_FORMAT:0==i&&0==n?v.su.CHAR.VTYPETEXT.TIME_END:!(24==i&&0<n)||v.su.CHAR.VTYPETEXT.TIME_END}},time:{format:"hh:mm:ss",validator:function(e){if("hh:mm:ss"===this.format){if(!1===/^(?:[01]\d|2[0-3])(?::[0-5]\d){2}$/.test(e))return v.su.CHAR.VTYPETEXT.TIME_FORMAT}else if("hh:mm"===this.format&&!1===/^(?:[01]\d|2[0-3])(?::[0-5]\d){1}$/.test(e))return v.su.CHAR.VTYPETEXT.TIME_FORMAT;return!0}},username:{regex:/^[A-Za-z0-9\`\~\!\@\#\$\%\^\&\*\(\)\-\=\_\+\[\]\{\}\;\:\'\"\\\|\/\?\.\,<\>\ ]+$/,vtypeText:v.su.CHAR.VTYPETEXT.USERNAME},adminName:{regex:/^[A-Za-z0-9\-\_\@\.]+$/,vtypeText:v.su.CHAR.VTYPETEXT.USERNAME},securityPwd:{validator:function(e){if(8<=e.length&&e.length<64){var t=/^[A-Za-z0-9\`\~\!\@\#\$\&\*\(\)\-\=\_\+\[\]\{\}\;\:\'\"\\\|\/\?\.\,\<\>\%\^\ ]+$/;if(e&&!t.test(e))return v.su.CHAR.VTYPETEXT.ILLEGAL_PWD}else if(64==e.length&&(t=/^[A-Fa-f0-9]+$/,e&&!t.test(e)))return smb.charset.validation.ILLEGAL_PWD;return!0}},wanPwd:{regex:/^[A-Za-z0-9\`\~\!\@\#\$\&\*\(\)\-\=\_\+\[\]\{\}\;\:\'\"\\\|\/\?\.\,\<\>\%\^\/\ ]+$/,vtypeText:v.su.CHAR.VTYPETEXT.PASSWORD_FORMAT},userPwd:{regex:/^[A-Za-z0-9\`\~\!\@\#\$\&\*\(\)\-\=\_\+\[\]\{\}\;\:\'\"\\\|\/\?\.\,\<\>\%\^\/]+$/,vtypeText:v.su.CHAR.VTYPETEXT.PASSWORD_FORMAT},serviceName:{regex:/^[A-Za-z0-9\`\~\!\@\#\$\&\*\(\)\-\=\_\+\[\]\{\}\;\:\'\"\\\|\/\?\.\,\<\>\%\^\/\ ]+$/,vtypeText:v.su.CHAR.VTYPETEXT.SERVICE_NAME},acName:{regex:/^[A-Za-z0-9\`\~\!\@\#\$\&\*\(\)\-\=\_\+\[\]\{\}\;\:\'\"\\\|\/\?\.\,\<\>\%\^\/\ ]+$/,vtypeText:v.su.CHAR.VTYPETEXT.AC_NAME},integer:{regex:/^[0-9]+$/,vtypeText:v.su.CHAR.VTYPETEXT.INTEGER_INVALID,validator:function(e){return(null!==this.max||this.max!==undefined)&&e>this.max?null===this.min&&this.min===undefined?v.su.CHAR.VTYPETEXT.NUMBER_MAX.replace("%max",this.max.toString()):v.su.CHAR.VTYPETEXT.NUMBER_MIN_MAX.replace("%min",this.min.toString()).replace("%max",this.max.toString()):null===this.min&&this.min===undefined||!(e<this.min)||(null===this.max&&this.max===undefined?v.su.CHAR.VTYPETEXT.NUMBER_MIN.replace("%min",this.min.toString()):v.su.CHAR.VTYPETEXT.NUMBER_MIN_MAX.replace("%min",this.min.toString()).replace("%max",this.max.toString()))}},groupKey:{validator:function(e){return 0!==e&&e<30?v.su.CHAR.VTYPETEXT.MIN_THIRTY:!(0!==e&&1e6<e)||v.su.CHAR.VTYPETEXT.MAX_MILLION}},ipMask:{allowAllZero:!1,allowAny:!1,validator:function(e){var t=e.indexOf("/"),n=(e.slice(0,t),e.slice(t+1,e.length));if(n<=0||32<n)return v.su.CHAR.VTYPETEXT.IP_MASK_UNION;if(!/^[0-9]{1,3}\.{1}[0-9]{1,3}\.{1}[0-9]{1,3}\.{1}[0-9]{1,3}$/.test(e))return v.su.CHAR.VTYPETEXT.IP_MASK_UNION;var s=e.split(".");for(i=0;i<4;i++)if(s[i]<0||255<s[i])return v.su.CHAR.VTYPETEXT.IP_MASK_UNION;if(!this.allowAllZero&&0==parseInt(s[0],10)&&0==parseInt(s[1],10)&&0==parseInt(s[2],10)&&0==parseInt(s[3],10))return v.su.CHAR.VTYPETEXT.IP_MASK_UNION;if(255==s[0]){if(!this.allowAny)return v.su.CHAR.VTYPETEXT.IP_MASK_UNION;if(255!=s[1]||255!=s[2]||255!=s[3])return v.su.CHAR.VTYPETEXT.IP_MASK_UNION}return 240<=s[0]&&s[0]<=254?v.su.CHAR.VTYPETEXT.IP_MASK_UNION:224<=s[0]&&s[0]<=239?v.su.CHAR.VTYPETEXT.IP_MASK_UNION:127!=s[0]||v.su.CHAR.VTYPETEXT.IP_MASK_UNION}},deviceName:{regex:/^[A-Za-z0-9\-\_]+$/,vtypeText:v.su.CHAR.VTYPETEXT.DEVICE_NAME_INVALID},noStartSpace:{validator:function(e){return!e||!/^\s+/.test(e)||v.su.CHAR.VTYPETEXT.START_SPACE_IS_NOT_ALLOW}},noSpecialChar:{validator:function(e){return!e||!/[\s\$\`\#\&\(\)\;\"\'\<\>]+/.test(e)||v.su.CHAR.VTYPETEXT.NO_SPECIAL_CHARACTER}},hex:{regex:/^[A-Fa-f0-9]*$/,vtypeText:v.su.CHAR.VTYPETEXT.INVALIDTEXT},string:{regex:/^[A-Za-z0-9\_\-\@\:\/\.]+$/,vtypeText:v.su.CHAR.VTYPETEXT.INVALIDTEXT},numberAndPoint:{regex:/^[0-9\.]+$/,vtypeText:v.su.CHAR.VTYPETEXT.INVALIDTEXT},string_file:{extension:"txt",errorText:v.su.CHAR.ERROR["00000001"],validator:function(e){for(var t=v.isArray(this.extension)?this.extension:[this.extension],i=0;i<t.length;i++){if(new RegExp(".*."+t[i].toLowerCase()+"$").test(e))return!0;if(new RegExp(".*."+t[i].toUpperCase()+"$").test(e))return!0}return v.isFunction(this.errorText)?this.errorText(e):this.errorText}}},g.prototype.validate=function(e,t){var i={type:"sample",regex:/^[a-zA-Z0-9]&/,vtypeText:"",validator:null},n="",s={};if("string"===v.type(t))n=t;else if("object"===v.type(t)&&t.vtype&&!(n=(s=t).vtype))return!0;if(!g.types[n]){for(var a=!1,r=n.split("||"),o=0;o<r.length;o++){for(var d=!0,l=r[o].split("&&"),c=0;c<l.length;c++){var u=v.trim(l[c]);if(!g.types[u])return null;var h=v.extend(s,{"vtype":u});if(!0!==(d=this.validate(e,h)))break}if(!0===d){a=!0;break}a=d}return!0===a||(s.vtypeText?s.vtypeText:a)}i=g.types[n];var p=v.extend({},i,s),f=!0;return!p.regex||!0===p.regex.test(e)||p.vtypeText===undefined&&null===p.vtypeText&&""===p.vtypeText?!p.validator||!0===(f=p.validator(e))||f:p.vtypeText},g.prototype.addVtype=function(e){v.extend(g.types,e)},g)}(jQuery),function(d){var l,t;d.su=d.su||{},d.su.Ajax=(l={url:null,ajax:{timeout:15e3,type:"POST"},root:null,params:{}},t=function(e){if("object"==typeof t.instance)return t.instance;d.extend(!0,l.ajax,e.ajax),this.failHandler=e.failHandler,this.errorHandler=e.errorHandler,this.name="ajax",this.proxyMap={},d.su.Service.call(this),t.instance=this},d.su.inherit(d.su.Service,t),t.prototype.request=function(t){var i=this,n={};t.url&&(n.url=t.url,n.preventSuccessEvent=t.preventSuccessEvent,n.preventFailEvent=t.preventFailEvent,n.preventErrorEvent=t.preventErrorEvent,d.su.debug.log("can not use url:"+t.url+" in services ajax")),n.ajax=d.extend(!0,{},l.ajax,t.ajax),t.data&&(n.data=t.data),t.success&&(n.success=t.success),t.fail&&(n.fail=t.fail),t.error&&(n.error=t.error),this.failHandler&&(n.fail=this.failHandler(t.fail)),this.errorHandler&&(n.error=this.errorHandler(t.error,t.preventDefaultError)),t.params&&(n.params=t.params,delete t.params),t.proxy=t.proxy||d.su.settings.AjaxService.defaultProxy;var e=d.extend(!0,{},l,t),s=d.su.ClassManager.getInstance(),a=d.Deferred(),r=d.Deferred();if(t.proxy)this.proxyMap[t.proxy]?a.resolve(i.proxyMap[t.proxy]):d.su.create(t.proxy).done(function(e){i.proxyMap[t.proxy]=e,a.resolve(e)});else{var o=s.get(d.su.settings.AjaxService.defaultProxy).create(e);a.resolve(o)}return a.then(function(e){t.method&&e[t.method]?e[t.method].call(e,n):r.resolve(e.op("default",n))}),r},t.prototype.upload=function(t){var i=this,e=d.extend({},l,t),n={fileId:t.fileId,data:t.data,success:t.success,fail:t.fail,error:t.error,timeout:t.timeout},s=d.su.ClassManager.getInstance(),a=d.Deferred();if(t.proxy)this.proxyMap[t.proxy]?a.resolve(i.proxyMap[t.proxy]):d.su.create(t.proxy).done(function(e){i.proxyMap[t.proxy]=e,a.resolve(e)});else{var r=s.get(d.su.settings.AjaxService.defaultProxy).create(e);a.resolve(r)}a.then(function(e){e.upload(n)})},t.prototype.download=function(e){d.su.ClassManager.getInstance().get(d.su.settings.AjaxService.defaultProxy).create(proxyOption).download(e)},t.prototype.createProxy=function(e,t){return d.su.ClassManager.getInstance().get(e).create(t)},t)}(jQuery),function(l){l.su=l.su||{},l.su.Polling=function(){var e=function(){if("object"==typeof e.instance)return e.instance;this.name="polling",l.su.Service.call(this),(e.instance=this).activityModelMap={},this.addListener("ev_model_dirty",function(e,t){this.clearPolling(t)})};l.su.inherit(l.su.Service,e);var d=function(e){var t=null;for(var i in e)e.hasOwnProperty(i)&&(null===t?t=e[i]:0<e[i]&&e[i]<t&&(t=e[i]));return t};return e.prototype.poll=function(e,t,i,n,s){var a="string"==typeof e?e:e.name?e.name:e.dataObj.name,r="string"==typeof s?s:s.name;if(this.activityModelMap[a]){this.activityModelMap[a].modules[r]=n,clearInterval(this.activityModelMap[a].instance);n=d(this.activityModelMap[a].modules);this.activityModelMap[a].method=t,this.activityModelMap[a].dataAndCallback=l.su.clone(i);o=function(){var e=l.su.modelManager.get(a)||l.su.storeManager.get(a);e.isDirty()&&"load"!=t||e[t](i)};this.activityModelMap[a].instance=setInterval(o,n),o()}else{this.activityModelMap[a]={modules:{},queryInterval:null,instance:null},this.activityModelMap[a].modules[r]=n,this.activityModelMap[a].method=t,this.activityModelMap[a].dataAndCallback=l.su.clone(i);var o=function(){var e=l.su.modelManager.get(a)||l.su.storeManager.get(a);e.isDirty()&&"load"!=t||e[t](i)};this.activityModelMap[a].instance=setInterval(o,n),o()}},e.prototype.stopPolling=function(e,t){var i="string"==typeof e?e:e.name?e.name:e.dataObj.name,n="string"==typeof t?t:t.name;if(this.checkPolling(e,t)){n in this.activityModelMap[i].modules&&(this.activityModelMap[i].modules[n]=undefined),clearInterval(this.activityModelMap[i].instance);var s=d(this.activityModelMap[i].modules),a=this.activityModelMap[i].method,r=this.activityModelMap[i].dataAndCallback;if(s){var o=function(){var e=l.su.modelManager.get(i)||l.su.storeManager.get(i);e.isDirty()&&"load"!=a||e[a](r)};this.activityModelMap[i].instance=setInterval(o,s),o()}}},e.prototype.clearPolling=function(e){for(var t in clearInterval(this.activityModelMap[e].instance),this.activityModelMap[e].modules)this.activityModelMap[e].modules.hasOwnProperty(t)&&(this.activityModelMap[e].modules[t]=undefined)},e.prototype.checkPolling=function(e,t){var i="string"==typeof e?e:e.name?e.name:e.dataObj.name,n="string"==typeof t?t:t.name;return!!this.activityModelMap[i]&&this.activityModelMap[i].modules[n]},e}()}(jQuery),function(i){var e;i.su=i.su||{},i.su.Services=i.su.Services||{},i.su.Services.ModuleManager=(e=function(){if("object"==typeof e.instance)return e.instance;this.name="moduleManager",i.su.Service.call(this),e.instance=this},i.su.inherit(i.su.Service,e),e.prototype.launch=function(e,t){i.su.moduleManager.launch(e,t)},e.prototype.get=function(e){var t=i.su.moduleManager.query(e);return t instanceof i.su.Module&&t},e.prototype.getStatus=function(e){return i.su.moduleManager.getStatus(e)},e.prototype.hasModule=function(e){return!1!==i.su.moduleManager.getStatus(e)},e)}(jQuery),function(f){f.su=f.su||{},f.su.Services=f.su.Services||{},f.su.Services.ModuleLoader=function(){var e=function(){if("object"==typeof e.instance)return e.instance;this.name="moduleLoader",f.su.Service.call(this),(e.instance=this)._map={},this.loadingModule={}};f.su.inherit(f.su.Service,e);var h=function(e,t){return e[t]},p=function(e,t){return e+"_"+t};return e.prototype.load=function(e,s,a,r){var o=this;this.isBusy=!0;var t=e.module,i=e.view||f.su.moduleManager.query(t).view[0],d=p(t,i),l=h(this._map,d),c=s.module,u=f.su.randomId("timestamp");this.loadingModule[c]=this.loadingModule[c]||{},f.each(this.loadingModule[c],function(e,t){delete o.loadingModule[c][e]}),this.loadingModule[c][u]="running",l||(this._map[d]={id:d,module:t,view:i,children:[],htmlLoader:null,parent:null},l=this._map[d]),o.unLoad(a),f.su.moduleManager.load(c,function(){if(o.loadingModule[c][u]){var e=f.su.moduleManager.query(c),t=s.view||f.su.moduleManager.query(c).view[0],i=p(c,t);o._map[i]?o._map[i].htmlLoader&&o.unLoad(o._map[i].htmlLoader):o._map[i]={id:i,module:c,view:t,children:[],htmlLoader:null,parent:d},o._map[i].htmlLoader=a,0<=f.inArray(i,l.children)||l.children.push(i);var n=a.viewObjs?a.viewObjs[0]:a;e._getView(s.view).setContainer(n),e.load(function(){delete o.loadingModule[c][u],r&&r()}),o.isBusy=!1}})},e.prototype.unLoad=function(e){var d=function(e,t){var i=e[t].module,n=f.su.moduleManager.query(i),s=e[t].children.slice(0);if(s&&0<s.length)for(var a=0;a<s.length;a++)d(e,s[a]);if(n.fireEvent&&n.fireEvent("ev_before_view_unload",[e[t].view]),null!==e[t].htmlLoader&&e[t].htmlLoader.load(""),n&&n.fireEvent("ev_view_unload",[e[t].view]),e[t].children=[],e[t].htmlLoader=null,e[t].parent){var r=h(e,e[t].parent),o=f.inArray(t,r.children);0<=o&&r.children.splice(o,1)}};for(var t in this._map)this._map.hasOwnProperty(t)&&this._map[t].htmlLoader===e&&d(this._map,t)},e}()}(jQuery),function(h){var e;h.su=h.su||{},h.su.Services=h.su.Services||{},h.su.Services.Timer=(e=function(){if("object"==typeof e.instance)return e.instance;this.name="timer",h.su.Service.call(this),(e.instance=this)._timerMap={},this.defaultTimeout=1e3},h.su.inherit(h.su.Service,e),e.prototype.setTimer=function(e,t,i,n,s){var a=this;if("string"===h.type(n)&&(s=n,n=undefined),e instanceof h.su.Module&&"function"===h.type(t)&&("interval"===s||"timeout"===s)){var r=e.name;if(this._timerMap[r]||(this._timerMap[r]=[]),"available"===e.status||"running"===e.status){var o=function(){a.clearAll(e)};this._timerMap[r].destroyHandler||(this._timerMap[r].destroyHandler=o,e.one("ev_before_destroy",o));for(var d=this._timerMap[r].length-1;0<=d;d--){var l=this._timerMap[r][d];clearTimer="interval"===l.type?clearInterval:clearTimeout,l.moduleId!==e.id&&(clearTimer(l.timerId),this._timerMap[r].splice(d,1))}"interval"===s?(setTimer=setInterval,clearTimer=clearInterval,n&&t()):(setTimer=setTimeout,clearTimer=clearTimeout);var c=function(){"available"!==e.status&&"running"!==e.status?a.clearAll(e):t()},u=setTimer(c,i);return this._timerMap[r].push({timerId:u,moduleId:e.id,fn:c,type:s}),u}this.clearAll(e)}else h.su.debug.log("Error arguments.")},e.prototype.setInterval=function(e,t,i,n){return this.setTimer(e,t,i,n,"interval")},e.prototype.setTimeout=function(e,t,i){return this.setTimer(e,t,i,"timeout")},e.prototype.get=function(e,i){var n,t=e.name;if(this._timerMap[t])return h.each(this._timerMap[t],function(e,t){i!==t.timerId||(n=t)}),n},e.prototype.clearTimer=function(e,t){var i=e.name;if(this._timerMap[i]){var n=this.get(e,t);if(n){var s=h.inArray(this._timerMap[i]),a="interval"===n.type?clearInterval:clearTimeout;this._timerMap[i].splice(s,1),a(t)}}},e.prototype.clearTimeout=e.prototype.clearTimer,e.prototype.clearInterval=e.prototype.clearTimer,e.prototype.clearAll=function(e){var t=e.name,i=this._timerMap[t].length;if(this._timerMap[t]&&i){for(var n=0;n<i;n++)("interval"===this._timerMap[t][n].type?clearInterval:clearTimeout)(this._timerMap[t][n].timerId);e.off("ev_before_destroy",this._timerMap[t].destroyHandler),this._timerMap[t].length=0,this._timerMap[t].destroyHandler=null}},e)}(jQuery),function(h){h.su=h.su||{},h.su.Model=function(){var e=function(e){e=h.extend(!0,{fields:null,feedback:!0,validator:null,autoReload:!1,convert:null,serialize:null,preventSuccessEvent:!1,preventFailEvent:!1,preventErrorEvent:!1,params:{read:{},update:{},create:{},remove:{}},methods:{}},e);var i=this;if(this.name=e.name,this._name=e.name,this.feedback=e.feedback,this.fields=e.fields,this.validator=e.validator,this.data=[],this.convert=e.convert,this.serialize=e.serialize,this.params=e.params,this.methods=e.methods,this.autoReload=e.autoReload,this.preventSuccessEvent=e.preventSuccessEvent,this.preventFailEvent=e.preventFailEvent,this.preventErrorEvent=e.preventErrorEvent,h.su.Observable.call(this),e.proxy){var t=h.su.ClassManager.getInstance();if("string"===h.type(e.proxy)){var n=t.get(e.proxy);n||h.su.debug.error("Model proxy class not found: "+e.proxy),this.proxy=n.create()}else if(e.proxy.isProxy)this.proxy=e.proxy;else{var s=h.extend(!0,{triggerEvent:!0},e.proxy);this.proxy=t.get(h.su.settings.Model.defaultProxy).create(s)}this.proxy.addListener("ev_load",function(e,t){i.loadData(t,!0)})}a.call(this)};h.su.inherit(h.su.Observable,e);var s=function(e){var t=new h.su.DataField(e),i=this;if(t.validator){var n=t.validator;t.validator=function(){var e=Array.prototype.slice.call(arguments,0);return e.push(i),n.apply(this,e)}}return t},a=function(){for(var n=this,e=0,t=this.fields.length;e<t;e++)this.data[e]=s.call(this,this.fields[e]),this[this.fields[e].name]=this.data[e],this.data[e].on("ev_data_change",function(e,t,i){"_value"===t.type&&n.trigger("ev_data_change",[t,i,n])});for(var i in n.methods)n.methods.hasOwnProperty(i)&&(n[i]=function(){n.method.apply(n,arguments)})};return e.checkProxyDep=function(e){return"string"==h.type(e)},e.importProxyDep=function(e,t){return h.su.require(e,t)},e.prototype.modelConvert=function(e){var t={};e||(e={}),null!==this.convert&&(e=this.convert(e));for(var i=0,n=this.data.length;i<n;i++){var s=this.data[i];if(s.mapping){var a=e[s.mapping];t[s.name]=a===undefined?s.defaultValue:a,null!==s.convert&&a!==undefined&&null!==a&&(t[s.name]=s.convert(a,e))}}return t},e.prototype.modelSerialize=function(e){var t={};if(!e)return{};for(var i=0,n=this.data.length;i<n;i++){var s=this.data[i];if(s.name){var a=e[s.name];null!==s.serialize&&a!==undefined&&(a=s.serialize(a,e)),t[s.mapping]=a}}return null!==this.serialize&&(t=this.serialize(t)),t},e.prototype.loadData=function(e,t){this.trigger("ev_before_load_data",[e]),t&&(e=this.modelConvert(e));for(var i=0,n=this.data.length;i<n;i++){var s=e[this.data[i].name];this.data[i].setValue(s)}this.record(),this.trigger("ev_loaded",[e])},e.prototype.replaceData=function(e,t){t&&(e=this.modelConvert(e));for(var i=0,n=this.data.length;i<n;i++){var s=e[this.data[i].name];s!==undefined&&this.data[i].setValue(s)}this.trigger("ev_loaded",[e])},e.prototype.getData=function(e){for(var t,i={},n=0,s=this.fields.length;n<s;n++)if("submit"!==e||!this.data[n].disabled){t=this.data[n].getValue();var a={};a[this.data[n].name]=t,h.extend(i,a)}return i},e.prototype.validate=function(e){for(var t=e&&e.returnDetail,i=!0,n=0,s=this.fields.length;n<s;n++){var a=this.data[n];if(!0!==(i=a.validate()))return this.trigger("ev_validate_change",[{result:!1,field:a.getName()}]),t?{result:!1,field:a.getName()}:i}return h.isFunction(this.validator)?(i=this.validator.call(this),this.trigger("ev_validate_change",[{result:i,field:null}]),t?{result:!1,field:a.getName()}:i):(this.trigger("ev_validate_change",[{result:!0}]),t?{result:!0,field:a.getName()}:i)},e.prototype.beforeLoad=function(e){var s=this,a=((e=e||{}).preventSuccessEvent===undefined?s.preventSuccessEvent:e.preventSuccessEvent,e.preventFailEvent===undefined?s.preventFailEvent:e.preventFailEvent),i=e.preventErrorEvent===undefined?s.preventErrorEvent:e.preventErrorEvent;e.preventSuccessEvent=!0,e.preventFailEvent=!0,e.preventErrorEvent=!0;var n=e.success;e.success=function(e,t){n&&n(e,t)};var r=e.fail;e.fail=function(e,t,i,n){r&&r(e,t,i,n),t&&!a&&s.trigger("ev_model_load_error",t)};var o=e.error;return e.error=function(e,t){o&&o(e,t),i||s.trigger("ev_model_ajax_error",[e,t])},e},e.prototype.load=function(e){e=e||{};var t=this.beforeLoad(e);this.proxy.sync(h.extend({},{operation:"read",dataObj:this},t))},e.prototype.getProxy=function(){return this.proxy},e.prototype.submit=function(e){if(!0!==this.validate())return null;e=e||{},this.sync(e)},e.prototype.beforeSync=function(i){var s=this,a=i.autoReload===undefined?s.autoReload:i.autoReload,n=i.preventSuccessEvent===undefined?s.preventSuccessEvent:i.preventSuccessEvent,r=i.preventFailEvent===undefined?s.preventFailEvent:i.preventFailEvent,o=i.preventErrorEvent===undefined?s.preventErrorEvent:i.preventErrorEvent;i.preventSuccessEvent=!0,i.preventFailEvent=!0,i.preventErrorEvent=!0;var d=i.success;i.success=function(e,t){d&&d(e,t),s.trigger("ev_model_submit",[e,t]),s.trigger("ev_model_submit_complete",["success",e,t]),!1!==a&&s.load(),!0!==n&&"read"!=i.operation&&h.su.moduleManager.query("main").showNotice(h.su.CHAR.COMMON.SAVED)};var l=i.fail;i.fail=function(e,t,i,n){t&&!0!==r&&s.trigger("ev_model_submit_error",t),s.trigger("ev_model_submit_complete",["fail",t]),l&&l(e,t,i,n),!1!==a&&s.load()};var c=i.error;i.error=function(e,t){c&&c(e,t),!0!==o&&s.trigger("ev_model_ajax_error",[e,t]),s.trigger("ev_model_submit_complete",["error",e,t]),!1!==a&&s.load()};var u=h.su.getDefaultEvent(this,function(){});return this.trigger("ev_model_before_submit",[u.ev]),h.each(this.data,function(e,t){t.trigger("ev_model_before_submit",[u.ev,s])}),u.exe()?i:i=null},e.prototype.sync=function(t){var i=this;if(t=t||{},t=this.beforeSync(t),"object"!==h.type(t))return null;var e=Array.prototype.slice.call(arguments,0);if(t&&"read"!==t.operation&&!0!==this.validate())return null;var n=h.extend(!0,{},t);n.operation=n.operation||"write","read"!==n.operation&&(n.difference=this.checkDataChange(t)),n.dataObj=this,n.success=function(e){t&&t.success&&t.success(i.modelConvert(e))},e[0]=n,this.proxy&&this.proxy.sync.apply(this.proxy,e)},e.prototype.checkDataChange=function(e){var t={};return t[e.updateDataKey||"update"]={model:this.modelSerialize(this.getData("submit")),oldModel:null},t},e.prototype.record=function(){for(var e=0,t=this.fields.length;e<t;e++)this.data[e].record();return this},e.prototype.reset=function(){for(var e=0,t=this.fields.length;e<t;e++)this.data[e].reset();return this},e.prototype.isDirty=function(){for(var e=0,t=this.fields.length;e<t;e++)if(this.data[e].isDirty())return!0;return!1},e.prototype.getField=function(e){return this[e]},e.prototype.getFieldNameByIndex=function(e){return this.fields.length>=e?this.data[i].name:null},e.prototype.getSize=function(e){return this.fields.length},e}()}(jQuery),function(s){var e;s.su.DataField=(e=function(t){s.su.Observable.call(this);t=s.extend({name:"",mapping:null,defaultValue:null,disabled:!1,readOnly:!1,autoTrim:!1,valueType:null,valid:!0,validated:!1,isDetect:!0,format:null,allowBlank:!0,blankText:s.su.CHAR.VTYPETEXT.NOT_ALLOW_TO_BE_EMPTY,vtype:null,vtypeText:null,validator:null,maxLength:-1,minLength:-1,encrypt:s.su.encrypt},t);var i=this;this.name=t.name,this.mapping=t.mapping||this.name,this.defaultValue=t.defaultValue,this.convert=t.convert||null,this.serialize=t.serialize||null,this.valueType=t.valueType,this.allowBlank=t.allowBlank,this.blankText=t.blankText,this.disabled=t.disabled,this.valid=t.valid,this._realValid=t.valid,this.maxLength=t.maxLength,this.minLength=t.minLength,this.encrypt=t.encrypt;if(this.vtype=s.isArray(t.vtype)?t.vtype:[t.vtype],t.vtypeText){var e=this.vtype[0];this.vtype[0]={vtype:e,vtypeText:t.vtypeText}}if(t.validator){if(!s.isFunction(t.validator))throw new Error("Error in DataField: validator must be a function.");this.validator=t.validator}if(this._value=this._formatType(t.defaultValue),this._valueBackup=this._formatType(t.defaultValue),t.set&&(this.set=function(){var e=Array.prototype.slice.call(arguments,0,this.mapping.length);this.val(t.set.apply(this,e))}),t.get){if(!s.isFunction(t.get))throw new Error("Error in DataField: options.get must be a function, if options.get has been defined and mapping is a string.");this.get=function(){var e={};return e[i.mapping]=t.get.call(i,i._value),e}}},s.su.inherit(s.su.Observable,e),e.prototype.getName=function(){return this.name},e.prototype.val=function(e){return e!==undefined&&e!==this._value&&(this._value=this._formatType(e)),this._value},e.prototype._formatType=function(e){if(null===e||e===undefined||""===e)return e;if("number"!==this.valueType)return"string"===this.valueType?e.toString():"boolean"===this.valueType?"true"===e||"number"==typeof e&&0<e||"string"==typeof e&&0<parseInt(e,10)||"false"!==e&&0!==e&&"0"!==e&&e:e;var t=parseFloat(e,10);return isNaN(t)||(t+"").length!==(e+"").length?e:parseFloat(e,10)},e.prototype.setValue=function(e){var t=e;(s.isArray(e)||"object"===s.type(e))&&(t=JSON.parse(JSON.stringify(e))),this._set("_value",{oldValue:this.getValue(),value:t})},e.prototype.getValue=function(){var e=this._value;return(s.isArray(this._value)||"object"===s.type(e))&&(e=JSON.parse(JSON.stringify(this._value))),e},e.prototype.getBackup=function(){var e=this._valueBackup;return(s.isArray(e)||"object"===s.type(e))&&(e=JSON.parse(JSON.stringify(this._value))),e},e.prototype.getData=function(){var e={};return e[this.mapping]=this._value,e},e.prototype.record=function(){return this._valueBackup=this._value,this},e.prototype.isDirty=function(){return this._value!==this._valueBackup},e.prototype.isEnabled=function(){return!this.disabled},e.prototype.reset=function(){this.setValue(null===this._valueBackup?this.defaultValue:this._valueBackup)},e.prototype.doEncrypt=function(e){var t=this.getValue();return s.isFunction(this.encrypt)?this.encrypt(t,e):t},e.prototype.lengthCheck=function(){if("string"==typeof this._value){if(-1!=this.minLength&&this._value.length<this.minLength)return!1;if(-1!=this.maxLength&&this._value.length>this.maxLength)return!1}return!0},e.prototype.setVtype=function(e){this.vtype=e},e.prototype.vtypeCheck=function(){var e=this.vtype,t=!0;if(!e)return!0;e=s.isArray(e)?e:[e];var n=s.su.serviceManager.get("vtype");for(i=0,len=e.length;i<len;i++)if(e[i]&&!0!==(t=n.validate(this._value,e[i]))){e[i],this.valid=!1;break}return t},e.prototype.validatorCheck=function(){return!this.validator||this.validator(this._value)},e.prototype.validate=function(){var e;if(this._value,this.disabled)return this.setValid(!0),!0;if(""===this._value||null===this._value||this._value===undefined||"date"===s.type(this._value)&&!0===this._value._isBlank)return!0!==this.allowBlank?(this.setValid(!1,this.blankText),this._realValid=!1):(this.setValid(!0),this._realValid=!0);if(!this.lengthCheck())return e=-1!=this.minLength&&-1!=this.maxLength?s.su.CHAR.VTYPETEXT.LEN_MIN_MAX.replace("%min",this.minLength).replace("%max",this.maxLength):-1!=this.minLength?s.su.CHAR.VTYPETEXT.LEN_MIN.replace("%min",this.minLength):s.su.CHAR.VTYPETEXT.LEN_MAX.replace("%max",this.maxLength),this.setValid(!1,e),this._realValid=!1;var t=this.vtypeCheck();if(!0!==t)return this.setValid(!1,this.vtypeText||t),this._realValid=!1;var i=this.validatorCheck();return!0!==i?(this.setValid(!1,i),this._realValid=!1):(this.setValid(!0),this._realValid=!0)},e.prototype.disable=function(){this._set("disabled",!0),this.setValid(!0)},e.prototype.enable=function(){this._set("disabled",!1),!0!==this._realValid&&this.setValid(!0)},e.prototype.setValid=function(e,t){this._set("valid",e||t)},e.prototype._set=function(e,t){"_value"===e&&t.hasOwnProperty("value")?(t.value=this._formatType(t.value),this[e]=t.value):this[e]=t,this.trigger("ev_data_change",[{"type":e,"value":t},this])},e)}(jQuery),function(g){g.su.Connection=function(){var t={url:null,async:!0,timeout:15e3,type:"POST",dataType:"json",contentType:"application/json",successJudge:function(){return!0}},p=[],s=[],f=[],i=function(e,t){"function"!=typeof t||(t?-1<g.inArray(t,e):e&&e.length)||e.push(t)},v=function(e,t,i){for(var n=e.length,s=0;s<n;s++)t=e[s].call(this,t,i);return t},e=function(e){g.su.Observable.call(this),this.ajax=g.extend({},t,e),e&&e.readFilter&&(i(p,e.readFilter),delete e.readFilter),e&&e.writeFilter&&(i(s,e.writeFilter),delete e.writeFilter),e&&e.failHandler&&(i(f,e.failHandler),delete e.failHandler)};g.su.inherit(g.su.Observable,e);return e.prototype.upload=function(r){var o=this;r.success=r.success||function(){};var e=r.url||this.ajax.url;if(!r.fileId)return!1;var t=g.su.randomId("iframe-"),d=g('<iframe class="hidden" id="'+t+'" name="'+t+'"></iframe>');g("body").append(d);var l,c=0==g("#"+r.fileId+"_form").length;if(c?(l=g('<form class="hidden" id="'+r.fileId+'_form" method="POST" enctype="multipart/form-data"></form>').attr("target",t).attr("action",e.toStringURL?e.toStringURL():e.toString()),g("body").append(l)):l=g("#"+r.fileId+"_form").attr("target",t).attr("action",e.toStringURL?e.toStringURL():e.toString()),this.fieldset&&(this.fieldset.remove(),this.fieldset=undefined),r.data){for(var i in this.fieldset=g("<fieldset></fieldset>"),r.data)r.data.hasOwnProperty(i)&&this.fieldset.append('<input name="'+i+'" value="'+r.data[i]+'" />');l.append(this.fieldset)}l.submit();var u,h=!1;r.timeout&&(u=setTimeout(function(){h=!0,d.remove(),c&&l.remove(),o.fieldset&&(o.fieldset.remove(),o.fieldset=undefined),r.error&&r.error()},r.timeout)),d.on("load",function(){if(1!=h){clearTimeout(u),u=null;var e,t,i=d.get(0),n={},s=i.contentWindow.document||i.contentDocument||window.frames[i.id].document;d.remove(),c&&l.remove(),o.fieldset&&(o.fieldset.remove(),o.fieldset=undefined),s.body&&((contentNode=s.body.firstChild)&&/pre/i.test(contentNode.tagName)?n.responseText=contentNode.textContent:(contentNode=s.getElementsByTagName("textarea")[0])?n.responseText=contentNode.value:n.responseText=s.body.textContent||s.body.innerText),n.responseXML=s.XMLDocument||s,e=n.responseText&&JSON.parse(n.responseText),t=o.root?e[o.root]:e,e=v.call(o,p,e);var a=!o.successJudge||o.successJudge(e,settings);!0===a?r.success&&r.success(t||n.responseXML):(v.call(o,f,e),r.fail&&r.fail(a,t||n.responseXML))}})},e.prototype.request=function(e){var t=e.ajax||{},i=g.extend({},this.ajax,t,e),n=["/admin/system?form=envar","/admin/system?form=sysmode","/login?form=check_factory_default","/login?form=auth","/login?form=keys","/admin/log_export?form= save_log","/admin/cloud?form=firmware","/admin/isp?form=isp_upgrade"];return g.each(n,function(e,t){n[e]=g.su.url(t).toStringURL?g.su.url(t).toStringURL():g.su.url(t)}),i.url=function(e){var t=e.url.toStringURL?e.url.toStringURL():e.url,i=g.extend(!0,{},e.params),n="";if(!0===/\?/.test(t)){var s=function(e){var t=e.split("?")[1].split("&"),i={};if(!t||t&&""===t[0])return{};for(var n=0,s=t.length;n<s;n++){var a=t[n].split("=")[0];i[a]||(i[a]=[]),i[a].push(t[n].split("=")[1])}return i}(t);i=g.extend(!0,s,i),t=t.split("?")[0]}if(!g.isEmptyObject(i)){for(var a in n+="?",i)i.hasOwnProperty(a)&&g.each(i[a],function(e,t){n+=a,n+="=",n+=t,n+="&"});n=n.substring(0,n.lastIndexOf("&"))}return t+n}(i),i.data=v.call(this,s,e.data||{},i),"application/json"!==i.contentType||g.isEmptyObject(i.data)||(n.indexOf(i.url.toStringURL?i.url.toStringURL():i.url)<0&&g.su.encryptor?!0===i.isLogin?i.data=g.su.encryptor.AesEncrypt(JSON.stringify(i.data),!0):i.data=g.su.encryptor.AesEncrypt(JSON.stringify(i.data)):i.data=JSON.stringify(i.data)),g.ajax(i).done(function(e,t,i){}).fail(function(e,t){})},e.prototype.download=function(e){var t=localStorage.getItem("_tid_"),i=localStorage.getItem("usrLvl");if(e=0<=e.indexOf("?")?e+"&_tid_="+t+"&usrLvl="+i:e+"?_tid_="+t+"&usrLvl="+i,"ie"===g.su.getBrowseVersion().browse){var n=document.createElement("a");n.href=e,document.body.appendChild(n),n.click(),document.body.removeChild(n)}else setTimeout(function(){window.location.href=e},100)},e}()}(jQuery),function(s){s.su.define("Proxy",{extend:s.su.Observable,constructor:function(e){s.su.Observable.call(this),this.initApi(e);var t=this.connection||s.su.settings.AjaxProxy.defaultConnection;this.connection="string"===s.type(t)?s.su.createSync(t):t,this.isProxy=!0},inheritableDepsGatherer:function(e){var t=e.connection,i=s.Deferred();return t&&"string"===s.type(t)?s.su.require(t).done(function(){i.resolve()}):i.resolve(),i.promise()},connection:null,data:null,readFilter:null,writeFilter:null,successJudge:null,defaultOption:{},api:{},initApi:function(e){e=e||{},this.defaultOption={readFilter:e.readFilter||this.readFilter,writeFilter:e.writeFilter||this.writeFilter,failFilter:e.failFilter||this.failFilter,successJudge:e.successJudge||this.successJudge},this.defaultOption.ajax.url=this.url,this.defaultOption.ajax.data=this.data;var t=this.defaultOption,i=this.api=s.extend({},this.api,e.api);for(var n in i)i.hasOwnProperty(n)&&(i[n]=s.extend({},t,i[n]),this[n]||(this[n]=function(t){return function(e){this.op(t,e)}}(n)))},sync:function(){},request:function(e){return this._decorateOption(e),this.connection.request(e)},op:function(e,t){var i=this.api[e]?this.api[e]:this.defaultOption,n=s.extend(!0,{},i,t);return this.request(n)},_decorateOption:function(r){var o=this;r.writeFilter&&(r.data=r.writeFilter.call(this,r.data));var d=!!r&&r.success,l=!!r&&r.fail;r.success=function(e,t,i){var n=!r.successJudge||r.successJudge(e,t,i);if(!0===n){var s=r.readFilter?r.readFilter.call(o,e):e;d&&d(s,e,t,i)}else{var a=r.failFilter?r.failFilter.call(o,e):e;l&&l(a,n,t,i)}}},read:function(){},write:function(){},create:function(){},update:function(){},remove:function(){}})}(jQuery),function(s){s.su.define("AjaxProxy",{extend:"Proxy",url:null,method:"POST",ajax:null,initApi:function(e){e=e||{},this.defaultOption={url:e.url||this.url,method:e.method||this.method,ajax:s.extend(!0,{},this.ajax,e.ajax),readFilter:e.readFilter||this.readFilter,writeFilter:e.writeFilter||this.writeFilter,failFilter:e.failFilter||this.failFilter,successJudge:e.successJudge||this.successJudge},this.defaultOption.ajax.url=this.url,this.defaultOption.ajax.data=this.data;var t=this.defaultOption,i=this.api=s.extend({},this.api,e.api);for(var n in i)i.hasOwnProperty(n)&&(i[n]=s.extend({},t,i[n]),this[n]||(this[n]=function(i){return function(e){var t=s.extend(!0,{},{params:e.data});e.data=t,this.op(i,e)}}(n)))},upload:function(e){var t=this.api.upload?this.api.upload:this.defaultOption,i=s.extend({},t,e);this._decorateOption(i),this.connection.upload(i)},download:function(e){this.connection.download(e)}})}(jQuery),function(g){g.su.Store=function(e){var i=this,t=g.extend(!0,{},{fields:null,model:null,xtype:"store",autoLoad:!1,autoReload:!1,tag:"store",global:!1,keyProperty:"key",updateMode:"operation",keyLength:0,filters:[],data:[],convert:null,serialize:null,preventSuccessEvent:!1,preventFailEvent:!1,preventErrorEvent:!1},e);if(g.su.Observable.call(this),t.fields){for(var n=!1,s=0;s<t.fields.length;s++)if(t.fields[s].name==t.keyProperty){n=!0;break}n||t.fields.push({"name":t.keyProperty,"mapping":t.keyProperty})}if(t.proxy){var a,r=g.su.ClassManager.getInstance();if("string"===g.type(t.proxy))(a=r.get(e.proxy))||g.su.debug.error("Model proxy class not found: "+t.proxy),t.proxy=a.create?a.create():new a;else if(!t.proxy.isProxy){var o=g.extend(!0,{triggerEvent:!0},t.proxy);a=r.get(g.su.settings.Store.defaultProxy),t.proxy=a.create?a.create(o):new a(o)}t.proxy.addListener("ev_load",function(e,t){i.loadData(t,!0)})}return t.fields&&0!==t.fields.length&&(!0!==t.global||t.id)?(this.id=t.id||g.su.randomId("store"),void this.init(t)):null},g.su.inherit(g.su.Observable,g.su.Store),g.su.Store.checkProxyDep=function(e){return"string"==g.type(e)},g.su.Store.importProxyDep=function(e,t){return g.su.require(e,t)},g.su.Store.prototype.init=function(e){g.extend(this,e),this._name=e.name,this.data=[],this.snapshot=null,this.isStore=!0,this.isSorted=!1,e.data&&0<e.data.length&&this.loadData(e.data,!0),!0===this.autoLoad&&this.load()},g.su.Store.prototype.getSize=function(){return this.data.length},g.su.Store.prototype.getProxy=function(){return this.proxy},g.su.Store.prototype.hasField=function(e){for(var t=this.fields,i=0;i<t.length;i++)if(t[i].name===e)return!0;return!1},g.su.Store.prototype.storeConvert=function(e){for(var t in 0<this.data.length&&this.removeAllData(),this.data=[],this.dataMap={},null!==this.convert&&(e=this.convert(e)),e&&!g.isEmptyObject(e)||(e=[]),g.isArray(e)||(e=[e]),e)if(e.hasOwnProperty(t)){var i=this.createModel();e[t][this.keyProperty]===undefined&&(e[t][this.keyProperty]=g.su.randomId("key"));e[t][this.keyProperty];e[t]=i.modelConvert(e[t])}return e},g.su.Store.prototype.storeSerialize=function(e){for(var t in this.dataMap=this.dataMap||{},e||(e=[]),g.isArray(e)||(e=[e]),e)if(e.hasOwnProperty(t)){var i=e[t][this.keyProperty],n=this.dataMap[i];n||(n=this.createModel()),e[t]=n.modelSerialize(e[t])}return null!==this.serialize&&(e=this.serialize(e)),e},g.su.Store.prototype.loadData=function(e,t,i,n){if(t?e=this.storeConvert(e):(this.data=[],this.dataMap={}),this.filterBackupData=e,!(0<this.filters.length)){for(var s=e.length,a=0;a<s;a++){var r,o=e[a][this.keyProperty];o!==undefined&&this.dataMap[o]?(r=this.dataMap[o]).loadData(e[a]):(r=this.createModel(),o===undefined&&(o=e[a][this.keyProperty]=g.su.randomId("key")),r.loadData(e[a]),this.insertModelNoEvent(r,a),this.dataMap[o]=r)}return this.record(),this.trigger("ev_loaded"),this.fireEvent("ev_store_data_load_success"),n&&n.call(this,e),this}this.filter({filters:[]})},g.su.Store.prototype.refreshData=function(e){var o=function(e,t,i){var n,s=!!t.hasOwnProperty(i);for(var a in e)if(e.hasOwnProperty(a)&&(a!==i||s)){for(var r in n=!1,t)t.hasOwnProperty(r)&&(a===r&&e[a]===t[r]?n=!0:"array"===g.type(e[a])&&"array"===g.type(t[r])?n=e[a].join(",")===t[r].join(","):"object"===g.type(e[a])&&"object"===g.type(t[r])&&(n=o(e[a],t[r])));if(!1===n)break}return n};if(0===this.data.length)this.loadData(e,!0);else{var t,i,n,s,a,r,d=(e=function(e,t){null!==e.convert&&(t=e.convert(t)),t||(t=[]),g.isArray(t)||(t=[t]);var i=e.createModel();for(var n in t)t.hasOwnProperty(n)&&(t[n][e.keyProperty]||(t[n][e.keyProperty]=g.su.randomId("key")),t[n]=i.modelConvert(t[n]));return t}(this,e)).length;for(t=0;t<d;t++)if((n=e[t]).hasOwnProperty(this.keyProperty)&&n[this.keyProperty]!==undefined&&null!==n[this.keyProperty])r=n[this.keyProperty],(s=this.getModelByKey(r))?o(s.getData(),e[t],this.keyProperty)||s.loadData(e[t]):((a=this.createModel()).loadData(e[t]),this.insertModel(a)),this.moveModelPosition(r,t);else{var l;if((i=t)<this.data.length)for(i=t;i<this.data.length;i++)if(s=this.data[i],o(s.getData(),e[t],this.keyProperty)){l=s.getField(this.keyProperty).getValue();break}l?this.moveModelPosition(l,t):((a=this.createModel()).loadData(e[t]),this.insertModel(a),this.moveModelPosition(a.getField(this.keyProperty).getValue(),t))}if(this.data.length>e.length){var c=[];for(t=e.length;t<this.data.length;t++)c.push(this.data[t].getField(this.keyProperty).getValue());this.data.splice(e.length,this.data.length-e.length),this.trigger("ev_model_deleted",[c])}}},g.su.Store.prototype.loadFilterData=function(e){for(var t in 0<this.filters.length&&(e=this.runFilter(g.su.clone(e))),this.data=[],this.dataMap={},e)if(e.hasOwnProperty(t)){var i,n=e[t][this.keyProperty];n&&this.dataMap[n]?(i=this.dataMap[n]).loadData(e[t]):(i=this.createModel(),n||(n=e[t][this.keyProperty]=g.su.randomId("key")),i.loadData(e[t]),this.insertModelNoEvent(i,t),this.dataMap[n]=i)}return this.record(),this.trigger("ev_loaded"),this},g.su.Store.prototype.filter=function(e,t){var i=e.filters,n=e.append,s=e.columns;if(this.rendererMap={},this.filterPrecise=!!t,i&&0!==i.length){if(i=g.isArray(i)?i:[i],n?this.filters.concat(i):this.filters=i,s)for(var a=0,r=s.length;a<r;a++){var o=s[a].dataIndex;this.rendererMap[o]=s[a].renderer}this.loadFilterData(this.filterBackupData)}else 0<this.filters.length&&(this.filters=[],this.loadData(this.filterBackupData))},g.su.Store.prototype.runFilter=function(o){for(var d=this,e=0,t=this.filters.length;e<t;e++){var i=this.filters[e];if(i.func)for(var n=o.length-1;0<=n;n--)i.func(o[n])||o.splice(n,1);else i.value!==undefined&&null!==i.value&&""!==i.value&&i.column!==undefined&&s(i.column,i.value)}function s(e,t){if(d.filterPrecise)for(var i=o.length-1;0<=i;i--){if((a=o[i][e])===undefined){var n=!1;for(var s in o[i]){if(o[i].hasOwnProperty(s)&&s!==d.keyProperty)if((r=o[i][s])!==undefined&&r===t){n=!0;break}}!1===n&&o.splice(i,1)}else a!==t&&o.splice(i,1)}else for(i=o.length-1;0<=i;i--){var a;if((a=l(e,o[i][e],o[i]))===undefined){n=!1;for(var s in o[i]){var r;if(o[i].hasOwnProperty(s)&&s!==d.keyProperty)if((r=l(s,o[i][s],o[i]))!==undefined&&-1!==(r+"").search(new RegExp(t,"i"))){n=!0;break}}!1===n&&o.splice(i,1)}else"array"===g.type(t)?-1===g.inArray(o[i][e],t)&&o.splice(i,1):-1===a.toString().search(new RegExp(t,"i"))&&-1===o[i][e].toString().search(new RegExp(t,"i"))&&o.splice(i,1)}}function l(e,t,i){return d.rendererMap[e]===undefined?""+t:d.rendererMap[e](t,i)}return o},g.su.Store.prototype.record=function(){for(var e=0,t=this.data.length;e<t;e++)this.data[e].record();return this.snapshot=g.su.clone(this.getStoreData()),this},g.su.Store.prototype.getDataByIndex=function(e){return this.data[e].getData()},g.su.Store.prototype.getModelByIndex=function(e){return this.data[e]},g.su.Store.prototype.getModelByKey=function(e){return this.data[this.getIndex(e)]},g.su.Store.prototype.getIndex=function(e){var t=this.data,i=this.keyProperty;if(e===undefined)return undefined;for(var n=0,s=t.length;n<s;n++)if(t[n].getField(i).val().toString()==e.toString())return n;return undefined},g.su.Store.prototype.getKeyByIndex=function(e){var t=this.data,i=this.keyProperty;return t[e].getField(i).val()},g.su.Store.prototype.getIndexs=function(e){var t=this.data,i=this.keyProperty;if(0===e.length)return undefined;for(var n="",s=0,a=e.length;s<a;s++)for(var r=0,o=t.length;r<o;r++){var d=e[s];if(t[r].getField(i).val().toString()==d.toString()){n+=r+",";break}}return""!==n?n.substring(0,n.length-1):n},g.su.Store.prototype.beforeLoad=function(e){var s=this,a=(e.preventSuccessEvent===undefined?s.preventSuccessEvent:e.preventSuccessEvent,e.preventFailEvent===undefined?s.preventFailEvent:e.preventFailEvent),i=e.preventErrorEvent===undefined?s.preventErrorEvent:e.preventErrorEvent;e.preventSuccessEvent=!0,e.preventFailEvent=!0,e.preventErrorEvent=!0;var r=e.fail;e.fail=function(e,t,i,n){r&&r(e,t,i,n),t&&!a&&s.trigger("ev_store_sync_error",t)};var n=e.error;return e.error=function(e,t){n&&n(e,t),i||s.trigger("ev_store_ajax_error",[e,t])},e},g.su.Store.prototype.load=function(e){e=e||{},e=this.beforeLoad(e);var t=g.extend(!0,{operation:"read",dataObj:this},e);this.proxy&&this.proxy.sync(t)},g.su.Store.prototype.beforeUpdate=function(e,t,i){var s=this,n={};for(var a in t)t.hasOwnProperty(a)&&(n[a]=s.storeSerialize(t[a].model)[0]);return{data:n,params:{option:"edit"},success:function(e){s.loadData(e.model,!0),s.fireEvent("ev_store_operation")},fail:function(e,t,i,n){s.loadData(s.snapshot),t&&s.trigger("ev_store_sync_error",t)},error:function(e,t){s.loadData(s.snapshot),s.trigger("ev_store_ajax_error",[e,t])}}},g.su.Store.prototype.update=function(e,t,i){if(this.proxy&&!g.isEmptyObject(e)){var n=this.getStoreData(),s=this.beforeUpdate(n,e,t,i);this.proxy.update(s)}else i&&i("update")},g.su.Store.prototype.beforeRemove=function(e,t,i){var s=this,n={};for(var a in t)t.hasOwnProperty(a)&&(n[a]=s.storeSerialize(t[a].oldModel)[0]);return{data:n,params:{option:"delete"},success:function(e,t){s.loadData(e.model,!0),s.fireEvent("ev_store_operation")},fail:function(e,t,i,n){s.loadData(s.snapshot),t&&s.trigger("ev_store_sync_error",t)},error:function(e,t){s.loadData(s.snapshot),s.trigger("ev_store_ajax_error",[e,t])}}},g.su.Store.prototype.remove=function(e,t,i){if(this.proxy&&!g.isEmptyObject(e)){var n=this.getStoreData(),s=this.beforeRemove(n,e,t,i);this.proxy.remove(s)}else i&&i("remove")},g.su.Store.prototype.removeDataByKey=function(e,i){var t,n,s=this.keyProperty;g.isArray(e)||(e=[e]);var a={};for(t=0,n=e.length;t<n;t++)a[e[t]]=!0;var r=this.data,o=[];for(t=0,n=r.length;t<n;t++)r[t].getField(s).val()in a&&o.push(t);this.removeDataByIndex(o,function(e,t){i&&i.call(this,e,t)})},g.su.Store.prototype.moveModelPosition=function(e,t){var i=this.getIndex(e);if(i!==t){var n=this.data.splice(i,1);this.data.splice(t,0,n[0]),this.trigger("ev_store_item_moved",[e,t,i])}},g.su.Store.prototype.removeDataByIndex=function(e,t){var i=this.keyProperty,n=this.data;g.isArray(e)||(e=[e]),e.sort(function(e,t){return e-t});for(var s=[],a=e.length-1;0<=a;a--){var r=e[a];isNaN(r)||(s.push(n[r][i].getValue()),n.splice(e[a],1))}return t&&t.call(this,s,e),this.trigger("ev_model_deleted",[s,e]),this.trigger("ev_datachanged",[this,this.getStoreData,"removeData"]),this},g.su.Store.prototype.removeAllData=function(e){return this.data=null,delete this.data,this.data=[],this.trigger("ev_removeAllData",[this]),this.trigger("ev_datachanged",[this,this.data,"removeData"]),this},g.su.Store.prototype.getStoreData=function(){return this.getData()},g.su.Store.prototype.getSelectedStoreData=function(){var e,t=[];for(e=0;e<this.data.length;e++)this.data[e].selected&&t.push(this.data[e]);var i=t.length,n=[];for(e=0;e<i;e++){var s=t[e].getData();n.push(s)}return n},g.su.Store.prototype.getSelectedData=function(){var e,t=[];for(e=0;e<this.data.length;e++)this.data[e].selected&&t.push(this.data[e]);var i=t.length,n=[];for(e=0;e<i;e++){var s=t[e].getData();n.push(s)}return n},g.su.Store.prototype.getSelectedDataKey=function(e){var t,i=[];for(t=0;t<this.data.length;t++)this.data[t].selected&&i.push(this.data[t]);var n=i.length,s=[];for(t=0;t<n;t++){var a=i[t].getField(e||this.keyProperty).getValue();s.push(a)}return s},g.su.Store.prototype.getData=function(e){for(var t=this.data,i=t.length,n=[],s=0;s<i;s++){var a=t[s].getData(e);n.push(a)}return n},g.su.Store.prototype.insertModel=function(e,t){var s=this;return t=t||0,this.data.splice(t,0,e),this.trigger("ev_model_inserted",[t]),e.on("ev_data_change",function(e,t,i,n){s.trigger("ev_data_change",[t,i,n,s])}),this},g.su.Store.prototype.insertModelNoEvent=function(e,t){var s=this;return t=t||0,this.data.splice(t,0,e),e.on("ev_data_change",function(e,t,i,n){s.trigger("ev_data_change",[t,i,n,s])}),this},g.su.Store.prototype.insertData=function(e,t){t=t||0;var i=this.keyProperty,n=this.createModel();e[i]===undefined&&(e[i]=n.getField(i).getValue()),n.replaceData(e,!0),this.insertModel(n,t)},g.su.Store.prototype.generateModelKey=function(){return g.su.randomId(this.keyProperty)},g.su.Store.prototype.createModel=function(){var e={"fields":this.fields},t=new g.su.Model(e);return t.getField(this.keyProperty).setValue(this.generateModelKey()),t},g.su.Store.prototype.getModelKey=function(e){var t=e.getField(this.keyProperty);return t?t.getValue():null},g.su.Store.prototype.checkDataChange=function(e){var t=e&&e.sync,r=this,i=function(e){var t={},i={};if(!e)return{data:t,map:i};for(var n=0,s=e.length;n<s;n++){var a=e[n][r.keyProperty];t[a]=g.extend({},e[n]),i[a]=!1}return{data:t,map:i}},n=function(e,t){var i,n=g.su.getObjectLength(e),s=g.su.getObjectLength(t);for(var a in e)if(e.hasOwnProperty(a)){for(var r in i=!1,t)t.hasOwnProperty(r)&&(a===r&&e[a]===t[r]?i=!0:a===r&&("array"===g.type(e[a])&&"array"===g.type(t[r])||"object"===g.type(e[a])&&"object"===g.type(t[r]))&&(i=JSON.stringify(e[a])===JSON.stringify(t[r])));if(!1===i)break}return n===s&&i},s=this.getStoreData(),a=i(t?this.storeSerialize(s):s),o=i(t?this.storeSerialize(this.snapshot):this.snapshot),d={},l={},c={},u=0;for(var h in a.map)if(a.map.hasOwnProperty(h))for(var p in o.map)o.map.hasOwnProperty(p)&&h===p&&(o.map[p]=!0,a.map[h]=!0);for(var f in u=0,a.map)a.map.hasOwnProperty(f)&&(a.map[f]&&o.map[f]&&!n(a.data[f],o.data[f])?l[f]={index:u,model:a.data[f],oldModel:o.data[f]}:a.map[f]||(d[f]={index:u,model:a.data[f]}),u++);for(var v in u=0,o.map)o.map.hasOwnProperty(v)&&(o.map[v]||(c[v]={index:u,oldModel:o.data[v]}),u++);return{"insert":d,"update":l,"remove":c}},g.su.Store.prototype.beforeSync=function(t){var s=this,a=t.autoReload===undefined?s.autoReload:t.autoReload,i=t.preventSuccessEvent===undefined?s.preventSuccessEvent:t.preventSuccessEvent,r=t.preventFailEvent===undefined?s.preventFailEvent:t.preventFailEvent,n=t.preventErrorEvent===undefined?s.preventErrorEvent:t.preventErrorEvent;t.preventSuccessEvent=!0,t.preventFailEvent=!0,t.preventErrorEvent=!0;var o=t.success;t.success=function(e){s.trigger("ev_store_operation",[e]),s.trigger("ev_store_sync_complete",["success",e]),o&&o(e),!1!==a&&s.load(),!0!==i&&"read"!=t.operation&&g.su.moduleManager.query("main").showNotice(g.su.CHAR.COMMON.SAVED)};var d=t.fail;t.fail=function(e,t,i,n){d&&d(e,t,i,n),t&&!r&&s.trigger("ev_store_sync_error",t),s.trigger("ev_store_sync_complete",["fail",t]),!1!==a&&s.load()};var l=t.error;t.error=function(e,t){l&&l(e,t),n||s.trigger("ev_store_ajax_error",[e,t]),s.trigger("ev_store_sync_complete",["error",e,t])};var e=g.su.getDefaultEvent(this,function(){});return this.trigger("ev_store_before_sync",[e.ev]),e.exe()?t:t=null},g.su.Store.prototype.afterSync=function(){},g.su.Store.prototype.sync=function(e){if(e=e||{},e=this.beforeSync(e),"object"!==g.type(e))return null;var t=Array.prototype.slice.call(arguments,0),i=g.extend(!0,{},e);i.difference=this.checkDataChange({sync:!0}),i.operation=i.operation||"write",i.dataObj=this,t[0]=i,this.proxy&&this.proxy.sync.apply(this.proxy,t)},g.su.Store.prototype.isDirty=function(){var e=this.checkDataChange();return!(g.isEmptyObject(e.insert)&&g.isEmptyObject(e.update)&&g.isEmptyObject(e.remove))},g.su.Store.prototype.reset=function(){for(var e=0,t=this.data.length;e<t;e++)this.data[e].reset();return this},g.su.Store.prototype.selectByKey=function(e){for(var t,i=0,n=(e=g.isArray(e)?e:[e]).length;i<n;i++)(t=this.getModelByKey(e[i]))&&(t.selected=!0)},g.su.Store.prototype.selectAll=function(){for(var e=0,t=this.data.length;e<t;e++)this.data[e].selected=!0;return this},g.su.Store.prototype.unselectAll=function(){for(var e=0,t=this.data.length;e<t;e++)this.data[e].selected=!1;return this},g.su.Store.prototype.unselectByKey=function(e){for(var t,i=0,n=(e=g.isArray(e)?e:[e]).length;i<n;i++)(t=this.getModelByKey(e[i]))&&(t.selected=!1)},g.su.Store.prototype.syncSelectedData=function(){var r=this,e=function(e){var t={},i={};if(!e)return{data:t,map:i};for(var n=0,s=e.length;n<s;n++){var a=e[n][r.keyProperty];t[a]=g.extend({},e[n]),i[a]=!1}return{data:t,map:i}},t=function(e,t){var i,n=g.su.getObjectLength(e),s=g.su.getObjectLength(t);for(var a in e)if(e.hasOwnProperty(a)){for(var r in i=!1,t)t.hasOwnProperty(r)&&a===r&&e[a]===t[r]&&(i=!0);if(!1===i)break}return n===s&&i},i=e(this.getSelectedData()),n=e(this.snapshot),s={};for(var a in i.map)if(i.map.hasOwnProperty(a))for(var o in n.map)n.map.hasOwnProperty(o)&&a===o&&(n.map[o]=!0,i.map[a]=!0);for(var d in i.map)i.map.hasOwnProperty(d)&&i.map[d]&&n.map[d]&&!t(i.data[d],n.data[d])&&(s[d]={model:i.data[d],oldModel:n.data[d]});this.update(s)},g.su.Store.prototype.getAllKeys=function(){for(var e=this.keyProperty,t=this.data,i=t.length,n=[],s=0;s<i;s++)n.push(t[s].getField(e).getValue());return n},g.su.Store.prototype.setConvert=function(e){this.convert=e},g.su.Store.prototype.keyConflict=function(e){var t;return t=e instanceof g.su.Model?e[this.keyProperty].getValue():e[this.keyProperty],{conflict:this.getIndex(t)!==undefined,keyNew:t}},g.su.Store.prototype.dataConflict=function(e,t){if(!this.conflictFields||0==this.conflictFields.length)return!1;var i;i=e instanceof g.su.Model?e.getData():i;for(var n=this.getData(),s=this.conflictFields,a=this.keyProperty,r=0;r<n.length;r++)for(var o=n[r],d=0;d<s.length;d++){var l=s[d].name;if(o[l]==i[l]){if(t&&o[a]==t)continue;return l}}return!1},g.su.Store.prototype.fetchChildren=function(e,t){return this.load({operation:"read",dataObj:this,data:e,success:function(e){t(e)}}),this},g.su.Store.prototype.loadTreeData=function(e){if(this.data=[],this.dataMap={},this.filterBackupData=e,!(0<this.filters.length)){for(var t=e.length,i=0;i<t;i++){var n,s=e[i][this.keyProperty];s!==undefined&&this.dataMap[s]?(n=this.dataMap[s]).loadData(e[i]):(n=this.createModel(),s===undefined&&(s=e[i][this.keyProperty]=g.su.randomId("key")),n.loadData(e[i]),this.insertModelNoEvent(n,i),this.dataMap[s]=n)}return this.record(),this.trigger("ev_render_tree"),this}this.filter({filters:[]})}}(jQuery),function(l){var c,o;l.su=l.su||{},l.su.widgets={},l.su.Widget=(c={labelField:{attribute:"label-field",defaultValue:""},cls:{attribute:"cls",defaultValue:" container widget-container "},separator:{attribute:"separator",defaultValue:":"},labelCls:{attribute:"label-cls",defaultValue:""},inputCls:{attribute:"input-cls",defaultValue:""},tips:{attribute:"tips",defaultValue:""},shortTips:{attribute:"short-tips",defaultValue:""},tipsCls:{attribute:"tips-cls",defaultValue:""},errorTipsCls:{attribute:"error-tips-cls",defaultValue:""}},(o=function(e){if("object"===l.type(e.id))l(e.id).attr("id")?this.domId=l(e.id).attr("id"):(this.domId=l.su.randomId("widget-"),l(e.id).attr("id",this.domId)),e.id=this.domId;else{if("string"!==l.type(e.id))return;this.domId=e.id}this._init(e),this.init(e);var n,s,t=this.render;return this.render=(n=t,s=this,function(){var e,t=n.call(this);if(t&&t.then&&(e=t),s._bindListeners(),s._initTip(),this._view&&this._view.onChildWidgetRendered(this),this.rendered=!0,e)return e;var i=l.Deferred();return i.resolve(),i.promise()}),this}).prototype={_init:function(e){var r,o=this.dom(),d=this;r=e.settings=e.settings||{},this.settings=function(){var e=l.extend({},c,d.settings);for(var t in e)if(e.hasOwnProperty(t)){var i=e[t];if(r.hasOwnProperty(i.attribute)||o[0]&&o[0].hasAttribute(i.attribute)){"object"===l.type(r[i.attribute])&&"object"===l.type(i.defaultValue)&&(r[i.attribute]=l.extend(!0,{},i.defaultValue,r[i.attribute]));var n,s=r[i.attribute]||o.attr(i.attribute);n=l.isFunction(i.setter)?i.setter.call(o,s):s,r[t]=n}else{var a=i.defaultValue;i.getter?r[t]=i.getter.call(o):r[t]="object"===l.type(a)?l.su.clone(a):a}}return r}(),e.customSettings&&l.extend(this.settings,e.customSettings),this._view=e.view,this._view&&this._view.addChildWidget(this),this._status={shown:!0,disabled:!1},this.dom().data("viewObj",this)},_initTip:function(e){var t=(e=this).settings,i=e.getContainer();if(t.tipText&&i){var n=i.find("div[widget=toolTip]");n.get(0)&&(l(n[0]).attr("id",e.domId+"_tooltip"),new l.su.widgets.toolTip({id:l(n[0]),tipText:t.tipText}).render())}if(i){var s=i.children(".widget-wrap-outer").children("div[widget=errortip]");s.get(0)&&(l(s[0]).attr("id",e.domId+"_errortip"),e.errortip=new l.su.widgets.errortip({id:l(s[0]),type:e._type}),e.errortip.render(),e.errortip.hide())}e.setTips(t.tips)},_bindListeners:function(){if(this.listeners&&l.isArray(this.listeners)){var e,t,s=this,a=this.listeners;if(s._eventMap&&0<s._eventMap.length)for(e=0,t=s._eventMap.length;e<t;e++){var i=s._eventMap[e];i.target?i.parent.off(i.event,i.target,i.func):i.parent.off(i.event,i.func)}for(s._eventMap=[],e=0,t=a.length;e<t;e++)!function(t){var e=function(){var e=Array.prototype.slice.apply(arguments);e.push(s),a[t].callback.apply(this,e)};if(!a[t].condition||!1!==a[t].condition(s)){var i=a[t].selector;if("function"===l.type(i)){var n=i.call(s);n.target?l(n.parent).on(a[t].event,n.target,e):l(n.parent).on(a[t].event,e),s._eventMap.push({parent:l(n.parent),target:n.target||"",event:a[t].event,handler:e})}else""!==i?s.dom().on(a[t].event,i,e):s.dom().on(a[t].event,e),s._eventMap.push({parent:s.dom(),target:i||"",event:a[t].event,handler:e})}}(e)}},init:function(){},dom:function(){return l("#"+this.domId)},render:function(){this.dom().addClass(this.settings.cls)},getContainer:function(){var e=this.dom();if(e.hasClass("widget-container"))return e;var t=e.children(".widget-container");return t.get(0)?l(t.get(0)):null},setLabelField:function(e){this.dom().find("label.widget-fieldlabel").html(e)},show:function(){this.dom().show(),this.dom().triggerHandler("ev_widget_show")},hide:function(){this.dom().hide(),this.dom().triggerHandler("ev_widget_hide")},remove:function(){this.dom().remove()},fadeOut:function(e){var t=this,i=e/1e3+"s";this.dom().css({opacity:0,transtion:"opacity "+i}),setTimeout(function(){t.dom().hide().css({display:"none",opacity:1,transtion:"no "})},e)},toggle:function(){this.dom().is(":visible")?this.hide():this.show()},enable:function(){this.dom().removeClass("disabled")},disable:function(){this.dom().addClass("disabled")},isDisabled:function(){var e=this.dom(),t=this.getContainer();return t&&t.hasClass("disabled")||!0===e.prop("disabled")},setError:function(e){var t=this.dom(),i=this.getContainer(),n=t.find("div[widget=errortip]");if(i&&!this.isDisabled()){if(this.errortip)e&&this.errortip.show(e);else if(0<n.length&&i){var s=i.children(".widget-wrap-outer").children("div[widget=errortip]");s.get(0)&&(l(s[0]).attr("id",this.domId+"_errortip"),this.errortip=l(s[0]).errortip({type:this.type})[0],this.errortip.render(),e&&this.errortip.show(e))}i.removeClass("valid").addClass("error"),i.find("span.widget-validate-icon").css({"display":"inline-block"})}},setErrorHtml:function(e){var t=this.dom(),i=this.getContainer(),n=t.find("div[widget=errortip]");if(i&&!this.isDisabled()&&e){if(this.errortip)this.errortip.showHtml(e);else if(0<n.length&&i){var s=i.children(".widget-wrap-outer").children("div[widget=errortip]");s.get(0)&&(l(s[0]).attr("id",this.domId+"_errortip"),this.errortip=l(s[0]).errortip({type:this.type})[0],this.errortip.render(),this.errortip.showHtml(e))}i.removeClass("valid").addClass("error"),i.find("span.widget-validate-icon").css({"display":"inline-block"})}},setNormal:function(){var e=this.dom(),t=(this.settings,this.getContainer()||e);e.find("div[widget=errortip]"),t&&(t.removeClass("focus error disable dirty correct"),t.find("span.widget-validate-icon").css({"display":"none"}),this.errortip&&this.errortip.hide())},addClass:function(e){var t=this.dom();return t&&0<t.length&&t.addClass(e),this},removeClass:function(e){var t=this.dom();return t&&0<t.length&&t.removeClass(e),this},setFocus:function(){var e=this.getContainer();this.setNormal(),e.addClass("focus")},removeFocus:function(){this.getContainer().removeClass("focus")},setTips:function(e){var t=this.dom(),i=this.settings,n=(this.getContainer()||t).find("div.widget-tips");i.tips=e,"string"===l.type(e)&&n.find("div.tips-content").html(e),e?(n.show(),n.fadeIn(150)):(n.hide(),n.css("display","none"))},setShortTips:function(e){var t=this.dom(),i=this.settings,n=(this.getContainer()||t).find("div.widget-short-tips");i.shortTips=e,"string"===l.type(e)&&n.find("div.short-tips-content").html(e),e?(n.css("display","inline-block"),n.fadeIn(150)):(n.hide(),n.css("display","none"))},setToolTip:function(e){var t=this.dom(),i=this.settings,n=(this.getContainer()||t).find("div.tooltip-container");i.tipText=e,"string"===l.type(e)&&n.find("p.tip-text").html(e),e?n.show():n.hide()},setPosition:function(e,t,i,n){var s=this.getContainer();if(s){var a="center"===e?parseInt((l(window).width()-s.outerWidth())/2,10):e||0,r="center"===t?parseInt((l(window).height()-s.outerHeight())/2,10):t||0;return a=a<0?0:a,s.css({left:a,top:r,right:i,bottom:n}),{x:a,y:r}}},getMask:function(){var e=l("#global-mask");return 0<e.length?e.data("viewObj"):(l('<div id="global-mask"></div>').appendTo(l("body")),new l.su.widgets.mask({id:"global-mask"}))},_destroy:function(){if(this._view&&this._view.removeChildWidget(this),this.destroy&&this.destroy(),this._eventMap){for(var e=0,t=this._eventMap.length;e<t;e++){var i=this._eventMap[e];i.target?l(i.parent).off(i.event,i.target,i.handler):l(i.parent).off(i.event,i.handler)}this._eventMap=[]}this.dom().data("viewObj",null),this.dom().remove(),this.settings=null},getStatus:function(e){return e?this._status[e]:this._status},setStatus:function(e,t){this._status[e]=t,this.dom().triggerHandler("ev_status_change",[this._status])}},o.regMap={base:l.extend({settings:c,listeners:[]},o.prototype)},o.register=function(t,n){var s,i;for(var e in o.regMap[t]=n,i=n.extend?l.su.widgets[n.extend]:l.su.Widget,o.regMap[t].settings=function a(){var e,t=n.extend?o.regMap[n.extend].settings:c;for(var i in e=l.isFunction(n.settings)?n.settings.call(s,l.extend({},t)):l.extend({},t,n.settings))e.hasOwnProperty(i)&&!e[i].setter&&(e[i].setter=(e[i].attribute,function(e){l(this);var t=l.su.getAttrObject;if(null!==e&&e!==undefined){if("string"===l.type(e)&&e.match(/{(.+)}/g)){var i=t(l.su.CHAR,e);return null!==i&&i!==undefined?i:"Not Defined"}return e}}));return e}(),o.regMap[t].listeners=function r(){var e=n.extend?o.regMap[n.extend].listeners:[];return n.listeners=n.listeners||[],l.isFunction(n.listeners)?n.listeners.call(s,e):e.concat(n.listeners)}(),s=l.su.widgets[t]=function(e){return this._type||(this._type=t,this.settings=o.regMap[t].settings,this.listeners=o.regMap[t].listeners),i.call(this,e),this},l.su.inherit(i,s),n)n.hasOwnProperty(e)&&l.isFunction(n[e])&&(s.prototype[e]=n[e]);return s},o),l("html").delegate("input","focus",function(e){e.stopPropagation(),e.preventDefault()}).on("click",function(e){e.stopPropagation(),l("div.region-select-wrap, div.region-search-wrap").hide(),l("div.timepicker-msg-container").removeAttr("dragFlag")}).on("mouseup",function(e){l("div.button-container").removeClass("clicked"),l("div.btn-help-container a.btn-help").removeClass("clicked"),l("div.timepicker-msg-container-wrap").trigger("mouseup")}).on("keyup mousedown",function(e){}),l(document).ready(function(e){l('<div id="global-mask"></div>').appendTo(l("body")),new l.su.widgets.mask({id:"global-mask"}).render(),l('<div id="global-combobox-options" data-shown="_hidden_"></div>').appendTo(l("body")),l('<div id="global-tips-text" class="global-tips-text" data-shown="_hidden_"></div>').appendTo(l("body"));var t,i=document.body.clientWidth;t=i<768?"s":i<1024?"m":i<1280?"l":"xl",l.su.widgetSize=t}),l(window).on("resize",l.su.throttle(function(e){var t,i=l("div.msg-container"),n=document.body.clientWidth,s=l("#global-combobox-options"),a=l("#global-tips-text"),r=s.attr("data-shown"),o=a.attr("data-shown");t=n<768?"s":n<1024?"m":n<1280?"l":"xl",l.su.widgetSize=t,l(window).trigger("ev_resize",[t,n]),i.each(function(e,t){var i=l(t).data("viewObj");i.settings.shown&&i.setPosition("center","center")}),"_hidden_"!==r&&l("#"+r).data("viewObj").calculatePosition(),"_hidden_"!==o&&l("#"+o).data("viewObj").adjustLayout(l.su.widgetSize);var d=l(".page-content").data("ps");d&&d.update()},100,100)),l(document).on("DOMSubtreeModified",l.su.debounce(function(){l(".ps").each(function(e){var t=l(this).data("ps");t&&t.update()})},100))}(jQuery),function(){function i(e,t){if(0<$(e.ele).length){var i=new scrollbar(e.ele,e.opts);$(e.ele).data("ps",i),t&&t(i)}}$.su.scrollbar=function(e,t){"Microsoft Internet Explorer"===navigator.appName&&navigator.userAgent.match(/Trident/i)&&navigator.userAgent.match(/MSIE 8.0/i)||($.su.scrollbar.loaded?i(e,t):$.su.router.loadFile("js/libs/perfect-scrollbar.min.js",function(){i(e,t),$.su.scrollbar.loaded=!0}))},$.su.scrollbar.loaded=!1}(),$.su.Widget.register("panel",{settings:{_title:{attribute:"title-label",defaultValue:""},instruction:{attribute:"instruction",defaultValue:""},icon:{attribute:"icon",defaultValue:""},iconCls:{attribute:"icon-cls",defaultValue:""},panelType:{attribute:"panel-type",defaultValue:"form"},collapsible:{attribute:"collapsible",defaultValue:!1},collapsed:{attribute:"collapsed",defaultValue:!1},tipText:{attribute:"tip-text",defaultValue:""}},listeners:[{selector:function(e){return{parent:this.getContainer().find(".panel-title:first")}},event:"click",callback:function(e,t){var i=$(this).find("span.panel-header-btn-collapse"),n=t.settings;if(n.collapsible){var s=t.getContainer(),a=s.find("div.panel-content");n.collapsed?(a.slideDown(200,function(){a.css("display","block")}),s.removeClass("collapsed"),n.collapsed=!1,i.closest("div[widget=panel]").triggerHandler("ev_panel_open")):(a.slideUp(200,function(){$(this).css("display","none")}),s.addClass("collapsed"),n.collapsed=!0,i.closest("div[widget=panel]").triggerHandler("ev_panel_close"))}}}],init:function(){},render:function(){var e=this.dom(),t=this.settings,i=t.collapsible?!1===t.collapsed?"block":"none":"block",n=t.collapsed?" collapsed":"";e.addClass(t.cls+"panel-container "+t.panelType+n);var s="";s+='<div class="panel-wrap">',!1!==t._title&&(s+='<div class="panel-header">',s+='<h3 class="panel-title">',s+='<span class="panel-title-text" style="vertical-align: middle">'+t._title+"</span>",t.tipText&&(s+='<div widget="toolTip" style="vertical-align: middle"></div>'),s+='<span class="panel-title-icon"></span>',"string"===$.type(t.instruction)&&""!==t.instruction&&(s+='<div class="panel-title-instruction">'+t.instruction+"</div>"),s+='<div class="panel-header-btn-container">',t.collapsible&&(s+='<span class="panel-header-btn-collapse" type="button"></span>'),s+="</div>",s+="</h3>",s+="</div>"),s+='<div class="panel-content" style="display: '+i+'">',s+='<div class="panel-tbar-container"></div>',s+='<div class="panel-content-container"></div>',s+='<div class="panel-fbar-container"></div>',s+="</div>",s+="</div>";var a=$(s);0<e.find("div.panel-content-container").length?(a.find("div.panel-content-container").append(e.find("div.panel-content-container").children().detach()),e.find(".panel-wrap").remove()):a.find("div.panel-content-container").append(e.children().detach()),e.append(a)},setTitle:function(e){var t=this.getContainer();e&&t.find("h3.panel-title span.panel-title-text").html(e)},setInstruction:function(e){var t=this.getContainer();e&&t.find("h3.panel-title div.panel-title-instruction").html(e)},open:function(){var e=this.settings,t=this.getContainer(),i=t.find("div.panel-content");t.find("span.panel-header-btn-collapse"),i.slideDown(200,function(){i.css("display","block"),t.removeClass("collapsed")}),e.collapsed=!1,this.dom().triggerHandler("ev_panel_open")},hideHeader:function(){this.getContainer().addClass("panel-header-empty")},showHeader:function(){this.getContainer().removeClass("panel-header-empty")}}),$.su.Widget.register("simpleDom",{render:function(){}}),$.su.Widget.register("textbox",{settings:{readOnly:{attribute:"read-only",defaultValue:!1},tipText:{attribute:"tip-text",defaultValue:""},unit:{attribute:"unit",defaultValue:""},addon:{attribute:"add-on",defaultValue:""},hint:{attribute:"hint",defaultValue:null},prefix:{attribute:"prefix",defaultValue:null}},listeners:[{selector:".text-wrap-inner input",event:"keyup",callback:function(e,t){var i=t.getValue();t.dom().triggerHandler("ev_view_change",[{"type":"value","value":i}])}},{selector:".text-wrap-inner input",event:"click",callback:function(e,t){var i=t.getValue();t.dom().addClass("focus"),t.dom().triggerHandler("ev_view_change",[{"type":"value","value":i}]),t.dom().find(".text-hint-inner").hide()}},{selector:"div.text-wrap",event:"mouseenter",callback:function(e,t){t.dom().addClass("hover")}},{selector:"div.text-wrap",event:"mouseleave",callback:function(e,t){t.dom().removeClass("hover")}},{selector:".text-wrap-inner input",event:"blur",callback:function(e,t){var i=t.getValue();t.dom().find("div.widget-addon").hide(),t.dom().triggerHandler("ev_view_change",[{"type":"value","value":i}]),t.dom().triggerHandler("ev_view_change",[{"type":"valid","value":i}]),t.dom().triggerHandler("ev_textbox_blur"),t.dom().removeClass("focus"),""==i&&t.settings.hint&&t.dom().find(".text-hint-inner").show()}},{selector:".text-wrap input",event:"focus",callback:function(e,t){t.setAddon(),t.dom().addClass("focus"),t.dom().triggerHandler("ev_textbox_focus")}},{selector:".text-hint-inner input.text-hint",event:"click",callback:function(e,t){t.dom().hasClass("disabled")||t.dom().find(".text-wrap-inner input").click().focus()}}],init:function(){},render:function(){var e=this.dom(),t=this.settings,i=t.readOnly?'readonly="readonly"':"",n=t.readOnly?" readonly":"",s=!1===t.labelField?"label-empty":"",a=""===t.addon?"":" addon",r=""===t.unit?"":" unit",o=""===t.tips?"":" tips",d=""===t.shortTips?"":" short-tips",l=null==t.prefix?"":" prefix";e.addClass(t.cls+"text-container "+s+a+r+o+d+l+n);var c="";null!==t.labelField&&(c+='<div class="widget-fieldlabel-wrap'+t.labelCls+(""==t.labelField?" empty":"")+'">',c+='<div class="widget-fieldlabel-inner">',c+='<label class="widget-fieldlabel text-fieldlabel">'+t.labelField+"</label>",t.labelField&&(c+='<span class="widget-separator">'+t.separator+"</span>"),c+="</div>",c+="</div>"),c+='<div class="widget-wrap-outer text-wrap-outer">',c+='<div class="widget-wrap text-wrap">',(t.prefix||t.unit)&&(c+='<div class="widget-table-wrap text-table-wrap">'),c+='<span class="text-wrap-before"></span>',t.prefix&&(c+='<div class="text-wrap-prefix">',c+='<span class="text-prefix">'+t.prefix+"</span>",c+="</div>"),c+='<span class="text-wrap-inner"><input type="text" '+i+"/></span>",c+='<span class="text-wrap-after"></span>',t.unit&&(c+='<span class="text-wrap-unit">'+t.unit+"</span>"),t.hint&&(c+='<span class="hint text-hint-inner">',c+='<input class="text-hint" value="'+t.hint+'" tabindex="-1" contenteditable="false" readonly="readonly"/>',c+="</span>"),(t.prefix||t.unit)&&(c+="</div>"),c+="</div>",""!=t.shortTips&&null!=t.shortTips&&t.shortTips!=undefined&&(c+='<div class="widget-short-tips textbox-short-tips">',c+='<div class="content short-tips-content">'+t.shortTips+"</div>",c+="</div>"),""!=t.tips&&null!=t.tips&&t.tips!=undefined&&(c+='<div class="widget-tips textbox-tips '+t.tipsCls+'">',c+='<div class="content tips-content">'+t.tips+"</div>",c+="</div>"),c+='<div widget="errortip" error-cls="'+t.errorTipsCls+'">',c+="</div>",t.addon&&(c+='<div class="widget-addon">',c+='<span class="addon-content">'+t.addon+"</span>",c+="</div>"),c+="</div>",t.tipText&&(c+='<div widget="toolTip"></div>',e.addClass("has-tool-tip")),e.empty().append(c)},setMaxLength:function(e){var t=this.dom();e=parseInt(e,10),"number"===$.type(e)&&t.find(".text-wrap-inner input").attr("maxlength",e)},focus:function(){this.dom().find(".text-wrap-inner input").focus()},disable:function(){var e=this.dom();this.getContainer().addClass("disabled"),e.find(".text-wrap-inner input").prop("disabled",!0),e.triggerHandler("ev_view_disable")},enable:function(){var e=this.dom();this.getContainer().removeClass("disabled"),e.find(".text-wrap-inner input").prop("disabled",!1),e.triggerHandler("ev_view_enable")},setValue:function(e){if(this.getValue()!==e){var t=this.dom();t.find(".text-wrap-inner input").val(e),""!=e&&null!=e&&t.find(".text-hint-inner").hide()}},getValue:function(){var e=this.dom().find(".text-wrap-inner input");if(1<e.length){var t=[];return e.each(function(){t.push($(this).val())}),t}return e.val()},setAddon:function(e){e=e||this.settings.addon;var t=this.dom().find("div.widget-addon"),i=this.getContainer()||this.dom(),n=this.dom().find(".widget-tips");i.removeClass("error dirty correct"),this.errortip&&this.errortip.hide(),""!=e&&e&&(n.hide(),$.su.isIe?t.show():t.fadeIn(150))},setError:function(e){var t=this.dom(),i=this.getContainer(),n=t.find("div[widget=errortip]"),s=t.find(".widget-tips");if(i&&!this.isDisabled()){if(s.hide(),this.errortip)e&&this.errortip.show(e);else if(0<n.length&&i){var a=i.children(".widget-wrap-outer").children("div[widget=errortip]");a.get(0)&&($(a[0]).attr("id",this.domId+"_errortip"),this.errortip=$(a[0]).errortip({type:this.type})[0],this.errortip.render(),e&&this.errortip.show(e))}i.removeClass("valid").addClass("error"),i.find("span.widget-validate-icon").css({"display":"inline-block"})}},setNormal:function(){var e=this.dom(),t=(this.settings,this.getContainer()||e),i=(e.find("div[widget=errortip]"),e.find(".widget-tips"));t&&(t.removeClass("focus error disable dirty correct"),t.find("span.widget-validate-icon").css({"display":"none"}),t.find("div.widget-addon").hide(),this.errortip&&this.errortip.hide(),0<i.length&&($.su.isIe?i.show():i.fadeIn(150)))},setPrefix:function(e){this.dom().find(".text-prefix").html(e)}}),$.su.Widget.register("displaylabel",{settings:{readOnly:{attribute:"read-only",defaultValue:!1},tipText:{attribute:"tip-text",defaultValue:""},text:{attribute:"text",defaultValue:""},renderer:{attribute:"renderer",defaultValue:function(e){return null==e?"":e}}},init:function(){},render:function(){var e=this.dom(),t=this.settings,i=!1===t.labelField?"label-empty":"";e.addClass(t.cls+"displaylabel-container "+i);var n="";null!==t.labelField&&(n+='<div class="widget-fieldlabel-wrap '+t.labelCls+'">',n+='<div class="widget-fieldlabel-inner">',n+='<label class="widget-fieldlabel text-fieldlabel">'+t.labelField+"</label>",t.labelField&&(n+='<span class="widget-separator">'+t.separator+"</span>"),n+="</div>",n+="</div>"),n+='<div class="widget-wrap-outer text-wrap-outer">',n+='<div class="widget-wrap text-wrap">',n+='<span class="text-wrap-before"></span>',null!==t.text?n+='<span class="text-wrap-display">'+t.text+"</span>":n+='<span class="text-wrap-display"></span>',n+='<span class="text-wrap-after"></span>',n+="</div>",n+='<div widget="errortip" error-cls="'+t.errorTipsCls+'">',n+="</div>",null!=t.tips&&t.tips!=undefined&&(n+='<div class="widget-tips textbox-tips '+t.tipsCls+'">',n+='<div class="content tips-content">'+t.tips+"</div>",n+="</div>"),n+="</div>",t.tipText&&(n+='<div widget="toolTip"></div>'),e.append(n)},setValue:function(e){var t=this.dom();e=this.settings.renderer(e),t.find("span.text-wrap-display").text(e)},getValue:function(){return this.dom().find("span.text-wrap-display").text()}}),$.su.Widget.register("combobox",{settings:{name:{attribute:"name",defaultValue:""},labelField:{attribute:"label-field",defaultValue:""},multiSelect:{attribute:"multi-select",defaultValue:"single"},displayField:{attribute:"display-field",defaultValue:"name"},valueField:{attribute:"value-field",defaultValue:"value"},tipText:{attribute:"tip-text",defaultValue:""},editable:{attribute:"editable",defaultValue:!1},readOnly:{attribute:"read-only",defaultValue:!1},noneSelectedRemind:{attribute:"none-selected-remind",defaultValue:!0},noneSelectedText:{attribute:"none-selected-text",defaultValue:$.su.CHAR.COMMON.PLEASE_SELECT},widthAuto:{attribute:"width-auto",defaultValue:!1},wrapText:{attribute:"wrap-text",defaultValue:!1}},listeners:[{selector:"a.combobox-switch",event:"click",callback:function(e,t){t.dom().find("input.combobox-text").focus()}},{selector:"div.combobox-wrap",event:"click",callback:function(e,t){e.stopPropagation(),$.su.isMobile()||t._handleToggle()}},{selector:"div.combobox-wrap",event:"mousedown",callback:function(e,t){e.stopPropagation()}},{selector:"div.combobox-wrap",event:"mouseenter",callback:function(e,t){t.dom().addClass("hover")}},{selector:"div.combobox-wrap",event:"mouseleave",callback:function(e,t){t.dom().removeClass("hover")}},{selector:"input.combobox-text",event:"click",callback:function(e){e.preventDefault()}},{selector:"input.combobox-text",event:"focus",callback:function(e,t){var i=t.getContainer();i.hasClass("disabled")||i.hasClass("none-items")||(t.setFocus(),i.addClass("focus"))}},{selector:"input.combobox-text",event:"keyup",callback:function(e,t){var i=t.getContainer(),n=i.find("input.combobox-text").val(),s=i.find("input.combobox-checkbox");i.find("li").removeClass("selected"),s.prop("checked",!1),s.each(function(e,t){if($(t).val()==n)return $(t).prop("checked",!0),$(t).closest("li.combobox-list").addClass("selected"),!1})}},{selector:"input.combobox-text",event:"keyup",callback:function(e,t){if(t.settings.editable){var i=t.dom().find("input.combobox-text").val();t.dom().triggerHandler("ev_view_change",[{"type":"value","value":i}])}}},{selector:"input.combobox-text",event:"blur",callback:function(e,t){t.dom().find("input.combobox-text").val(),t.dom().removeClass("focus")}}],init:function(){this._defaultValue=null,this._dataMap={},this._displayMap={},this._value=[]},render:function(){var e=this.dom(),t=this.settings,i=!0===t.editable&&"single"===t.multiSelect?"":'readonly="true"',n=!1===t.labelField?" label-empty":"",s=t.readOnly?" readonly":"",a=t.tips?" tips":"",r=""===t.shortTips?"":" short-tips";e.addClass(t.cls+"combobox-container "+t.multiSelect+n+s+a+r);var o="";null!==t.labelField&&(o+='<div class="widget-fieldlabel-wrap '+t.labelCls+'">',o+='<div class="widget-fieldlabel-inner">',o+='<label class="widget-fieldlabel combobox-fieldlabel">'+("false"===t.labelField?"":t.labelField)+"</label>",t.labelField&&(o+='<span class="widget-separator">'+t.separator+"</span>"),o+="</div>",o+="</div>"),o+='<div class="widget-wrap-outer combobox-wrap-outer">',o+='<div class="widget-wrap combobox-wrap">',o+='<span class="text-wrap-before"></span>',t.widthAuto?o+='<span class="combobox-text '+t.inputCls+'"></span>':(o+='<span class="combobox-wrap-inner">',o+='<input class="combobox-text '+t.inputCls+'" type="text" tabindex="-1" '+i+' value="'+(t.noneSelectedRemind?t.noneSelectedText:"")+'" />',o+="</span>"),o+='<a class="combobox-switch" href="javascript:void(0);" tabindex="'+t.tabindex+'">',o+='<span class="icon"></span>',o+="</a>",0===$("#global-combobox-options").children().length&&$("#global-combobox-options").append('<div class="combobox-list-wrap"><div class="position-top-left"></div><div class="position-top-center"></div><div class="position-center-left"><div class="position-center-right"><div class="combobox-list-content-wrap"><ul class="combobox-list"></ul></div></div></div><div class="position-bottom-left"></div><div class="position-bottom-center"></div></div>'),o+='<div class="hidden combobox-lists"></div>',o+='<span class="text-wrap-after"></span>',o+="</div>",""!=t.shortTips&&null!=t.shortTips&&t.shortTips!=undefined&&(o+='<div class="widget-short-tips combobox-short-tips">',o+='<div class="content short-tips-content">'+t.shortTips+"</div>",o+="</div>"),o+='<div widget="errortip" error-cls="'+t.errorTipsCls+'">',o+="</div>",""!=t.tips&&null!=t.tips&&t.tips!=undefined&&(o+='<div class="widget-tips combobox-tips '+t.tipsCls+'">',o+='<div class="content tips-content">'+t.tips+"</div>",o+="</div>"),o+="</div>",t.tipText&&(o+='<div widget="toolTip"></div>'),e.append(o),t.items&&0<t.items.length&&this.loadItems(t.items);var d=$("#global-combobox-options .combobox-list-content-wrap");0===d.find(".ps__rail-y").length&&$.su.scrollbar({ele:d[0]})},loadItems:function(e){var t,i=this.dom(),n=this.settings,s=this.getContainer();$.isArray(e)||(e=[]);for(var a="",r=0,o=(n.items=e).length;r<o;r++)e[r]&&(a+=this.initItemHtml(r,e[r]),e[r].selected&&(t=e[r][n.valueField],t=this.convertValue(t),this._defaultValue=t));i.find("div.combobox-lists").html(a),this.setValue(t),0==e.length?s.addClass("none-items"):s.removeClass("none-items"),i.triggerHandler("ev_view_update")},initItemHtml:function(e,t){var i=this.settings,n=(this.dom(),i.multiSelect),s=this.domId+"-"+$.su.randomId("option"),a=t[i.displayField],r=t[i.valueField],o=!!t.disabled,d=!!t.selected,l=t.cls||"";this._dataMap[e]=r,this._displayMap[r]=a;var c="";return c+='<li class="combobox-list '+l+" "+(o?"disabled":"")+" "+(d?"selected":"")+'">',c+='<label for="'+s+'" type="'+n+'" class="combobox-label '+n+'">',c+='<input id="'+s+'" name="'+i.name+'" display="'+a+'" class="combobox-checkbox" type="checkbox" data-index="'+e+'" '+(d?' checked="checked"':"")+" "+(o?'disabled="disabled"':"")+" />",c+='<span class="icon"></span>',c+='<span class="text">'+a+"</span>",c+="</label>",c+="</li>"},getLiIndex:function(e){for(var t in this._dataMap)if(this._dataMap.hasOwnProperty(t)&&e===this._dataMap[t])return t;return!1},setValue:function(e){var t,i,n=$("#global-combobox-options"),s=this.settings;if(null===e){if(this._defaultValue!==undefined&&null!==this._defaultValue)return void this.dom().triggerHandler("ev_view_change",[{"type":"record","value":this._defaultValue}]);e=this._defaultValue}if(e=this.convertValue(e),this._value=$.su.clone(e),"multiple"===s.multiSelect){t=[];for(var a=0;a<e.length;a++)i=this._displayMap[e[a]]||e[a],t.push(i);t=t.join(",")}else"single"===s.multiSelect&&(t=this._displayMap[e]||s.noneSelectedText);this.setText(t),n.attr("data-shown")===this.domId&&this.setOptionsSelected()},setOptionsSelected:function(){this.dom();var s=this,e=this.settings,t=$("#global-combobox-options").find("input.combobox-checkbox"),a=$.isArray(this._value)?this._value:[this._value];if("multiple"===e.multiSelect){var r=function(){for(var e={},t=0;t<a.length;t++)e[a[t]]=!0;return e}();t.each(function(e,t){var i=$(t),n=i.attr("data-index");s._dataMap[n]in r?(i.closest("li.combobox-list").addClass("selected"),t.checked=!0):(i.closest("li.combobox-list").removeClass("selected"),t.checked=!1)})}else"single"===e.multiSelect&&(a=a[0],t.each(function(e,t){var i=$(t),n=i.attr("data-index");s._dataMap[n]===a?(i.closest("li.combobox-list").addClass("selected"),t.checked=!0):(i.closest("li.combobox-list").removeClass("selected"),t.checked=!1)}))},convertValue:function(e){var t=this.settings;return"array"!==$.type(e)&&"multiple"===t.multiSelect&&(e=null==e?[]:[e]),e},setText:function(e){var t=this.getContainer(),i=t.find("input.combobox-text"),n=t.find("span.combobox-text");e=this.settings.wrapText?"("+e+")":e,0<i.length?i.val(e):0<n.length&&n.text(e)},getText:function(){var e=this.getContainer().find("input.combobox-text");return e.val()===undefined?"":e.val()},setReadOnly:function(e){var t=this.getContainer();e?t.addClass("readonly"):t.removeClass("readonly")},enable:function(){var e=this.getContainer();e.removeClass("disabled"),e.find("input.combobox-text").removeAttr("disabled"),e.find("input.combobox-checkbox").prop("disabled",!1),e.triggerHandler("ev_view_enable")},disable:function(){var e=this.getContainer();e.addClass("disabled"),e.find("input.combobox-text").attr("disabled",!0),e.find("input.combobox-checkbox").prop("disabled",!0),e.triggerHandler("ev_view_disable")},enableItems:function(e){this.toggleItems(e,!0)},disableItems:function(e){this.toggleItems(e,!1)},hideItems:function(e){if(e===undefined)return this.disable();for(var t,i,n,s=this.dom(),a=$("#global-combobox-options"),r=s.find("div.combobox-lists"),o=0,d=(e=$.isArray(e)?e:[e]).length;o<d;o++)!1!==(t=this.getLiIndex(e[o]))&&((i=(n=r.find("input.combobox-checkbox[data-index="+t+"]")).closest("li")).addClass("hidden"),i.addClass("disabled"),n.attr("disabled","disabled"));if(a.attr("data-shown")===this.domId){var l=r.eq(0).html();a.find("ul.combobox-list").html(l),this.setOptionsSelected()}},toggleItems:function(e,t){if(e===undefined)return this.disable();for(var i,n,s,a=this.dom(),r=$("#global-combobox-options"),o=a.find("div.combobox-lists"),d=0,l=(e=$.isArray(e)?e:[e]).length;d<l;d++)!1!==(i=this.getLiIndex(e[d]))&&(n=(s=o.find("input.combobox-checkbox[data-index="+i+"]")).closest("li"),t?(n.removeClass("disabled"),s.removeAttr("disabled")):(n.addClass("disabled"),s.attr("disabled","disabled")));if(r.attr("data-shown")===this.domId){var c=o.eq(0).html();r.find("ul.combobox-list").html(c),this.setOptionsSelected()}},getValue:function(){var e=this.dom(),t=this.settings,i=(e.find("input.combobox-checkbox"),$.isArray(this._value)?$.su.clone(this._value):[this._value]);return"single"===t.multiSelect&&(i=0<i.length?i[0]:t.noneSelectedText,1==t.editable&&(i=e.find("input.combobox-text").val())),i},_handleToggle:function(){var s=this,e=s.dom(),t=e.find("a.combobox-switch"),i=(e.find(".widget-wrap.combobox-wrap"),t.next("div.combobox-list-wrap"),s.getContainer()),a=$("#global-combobox-options"),n=a.attr("data-shown")===s.domId?"shown":"hidden";if(i.hasClass("disabled")||i.hasClass("none-items")||i.hasClass("readonly"))return!1;s.setFocus(),i.addClass("focus"),i.removeClass("error"),"hidden"===n?("single"==s.settings.multiSelect?a.addClass("single"):a.removeClass("single"),"single"===s.settings.multiSelect?e.off("focusout","div.combobox-wrap-outer").on("focusout","div.combobox-wrap-outer",function(e){var t=a.offset(),i=a.find(".combobox-list-wrap").width(),n=a.find(".combobox-list-wrap").height();(s._xx<t.left||s._xx>t.left+i||s._yy<t.top||s._yy>t.top+n)&&s.hideGlobalOptions()}):$("html").on("click","div:not(.combobox-list-wrap)",s.hideGlobalOptions),s._bindGlobalEvent(),s.showGlobalOptions()):s.hideGlobalOptions()},_bindGlobalEvent:function(){var l=this;$("#global-combobox-options").off("click","label.combobox-label").on("click","label.combobox-label",function(e){e.stopPropagation(),e.preventDefault();var t=$(this),i=t.closest("li.combobox-list"),n=l.getContainer(),s=t.find("input.combobox-checkbox"),a=l._dataMap[s.attr("data-index")],r=l.getValue(),o=[];if(!i.hasClass("disabled")&&!n.hasClass("readonly")){switch(l.settings.multiSelect){case"multiple":if(s.prop("checked")){if(0<r.length)for(var d=r.length-1;0<=d;d--)if(r[d]==a){r.splice(d,1);break}}else r.push(a);o=r;break;case"single":o=a,l.hideGlobalOptions(),n.addClass("selected"),n.removeClass("focus")}l.dom().triggerHandler("ev_view_change",[{"type":"value","value":o},l.getValue()])}})},showGlobalOptions:function(){var t=this,e=t.dom(),i=t.settings,n=e.find(".widget-wrap.combobox-wrap"),s=$("#global-combobox-options"),a=n.offset(),r=$("body").offset(),o=e.find("div.combobox-lists").eq(0).html(),d=s.find("div.combobox-list-wrap");s.find("ul.combobox-list").html(o),i.widthAuto?s.addClass("nowrap"):s.removeClass("nowrap"),a.top+n.height()+d.outerHeight()+10>$(window).height()&&0<a.top-d.height()?s.css({"position":"absolute","width":i.widthAuto?"auto":n.outerWidth()+"px","left":a.left-r.left+"px","top":"auto","bottom":$(window).height()-a.top,"z-index":$.su.getMaxZIndex()+1}).addClass("down-to-up"):s.css({"position":"absolute","width":i.widthAuto?"auto":n.outerWidth()+"px","left":a.left-r.left+"px","top":a.top+n.height()+2+"px","bottom":"auto","z-index":$.su.getMaxZIndex()+1}).removeClass("down-to-up"),$.isIe?d.show():d.slideDown(150),s.attr("data-shown",t.domId),$("body").on("mousemove",t.getComboboxXy),t.toggleFlag="shown",t.setOptionsSelected();var l=s.find("li.selected"),c=$(s.find("li").get(0));if(0<l.length){var u=l.offset().top-c.offset().top;s.find("div.combobox-list-content-wrap").scrollTop(u)}else s.find("div.combobox-list-content-wrap").scrollTop(0);var h=s.find(".combobox-list-content-wrap").data("ps");h&&h.update(),$("div").not(function(){return $(s).find(this).length||$(s).is(this)||$(this).closest(".combobox-wrap-outer",e).length}).off(".combobox").one("scroll.combobox, mousedown.combobox",function(e){t.hideGlobalOptions(),$("div").off(".combobox")})},hideGlobalOptions:function(e){var t=this,i=$("#global-combobox-options");function n(){t.dom().triggerHandler("ev_view_change",[{"type":"valid","value":t._value}])}t.toggleFlag="hidden",t.dom().removeClass("focus"),i.attr("data-shown")===t.domId&&(!1===e||$.isIe?(i.find("div.combobox-list-wrap").hide(),n()):i.find("div.combobox-list-wrap").slideUp(150,n),i.attr("data-shown","_hidden_"),i.off("click","label.combobox-label"),$("body").off("mousemove",t.getComboboxXy))},getComboboxXy:function(e){e=e||window.event,this._xx=e.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,this._yy=e.clientY+document.body.scrollTop+document.documentElement.scrollTop},calculatePosition:function(){var e=this.dom(),t=$("#global-combobox-options"),i=e.find(".combobox-wrap"),n=i.offset(),s=$("body").offset(),a=t.find("div.combobox-list-wrap");n.top+i.height()+a.outerHeight()+10>$(window).height()?t.css({"position":"absolute","width":i.width()+"px","left":n.left-s.left+"px","top":n.top-a.height()-2+"px","z-index":$.su.getMaxZIndex()+1}):t.css({"position":"absolute","width":i.width()+"px","left":n.left-s.left+"px","top":n.top+i.height()+2+"px","z-index":$.su.getMaxZIndex()+1})}}),$.su.Widget.register("button",{settings:{text:{attribute:"text",defaultValue:""},iconCls:{attribute:"icon-cls",defaultValue:""},enableToggle:{attribute:"enable-toggle",defaultValue:!1},toggleHander:{attribute:"toggle-hander",defaultValue:null},pressedCls:{attribute:"pressed-cls",defaultValue:"pressed"},pressed:{attribute:"pressed",defaultValue:!1},btnCls:{attribute:"btn-cls",defaultValue:"button-button"},handler:{attribute:"handler",defaultValue:null},tipText:{attribute:"tip-text",defaultValue:""}},listeners:[{selector:"",event:"click",condition:function(e){var t=e.settings.enableToggle;return"true"===t||!0===t},callback:function(e,t){e.preventDefault();var i=$(this),n=t.settings,s=n.pressed;s="false"===s.toString()?(i.addClass(n.pressedCls),!0):(i.removeClass(n.pressedCls),!1),i.attr("pressed",s),n.pressed=s,"function"===$.type(n.toggleHander)&&n.toggleHander.call(this,s)}},{selector:"a.button-button",event:"mousedown",callback:function(e,t){if(e.stopPropagation(),!t.getContainer().hasClass("disabled")&&!t.getContainer().hasClass("clicked")){t.getContainer().addClass("clicked");var i=$(this),n=i.find(".button-moire"),s=i.outerWidth(),a=i.outerHeight(),r=Math.sqrt(s*s+a*a);n.css({width:2*r,height:2*r,left:e.offsetX-r,top:e.offsetY-r})}}},{selector:"a.button-button",event:"mouseup mouseleave",callback:function(e,t){e.stopPropagation(),t.getContainer().hasClass("clicked")&&setTimeout(function(){var e=t.getContainer();e&&e.removeClass("clicked")},200)}},{selector:"a.button-button",event:"click",callback:function(e,t){e.preventDefault(),t.getContainer().hasClass("disabled")?e.stopPropagation():t.dom().triggerHandler("ev_button_click")}}],init:function(e){},render:function(){var e=this.dom(),t=this.settings,i=t.btnCls||"",n=t.text||"",s=!1===t.labelField?"label-empty":"";e.addClass(t.cls+"button-container "+s);var a="";if(null!==t.labelField&&(a+='<div class="widget-fieldlabel-wrap '+t.labelCls+'">',a+='<div class="widget-fieldlabel-inner">',a+='<label class="widget-fieldlabel text-fieldlabel">'+t.labelField+"</label>",t.labelField&&(a+='<span class="widget-separator">'+t.separator+"</span>"),a+="</div>",a+="</div>"),a+='<div class="widget-wrap-outer button-wrap-outer">',a+='<div class="widget-wrap button-wrap">',a+='<a href="javascript:void(0);" class="'+i+'" type="button" title="'+n+'">',a+='<span class="button-button-before"></span>',""!==t.iconCls&&(a+='<span class="icon button-icon '+t.iconCls+'"></span>'),a+='<span class="text button-text">'+n+"</span>",a+='<span class="icon button-loading"></span>',a+='<span class="button-moire"></span>',a+="</a>",a+="</div>",null!=t.tips&&t.tips!=undefined&&(a+='<div class="widget-tips textbox-tips '+t.tipsCls+'">',a+='<div class="content tips-content"></div>',a+="</div>"),a+='<div widget="errortip" error-cls="'+t.errorTipsCls+'">',a+="</div>",a+="</div>",t.tipText&&(a+='<div widget="toolTip"></div>'),e.empty().append(a),!0===t.enableToggle){var r=t.pressed;e.attr("pressed",r),"true"===r.toString()&&e.addClass(t.pressedCls)}this.setTips(t.tips)},setText:function(e){var t=this.settings,i=this.getContainer(),n=i.find("a.button-button"),s=i.find("a.button-button span.button-text");e&&(t.text=e,s.html(e),n.attr("title",e))},getText:function(){return this.settings.text},setValue:function(e){},loading:function(e){var t=this.dom();!1===e?(t.removeClass("loading"),this.enable()):(t.addClass("loading"),this.disable())},setIconCls:function(e){this.dom().find(".button-icon").removeClass().addClass("icon button-icon "+e)},status:function(e){return e!==undefined&&(this.dom().removeClass(this.dom().data("status")),this.dom().data("status",e),this.dom().addClass(e)),this.dom().data("status")}}),$.su.Widget.register("file",{settings:{inputCls:{attribute:"input-cls",defaultValue:"l"},buttonCls:{attribute:"button-cls",defaultValue:"inline-block"},buttonText:{attribute:"button-text",defaultValue:$.su.CHAR.OPERATION.FILEBUTTONTEXT},blankText:{attribute:"blank-text",defaultValue:$.su.CHAR.OPERATION.FILEBLANKTEXT},extension:{attribute:"extension",defaultValue:"txt, ai, docx"},extensionErrorText:{attribute:"extension-error-text",defaultValue:$.su.CHAR.ERROR["00000074"]},tipText:{attribute:"tip-text",defaultValue:""},paramName:{attribute:"param-name",defaultValue:"file"},note:{attribute:"note",defaultValue:""}},listeners:[{selector:"div.file-button",event:"click",callback:function(e,t){var i=t.getContainer();e.preventDefault(),e.stopPropagation(),i.find("input.file-input").click()}},{selector:"label.file-text",event:"click",callback:function(e,t){var i=t.getContainer();e.preventDefault(),e.stopPropagation(),i.hasClass("disabled")||i.find("div.file-button").click()}},{selector:function(){return{parent:this.dom().find("input.file-input")}},event:"change",callback:function(e,t){var i=t.getContainer(),n=$(this).val(),s=n.toString().match(/.+(?=\\)/g);s=s&&s[0]&&s[0].length?n.substring(s[0].length+1):n,t.dom().triggerHandler("ev_file_change",[s]),i.find("label.file-text").html(s),i.find("label.file-text").attr("title",s)}}],init:function(){},render:function(){var e=this.dom(),t=this.settings;e.addClass(t.cls+"text-container file-container");var i="";null!==t.labelField&&(i+='<div class="widget-fieldlabel-wrap '+t.labelCls+'">',i+='<div class="widget-fieldlabel-inner">',i+='<label class="widget-fieldlabel text-fieldlabel">'+t.labelField+"</label>",""!==t.labelField&&(i+='<span class="widget-separator">'+t.separator+"</span>"),i+="</div>",i+="</div>"),i+='<div class="file-wrap-outer widget-wrap-outer">',i+='<div class="file-wrap widget-wrap">',i+='<div class="widget-wrap text-wrap">',i+='<span class="text-wrap-before"></span>',i+='<span class="text-wrap-inner">',i+='<label class="file-text text-text '+t.inputCls+'"></label>',i+="</span>",i+='<span class="text-wrap-after"></span>',i+="</div>",t.note&&(i+='<div class="note"><span>'+t.note+"</span></div>"),i+="</div>",i+='<div widget="errortip" error-cls="'+t.errorTipsCls+'">',i+="</div>",i+='<div class="button-container file-button-container '+t.buttonCls+'">',i+='<div widget="button" id="'+this.domId+'-btn" class="file-button" type="button" text="'+t.buttonText+'"></div>',i+="</div>",t.tips&&(i+='<div class="widget-tips textbox-tips '+t.tipsCls+'">',i+='<div class="content tips-content">'+t.tips+"</div>",i+="</div>"),i+="</div>",t.tipText&&(i+='<div widget="toolTip"></div>'),e.append(i);var n=this.getContainer(),s='<form method="post" id="'+this.domId+'_form" class="hidden" name="form" enctype="multipart/form-data"><input type="file" name="'+t.paramName+'" class="file-input"></form>';n.find("div.file-wrap").append($(s).prop("single",!0)),n.find("div.file-wrap").append('<div class="file-text-hover"></div>');var a=e.find("div[widget=button]")[0];this.btn=new $.su.widgets.button({id:$(a)}),this.btn.render(),this.setTips(t.tips)},getFile:function(){return this.dom().find("input.file-input")[0]},getFileName:function(){var e=this.dom().find("input.file-input");return e.val()===undefined?"":e.val()},getFileSize:function(){var e=this.dom().find("input.file-input");return e[0].files[0]?Math.round(e[0].files[0].size/1024/1024*100)/100:0},startUpload:function(){this.dom().addClass("disabled"),this.btn.loading(!0)},endUpload:function(){this.dom().removeClass("disabled"),this.btn.loading(!1)},isEmpty:function(){return""===this.getFileName()&&(this.setError($.su.CHAR.ERROR["00000001"]),!0)}}),$.su.Widget.register("progressbar",{settings:{text:{attribute:"text",defaultValue:""},unit:{attribute:"unit",defaultValue:"%"},_timeout:{attribute:"timeout",defaultValue:"0"},duration:{attribute:"duration",defaultValue:1e3},value:{attribute:"value",defaultValue:0},url:{attribute:"url",defaultValue:null},animate:{attribute:"animate",defaultValue:!0},showPercentage:{attribute:"show-percentage",defaultValue:!0},underText:{attribute:"under-text",defaultValue:null},infinite:{attribute:"infinite",defaultValue:!1},circle:{attribute:"circle",defaultValue:!1},fn:{attribute:"fn",defaultValue:null},ptype:{attribute:"ptype",defaultValue:"horizontal"},tipText:{attribute:"tip-text",defaultValue:""},step:{attribute:"step",defaultValue:!1},animateText:{attribute:"animate-text",defaultValue:""}},init:function(){var e=this.settings;!1!==e.step&&(e.step=parseInt(e.step,10))},render:function(){var e=this.dom(),t=this.settings,i=t.ptype,n=t.value,s=t.width,a=t.height,r=!1===t.labelField?"label-empty":"",o=t.infinite?" infinite-progress":"",d=t.circle?" circle-progress":"";e.addClass(t.cls+"progressbar-container progressbar-"+i+" "+r+o+d);var l="";null!==t.labelField&&(l+='<div class="widget-fieldlabel-wrap '+t.labelCls+'">',l+='<div class="widget-fieldlabel-inner">',l+='<label class="widget-fieldlabel processbar-fieldlabel">'+t.labelField+"</label>",t.labelField&&(l+='<span class="widget-separator">'+t.separator+"</span>"),l+="</div>",l+="</div>"),l+='<div class="widget-wrap-outer progressbar-wrap-outer">',l+='<div class="widget-wrap progressbar-wrap">',l+='<div class="widget-wrap progressbar-content">',l+='<div class="progressbar-value"></div>',l+="</div>",(""!=t.text||t.showPercentage)&&(l+='<div class="progressbar-text">',""!=t.text&&(l+='<span class="progressbar-text">'+t.text+"</span>"),t.showPercentage&&(l+='<span class="progressbar-percentage">'+n+t.unit+"</span>"),l+="</div>"),l+="</div>",null!=t.underText&&t.underText!=undefined&&(l+='<div class="progressbar-under-text-wrap">',l+='<div class="progressbar-under-text">',l+=t.underText,l+="</div>",l+="</div>"),l+='<div widget="errortip" error-cls="'+t.errorTipsCls+'">',l+="</div>",null!=t.tips&&t.tips!=undefined&&(l+='<div class="widget-tips textbox-tips '+t.tipsCls+'">',l+='<div class="content tips-content">'+t.tips+"</div>",l+="</div>"),l+="</div>",t.tipText&&(l+='<div widget="toolTip"></div>'),e.append(l),e.find("div.progressbar-content").css({width:s,height:a}),this.setTips(t.tips),this.childrenDom={},this.childrenDom.container=this.getContainer(),this.childrenDom.progressbarBox=this.childrenDom.container.find("div.progressbar-content"),this.childrenDom.progressbarBar=this.childrenDom.progressbarBox.children("div.progressbar-value"),this.childrenDom.percentageBox=this.childrenDom.container.find("span.progressbar-percentage")},getValue:function(){return this.settings.value},setValue:function(e,t){if(e!==undefined&&null!==e){var i=this.settings;i.prevValue=i.value,i.value=e,i.animate?this.animate({percentageStart:i.prevValue,percentageEnd:e,duration:t||i.duration}):this.updateViewByPercentageVal(e)}},animate:function(e){var s=this,a=this.settings,t=this.getContainer(),i=a.ptype,r=a.unit,o="horizontal"===i?"width":"height",n=null===e.percentageStart?0:e.percentageStart;n=parseInt(n,10);var d=parseInt(e.percentageEnd,10),l="number"===$.type(parseInt(e.duration,10))?parseInt(e.duration,10):500,c=e.callback||null,u=n||0,h=t.find("div.progressbar-content"),p=h.children("div.progressbar-value"),f=t.find("span.progressbar-percentage");h[o](),this.updateViewByPercentageVal(n);var v=parseInt(l/Math.abs(d-n),10),g=(new Date).getTime();clearInterval(a._timeout),a._timeout=setInterval(function(){var e,t=(new Date).getTime(),i=t-g,n=Math.round(i/v);g=t,u!=d?(u=d<u?(u-=n)<d?d:u:d<(u+=n)?d:u,a.percentageCurrent=u.toFixed(1)/100,!1!==a.step?s.updateViewByPercentageVal(u):(e="width"===o?{"width":u+r}:{"height":u+r},p.clearQueue().animate(e,v,function(){f.html(u+r)}),s.settings.value=u)):(clearInterval(a._timeout),a._timeout=0,s.updateViewByPercentageVal(d),c&&c.call(this))},v)},animateInfinite:function(e){this.underTextAnimate(e);var t=this.settings,i=this.getContainer(),n=(t.ptype,t.unit,i.find("div.progressbar-content").children("div.progressbar-value"));if(1!=t.circle)if(!1!==e){var s=function(){n.css({left:-n.width()}),n.clearQueue().animate({left:"100%"},4e3)};s(),clearInterval(t._timeout),t._timeout=setInterval(function(){s()},4e3)}else n.clearQueue(),clearInterval(t._timeout)},reset:function(){var e=this.settings,t=this.getContainer(),i=e.unit,n="horizontal"===e.ptype?"width":"height";this.stop();var s=t.find("div.progressbar-content").children("div.progressbar-value"),a=t.find("span.progressbar-percentage"),r="width"===n?{"width":0}:{"height":0};s.css(r),a.html(0+i),this.settings.value=0},stop:function(){clearInterval(this.settings._timeout)},setText:function(e){this.getContainer().find("span.progressbar-text").text(e)},hide:function(){this.getContainer().css("display","none")},show:function(){this.getContainer().fadeIn(150)},hideBar:function(){var e=this.dom();e.find("div.progressbar-content").hide(),e.addClass("hide-bar")},showBar:function(){var e=this.dom();e.find("div.progressbar-content").show(),e.removeClass("hide-bar")},updateViewByPercentageVal:function(e){var t=this.childrenDom,i=this.settings,n=(t.container,i.ptype),s=i.unit,a="horizontal"===n?"width":"height",r=(t.progressbarBox,t.progressbarBar),o=t.percentageBox,d=e+"%";!1!==i.step&&(d=(e*i.step/100).toFixed(0)/i.step+"%"),r.css(a,d),o.text(e+s),this.settings.value=e},setUnderText:function(e){var t=this.dom();if(null!==e&&e!==undefined){var i=t.find(".progressbar-under-text-wrap");""==e?i.hide():i.show().find(".progressbar-under-text").html(e)}},underTextAnimate:function(e){var t,i=this,n=this.dom();0!=(t=this.settings.animateText?$(this.settings.animateText):n.find(".progressbar-under-text")).length&&(!1!==e?(clearInterval(this.underTextTimer),this.underTextTimer=setInterval(function(){if(i.dom().is(":visible")){var e=t.text();/\.\.\.$/.test(e)?e=e.replace(/\.\.\.$/,""):e+=".",t.text(e)}else clearInterval(i.underTextTimer)},500)):clearInterval(this.underTextTimer))},destroy:function(){this.stop()}}),$.su.Widget.register("password",{settings:{hint:{attribute:"hint",defaultValue:null},validateIcon:{attribute:"validate-icon",defaultValue:!1},showLevel:{attribute:"show-level",defaultValue:!1},allowBlank:{attribute:"allow-blank",defaultValue:!0},_minLength:{attribute:"min-length",defaultValue:2},_maxLength:{attribute:"max-length",defaultValue:16},vtype:{attribute:"vtype",defaultValue:"password"},invalidText:{attribute:"invalid-text",defaultValue:$.su.CHAR.VTYPETEXT.INVALIDTEXT},blankText:{attribute:"blank-text",defaultValue:$.su.CHAR.VTYPETEXT.BLANKTEXT},allowVisible:{attribute:"allow-visible",defaultValue:!0},visibleDefault:{attribute:"visible-default",defaultValue:!1},readOnly:{attribute:"read-only",defaultValue:!1},tipText:{attribute:"tip-text",defaultValue:""}},listeners:[{selector:"input.password-text",event:"click focus",callback:function(e,t){e.preventDefault(),t.dom().find("input.password-hint").fadeOut(50),t.setFocus()}},{selector:".text-wrap, .allow-visible-wrapper",event:"mouseenter",callback:function(e,t){t.dom().addClass("hover")}},{selector:".text-wrap, .allow-visible-wrapper",event:"mouseleave",callback:function(e,t){t.dom().removeClass("hover")}},{selector:"input.password-text",event:"blur",callback:function(e,t){var i=t.dom(),n=t.settings,s=(n.encrypt,i.find("input.password-visible")),a=i.find("input.password-hidden"),r=i.find("input.password-hint"),o=n.passwordVisible?s.val():a.val();t.removeFocus(),o||r.css("display","inline"),t.dom().triggerHandler("ev_view_change",[{"type":"value","value":o}]),t.dom().triggerHandler("ev_view_change",[{"type":"valid","value":o}]),t.dom().triggerHandler("ev_password_blur")}},{selector:"input.password-text",event:"keyup input",callback:function(e,t){var i=$(this).val();t.levelCheck(),t.dom().triggerHandler("ev_view_change",[{"type":"value","value":i}])}},{selector:"span.allow-visible-btn",event:"click",callback:function(e,t){var i=t.dom(),n=t.settings,s=i.find("input.password-visible"),a=i.find("input.password-hidden"),r=(i.hasClass("disabled"),$(this)),o="";n.passwordVisible?(o=s.val(),a.val(o),s.css("display","none"),a.css("display","inline-block"),r.removeClass("visible"),n.passwordVisible=!1):(o=a.val(),s.val(o),a.css("display","none"),s.css("display","inline-block"),r.addClass("visible"),n.passwordVisible=!0)}},{selector:"input.password-hint",event:"click focus",callback:function(e,t){e.preventDefault();var i=t.dom(),n=t.settings,s=i.find("input.password-visible"),a=i.find("input.password-hidden");return i.fadeOut(50,function(){n.passwordVisible?s.focus():a.focus()}),!1}}],init:function(){var e=this.settings;if(e.vtype){var t=e.vtype;e.vtypeText&&(e.vtype.vtypeText=e.vtypeText),e.vtype=t}},render:function(){var e=this.dom(),t=this.settings,i=""===t.tips?"":" tips",n=(t.shortTips,t.readOnly?'readonly="readonly"':""),s=t.allowVisible?" visible":"";e.addClass(t.cls+"text-container password-container "+i+s);var a="";null!==t.labelField&&(a+='<div class="widget-fieldlabel-wrap '+t.labelCls+'">',a+='<div class="widget-fieldlabel-inner">',a+='<label class="widget-fieldlabel text-fieldlabel password-fieldlabel">'+t.labelField+"</label>",""!==t.labelField&&(a+='<span class="widget-separator">'+t.separator+"</span>"),a+="</div>",a+="</div>"),a+='<div class="widget-wrap-outer text-wrap-outer password-wrap-outer '+(t.allowVisible?"allow-visible":"")+'">',a+='<div class="widget-wrap text-wrap password-wrap">',a+='<span class="text-wrap-before"></span>',a+='<span class="text-wrap-inner password-wrap ">',a+='<input type="password" '+n+' class="text-text password-text password-hidden '+(t.visibleDefault?"hidden ":" ")+t.inputCls+'" oncontextmenu="return false" />',t.allowVisible&&(t.passwordVisible=t.visibleDefault,a+='<input type="text" '+n+' class="text-text password-text password-visible '+(t.visibleDefault?" ":"hidden ")+t.inputCls+'" oncontextmenu="return false" oncopy="return false" />'),a+="</span>",t.hint&&(a+='<span class="hint text-hint password-hint">',a+='<input class="text-hint password-hint '+t.inputCls+'" value="'+t.hint+'" contenteditable="false" readonly="readonly"/>',a+="</span>"),t.showLevel&&(a+='<div class="password-level hidden '+t.inputCls+'">',a+='<span class="level low">'+$.su.CHAR.OPERATION.LOW+"</span>",a+='<span class="level middle">'+$.su.CHAR.OPERATION.MIDDLE+"</span>",a+='<span class="level high">'+$.su.CHAR.OPERATION.HIGH+"</span>",a+="</div>"),a+='<span class="text-wrap-after"></span>',a+="</div>",t.validateIcon&&(a+='<span class="widget-validate-icon"></span>'),""!=t.shortTips&&null!=t.shortTips&&t.shortTips!=undefined&&(a+='<div class="widget-short-tips textbox-short-tips">',a+='<div class="content short-tips-content">'+t.shortTips+"</div>",a+="</div>"),""!=t.tips&&null!=t.tips&&t.tips!=undefined&&(a+='<div class="widget-tips textbox-tips '+t.tipsCls+'">',a+='<div class="content tips-content">'+t.tips+"</div>",a+="</div>"),t.allowVisible&&(a+='<div class="allow-visible-wrapper">',a+='<span class="icon allow-visible-btn '+(t.visibleDefault?"visible":"")+'"></span>',a+='<span class="text allow-visible-text">'+$.su.CHAR.OPERATION.SHOW+"</span>",a+="</div>"),a+='<div widget="errortip" error-cls="'+t.errorTipsCls+'">',a+="</div>",a+="</div>",t.tipText&&(a+='<div widget="toolTip"></div>'),e.append(a),e.find("div.progressbar-container").addClass("hidden");var r=this.getContainer(),o=r.find("input.password-hidden"),d=r.find("input.password-visible"),l=r.find("input.password-hint");r.find("input.password-level"),t.visibleDefault?(d.css("display","inline-block"),o.css("display","none")):(d.css("display","none"),o.css("display","inline-block")),setTimeout(function(){""!=o.val()&&l.css("display","none")},100),this.setTips(t.tips)},levelCheck:function(){var e=this.settings;if(e.showLevel){var t,i=this.getContainer(),n=i.find("input.password-visible"),s=i.find("input.password-hidden"),a="",r=(a=e.passwordVisible?n.val():s.val()).length;t=(/[A-Z]/g.test(a)?1:0)+(/[a-z]/g.test(a)?1:0)+(/[0-9]/g.test(a)?1:0)+(10<=r?1:0)+(/[\`\~\!\@\#\$\%\^\&\*\(\)\-\=\_\+\[\]\{\}\;\:\'\"\\\|\/\?\.\,<\>\x20]/g.test(a)?1:0);var o=0;r<=5?t<=2?o=1:3!=t&&4!=t||(o=2):t<=1?o=1:2==t||3==t?o=2:4<=t&&(o=3);var d=i.find("div.password-level");d.removeClass("level-0 level-1 level-2 level-3"),""!==a?(d.fadeIn(100).addClass("level-"+o).removeClass("hidden"),i.addClass("level")):(d.hide().addClass("hidden"),i.removeClass("level"))}},setValue:function(e){this.dom().find("span.password-wrap input").val(e),this.levelCheck()},getValue:function(){return this.dom().find("span.password-wrap input").val()},setMaxLength:function(e){var t=this.dom();e=parseInt(e,10),"number"===$.type(e)&&t.find("span.password-wrap input").attr("maxlength",e)},disable:function(){var e=this.getContainer(),t=e.find("input.password-text");e.addClass("disabled"),t.prop("disabled",!0),e.triggerHandler("ev_view_disable")},enable:function(){var e=this.getContainer(),t=e.find("input.password-text");e.removeClass("disabled"),t.prop("disabled",!1),e.triggerHandler("ev_view_enable")},setCorrect:function(){this.setNormal(),this.getContainer().addClass("correct")},setError:function(e){var t=this.dom(),i=this.getContainer(),n=t.find("div[widget=errortip]"),s=t.find(".widget-tips");if(i&&!this.isDisabled()&&e){if(s.hide(),this.errortip)this.errortip.show(e);else if(0<n.length&&i){var a=i.children(".widget-wrap-outer").children("div[widget=errortip]");a.get(0)&&($(a[0]).attr("id",this.domId+"_errortip"),this.errortip=$(a[0]).errortip({type:this.type})[0],this.errortip.render(),this.errortip.show(e))}i.removeClass("valid").addClass("error"),i.find("span.widget-validate-icon").css({"display":"inline-block"})}},setNormal:function(){var e=this.dom(),t=(this.settings,this.getContainer()||e),i=(e.find("div[widget=errortip]"),e.find(".widget-tips"));t&&(t.removeClass("focus error disable dirty correct"),t.find("span.widget-validate-icon").css({"display":"none"}),this.errortip&&this.errortip.hide(),0<i.length&&($.su.isIe?i.show():i.fadeIn(150)))}}),$.su.Widget.register("fieldset",{settings:{legend:{attribute:"legend",defaultValue:""},disableOnHide:{attribute:"disable-on-hide",defaultValue:!0},enableOnShow:{attribute:"enable-on-show",defaultValue:!1},showValue:{attribute:"show-value",defaultValue:null},enableValue:{attribute:"enable-value",defaultValue:null},parentEnabled:{defaultValue:!0},selfEnabled:{defaultValue:!0},autoExpand:{attribute:"auto-expand",defaultValue:!0}},listeners:[{selector:"div.legend",event:"click",callback:function(e,t){e.preventDefault(),e.stopPropagation();var i=t.getContainer();i.hasClass("expand")?i.removeClass("expand").addClass("collapse"):i.hasClass("collapse")?i.removeClass("collapse").addClass("expand"):i.addClass("collapse")}}],init:function(){},render:function(){var e=this.dom(),t=this.settings;e.addClass(t.cls+"fieldset-container"),t.autoExpand?e.addClass("expand"):e.addClass("collapse");var i="";i+='<div class="legend">',i+='<div class="fieldset-img"></div>',i+='<div class="fieldset-text">'+t.legend+"</div>",i+="</div>",i+='<div class="fieldset-content"></div>';var n=e.children("div");e.append(i),e.find("div.fieldset-content").eq(0).append(n);var a=[];!function r(e){for(var t=$(e).children("div"),i=0,n=t.length;i<n;i++)if($(t[i]).attr("widget")){var s={id:$(t[i]).attr("id"),type:$(t[i]).attr("widget")};a.push(s)}else r(t[i])}(e.find("div.fieldset-content").get(0)),this.fields=a},hide:function(e){var t=this.dom(),i=this.settings;"true"!==i.disableOnHide&&!0!==i.disableOnHide||this.disable(),t.stop(!0).hide(),this.setStatus("shown",!1),e&&e.call(t)},show:function(e){var t=this.dom(),i=this.settings;this.setStatus("shown",!0),$.su.isIe?(t.show(),"true"!==i.enableOnShow&&!0!==i.enableOnShow||this.enable(),e&&e()):(t.fadeIn(200,e),"true"!==i.enableOnShow&&!0!==i.enableOnShow||this.enable())},setValue:function(e){var t=this.settings;t.data=e,null!==t.showValue&&(e==t.showValue?this.show():this.hide()),null!==t.enableValue&&(e==t.enableValue?this.enable():this.disable())},getValue:function(){return this.settings.data},disable:function(e,t){var i=this.getContainer(),n=this.fields;!0===e||e===undefined?this.settings.selfEnabled=!1:this.settings.parentEnabled=!1,i.addClass("disabled");for(var s=0,a=n.length;s<a;s++){var r=n[s];if(r){var o=$("#"+r.id);if(r.type,0<o.length)try{o.data("viewObj").disable(!1)}catch(d){}}}t&&t.call(this)},enable:function(e,t){var i=this.getContainer(),n=this.fields;if(!1===e?this.settings.parentEnabled=!0:this.settings.selfEnabled=!0,!1!==this.settings.parentEnabled&&(!1!==this.settings.selfEnabled||!1!==e)){i.removeClass("disabled");for(var s=0,a=n.length;s<a;s++){var r=n[s];if(r){var o=$("#"+r.id);if(r.type,0<o.length)try{o.data("viewObj").enable(!1)}catch(d){}}}this.setStatus("disabled",!1),t&&t.call(this)}},expand:function(e){var t=this.getContainer();e?t.removeClass("collapse").addClass("expand"):t.removeClass("expand").addClass("collapse")}}),$.su.Widget.register("paragraph",{settings:{text:{attribute:"text",defaultValue:""}},init:function(){},render:function(){var e=this.dom(),t=this.settings,i=t.labelField?"":"label-empty";e.addClass(t.cls+" "+i+" paragraph-container");var n="";t.labelField&&(n+='<div class="widget-fieldlabel-wrap '+t.labelCls+(0==/\S/.test(t.labelField)?" empty":"")+'">',n+='<label class="widget-fieldlabel text-fieldlabel">'+t.labelField+"</label>",t.labelField&&(n+='<span class="widget-separator">'+t.separator+"</span>"),n+="</div>"),n+='<div class="widget-wrap-outer paragraph-wrap-outer">',n+=t.text,n+="</div>",e.html(n)},setText:function(e){var t=this.settings,i=this.getContainer().find("div.paragraph-wrap-outer");e&&(t.text=e,i.html(e))},getText:function(){return this.getContainer().find("div.paragraph-wrap-outer").text()},setStatus:function(e,t){var i=this.getContainer();i.removeClass("error link correct"),i.addClass(e),this.setText(t)},setHtml:function(e){this.dom().find("div.paragraph-wrap-outer").html(e)},hide:function(){this.dom().css("display","none")},show:function(){this.dom().css("display","block")},textAnimate:function(e){var t=this;!1!==e?(clearInterval(this.underTextTimer),this.underTextTimer=setInterval(function(){if(t.dom().is(":visible")){var e=t.getText();/\.\.\.$/.test(e)?e=e.replace(/\.\.\.$/,""):e+=".",t.setText(e)}else clearInterval(t.underTextTimer)},500)):clearInterval(this.underTextTimer)}}),$.su.Widget.register("errortip",{settings:{errorCls:{attribute:"error-cls",defaultValue:""}},listeners:[{selector:"span.widget-error-tips-delta",event:"mouseenter",callback:function(e,t){t.dom().find("div.widget-error-tips-wrap").addClass("hover"),t.animate()}},{selector:"span.widget-error-tips-delta",event:"mouseleave",callback:function(e,t){t.dom().find("div.widget-error-tips-wrap").removeClass("hover")}}],init:function(e){var t=this.dom();switch(e.type){case"errortip":case"fieldset":case"form":case"msg":return!1;case"textbox":case"password":t.addClass("textbox-error-tips");break;case"button":case"checkbox":case"combobox":case"displaylabel":case"radio":t.addClass(e.type+"-error-tips")}},render:function(){var e=this.dom(),t=this.settings;e.append('<span class="widget-error-tips-delta"></span><div class="widget-error-tips-wrap"><span class="widget-error-tips-delta"></span><div class="content error-tips-content"></div></div>'),e.addClass(t.errorCls+" widget-error-tips")},show:function(e){var t=this.dom();t.find("div.widget-error-tips-wrap"),t.find("div.error-tips-content"),""==e||this.animate(e)},showHtml:function(e){var t=this.dom();t.find("div.widget-error-tips-wrap"),t.find("div.error-tips-content"),""==e||this.animate(e,!0)},animate:function(e,t){var i=this.dom(),n=(i.find("div.widget-error-tips-wrap"),i.find("div.error-tips-content"));"string"===$.type(e)&&(t?n.html(e):n.text(e)),i.addClass("show"),$.su.isIe?i.show():i.fadeIn(150)},hide:function(){var e=this.dom();e.find("div.widget-error-tips-wrap"),e.find("div.error-tips-content"),e.removeClass("show").stop(!0).hide()}}),$.su.Widget.register("toolTip",{settings:{tipText:{attribute:"tip-text",defaultValue:""},iconCls:{attribute:"icon-cls",defaultValue:""},sizeMapping:{attribute:"size-mapping",defaultValue:{}}},listeners:[{selector:"span.tooltip-icon, div.tip-text-container",event:"click",callback:function(e,t){e.stopPropagation(),t.dom().find("div.tip-text-container"),$("#global-tips-text").hasClass("show")?t.hideTips():t.showTips()}}],init:function(e){$.extend(this.settings,e)},render:function(){var e=this.dom(),t=this.settings;e.addClass(t.cls+"tooltip-container");var i="";i+='<div class="widget-wrap-outer tooltip-wrap-outer">',i+='<div class="widget-wrap tooltip-wrap">',i+='<div class="tooltip-icon-container">',i+='<span class="tooltip-icon-mask"></span>',i+='<span class="tooltip-icon '+t.iconCls+'"></span>',i+="</div>",i+='<div class="tip-text-container">',i+='<div class="tip-text-delta-container">',i+='<span class="icon-delta"></span>',i+="</div>",i+='<div class="tip-text-box">',i+='<p class="tip-text"></p>',i+="</div>",i+="</div>",i+="</div>",i+="</div>",e.append(i),e.find("div.tip-text-container").find("p.tip-text").html(t.tipText)},showTips:function(){var t=this,e=$("#global-tips-text");e.attr("data-shown",this.domId),$("div:not(.tooltip-container,.tooltip-container div, .global-tips-text, .global-tips-text div)").off(".toolTip").on("click.toolTip scroll.toolTip",function(e){t.hideTips(),$("div").off(".toolTip")}),e.empty().append(this.dom().find("div.tip-text-container").clone()),$.su.isIe?e.show().addClass("show"):e.fadeIn(150).addClass("show"),this.adjustLayout("s")},hideTips:function(){var e=$("#global-tips-text");$.su.isIe?e.hide().removeClass("show").attr("data-shown","_hidden_"):e.fadeOut(150,function(){e.removeClass("show").attr("data-shown","_hidden_")})},adjustLayout:function(e){var t=$("#global-tips-text");if(t.hasClass("show")){e=this.settings.sizeMapping[e]||e,t.css({width:"auto",left:-9999,top:-9999});var i=t.height(),n=t.width();t.removeClass("s m l xl").addClass(e);var s=this.dom(),a=t.find("div.tip-text-container"),r=a.height(),o=a.width(),d=s.find(".tooltip-icon-container"),l=d.offset(),c=d.height(),u=d.width(),h=t.find(".tip-text-delta-container"),p=h.height(),f=h.width();if(document.body.clientWidth,$("body").offset(),"s"==e){var v=$(s).closest(".panel-container"),g=v.offset(),m=v.width(),b=(v.outerWidth()-m)/2;t.css({width:m||$("body").width()-50,top:l.top-i,left:g.left+b}),h.css({left:l.left-t.offset().left+f/2,top:t.height()-12})}else"m"==e?(h.css({left:(o-f)/2,top:r}),i=t.height(),n=t.width(),t.css({top:l.top-i,left:l.left-(n-u)/2}),t.width()<n&&(t.css({top:l.top-t.height()}),h.css({top:a.height()}))):(h.css({top:(r-p)/2,left:-f}),i=t.height(),n=t.width(),t.css({left:l.left+u,top:l.top-(i-c)/2}))}}}),$.su.Widget.register("checkbox",{settings:{name:{attribute:"name",defaultValue:""},trueValue:{attribute:"true-value",defaultValue:!0},falseValue:{attribute:"false-value",defaultValue:!1},columns:{attribute:"columns",defaultValue:1},tipText:{attribute:"tip-text",defaultValue:""},boxLabel:{attribute:"box-label",defaultValue:""}},listeners:[{selector:".checkbox-label",event:"click",callback:function(e,t){e.preventDefault();var i=$(this),n=t.settings,s=(i.find("input[type=checkbox]").attr("name"),i.find("input[type=checkbox]").prop("checked"),t.getValue());i.hasClass("disabled")||(s=s===n.trueValue?n.falseValue:n.trueValue,t.dom().triggerHandler("ev_view_change",[{"type":"value","value":s}]),t.setStatus("checked",s===n.trueValue))}}],init:function(){this._status.disabled=!1,this._status.checked=!1},render:function(){var e=this.dom(),t=this.settings,i=!1===t.labelField?"label-empty":"",n=this.domId+"-checkbox-"+parseInt(1e3*Math.random()*1e3*1e3,10).toString();e.addClass(t.cls+"checkbox-container "+i);var s="";null!==t.labelField&&(s+='<div class="widget-fieldlabel-wrap '+t.labelCls+'">',s+='<div class="widget-fieldlabel-inner">',s+='<label class="widget-fieldlabel checkbox-group-label">'+t.labelField+"</label>",t.labelField&&(s+='<span class="widget-separator">'+t.separator+"</span>"),s+="</div>",s+="</div>"),s+='<div class="widget-wrap-outer checkbox-group-wrap-outer">',s+='<div class="checkbox-group-wrap">',s+="<ul>",s+='<li class="checkbox-list">',s+='<div class="widget-wrap">',s+='<label class="checkbox-label " for="'+n+'">',s+='<input class="checkbox-checkbox" type="checkbox" id="'+n+'" />',s+='<span class="icon"></span>',s+='<span class="text">'+t.boxLabel+"</span>",s+="</label>",s+="</div>",s+="</li>",s+="</ul>",s+="</div>",null!=t.tips&&t.tips!=undefined&&(s+='<div class="widget-tips textbox-tips '+t.tipsCls+'">',s+='<div class="widget-tips-wrap">',s+='<div class="content tips-content">'+t.tips+"</div>",s+="</div>",s+="</div>"),s+='<div widget="errortip" error-cls="'+t.errorTipsCls+'">',s+="</div>",s+="</div>",t.tipText&&(s+='<div widget="toolTip"></div>',e.addClass("has-tool-tip")),e.append(s)},setValue:function(e){var t,i,n=this.dom(),s=this,a=this.settings,r=n.find("input[type=checkbox]");t=r.eq(0),(i=e)===a.trueValue||!0===i||1===i?(t.closest("label.checkbox-label").addClass("checked"),t.prop("checked",!0),s.setStatus("checked",!0)):i!==a.falseValue&&!1!==i&&0!==i||(t.closest("label.checkbox-label").removeClass("checked"),t.prop("checked",!1),s.setStatus("checked",!1))},getValue:function(){var e=this.dom(),t=this.settings;return e.find("input[type=checkbox]").eq(0).prop("checked")?t.trueValue:t.falseValue},disable:function(e){var t=this.dom(),i=t.find("input.checkbox-checkbox");this.getContainer().addClass("disabled"),i.each(function(e,t){var i=$(t);i.closest("li.checkbox-list").addClass("disabled"),i.closest("label.checkbox-label").addClass("disabled"),i.prev("input[type=hidden]").prop("disabled",!0),i.prop("disabled",!0)}),e||(t.triggerHandler("ev_view_disable"),this.setStatus("disabled",!0))},enable:function(){var e=this.dom(),t=e.find("input.checkbox-checkbox");this.getContainer().removeClass("disabled"),t.each(function(e,t){var i=$(t);i.closest("li.checkbox-list").removeClass("disabled"),i.closest("label.checkbox-label").removeClass("disabled"),i.prev("input[type=hidden]").prop("disabled",!1),i.prop("disabled",!1)}),e.triggerHandler("ev_view_enable"),this.setStatus("disabled",!1)}}),$.su.Widget.register("grid",{settings:{operation:{attribute:"operation",defaultValue:null},plugins:{attribute:"plugins",defaultValue:""},minLines:{attribute:"min-lines",defaultValue:0},multiSelect:{attribute:"multi-select",defaultValue:!1},selectAll:{attribute:"select-all",defaultValue:!1},selectType:{attribute:"select-type",defaultValue:"row"},xScroll:{attribute:"x-scroll",defaultValue:!1},maxLines:{attribute:"max-lines",defaultValue:!1},showPrompt:{attribute:"show-prompt",defaultValue:!0},configs:{attribute:"configs",defaultValue:null},delAllText:{attribute:"del-all-text",defaultValue:$.su.CHAR.COMMON.DELETE_CONFIRM_CONTENT}},listeners:[{selector:"td.grid-content-td-check-column label.checkbox-label",event:"click",callback:function(e,t){e.stopPropagation(),e.preventDefault();var i,n=t.dom(),s=$(this),a=s.closest("tr.grid-content-tr"),r=t.getKeyById(a.attr("id")),o=s.find("input[type=checkbox]");if(!a.hasClass("disabled")){if(!1===t.settings.multiSelect){var d=n.find("tr.grid-content-tr").find("input[type=checkbox]");n.find("tr.grid-content-tr").each(function(){var e=t.getKeyById($(this).attr("id"));$(this).hasClass("selected")&&n.triggerHandler("ev_grid_row_unselected",[e])}),d.each(function(){$(this).prop("checked",!1),$(this).closest("label.checkbox-label").removeClass("checked"),$(this).closest("tr.grid-content-tr").removeClass("selected")}),o.prop("checked",!0),s.addClass("checked"),a.addClass("selected"),t.dom().triggerHandler("ev_grid_row_selected",[r])}else!0===t.settings.multiSelect&&(a.toggleClass("selected"),a.hasClass("selected")?(o.prop("checked",!0),s.addClass("checked"),t.dom().triggerHandler("ev_grid_row_selected",[r])):(o.prop("checked",!1),s.removeClass("checked"),t.dom().triggerHandler("ev_grid_row_unselected",[r])));n.triggerHandler("ev_grid_row_clicked",[r]),t.checkSelected();var l=n.find("tr.grid-content-tr"),c=(s=n.find("tr.grid-header-tr label.checkbox-label")).closest("div.checkbox-group-container");if(0<l.length){for(i=0;i<l.length&&($(l[i]).hasClass("disabled")||$(l[i]).hasClass("selected"));++i);for(i!=l.length&&(c.removeClass("selected"),s.removeClass("checked")),i=0;i<l.length&&($(l[i]).hasClass("disabled")||$(l[i]).hasClass("selected"));++i);i==l.length&&(c.addClass("selected"),s.addClass("checked"))}}}},{selector:"th.grid-header div.checkcolumn label.checkbox-label",event:"click",callback:function(e,t){e.stopPropagation(),e.preventDefault();var i=t.dom(),n=$(this),s=$(this).closest("div.checkbox-group-container"),a=i.find("tr.grid-content-tr:not(.disabled)");if(a.hasClass("empty"))return!1;s.hasClass("selected")?(s.removeClass("selected"),a.removeClass("selected"),a.find("label.checkbox-label").removeClass("checked"),a.find("input[type=checkbox]").prop("checked",!1),n.find("input[type=checkbox]").prop("checked",!1),n.removeClass("checked"),t.dom().triggerHandler("ev_grid_row_unselected_all",["all"])):(s.addClass("selected"),a.addClass("selected"),a.find("input[type=checkbox]").prop("checked",!0),a.find("label.checkbox-label").addClass("checked"),n.find("input[type=checkbox]").prop("checked",!0),n.addClass("checked"),t.dom().triggerHandler("ev_grid_row_selected_all",["all"])),t.checkSelected()}},{selector:"td.grid-content-td-action-column:not(.disabled) a",event:"click",callback:function(e,t){e.stopPropagation(),e.preventDefault();var i=$(this).closest("tr.grid-content-tr"),n=t.getKeyById(i.attr("id"));$(this).trigger("ev_grid_action_click",[n])}},{selector:"td.grid-content-td",event:"click",callback:function(e,t){var i=$(this).parent().attr("data-key");$(e.target).hasClass("grid-content-td")||$(e.target).hasClass("content")?$(this).trigger("ev_grid_td_click",[i]):$(this).trigger("ev_grid_action_click",[i])}},{selector:".grid-content-btn-edit",event:"click",callback:function(e,t){e.stopPropagation(),e.preventDefault();var i=$(this).closest("tr.grid-content-tr"),n=t.getKeyById(i.attr("id")),s=t.getPlugin("editor");if(s&&!s.isEditing()&&!1!==n&&!i.hasClass("disabled")){var a=$.su.getDefaultEvent(t,function(){s.startEdit(n),t.dom().triggerHandler("ev_grid_edit",[n])});t.dom().triggerHandler("ev_grid_before_edit",[a.ev,n]),a.exe()}}},{selector:".grid-content-btn-delete",event:"click",callback:function(e,t){e.preventDefault(),e.stopPropagation();var i=$(this),n=i.closest("tr.grid-content-tr"),s=t.getPlugin("editor"),a=t.getKeyById(n.attr("id"));if(!n.hasClass("disabled")&&!i.hasClass("disabled")&&!1!==a)if(s&&!1!==s.isEditing())s.shake();else{var r=$.su.getDefaultEvent(t,function(){t.dom().triggerHandler("ev_grid_delete",[[a]])});t.dom().triggerHandler("ev_grid_before_item_delete",[r.ev,a]),r.exe()}}},{selector:"",event:"ev_widget_show",callback:function(e,t){t.setGridHeight()}}],init:function(){this.objs={},(this.objs.grid=this).objs.modelMap={};var e=$('<tr id="'+$.su.randomId("trTool")+'"></tr>'),t=$('<td id="'+$.su.randomId("tdTool")+'"></td>');this.objs.row=new $.su.widgets.row({id:e,objs:this.objs}),this.objs.cell=new $.su.widgets.cell({id:t}),this._keys=[],this._renderMap={},this.objs.rows=[]},render:function(){var e=this.dom(),t=this.settings,i=t.configs.columns,n='<style type="text/css" name="column">',s=!1;e.addClass(t.cls+"grid-container");for(var a=this.columnOffset=0,r=i.length;a<r;a++)"row"===t.selectType&&i[a]&&"checkcolumn"===i[a].xtype&&(i.splice(a,1),this.columnOffset-=1),i[a]&&"btn"===i[a].xtype&&(s=!0);s||(i.unshift({width:0,xtype:"btn"}),this.columnOffset+=1);var o="";o+='<div  id="'+this.domId+'-panel" class="grid-panel">',o+='<div class="container widget-container grid-panel-container'+t.cls+'">',o+='<div class="grid-panel-wrap">',o+='<div class="grid-panel-content">',o+='<div class="grid-status-container hidden"></div>',o+='<div class="grid-limit-container hidden"></div>',o+='<div class="grid-panel-tbar-container tbar-container hidden"></div>',o+='<div class="grid-panel-content-container">',o+='<div class="container grid-container">',o+='<div class="scroll-x-container">',o+='<div class="container grid-header-container">',o+='<table border="0" cellspacing="0" cellpadding="0">',o+='<tr class="grid-header-tr">';for(var d=0;d<i.length;d++){var l=i[d];if(l.cls=l.cls||"",l.dataIndex=l.dataIndex||"",!1!==l.colspan){l.width!==undefined&&("number"==typeof l.width&&(l.width=l.width+"px"),n+="div#"+this.domId+" th.grid-header-"+d+",",n+="div#"+this.domId+" td.grid-tool-td-"+d+",",n+="div#"+this.domId+" td.grid-content-td-"+d,n+="{width:"+l.width+";",0===l.width&&(n+="padding: 0;"),n+="}");var c="";switch(l.xtype){case"checkcolumn":!1!==t.selectAll&&(c+='<div class="checkbox-group-container grid-header-checkbox checkcolumn inline">',c+='<div class="widget-wrap">',c+='<label class="checkbox-label">',c+='<input class="checkbox-checkbox" type="checkbox" value=""/>',c+='<span class="icon"></span>',c+="</label>",c+="</div>",c+="</div>"),l.text=l.text||"",l.name=l.name||"select";break;case"rownumberer":l.text=l.text||$.su.CHAR.GRID.ID,l.name=l.name||"seq";break;case"settings":l.text=l.text||$.su.CHAR.GRID.MODIFY,l.name=l.name||"settings";break;case"statuscolumn":l.text=l.text||$.su.CHAR.GRID.STATUS,l.dataIndex=l.dataIndex||"",l.name=l.name||l.dataIndex;break;default:l.text=l.text||"",l.name=l.name||l.dataIndex}if(l.thRenderer)o+=l.thRenderer();else{var u="grid-header-"+(l.xtype||"other")+(l.cls?" "+l.cls:"");o+='<th class="grid-header grid-header-'+d+" "+l.dataIndex+(d==i.length-1?" lst":"")+" "+u+'" '+(l.colspan?'colspan="'+l.colspan+'"':"")+' name="'+l.dataIndex+'">',o+=c,o+='<span class="content '+(l.xtype||"")+'">'+l.text+"</span>",o+="</th>"}}}o+="</tr>",o+="</table>",o+="</div>",o+='<div class="grid-tool-container hidden"></div>',o+='<div class="grid-content-container-outer">',o+='<div class="grid-content-container">',o+='<table border="0" cellspacing="0" cellpadding="0">',o+='<tbody class="grid-content-data">',o+="</tbody>",o+="</table>",o+="</div>",o+="</div>",o+="</div>",o+="</div>",o+="</div>",o+='<div class="grid-panel-fbar-container"></div>',o+="</div>",o+="</div>",o+="</div>",o+="</div>";var h=$(o);if(e.find(".grid-panel, .grid-prompt-msg").remove(),e.append(h),e[0]){this.msgId=e[0].id+"-prompt-msg",this.confirmId=e[0].id+"-confirm-msg",e.append($('<div class="grid-prompt-msg global-alert" widget="msg" type="alert" id = "'+this.msgId+'"></div>')),e.append($('<div class="grid-confirm-msg global-confirm" widget="msg" type="confirm" id = "'+this.confirmId+'"></div>')),n+="</style>",h.prepend($(n)),t.plugins&&this.initPlugins(t.plugins.split("|"));var p=e.find("div.grid-header-container>table").outerWidth();if(p&&t.xScroll){var f=e.find(".scroll-x-container");f.css("width",p+10+"px"),f.parent().css("overflow-x","auto")}}},initPlugins:function(e){var a=this.dom(),r=this,o=this.settings;r.plugins={};for(var t=0,i=(e=$.isArray(e)?e:[e]).length;t<i;t++)n(e[t]);function n(e){var t=$.extend({},o,{objs:r.objs,plugins:r.plugins});switch(e){case"tBar":$.extend(t,{custom:o.configs.tbar});var i=$('<div id="'+r.domId+'_bar" operation="'+o.operation+'"></div>').appendTo(a);r.plugins.tBar=new $.su.widgets.tBar($.extend(t,{id:i})),r.plugins.tBar.render();break;case"rowEditor":var n=$('<div id="'+r.domId+'_tr_editor"></div>').appendTo(a);r.plugins.rowEditor=new $.su.widgets.rowEditor($.extend(t,{id:n})),r.plugins.rowEditor.render();break;default:var s=$('<div id="'+r.domId+"_"+e+'"></div>').appendTo(a);$.su.widgets[e]&&(r.plugins[e]=new $.su.widgets[e]($.extend(t,{id:s})),r.plugins[e].render())}}},getValue:function(){return this.objs.rows},setValue:function(){return 0},syncData:function(e,t){var i=this.dom(),n=this.getPlugin("paging");this.objs.rows=[],this.objs.modelMap={},this._keys=e,this._renderMap={},n?(n.updateRowPage(e),n.updateBtns(e)):i.triggerHandler("ev_store_render_items",[e])},renderModels:function(e,t,i){for(var n,s=this,a=this.settings,r="",o=[],d=$.extend({},a,{objs:s.objs}),l=this.dom().find("tbody.grid-content-data").eq(0),c=[],u=s.getPlugin("paging"),h=u?u._pageMap:{},p=0,f=t.length;p<f;p++){var v=t[p][e].getValue();s.objs.modelMap[v]=t[p],n=s.objs.row.initRow(v,d),o.push(n),this._renderMap[v]=!0,r+=n.domContent}if(u){if(0<t.length){var g=t[0][e].getValue(),m=$.inArray(g,this._keys);if(-1!==m)if(0===m)l.prepend(r);else{for(var b,y=m-1;0<=y;y--)if(this._renderMap[this._keys[y]]){b=this._keys[y];break}b?l.find('tr[data-key="'+b+'"]').after(r):l.prepend(r)}}}else l.prepend(r);for(var _=0,w=o.length;_<w;_++){var x=o[_].domId,T=o[_].key,C=new $.su.widgets.row({id:x}),E=o[_].settings.cellObjs;u&&C.dom().attr("data-page",h[T]),$.extend(C,o[_]),s.objs.rows.push({key:T,obj:C}),c.push({key:T,obj:C});for(var M=0,O=E.length;M<O;M++){var A=E[M].domId,I=new $.su.widgets.cell({id:A});$.extend(I,E[M]),E[M].callback&&E[M].callback.call(I),C.cells.push(I)}}for(var k=0;k<c.length;k++){var j=c[k].obj;e=c[k].key,j&&j.dom().find("span.grid-row-numberer").html($.inArray(e,this._keys)+1)}this.settings.operation&&-1!==this.settings.operation.indexOf("columns")&&this.objs.tool.renderDefaultCol(this),this.updateRowNumber(),i(c)},addItem:function(e){this._keys.push(e);var t=this.getPlugin("paging");t?(t.updateRowPage(this._keys),t.updateBtns()):this.dom().triggerHandler("ev_store_render_items",[[e]])},deleteItem:function(e){var t=$.inArray(e,this._keys);if(0<=t){this._keys.splice(t,1),this.remove(e);var i=this.getPlugin("paging");i&&(i.updateRowPage(this._keys),i.updateBtns())}},createRow:function(e,t){var i=this,n=this.settings,s={},a=$.extend({},n,{objs:i.objs}),r={},o=i.dom().find("tbody.grid-content-data").eq(0);r[e]=[],i.objs.cells=r,i.objs.modelMap[e]=t,this._keys.push(e),s.key=e;var d=i.objs.row.initRow(e,a);o.append(d.domContent),s.obj=new $.su.widgets.row({id:d.domId}),$.extend(s.obj,d);for(var l=0,c=d.settings.cellObjs.length;l<c;l++){var u=d.settings.cellObjs[l],h=u.domId,p=new $.su.widgets.cell({id:h});$.extend(p,u),u.callback&&u.callback.call(p),s.obj.cells.push(p)}i.objs.rows.push(s),this._renderMap[e]=!0,i.updateRowNumber();var f=this.getPlugin("paging");return f&&(f.updateRowPage(this._keys),f.updateBtns()),i.dom().triggerHandler("ev_grid_row_created",[i.objs.rows]),s.obj},updateRowNumber:function(){0<this.dom().length&&this.updateRow()},updateRow:function(){var e,t=this.dom(),i=t.find("tbody.grid-content-data"),n=t.find("th.grid-header div.checkcolumn label.checkbox-label"),s=n.closest("div.checkbox-group-container");this.getPlugin("toolRow");var a=this.objs.rows,r=a.length;if(0==r){if(0===i.find("tr.grid-content-tr.empty").length){var o=this.objs.row.initEmptyRow(this.getColumns().length,this);return i.append(o),s.removeClass("selected"),n.removeClass("checked"),this.setGridHeight(),void this.checkSelected()}}else t.find(".grid-content-tr.empty").remove();for(e=0;e<r;e++){var d=a[e].obj,l=a[e].key;d&&d.dom().find("span.grid-row-numberer").html($.inArray(l,this._keys)+1)}var c=t.find("tr.grid-content-tr:not(.disabled)");if(0<c.length){for(e=0;e<c.length&&($(c[e]).hasClass("disabled")||$(c[e]).hasClass("selected"));++e);for(e!=c.length&&(s.removeClass("selected"),n.removeClass("checked")),e=0;e<c.length&&($(c[e]).hasClass("disabled")||$(c[e]).hasClass("selected"));++e);e==c.length&&(s.addClass("selected"),n.addClass("checked"))}this.setGridHeight(),this.checkSelected()},setGridHeight:function(){var e=this.settings,t=this.getContainer(),i=t.find(".grid-content-container")[0],n=i.scrollTop;0<t.find("style[name=grid]").length&&t.find("style[name=grid]").remove();var s='<style type="text/css" name="grid">';s+="div#"+this.domId+" div.grid-content-container{";for(var a=t.find("tr.grid-content-tr"),r=null,o=0,d=a.length;o<d;o++){for(var l=a.eq(o),c=l.find("td"),u=!1,h=0,p=c.length;h<p;h++)if(1<c.eq(h).attr("rowspan")){u=!0;break}if(!u){r=l;break}}var f=0;if(r&&(f=r.outerHeight()),e.minLines&&(s+="min-height:"+e.minLines*f+"px;"),e.maxLines&&(s+="max-height:"+e.maxLines*f+"px;",t.addClass("allow-scroll")),s+="}",s+="</style>",t.prepend($(s)),i.scrollTop=n,$(i).height()<$(i).find("table").height()){if(!this._resetWidth){var v=$(i).width()-$(i).children("table").width();this._resetWidth=!0,t.find(".grid-header-container").css("padding-right",v),t.find(".grid-tool-container").css("padding-right",v)}}else this._resetWidth&&(this._resetWidth=!1,t.find(".grid-header-container").css("padding-right",0),t.find(".grid-tool-container").css("padding-right",0))},setGridColumnName:function(e){var t=this.dom(),i=this.settings.configs.columns;if($.isArray(e))for(var n=0,s=e.length;n<s;n++){var a=parseInt(e[n].index,10)+this.columnOffset,r=e[n].text,o=t.find(".grid-header-container th").get(a);o&&$(o).find("span.content").text(r),i[a].text=r}},reRenderColumn:function(e){for(var t=this.objs.rows,i=this.objs.modelMap,n=0,s=t.length;n<s;n++)for(var a=t[n].key,r=t[n].obj.cells,o=i[a].getData()[e],d=0,l=r.length;d<l;d++)r[d].field===e&&r[d].setValue(o)},getKeys:function(){var e=[],t=this.objs.modelMap;for(var i in t)t.hasOwnProperty(i)&&e.push(i);return e},getRow:function(e){var t=this.objs.rows;if(e===undefined)return t;for(var i=0,n=t.length;i<n;i++)if(e===t[i].key)return t[i].obj;return!1},getRows:function(){for(var e=this.objs.rows,t=[],i=0,n=e.length;i<n;i++)t.push(e[i].obj);return t},getPlugin:function(e){var t=this.settings.plugins.split("|");if("editor"===e){if(-1!==$.inArray("editor",t))return this.plugins.editor;if(-1!==$.inArray("rowEditor",t))return this.plugins.rowEditor;if(-1!==$.inArray("popEditor",t))return this.plugins.popEditor}return-1!==$.inArray(e,t)&&this.plugins[e]},getColumns:function(){return this.settings.configs.columns},getSelected:function(){var a=this,e=this.dom().find("tr.grid-content-tr.selected"),r=[];return e.each(function(e,t){var i=$(t);if(!i.hasClass("empty")&&!i.hasClass("disabled")){var n=i.attr("id"),s=a.getKeyById(n);r.push(s)}}),r},checkSelected:function(){var e=this,t=this.getSelected(),i=this.getPlugin("tBar");i&&(0===t.length?i.disable(["delete","edit"]):1===t.length?i.enable(["delete","edit"]):1<t.length&&(i.disable("edit"),i.enable("delete"))),clearTimeout(this._checkStatusEvent),this._checkStatusEvent=setTimeout(function(){e.dom().triggerHandler("ev_grid_check_status")},10)},setSelected:function(e){var t=this.dom(),i=this.getSelected();e===undefined&&(e=this._keys);for(var n=0,s=(e=$.isArray(e)?e:[e]).length;n<s;n++)-1===$.inArray(e[n],i)&&t.find('tr.grid-content-tr[data-key="'+e[n]+'"]').find("label.checkbox-label").trigger("click")},setUnselected:function(e){var t=this.dom(),i=this.getSelected();e===undefined&&(e=this._keys);for(var n=0,s=(e=$.isArray(e)?e:[e]).length;n<s;n++)-1!==$.inArray(e[n],i)&&t.find('tr.grid-content-tr[data-key="'+e[n]+'"]').find("label.checkbox-label").trigger("click")},getDisplay:function(){var e=this.dom().find("input.grid-display");return 0<e.length?e:null},search:function(e){if(!e)return null},updateRowId:function(){this.dom().find("tbody.grid-content-data tr.grid-content-tr").each(function(e,t){$(t).find("span.grid-row-numberer").text(e+1)})},moveItem:function(e,t){var i=this.dom(),n=i.find("tr.grid-content-tr[data-key="+e+"]");if(n.index()!==t){var s=i.find("tbody.grid-content-data tr.grid-content-tr").get(t);$(s).before(n);var a=$.inArray(e,this._keys);this._keys.splice(a,1),this._keys.splice(t,0,e),this.updateRowId();var r=this.getPlugin("paging");r&&(r.updateRowPage(this._keys),r.updateBtns())}},runProgress:function(){var e=this.getPlugin("tBar").dom().find("div.gird-prompt-progressbar"),t=e.find("div.progressbar-value");t.stop(),t.css("width","0px"),e.clearQueue().fadeIn(100,function(){t.animate({width:"50%"},5e3)})},prompt:function(e){var t=$("#"+this.msgId);if(t.data("viewObj"))return t.data("viewObj").setContent(e),t.data("viewObj").show(),t.data("viewObj");var i=new $.su.widgets.msg({id:this.msgId});return i.render(),i._gridObj=this,i.setContent(e),i.show(),confirmObj},confirm:function(e){var t=$("#"+this.confirmId);if(t.data("viewObj"))return t.data("viewObj").setContent(e),t.data("viewObj").show(),t.data("viewObj");var i=new $.su.widgets.msg({id:this.confirmId});return i.render(),i._gridObj=this,i.setContent(e),i.show(),i},insert:function(e,t){var i=this.dom(),n=this.settings,s=i.find("tbody.grid-content-data");e=parseInt(e,10)||0,t=t||[{}],$.isArray(t)||(t=[t]),t.reverse();for(var a=0,r=t.length;a<r;a++){var o=n.row.initRow(e+a,t[a]);0==e?s.prepend(o):o.insertBefore(this.objs.rows[e]),this.objs.rows.splice(e,0,o)}this.updateRowNumber(),i.triggerHandler("ev_insert",[e,t])},remove:function(e){var t,i,n=this.objs.rows;if(e){for(t=n.length-1;0<=t;t--)n[t].key===e&&(n[t].obj.dom().remove(),n.splice(t,1));delete this.objs.modelMap[e];var s=$.inArray(e,this._keys);0<=s&&this._keys.splice(s,1)}else{for(t=0,i=n.length;t<i;t++)n[t].obj.dom().remove();n.length=0,this.objs.modelMap=[],this._keys=[]}this.updateRowNumber();var a=this.getPlugin("paging");a&&(a.updateRowPage(this._keys),a.updateBtns())},getEditStatus:function(){var e=this.getPlugin("editor");return e.isEditing()?""===e.getEditingId()?0:"add"===e.getEditingId()?2:1:0},getKeyById:function(e){for(var t=this.objs.rows,i=0,n=t.length;i<n;i++)if(e===t[i].obj.domId)return t[i].key;return!1},rowSpan:function(e,t){var i=this.dom(),n={};if(t===undefined)n["0"]=this.objs.rows.length;else for(var s=0,a=t.length;s<a;s++){var r=t[s];n[r[0]]=r.length}i.find("td.grid-content-td-"+e).each(function(e,t){$(t).show(),n[e]?$(t).attr("rowspan",n[e]):$(t).hide()})},colSpan:function(e,t){var i=this.dom(),n={},s=[],a=[];if(t===undefined)for(var r=0,o=this.objs.rows.length;r<o;r++)s.push(this.objs.rows[r].key);else s=$.isArray(t)?t:[t];for(var d=0,l=e.length;d<l;d++){var c=e[d];n[c[0]]=c.length,a=a.concat(c.slice(1))}for(var u=0,h=s.length;u<h;u++){var p=i.find('tr.grid-content-tr[data-key="'+s[u]+'"]');0<p.length&&p.find("td.grid-content-td").each(function(e,t){var i=$(t).attr("name");"btn-column"!==i&&($(t).show(),n[i]?$(t).attr("colspan",n[i]):(-1!==$.inArray(i,a)&&$(t).hide(),$(t).removeAttr("colspan")))})}},enableColumn:function(e){var t="td.grid-content-td-"+e;this.dom().find(t).removeClass("disabled")},disable:function(e){for(var t=0,i=(e=$.isArray(e)?e:[e]).length;t<i;t++){var n=$(".grid-content-tr[data-key="+e[t]+"]");n.attr("disabled",!0).addClass("disabled"),n.find(".grid-content-td").addClass("disabled")}},disableColumn:function(e){var t="td.grid-content-td-"+e;this.dom().find(t).addClass("disabled")},showColumn:function(e){this.dom().find("div.grid-container").children("style.column-hide-style[data-index="+e+"]").remove()},hideColumn:function(e){var t="",i="#"+this.domId+" ";t+='<style class="column-hide-style" data-index="'+e+'">',t+=i+"th.grid-header."+e+", ",t+=i+"td.grid-content-td-"+e+", ",t+=i+"td.grid-tool-td-"+e,t+="{display: none;}</style>",this.dom().find("div.grid-container").append(t)},setMaxRules:function(e,t,i){t=t||!1,i=i||$.su.CHAR.GRID.MAX_RULES_TIPS,e=parseInt(e,10),(isNaN(e)||e<=0)&&(e=0,t=!1);var n=this.dom().find("div.grid-limit-container"),s="";s+='<div class="grid-limit-bar-container">',s+="<span>"+$.su.CHAR.GRID.MAX_LIMIT+': <span class="limit-num"></span></span>',s+="</div>",n.append(s),"object"!==$.type(this.objs.maxRulesObj)&&(this.objs.maxRulesObj={}),this.objs.maxRulesObj.maxRules=e,this.objs.maxRulesObj.errorText=i,n.find(".limit-num").text(this.objs.maxRulesObj.maxRules),t?n.removeClass("hidden"):n.addClass("hidden")},getMaxRules:function(){return"object"!==$.type(this.objs.maxRulesObj)?0:this.objs.maxRulesObj.maxRules||0},isExceeded:function(){return 0<this.getMaxRules()&&this.objs.rows.length>=this.getMaxRules()},showMaxRulesWarning:function(){this.prompt(this.objs.maxRulesObj.errorText)},destroy:function(){var e=$("#"+this.msgId).data("viewObj"),t=$("#"+this.confirmId).data("viewObj"),i=this.getPlugin("popEditor");e&&e.destroy(),t&&t.destroy(),i&&i.destroy()}}),$.su.Widget.register("tBar",{settings:{operation:{attribute:"operation",defaultValue:""}},listeners:[{selector:"a.btn-add",event:"click",callback:function(e,t){if(e.stopPropagation(),e.preventDefault(),!$(this).hasClass("disabled")){var i=t.settings,n=i.objs.grid,s=n.getPlugin("editor");if(s&&!$(this).hasClass("disabled")&&("function"!=$.type(i.beforeStartAdd)||i.beforeStartAdd()))if(n.isExceeded())n.showMaxRulesWarning();else if(!1===s.isEditing()){var a=i.configs.paging,r=n.plugins.paging;a&&a.isPaging&&r.goToPage(0),s.startEdit("add"),n.dom().triggerHandler("ev_grid_edit",["add"])}}}},{selector:"a.btn-delete",event:"click",callback:function(e,n){e.stopPropagation(),e.preventDefault();var s=n.settings.objs.grid,a=s.getPlugin("paging"),r=s.objs.rows,t=s.getPlugin("editor"),o=s.getSelected();$(this).hasClass("disabled")||t&&!1===t.isEditing()&&(s.confirm($.su.CHAR.COMMON.DELETE_CONFIRM_CONTENT),$("#"+s.confirmId).one("ev_msg_ok",function(){for(var e=r.length-1;0<=e;e--){var t=r[e].obj;-1!==$.inArray(t.dom().attr("data-key"),o)&&(t.dom().remove(),r.splice(e,1))}s.updateRowNumber(),a&&a.updateBtns();var i=$.su.getDefaultEvent(n,function(){s.dom().triggerHandler("ev_grid_delete",[o])});s.dom().triggerHandler("ev_grid_before_delete",[i.ev]),i.exe(),s.dom().triggerHandler("ev_grid_after_delete"),$(this).off("ev_msg_no")}).one("ev_msg_no",function(){$(this).off("ev_msg_ok")}))}},{selector:"a.btn-edit",event:"click",callback:function(e,t){e.stopPropagation(),e.preventDefault();var i=t.settings.objs.grid,n=i.getSelected(),s=i.getPlugin("editor");s&&!$(this).hasClass("disabled")&&0<n.length&&s&&!s.isEditing()&&(s.startEdit(n[0]),i.dom().triggerHandler("ev_grid_edit",[n[0]]))}},{selector:"a.btn-delete-all",event:"click",callback:function(e,t){e.stopPropagation(),e.preventDefault();var i=t.settings.objs.grid,n=i.getPlugin("editor");if(n&&!1===n.isEditing()){for(var s=[],a=i.getPlugin("paging"),r=i.objs.rows,o=r.length-1;0<=o;o--)s.push(r[o].key),r[o].obj.dom().remove(),r.splice(o,1);i.updateRowNumber(),a&&a.updateBtns(),i.dom().triggerHandler("ev_grid_delete",[s])}}},{selector:"a.btn-clear",event:"click",callback:function(e,t){e.stopPropagation(),e.preventDefault();var i=t.settings,n=i.objs.grid,s=n.getPlugin("editor");n.confirm(i.delAllText).dom().off("ev_msg_ok").on("ev_msg_ok",function(){s&&!1===s.isEditing()&&n.dom().triggerHandler("ev_grid_delete_all")})}},{selector:"input.search-text",event:"focus",callback:function(e){e.stopPropagation(),$(this).closest("div.search-container").addClass("focus")}},{selector:"input.search-text",event:"blur",callback:function(e){e.stopPropagation(),$("div.search-container").removeClass("focus")}},{selector:"a.operation-btn",event:"click",callback:function(e,t){if(e.preventDefault(),e.stopPropagation(),!$(this).hasClass("disabled")){var i=t.settings.objs.grid,n=$(this).attr("tbar-name");i.dom().triggerHandler("ev_grid_tbar_"+n)}}},{selector:"a.search-switch",event:"click",callback:function(e,t){e.stopPropagation();var i=t.settings.objs.grid,n=$(this).prevAll("input.search-text").val();i.search(n)}}],init:function(e){this.settings=e},render:function(){var e=this.dom(),t=e.parent().find("div.grid-panel-tbar-container"),i=this.settings,n=$.type(i.operation),s=[];if(i.objs.grid.dom().addClass("grid-tbar"),"string"===n)s=i.operation.split("|");else if("array"===n)s=i.operation;else if(!i.custom)return null;i.operation=s,t.removeClass("hidden");for(var a='<div class="operation-container" id="'+this.domId+'">',r=0,o=s.length;r<o;r++){var d=0===r?"fst":"",l=r===o-1?"lst":"";switch(s[r]){case"add":a+='<a href="javascript:void(0);" tbar-name="add" class="operation-btn btn-add '+d+" "+l+'">',a+='<span class="icon"></span>',a+='<span class="text">'+$.su.CHAR.OPERATION.ADD+"</span>",a+="</a>",i.maxRulesMsgText;break;case"edit":a+='<a href="javascript:void(0);" tbar-name="edit" class="operation-btn btn-edit '+d+" "+l+'">',a+='<span class="icon"></span>',a+='<span class="text">'+$.su.CHAR.OPERATION.EDIT+"</span>",a+="</a>";break;case"prompt":a+='<div class="grid-prompt hidden widget-container successed inline-block left">',a+='<div class="content">',a+='<span class="icon"></span>',a+='<span class="text text-successed">'+i.promptTextSuccessed+"</span>",a+='<span class="text text-failed">'+i.promptTextFailed+"</span>",a+="</div>",a+="</div>",i.showPrompt=!0;break;case"delete":a+='<a href="javascript:void(0);" tbar-name="delete" class="operation-btn btn-delete '+d+" "+l+'">',a+='<span class="icon"></span>',a+='<span class="text">'+$.su.CHAR.OPERATION.DELETE+"</span>",a+="</a>",i.noneSelectedMsgText,i.deleteConfirmMsgText;break;case"deleteAll":a+='<a href="javascript:void(0);" tbar-name="deleteAll" class="operation-btn btn-delete-all '+d+" "+l+'">',a+='<span class="icon"></span>',a+='<span class="text">'+$.su.CHAR.OPERATION.DELETE_ALL+"</span>",a+="</a>",i.noneSelectedMsgText,i.deleteAllConfirmMsgText;break;case"clear":a+='<a href="javascript:void(0);" tbar-name="clear" class="operation-btn btn-clear '+d+" "+l+'">',a+='<span class="icon"></span>',a+='<span class="text">'+$.su.CHAR.OPERATION.DELETE_ALL+"</span>",a+="</a>";break;case"enable":a+='<a href="javascript:void(0);" tbar-name="enable" class="operation-btn btn-enable '+d+" "+l+'">',a+='<span class="icon"></span>',a+='<span class="text">'+$.su.CHAR.OPERATION.ENABLE+"</span>",a+="</a>";break;case"disable":a+='<a href="javascript:void(0);" tbar-name="disable" class="operation-btn btn-disable '+d+" "+l+'">',a+='<span class="icon"></span>',a+='<span class="text">'+$.su.CHAR.OPERATION.DISABLE+"</span>",a+="</a>";break;case"search":a+='<div class="container widget-container text-container search-container inline">',a+='<span class="widget-wrap text-wrap search-wrap">',a+='<input type="text" class="text-text search-text" value="'+$.su.CHAR.OPERATION.SEARCH+'" />',a+='<span class="pos"></span>',a+='<a href="javascript:void(0);" class="search-switch"></a>',a+="</span>",a+="</div>";break;case"refresh":a+='<a href="javascript:void(0);" tbar-name="refresh" class="operation-btn btn-refresh '+d+" "+l+'">',a+='<span class="icon"></span>',a+='<span class="text">'+$.su.CHAR.OPERATION.REFRESH+"</span>",a+="</a>";break;default:var c=s[r].xtype;c&&(a+='<input operation-index="'+r+'" class="operation-user-defined operation-'+r+" "+d+" "+l+" "+c+'"/>')}}a+="</div>";var u=$(a);for(var h in t.append(u),e.remove(),this.settings.custom)if(this.settings.custom.hasOwnProperty(h)){var p=this.settings.custom[h],f='<a href="javascript:void(0);" tbar-name="'+h+'" class="operation-btn btn-'+h+" "+p.cls+'">';if(f+='<span class="icon"></span>',f+='<span class="text">'+p.text+"</span>",f+="</a>",p.index!==undefined){var v=this.dom().children();0===p.index?this.dom().prepend($(f)):p.index<=v.length?$(v.get(p.index-1)).after($(f)):this.dom().append($(f))}else this.dom().append($(f))}this.disable(["delete","edit"])},disable:function(e){$.isArray(e)||(e=[e]);for(var t=0,i=e.length;t<i;t++){var n=".operation-btn.btn-"+e[t];this.dom().find(n).addClass("disabled")}},enable:function(e){$.isArray(e)||(e=[e]);for(var t=0,i=e.length;t<i;t++){var n=".operation-btn.btn-"+e[t];this.dom().find(n).removeClass("disabled")}}}),$.su.Widget.register("row",{settings:{},init:function(e){this.objs=e.objs,this.cells=[]},render:function(){},initRow:function(e,t){for(var i=t.configs.columns,n={inited:!0,columns:i,objs:t.objs,cells:[],cellObjs:[]},s=t.objs.modelMap[e].selected,a=i.length,r=(n.objs.grid.dom().find("tbody.grid-content-data").eq(0),{domId:n.objs.grid.domId+"_tr_"+$.appUtils.keyHandler(e),key:e,domContent:""}),o="",d=0;d<a;d++)n.cellObjs[d]=n.objs.cell.initCell(e,d,t),o+=n.cellObjs[d].domContent;return r.domContent='<tr id="'+r.domId+'" class="grid-content-tr '+(s?"selected":"")+" grid-content-tr-"+$.appUtils.keyHandler(e)+'" data-key="'+e+'">'+o+"</tr>",r.settings=n,r},getAllFields:function(){return this.cells},initEmptyRow:function(e,t){this.objs.grid.columnOffset!==undefined&&this.objs.grid.columnOffset;var i='<tr class="grid-content-tr empty">';return t.dom().find("tr.grid-header-tr th"),i+='<td colspan="'+e+'">'+$.su.CHAR.COMMON.NO_ENTRY+"</td>",i+="</tr>",$(i)},disableRow:function(){var e=this.dom(),t=this.settings.columns,i=e;if(i){i.addClass("disabled");for(var n=0,s=t.length;n<s;n++){var a=t[n],r=a.items;if("actioncolumn"===a.xtype)for(var o=0,d=r.length;o<d;o++){var l=r[o].xtype,c=a.dataIndex,u=i.find("input[data-property="+c+"][data-type="+l+"]");u&&"function"==$.type(u[l])&&u[l]("disable")}}}},enableRow:function(){var e=this.dom(),t=this.settings.columns,i=e;if(i){i.removeClass("disabled");for(var n=0,s=t.length;n<s;n++){var a=t[n],r=a.items;if("actioncolumn"===a.xtype&&r)for(var o=0,d=r.length;o<d;o++){var l=r[o].xtype,c=a.dataIndex,u=i.find("input[data-property="+c+"][data-type="+l+"]");u&&"function"==$.type(u[l])&&u[l]("enable")}}}}}),$.su.Widget.register("cell",{settings:{},init:function(){},render:function(){},initCell:function(e,t,i){var n={rowKey:e,columns:i.configs.columns,cellId:t,objs:i.objs},s=function(e){return e===undefined||null===e||""===e?"---":e},a=i.objs.modelMap[e].getData(),r=n.columns[t],o=n.columns.length,d=s(a[r.dataIndex]),l=0===t?"fst":"",c=t===o-1?"lst":"",u="",h=r.cls||"";h&&(h+=" ");var p="",f={domId:n.objs.grid.domId+"_tr_"+$.appUtils.keyHandler(e)+"_td_"+t,domContent:"",column:r,field:r.dataIndex||!1,renderer:r.renderer||function(e){return s(e)}};if(i.editor)0===t?f.addClass("grid-content-td grid-content-td-0").css({position:"relative"}):r.dataIndex?f.addClass("grid-content-td grid-content-td-"+t).append($(i.editorItems[r.dataIndex])):f.addClass("grid-content-td grid-content-td-"+t);else switch(r.xtype){case"rownumberer":h+="grid-content-td grid-content-td-"+t+" grid-content-td-row-numberer "+l+" "+c+" "+r.cls,p+=' name="row-numberer"',u+='<span class="grid-row-numberer content"></span>';break;case"checkcolumn":var v=i.objs.modelMap[e].selected;h+=" grid-content-td grid-content-td-"+t+" grid-content-td-check-column "+l+" "+c,p+=' name="check-column"',u+='<div class="checkbox-group-container">',u+='<div class="widget-wrap">',u+='<label class="checkbox-label '+(v?"checked":"")+'">',u+='<input class="checkbox-checkbox" '+(v?' checked="checked" ':" ")+' type="checkbox" value="'+e+'"/>',u+='<span class="icon"></span>',u+="</label>",u+="</div>",u+="</div>",u+='<span class="content">--</span>';break;case"statuscolumn":var g,m,b=r.trueValue||"on",y=r.falseValue||"off";g=$.su.CHAR.GRID.DISABLED,m=y,h+="grid-content-td grid-content-td-"+t+" grid-content-td-status-column "+l+" "+c,p+=' name="check-column"',u+='<a href="javascript:void(0);" data-index="'+t+'" data-name="'+r.dataIndex+'" data-value="'+m+'" data-key="'+e+'" data-on="'+b+'" data-off="'+y+'" class="grid-content-btn grid-content-btn-status btn-status disabled">',u+='<span class="icon"></span>',u+='<span class="text">'+g+"</span>",u+="</a>";break;case"settings":n.objs.grid.dom().addClass("settings"),h+="grid-content-td grid-content-td-"+t+" grid-content-td-settings-column "+l+" "+c,u+='<div class="grid-btn-container">',r.items!==undefined&&-1===$.inArray("edit",r.items)||(u+='<a href="javascript:void(0);" data-index="'+t+'" data-key="'+e+'" class="grid-content-btn grid-content-btn-edit btn-edit">',u+='<span class="icon"></span>',u+='<span class="text">'+$.su.CHAR.OPERATION.EDIT+"</span>",u+="</a>"),r.items!==undefined&&-1===$.inArray("delete",r.items)||(u+='<a href="javascript:void(0);" data-index="'+t+'" data-key="'+e+'" class="grid-content-btn grid-content-btn-delete btn-delete">',u+='<span class="icon"></span>',u+='<span class="text">'+$.su.CHAR.OPERATION.DELETE+"</span>",u+="</a>"),u+="<div>";break;case"actioncolumn":n.objs.grid.dom().addClass("actioncolumn"),h+="grid-content-td grid-content-td-"+t+" grid-content-td-action-column "+l+" "+c,p+=' name="action-column"',u+='<div class="grid-content-td-wrap" data-key="'+e+'">',u+=f.renderer.call(f,d,n.objs.modelMap[e].getData()),u+="</div>";break;case"btn":h+="grid-content-td grid-content-td-"+t+" "+l+" "+c,p+=' name="btn-column"';break;case"customWidget":var _=r.widgetName;if(h+="grid-content-td grid-content-td-"+t+" grid-content-td-"+r.name+" "+l+" "+c+" "+r.cls,p+=' name="'+_+'"',_){var w="textbox"==_&&"false"!==f.renderer.call(f,d,n.objs.modelMap[e].getData())?"hidden":"";u+='<div widget="'+_+'" id="'+$.su.randomId("grid-content-custom-widget")+'" class="'+w+'"></div>',r.renderer&&(u+='<div class="content">'+f.renderer.call(f,d,n.objs.modelMap[e].getData())+"</div>")}else u+='<div class="content">'+f.renderer.call(f,d,n.objs.modelMap[e].getData())+"</div>";break;default:h+="grid-content-td grid-content-td-"+t+" grid-content-td-"+r.name+" "+l+" "+c+" "+r.cls,p+=' name="'+r.name+'"',u+='<div class="content">'+f.renderer.call(f,d,n.objs.modelMap[e].getData())+"</div>"}return f.domContent='<td id="'+f.domId+'" class="'+h+'" '+p+'><div class="td-label">'+r.text+'<span class="content-separator">:</span></div><div class="td-content">'+u+"</div></td>",f.callback=function(){var i=this,e=$("#"+f.domId).find("div[widget]");if(0<e.length){var t=i.dom().attr("name");i.customWidget=new $.su.widgets[t]({id:e,customSettings:i.column.settings}),i.customWidget.render(),$("#"+f.domId).find("div[widget]").on("ev_view_change",function(e,t){i.dom().triggerHandler("ev_view_change",[t]),n.objs.grid.dom().triggerHandler("ev_grid_custom_change",[t,i.customWidget,n.rowKey,r])})}},f.settings=n,f},getValue:function(){var e=this.dom();if(this.statusColumn){var t=e.find("a");return!!t.length&&t.attr("data-value")}return this.dom().find("div.content").text()},setValue:function(e){var t,i,n,s=this.dom(),a=this.settings,r=a.cellId,o=a.columns[r],d=o.trueValue||"on",l=o.falseValue||"off",c=this.settings.objs.modelMap[this.settings.rowKey].getData();"string"===$.type(e)&&(e=$.su.transSpecialChar(e));var u=this.renderer(e,c,a.objs.rows.length-1);this.statusColumn?(n="on"===u?(t=$.su.CHAR.GRID.ENABLED,i="enabled",d):(t=$.su.CHAR.GRID.DISABLED,i="disabled",l),s.find("a").removeClass("enabled disabled").addClass(i).attr("data-value",n),s.find("span.text").text(t)):this.customWidget?o.renderer&&!1!==u?(this.customWidget.hide(),this.dom().find("div.content").show().html(u)):(this.dom().find("div.content").hide(),this.customWidget.show(),this.customWidget.setValue(e)):this.dom().find("div.td-content").html(u)},hideButton:function(e){this.dom().find(e).hide()},showButton:function(e){this.dom().find(e).show()},getInnerWidget:function(){return this.customWidget},getDisplay:function(){var e=this.dom();if(!this.customWidget)return e.find("div.content").text();switch(this.customWidget.type){case"grid":return this.customWidget;case"combobox":return this.customWidget.getText();case"textbox":default:return this.customWidget.getValue()}}}),$.su.Widget.register("editor",{settings:{},listeners:[],init:function(e){var s=this,t=$(e.configs[this._type].content).find("div[widget][name]");this.widgets=[],this.settings=e,t.each(function(e,t){var i=$(t).attr("name"),n=$(t).attr("widget");s.widgets.push({id:$(t).attr("id"),name:i,widget:n})}),this.setEditing(!1)},getAllFields:function(){for(var e=[],t=0,i=this.widgets.length;t<i;t++){var n=$("#"+this.widgets[t].id),s=(this.widgets[t].widget,this.widgets[t].name);if(s){var a=n.data("viewObj");a.field=s,e.push(a)}}return e},hide:function(){this.dom().detach().css("display","none")},startEdit:function(e){this.dom();var t=this.settings,i=e||"add",n=(t.objs.grid.dom(),this.getAllFields());t.configs[this._type],this.hide(),this.setEditing(!0),this.setEditingId(i);for(var s=0,a=n.length;s<a;s++)n[s].setNormal()},loadData:function(e){this.settings;for(var t=this.widgets,i=0,n=t.length;i<n;i++)$("#"+t[i].id).data("viewObj").setValue(e[t[i].name])},completeEdit:function(){this.setEditing(!1),this.setEditingId("")},cancelEdit:function(){this.setEditing(!1),this.setEditingId("")},setEditing:function(e){this.settings.configs[this._type].editing=e},isEditing:function(){return this.settings.configs[this._type].editing},setEditingId:function(e){this.settings.configs[this._type].editingIndex=e},getEditingId:function(){return this.settings.configs[this._type].editingIndex}}),function(){var l=$.su.Widget.register("rowEditor",{extend:["editor"],settings:{},listeners:[{selector:"div.btn-cancel",event:"click",callback:function(e,t){var i=t.settings,n=i.objs.grid,s=t.getEditingId(),a=i.objs.grid.getRow(s);t.isEditing()&&!i.configs.rowEditor.adding&&a.enableRow(s).dom().show(),n.dom().triggerHandler("ev_grid_cancel",[s]),t.cancelEdit()}},{selector:"div.btn-submit",event:"click",callback:function(e,t){$(this);var i=t.settings,n=i.objs.grid,s=t.getEditingId(),a=i.objs.grid.getRow(s),r=$.su.getDefaultEvent(t,function(){t.isEditing()&&!i.configs.rowEditor.adding&&a.enableRow(s).dom().show(),t.completeEdit()});n.dom().triggerHandler("ev_grid_save",[r.ev,s]),r.exe()}},{selector:function(){return{parent:this.settings.objs.grid.dom(),target:"tr.grid-content-tr:not(.empty)"}},event:"dblclick",callback:function(e,t){e.stopPropagation(),e.preventDefault();var i=t.settings.objs.grid,n=$(this).attr("data-key");t&&!t.isEditing()&&(t.startEdit(n),i.dom().triggerHandler("ev_grid_edit",[n]))}}],init:function(e){l.superclass.init.call(this,e),this.cells=[]},render:function(){var e=this.dom(),t=this.settings,i=t.configs.columns,n=t.objs.cell,s=t.objs.grid,a=$('<tr class="editor-container" id='+this.domId+"></tr>");e.parent().find("tbody.grid-content-data").append(a),e.remove();for(var r=0,o=i.length;r<o;r++){var d=n.initCell("editor",r,this.editorConfigs);this.cells.push(d)}var l=$('<div id="'+s.domId+'-cancel-button" widget="button" class="btn-cancel button-button" text= "Cancel"></div>'),c=$('<div id="'+s.domId+'-save-button" widget="button" class="btn-submit button-button" text= "Save"></div>'),u=this.dom().find("td").eq(0).empty();l.appendTo(u),c.appendTo(u),this.cancelObj=new $.su.widgets.button({id:l}),this.saveObj=new $.su.widgets.button({id:c}),this.cancelObj.render(),this.saveObj.render(),$(t.configs.rowEditor.content).remove(),this.dom().css("display","none")},startEdit:function(e){var t=this.dom(),n=e||"add",s=this.settings.objs.grid,a=s.dom(),r=null;this.getAllFields();(l.superclass.startEdit.call(this,e),"add"!=n)?(r=s.getRow(n))&&(r.dom().addClass("editing"),r.disableRow(n).dom().hide()):r=a.find("tbody.grid-content-data").find("tr.grid-content-tr").eq(0).row();for(r&&r.dom?t.insertBefore(r.dom()):t.prependTo(a.find("tbody.grid-content-data")),t.show(),i=0,len=this.widgets.length;i<len;i++){var o=this.widgets[i];this.setWidgetWidth($("#"+o.id),o.name,o.widget)}var d=t.height();this.cancelObj.dom().css("top",d),this.saveObj.dom().css("top",d)},completeEdit:function(){var e=this.dom(),t=this.settings,i=t.objs.grid,n=this.getEditingId();if(l.superclass.completeEdit.call(this),this.isEditing()&&!t.configs.rowEditor.adding){var s=t.objs.grid.getRow(n);s.dom().removeClass("editing"),s.enableRow()}e.hide(),i.updateRowNumber()},cancelEdit:function(){var e=this.dom(),t=this.settings,i=t.objs.grid,n=i.dom(),s=t.configs.rowEditor.editingIndex;if(l.superclass.cancelEdit.call(this),"add"!==s){var a=t.objs.grid.getRow(s);a.dom().removeClass("editing"),a.enableRow()}else n.find("tr.grid-content-tr.add").remove();e.hide(),i.updateRowNumber()},setWidgetWidth:function(e,t,i){for(var n=this.dom(),s=this.settings.configs.columns,a={},r=0,o=s.length;r<o;r++){if(s[r].dataIndex)a[s[r].dataIndex]=s[r].width}if("combobox"===i){parseInt(n.find("a.combobox-switch").width(),10),parseInt(n.find("div.widget-error-tips").width(),10);var d=a[t]-13;d<$(e).find(".widget-wrap").outerWidth()&&$(e).find(".widget-wrap").css({"width":d+"px"})}}})}(),function(){var a=$.su.Widget.register("popEditor",{extend:["editor"],settings:{},listeners:[],init:function(e){a.superclass.init.call(this,e),this.cells=[]},render:function(){var n=this,e=this.dom(),t=this.settings,i=(t.configs.columns,t.objs.grid),s=t.configs.popEditor;t.addTitle=s.addTitle||$.su.CHAR.OPERATION.ADD_TITLE,t.editTitle=s.editTitle||$.su.CHAR.OPERATION.EDIT_TITLE,t.addBtnText=s.addBtnText||$.su.CHAR.OPERATION.ADD_DEFAULT,t.editBtnText=s.editBtnText||$.su.CHAR.OPERATION.SAVE_DEFAULT;var a=$('<div class="editor-container" id="'+this.domId+'"><div widget="msg" type="window" close-btn="{true}" msg-title="'+(s.addTitle||"")+'" class="editor-container '+s.cls+'" id="'+this.domId+'-msg" title-bar="{true}"></div></div>'),r=i.dom().find(".grid-panel-content-container .grid-container");$("#"+this.domId+"-msg").remove(),r.append(a),e.remove();var o=$("#"+this.domId+"-msg");o.append($(s.content)),s.customBtns&&o.append($(s.customBtns));var d=$('<div widget="fieldset" class="inline-container btn-container"></div>').appendTo(o),l=$('<div id="'+i.domId+'-cancel-button" widget="button" class="btn-cancel button-button" text= "{OPERATION.CANCEL_UPPERCASE}" label-field={false}></div>'),c=$('<div id="'+i.domId+'-save-button" widget="button" class="btn-submit button-button" text= "{OPERATION.SAVE_UPPERCASE}" label-field={false}></div>');l.appendTo(d),c.appendTo(d),(this.btnContainer=new $.su.widgets.fieldset({id:d})).render(),this.containerMsg=new $.su.widgets.msg({id:o,settings:s.msg}),this.cancelObj=new $.su.widgets.button({id:l}),this.saveObj=new $.su.widgets.button({id:c}),this.containerMsg.render(),this.cancelObj.render(),this.saveObj.render(),o.off("ev_msg_close").on("ev_msg_close",function(){var e=n.getEditingId();i.dom().triggerHandler("ev_grid_cancel",[e]),n.cancelEdit()}),this.cancelObj.dom().off("ev_button_click").on("ev_button_click",function(){var e=n.getEditingId();i.dom().triggerHandler("ev_grid_cancel",[e]),n.containerMsg.close(),n.cancelEdit()}),this.saveObj.dom().off("ev_button_click").on("ev_button_click",function(){$(this);var t=n.settings.objs.grid,i=n.getEditingId(),e=$.su.getDefaultEvent(n,function(){var e=$.su.getDefaultEvent(n,function(){n.completeEdit()});t.dom().triggerHandler("ev_grid_save",[e.ev,i]),e.exe()});t.dom().triggerHandler("ev_grid_before_save",[e.ev]),e.exe(),t.dom().triggerHandler("ev_grid_after_save")})},startEdit:function(e){var t=this.dom(),i=this.settings,n=e||"add";i.objs.grid.dom(),this.getAllFields();a.superclass.startEdit.call(this,e),"add"!=n?(this.saveObj.setText(i.editBtnText),this.containerMsg.setTitle(i.editTitle)):(this.saveObj.setText(i.addBtnText),this.containerMsg.setTitle(i.addTitle)),this.containerMsg.show();var s=t.height();this.cancelObj.dom().css("top",s),this.saveObj.dom().css("top",s)},completeEdit:function(){var e=this.settings.objs.grid;a.superclass.completeEdit.call(this),this.containerMsg.close(),e.updateRowNumber()},cancelEdit:function(){var e=this.settings.objs.grid;a.superclass.cancelEdit.call(this),e.updateRowNumber()},setTitle:function(e){this.containerMsg.setTitle(e)},getMsgBox:function(){return this.containerMsg},getCancelBtn:function(){return this.cancelObj},showBtns:function(){this.btnContainer.show()},hideBtns:function(){this.btnContainer.hide()},destroy:function(){$("#"+this.domId+"-msg").remove()}})}(),$.su.Widget.register("paging",{settings:{numPerPage:{attribute:"num-per-page",defaultValue:8}},listeners:[{selector:"a.paging-btn-num",event:"click",callback:function(e,t){e.stopPropagation(),e.preventDefault();var i=t.settings,n=i.objs.grid,s=$(this),a=parseInt(s.attr("data-index"),10),r=i.plugins.editor||i.plugins.rowEditor,o=n.getPlugin("editor")?i.configs.editor:i.configs.rowEditor;s.hasClass("disabled")||(o&&o.editing&&r.cancelEdit(),t.goToPage(a))}},{selector:"a.pageing-btn-prev",event:"click",callback:function(e,t){e.stopPropagation(),e.preventDefault(),t.settings.objs.grid,$(this).hasClass("disabled")||t.goFirst()}},{selector:"a.pageing-btn-next",event:"click",callback:function(e,t){e.stopPropagation(),e.preventDefault(),t.settings.objs.grid,$(this),$(this).hasClass("disabled")||t.goLast()}}],init:function(e){this.dom();var t=this.settings;this._pageMap={},$.extend(t,e,e.configs.paging)},render:function(){var i=this,e=this.dom(),t=e.parent().find("div.grid-panel-content");grid=this.settings.objs.grid;var n=this.settings,s='<div class="container widget-container paging-container disabled">';s+='<div class="paging-wrap">',s+='<div class="paging-options inline-block hidden">',s+='<div class="paging-info inline-block">',s+="<span></span>",s+="</div>",s+='<div class="paging-select inline-block">',s+='<div id="'+this.domId+'_select" label-field="'+$.su.CHAR.COMMON.GRID_PAGING_PER+'" widget="combobox"></div>',s+="</div>",s+="</div>",s+='<div class="paging-btns inline-block">',s+='<a href="javascript:void(0);" class="paging-btn pageing-btn-prev" data-index="prev">',s+='<span class="icon"></span>',s+='<span class="text">'+$.su.CHAR.OPERATION.PREV+"</span>",s+="</a>",s+='<div class="num-buttons-container">',s+="</div>",s+='<a href="javascript:void(0);" class="paging-btn pageing-btn-next" data-index="next">',s+='<span class="icon"></span>',s+='<span class="text">'+$.su.CHAR.OPERATION.NEXT+"</span>",s+="</a>",s+="</div>",s+="</div>",s+="</div>",s+='<input type="hidden" class="hidden paging-input">',e.append($(s)),t.append(e),this._numSelect=new $.su.widgets.combobox({id:this.domId+"_select"}),this._numSelect.render(),this._numSelect.loadItems(n.items),n.numPerPage=this._numSelect.getValue()||n.numPerPage,n.objs.grid.updateRowNumber(),this._numSelect.dom().on("ev_view_change",function(e,t){i._numSelect.setValue(t.value),n.numPerPage=t.value,i.updateRowPage(grid._keys),i.goToPage(n.currentPage),n.objs.grid.updateRowNumber()})},updateBtns:function(){var e=this.dom(),t=this.settings,i=t.objs.grid,n=e.find("div.paging-btns"),s=n.find("div.num-buttons-container"),a=t.numPerPage,r=t.currentPage,o=t.objs.grid._keys.length,d=Math.ceil(o/a);if(t.totalPage=d,i.dom().find("tr.grid-content-tr").removeClass("hidden"),0==d||1==d)n.addClass("disabled").hide();else{n.removeClass("disabled").show();for(var l="",c=0;c<d;c++)l+='<a href="javascript:void(0);" class="paging-btn paging-btn-num pageing-btn-'+c+'" data-index="'+c+'">',l+='<span class="icon"></span>',l+='<span class="text">'+(c+1)+"</span>",l+="</a>",l+='<span class="dots">...</span>'}s.empty().append($(l)),d<r&&(r=t.currentPage=d),this.goToPage(r)},goToPage:function(e){var t=this.dom(),i=this.settings,n=t.find("div.paging-container"),s=i.objs.grid.dom(),a=(i.objs.rows,isNaN(e)?0:e),r=i.numPerPage,o=i.totalPage,d=s.find("tbody.grid-content-data").eq(0),l=i.objs.grid._keys.length;o<=a&&0<o?a=o-1:a<0&&(a=0);var c=0===l?0:a*r+1,u=0===l?0:c+r-1;u=l<u?l:u;var h=$.su.CHAR.COMMON.GRID_PAGING_SHOW;h=(h=(h=h.replace("%start",c)).replace("%end",u)).replace("%total",l),t.find(".paging-info span").text(h);var p=n.find("a.paging-btn.pageing-btn-prev"),f=n.find("a.paging-btn.pageing-btn-next"),v=n.find("a.paging-btn-num"),g=n.find("span.dots");if(v.removeClass("current"),g.addClass("hidden"),v.filter("[data-index="+a+"]").addClass("current"),5<o){var m=a-2,b=a+2,y=o-1,_=a+2+(m<0?0-m:y<b?y:0),w=m<0?0:m-(y<b?b-y:0);v.addClass("hidden");for(var x=w;x<=_;x++)v.eq(x).removeClass("hidden")}i.currentPage=a;var T=this.getPageKeys();d.children("tr[data-page!="+a+"]").addClass("hidden"),d.children("tr[data-page="+a+"], .grid-content-tr.empty").removeClass("hidden"),s.triggerHandler("ev_store_render_items",[T]),setTimeout(function(){o<=5?(p.hide(),f.hide()):(p.show(),f.show()),0===a?(p.addClass("disabled"),f.removeClass("disabled")):o-1<=a?(p.removeClass("disabled"),f.addClass("disabled")):(p.removeClass("disabled"),f.removeClass("disabled"))},180),s.triggerHandler("ev_grid_paging_changed")},goPrev:function(){var e=this.settings.currentPage;--e<0||this.goToPage(e)},goNext:function(){var e=this.settings,t=e.currentPage;e.totalPage<=++t||this.goToPage(t)},goFirst:function(){var e=this.settings;e.totalPage,e.currentPage=0,this.goToPage(0)},goLast:function(){var e=this.settings,t=e.totalPage;e.currentPage=1<t?t-1:t,this.goToPage(e.currentPage)},getPageKeys:function(){for(var e=this.settings,t=e.objs.grid,i=t._renderMap,n=t._keys,s=e.numPerPage,a=s*e.currentPage,r=a+s-1,o=[],d=a;d<=r;d++)i[n[d]]||n[d]==undefined||o.push(n[d]);return o},updateRowPage:function(e){for(var t=this,i=this.settings,n=i.objs.grid,s=i.numPerPage,a=n.dom().find("tbody.grid-content-data").eq(0).children("tr"),r=0,o=e.length;r<o;r++){var d=Math.floor(r/s);this._pageMap[e[r]]=d}return a.each(function(){var e=$(this).attr("data-key");$(this).attr("data-page",t._pageMap[e])}),this._pageMap}}),$.su.Widget.register("sorts",{settings:{},listeners:[{selector:function(){return{parent:this.settings.objs.grid.dom(),target:"th.grid-header-other"}},event:"click",callback:function(e,t){var i=$(this).attr("name");t.sortByColumn(i)}}],init:function(e){this.settings=$.extend({},this.settings,{objs:e.objs}),this._sortColumnName=null,this._sortKeys=[]},render:function(){},clearSortStatus:function(){var e=this._sortColumnName,t=this.settings.objs.grid;null!==e&&t.dom().find("div.grid-header-container th.grid-header."+e).removeClass("sort-asc sort-desc")},sortByColumn:function(e){var t=this.settings.objs.grid,i=t.dom().find("div.grid-header-container th.grid-header."+e),n=t.dom().find("tbody.grid-content-data");e===this._sortColumnName?i.hasClass("sort-asc")?(i.removeClass("sort-asc").addClass("sort-desc"),this.sortValue(e,!0)):(i.removeClass("sort-desc").addClass("sort-asc"),this.sortValue(e)):(this.clearSortStatus(),i.addClass("sort-asc"),this.sortValue(e)),this._sortColumnName=e;for(var s=0,a=this._sortKeys.length;s<a;s++)n.append(n.find("tr.grid-content-tr[data-key="+this._sortKeys[s]+"]"))},sortValue:function(e,t){var i=this.settings.objs.grid,n=this.settings.objs.modelMap,s={},a=0===this._sortKeys.length?i.getKeys():this._sortKeys;for(var r in n)if(n.hasOwnProperty(r)){var o=n[r].getData()[e];"string"===$.type(o)&&/^\d+$/.test(o)?s[r]=parseInt(o,10):s[r]=o}t?a.sort(function(e,t){return s[e]>s[t]?-1:s[e]<s[t]?1:0}):a.sort(function(e,t){return s[e]<s[t]?-1:s[e]>s[t]?1:0}),this._sortKeys=a}}),$.su.Widget.register("statusBar",{settings:{},listeners:[{selector:function(){return{parent:this.settings.objs.grid.dom(),target:""}},condition:function(e){return!!e.settings.objs.grid.getPlugin("statusBar")},event:"ev_grid_row_clicked ev_grid_row_selected_all ev_grid_row_unselected_all ev_grid_delete",callback:function(e,t,i){i.refreshStatus()}},{selector:function(){return{parent:this.settings.objs.grid.dom(),target:""}},condition:function(e){return!!e.settings.objs.grid.getPlugin("statusBar")},event:"ev_store_bound",callback:function(e,t){t.refreshStatus()}},{selector:function(){return{parent:this.settings.objs.grid.dom(),target:""}},event:"ev_grid_save",callback:function(e,t,i,n){setTimeout(function(){n.refreshStatus()},100)}},{selector:function(){return{parent:this.settings.objs.grid.dom(),target:""}},event:"ev_grid_row_created",callback:function(e,t,i){var n=i.dom();clearTimeout(i._updateTotal),i._updateTotal=setTimeout(function(){n.find("td.grid-status-td span.status-total-num").text(t.length)},100)}},{selector:function(){return{parent:this.settings.objs.grid.dom(),target:""}},event:"ev_grid_check_status",callback:function(e,t){t.refreshStatus()}}],init:function(e){this.settings=$.extend({},this.settings,{objs:e.objs},e.configs.statusBar),this.settings.objs.grid},render:function(){var e=this.dom(),t=this.settings.objs.grid,i=!1!==this.settings.total,n=t.settings.configs.columns,s=this.settings.statusBarText||$.su.CHAR.GRID.TOTAL,a=e.parent().find("div.grid-status-container"),r='<table border="0" cellspacing="0" cellpadding="0">';r+='<tr class="status-row">',r+='<td class="grid-status-td" colspan="'+(n.length-t.columnOffset)+'">',i&&(r+='<span class="status-total">'+s+': <span class="status-total-num"></span></span>'),r+='<span class="status-selected status-selected-text hidden"><span class="status-selected-num"></span></span>',r+="</td>",r+="</tr>",r+="</table>",e.append(r).addClass("grid-status-bar-container"),a.removeClass("hidden").append(e),e.find("td.grid-status-td span.status-total-num").text(this.settings.objs.rows.length)},refreshStatus:function(){var e=this.dom(),t=this.settings.objs.grid,i=t.getSelected(),n=t._keys.length;if(t.getPlugin("paging"),0<i.length?(1==i.length?e.find("td.grid-status-td span.status-selected-num").text($.su.CHAR.GRID.SELECTED_ONE):e.find("td.grid-status-td span.status-selected-num").text($.su.CHAR.GRID.SELECTED.replace("%n%",i.length)),e.find("td.grid-status-td span.status-selected").show()):e.find("td.grid-status-td span.status-selected").hide(),this.toolEnable)if(0<i.length)e.find("td.grid-status-td span.status-btns").show();else{var s=$.su.getDefaultEvent(this,function(){e.find("td.grid-status-td span.status-btns").hide()});t.dom().triggerHandler("ev_grid_tool_status_hide",[s.ev]),s.exe()}e.find("td.grid-status-td span.status-total-num").text(n)}}),$.su.Widget.register("maxLimit",{settings:{},listeners:[],init:function(e){this.limit=0,this.settings=$.extend({},this.settings,{objs:e.objs},e.configs.maxLimit)},render:function(){var e=this.dom(),t=(this.settings.objs.grid,e.parent().find("div.grid-limit-container")),i="<span>"+$.su.CHAR.GRID.MAX_LIMIT+': <span class="limit-num"></span></span>';e.append(i).addClass("grid-limit-bar-container"),t.removeClass("hidden").append(e)},setLimit:function(e){return"number"===$.type(e)&&(this.limit=e,this.dom().find(".limit-num").text(e),!0)},getLimit:function(){return this.limit}}),$.su.Widget.register("msg",{settings:{type:{attribute:"type",defaultValue:"prompt"},_title:{attribute:"msg-title",defaultValue:""},autoshow:{attribute:"autoshow",defaultValue:!1},autoAdapt:{attribute:"auto-adapt",defaultValue:!0},zIndex:{attribute:"z-index",defaultValue:"auto"},contentScroll:{attribute:"content-scroll",defaultValue:!0},dynamicHeight:{attribute:"dynamic-height",defaultValue:!0},mask:{attribute:"mask",defaultValue:!0},msg:{attribute:"msg",defaultValue:""},htmlLoader:{attribute:"html-loader",defaultValue:!1},callback:{attribute:"callback",defaultValue:null},titleBar:{attribute:"title-bar",defaultValue:!0},closeBtn:{attribute:"close-btn",defaultValue:!0},okText:{attribute:"ok-text",defaultValue:$.su.CHAR.OPERATION.OK},yesText:{attribute:"yes-text",defaultValue:$.su.CHAR.OPERATION.YES_UPPERCASE},noText:{attribute:"no-text",defaultValue:$.su.CHAR.OPERATION.NO_UPPERCASE},cancelText:{attribute:"cancel-text",defaultValue:$.su.CHAR.OPERATION.CANCEL_UPPERCASE}},listeners:[{selector:"a.msg-close",event:"click",callback:function(e,t){e.preventDefault(),t.close(),t.dom().triggerHandler("ev_msg_close")}},{selector:"div.btn-msg-ok",event:"click",callback:function(e,t){e.preventDefault(),e.stopPropagation();var i=$.su.getDefaultEvent(t,t.close);t.dom().triggerHandler("ev_msg_ok",[i.ev]),i.exe()}},{selector:"div.btn-msg-no",event:"click",callback:function(e,t){e.preventDefault(),e.stopPropagation();var i=$.su.getDefaultEvent(t,t.close);t.dom().triggerHandler("ev_msg_no",[i.ev]),i.exe()}},{selector:"div.btn-msg-cancel",event:"click",callback:function(e,t){e.preventDefault(),e.stopPropagation();var i=$.su.getDefaultEvent(t,t.close);t.dom().triggerHandler("ev_msg_cancel",[i.ev]),i.exe()}},{selector:".msg-title",event:"mousedown",callback:function(e,s){var t=e||event;s.distanceX=t.clientX-$(this).offset().left,s.distanceY=t.clientY-$(this).offset().top,s.drag=!0;var a=$(window).innerWidth(),r=$(window).innerHeight(),o=s.dom().outerWidth(),d=s.dom().outerHeight();function i(e){if(!1!==s.drag){$.su.isIe&&(e.clientX>=a-10||e.clientX<10||e.clientY>=r-10||e.clientY<10)&&l();var t=e||event,i=t.clientX-s.distanceX,n=t.clientY-s.distanceY;return i<=0?i=0:a-o<=i&&(i=a-o),n<=0?n=0:r-d<=n&&(n=r-d),s.dom().css({top:n+"px",left:i+"px"}),!1}}function l(e){return $(document).off("mouseup",l).off("mousemove",i),!1}return $(document).on("mousemove",i).on("mouseup",l),!1}}],init:function(){},render:function(){var e=this.dom(),t=this.settings;e.addClass(t.cls+" msg-container "+t.type),"ios"===$.su.platform&&e.addClass("ios");var i="";i+='<div class="msg-wrap">',t.closeBtn&&(i+='<a class="widget-close msg-close" href="javascript:void(0);"></a>'),i+='<div class="msg-content-wrap">';var n=t._title||"";t.titleBar&&(i+='<h3 class="widget-title msg-title">',i+='<span class="msg-title-container">'+n+"</span>",i+="</h3>"),i+='<div class="widget-content msg-content-container">'+(t.msg||"")+"</div>",i+="</div>";var s=t.type,a='<div widget="button" id="'+this.domId+'-btn-ok" class="btn-msg-ok" label-field="{false}" text="'+t.okText+'"></div>',r='<div widget="button" id="'+this.domId+'-btn-no" class="btn-msg-no" label-field="{false}" text="'+t.noText+'"></div>',o='<div widget="button" id="'+this.domId+'-btn-ok" class="btn-msg-ok" label-field="{false}" text="'+t.yesText+'"></div>',d='<div widget="button" id="'+this.domId+'-btn-cancel" class="btn-msg-cancel" label-field="{false}" text="'+t.cancelText+'"></div>';switch(s){case"alert":i+='<div class="msg-btn-container">',i+='<div class="msg-btn-wrap">',i+='<div class="button-container inline-block">',i+=a,i+="</div>",i+="</div>",i+="</div>";break;case"confirm":i+='<div class="msg-btn-container">',i+='<div class="msg-btn-wrap">',i+='<div class="button-container inline-block">',i+=r,i+="</div>",i+='<div class="button-container inline-block">',i+=o,i+="</div>",i+="</div>",i+="</div>";break;case"prompt":i+='<div class="button-container msg-btn-container">',i+='<div class="msg-btn-wrap">',i+='<div class="button-container inline-block">',i+=d,i+="</div>",i+='<div class="button-container inline-block">',i+=a,i+="</div>",i+="</div>",i+="</div>";break;case"show":i+='<div class="button-container msg-btn-container">',i+='<div class="msg-btn-wrap">',i+='<div class="button-container inline-block">',i+=o,i+="</div>",i+='<div class="button-container inline-block">',i+=r,i+="</div>",i+='<div class="button-container inline-block">',i+=d,i+="</div>",i+="</div>",i+="</div>";break;case"window":break;default:t.buttons}i='<div class="position-top-left"></div>'+(i='<div class="position-top-center"></div>'+(i='<div class="position-top-right"></div>'+(i='<div class="position-center-left">'+(i='<div class="position-center-right">'+(i+="</div>")+"</div>")+"</div>"))),i+='<div class="position-bottom-left"></div>',i+='<div class="position-bottom-center"></div>',i+='<div class="position-bottom-right"></div>';var l=$("div#msg-boxs-container");0==l.length&&(l=$('<div id="msg-boxs-container" class="msg-boxs-container"></div>'),$("body").append(l)),l.append(e),e.append($(i)).css({"z-index":"auto"==t.zIndex?undefined:t.zIndex,"display":"none"}),t.autoshow&&this.show();for(var c=e.find(".msg-btn-container").find("div[widget=button]"),u=0,h=c.length;u<h;u++)new $.su.widgets.button({id:$(c[u])}).render();0<e.children("div[widget]").length&&e.children("div[widget]").appendTo(e.find("div.msg-content-container"))},show:function(e){var t=this,i=this.dom(),n=this.settings,s=this.getContainer(),a=$(i.find("div.msg-content-wrap .msg-content-container").children().get(0)),r=$(window).height();$(window).width(),a.css({"max-height":r-320+"px"}),n.contentScroll&&0!==a.length&&a.addClass("scroll"),n.mask&&!n.shown&&this.getMask().show(this.domId),t.setPosition("center","center"),n.shown=!0,s.css({left:"-100%"}).show(1,function(){"s"!==$.su.widgetSize&&n.contentScroll&&0!==a.length&&$.su.scrollbar({ele:a[0]},function(e){e.update()}),"s"!==$.su.widgetSize&&!0===n.dynamicHeight&&0!==a.length&&a.css({"max-height":r-parseInt(s.css("top"))-160}),t.setPosition("center","center"),s.css({"opacity":1,"filter":"alpha(opacity=100)"}),s.hide(),s.fadeIn(200),$.isFunction(e)&&e()})},close:function(e,t){var i=this.dom(),n=this.settings,s=this.getContainer(),a="function"===$.type(e)?e:null,r="boolean"===$.type(e)?e:"boolean"===$.type(t)&&t;if(n.shown)return n.mask&&this.getMask().hide(this.domId),r?s.finish().fadeOut(200,function(){n.shown=!1,i.remove()}):s.finish().fadeOut(200,function(){n.shown=!1,s.css({"display":"none","opacity":0,"filter":"alpha(opacity=0)"})}),this.setNormal(),a?a.call(this,this):void 0},hide:function(){var e=this.settings,t=this.getContainer();e.shown=!1,t.finish().css({"display":"none","opacity":0,"filter":"alpha(opacity=0)"}),e.mask&&this.getMask().hide(this.domId),this.setNormal()},setTitle:function(e){var t=this.dom(),i=this.settings;e!==undefined&&(i._title=e,t.find("span.msg-title-container").text(e))},setContent:function(e){var t=this.dom();e&&t.find("div.msg-content-container").html(e)},setButtonText:function(e,t){var i=this.dom();switch(e){case"yes":case"ok":i.find(".btn-msg-ok").data("viewObj").setText(t);break;case"no":i.find(".btn-msg-no").data("viewObj").setText(t);break;case"cancel":i.find(".btn-msg-cancel").data("viewObj").setText(t)}},showButtons:function(){this.dom().find("div.msg-btn-container").fadeIn(150)},hideButtons:function(){this.dom().find("div.msg-btn-container").css("display","none")},disableButton:function(e){var t=this.dom();switch(e){case"yes":case"ok":t.find(".btn-msg-ok").data("viewObj").disable();break;case"no":t.find(".btn-msg-no").data("viewObj").disable();break;case"cancel":t.find(".btn-msg-cancel").data("viewObj").disable()}},enableButton:function(e){var t=this.dom();switch(e){case"yes":case"ok":t.find(".btn-msg-ok").data("viewObj").enable();break;case"no":t.find(".btn-msg-no").data("viewObj").enable();break;case"cancel":t.find(".btn-msg-cancel").data("viewObj").enable()}},destroy:function(){this.dom().remove()},setNormal:function(){this.dom().find("div[widget]").each(function(e,t){var i=$(t).data("viewObj");i&&i.setNormal&&i.setNormal()})}}),$.su.Widget.register("navigator",{settings:{items:{attribute:"items",defaultValue:null},itemWidget:{attribute:"item-widget",defaultValue:null},bubbleEvent:{attribute:"bubble",defaultValue:!1},level:{attribute:"level",defaultValue:null}},listeners:[{selector:"li.navigator-li-effective",event:"click",callback:function(e,t){var i=this.getAttribute("navi-value");t.dom().triggerHandler("ev_navigator_clicked",[i]),e.stopPropagation()}}],init:function(){},render:function(){var e=this.dom(),t=this.settings;e.addClass(t.cls+"navigator-container"),this.loadItems(t.items)},createNavi:function(e,t){var i="navigator-ul";i+=" navigator-ul-level"+t,1<t&&(i+=" navigator-ul-sub");for(var n='<ul class="'+i+'">',s=0;s<e.length;s++){var a=e[s];n+=this.createNaviItem(a,t)}return n+="</ul>"},createNaviItem:function(e,t){var i='<li navi-value="'+e.name+'" class="navigator-li navigator-li-level'+t+" "+(e.children?" has-sub-navi":" navigator-li-effective")+(e.cls?" "+e.cls:"")+'">';return i+='<a href="javascript:void(0)">',i+='<span class="sub-navigator-icon"></span>',i+='<span class="sub-navigator-text">'+e.text+"</span>",i+='<span class="sub-navigator-icon-after"></span>',i+="</a>",e.children&&(!this.settings.level||t<this.settings.level)&&(i+=this.createNavi(e.children,t+1)),i+="</li>"},loadItems:function(e){var t=this.dom(),i=this.settings;i.items=e;var n="";n+='<div class="widget-wrap-outer navigator-wrap-outer">',n+='<div class="widget-wrap navigator-wrap">',i.items&&0<i.items.length&&(n+=this.createNavi(i.items,1)),n+="</div>",n+="</div>",t.empty().append(n)},showToggle:function(){this.dom().toggleClass("show")},find:function(e){return this.dom().find("li.navigator-li[navi-value="+e+"]")},hasChildren:function(e){return 0<this.find(e).find("li.navigator-li").length},select:function(e){this.find(e).addClass("selected")},isSelected:function(e){return this.find(e).hasClass("selected")},unSelect:function(e){this.find(e).removeClass("selected")},unSelectAll:function(){this.dom().find("li.navigator-li.selected").removeClass("selected")},open:function(e){this.find(e).addClass("opened")},close:function(e){this.find(e).removeClass("opened")},toggleOpen:function(e){this.find(e).toggleClass("opened")},closeAll:function(){this.dom().find("li.navigator-li.opened").removeClass("opened")}}),$.su.Widget.register("htmlLoader",{settings:{scroll:{attribute:"data-scroll",defaultValue:null}},init:function(){},render:function(){var e=this.dom(),t=this.settings;e.addClass(t.cls+"html-loader-container"),t.scroll&&$.su.scrollbar&&$.su.scrollbar({ele:e[0]})},load:function(e,t){var i=this.getContainer();i&&("object"===$.type(e)?i.append(e):"string"===$.type(e)&&i.html(e),t&&t())},unload:function(){}}),$.su.Widget.register("mask",{settings:{},init:function(){},render:function(){this.dom().addClass("mask"),this.useMap={},this.hide()},show:function(e){var t=this.dom();e&&!this.useMap.hasOwnProperty(e)&&(this.useMap[e]=!0,t.show().addClass(e),this.resetZIndex())},hide:function(e){var t=this.dom();!1===e?t.hide().removeClass().addClass("mask"):(this.useMap.hasOwnProperty(e)&&(delete this.useMap[e],t.removeClass(e)),this.resetZIndex(),this.checkUse()||t.hide())},resetZIndex:function(){var e=0,t=!1;for(var i in this.useMap)if(this.useMap.hasOwnProperty(i)){t=!0;var n=parseInt($("#"+i).css("zIndex"),10);e<n&&(e=n)}t&&0!=e||(e=998),_this=this.dom().css({zIndex:e})},checkUse:function(){for(var e in this.useMap)if(this.useMap.hasOwnProperty(e))return!0;return!1}}),$.su.Widget.register("loading",{settings:{firstLoading:{attribute:"first-loading",defaultValue:!1}},init:function(){},render:function(){var e,t=this.dom(),i=this.settings;!1===i.firstLoading?(e='<div class="loading-container-wrap">',e+='<div class="loading-container-inner">',e+='<div class="loading-waiting-icon">',e+="</div>",e+="</div>",e+="</div>"):!0===i.firstLoading&&(e='<div class="first-loading">',e+='<div class="loading-spinner-icon"></div>',e+='<div class="loading-text">'+$.su.SMB_CHAR.TIP.LOADING+"</div>",e+="<br />",e+='<div class="loading-text">'+$.su.SMB_CHAR.TIP.WEB_BROWSER+"</div>",e+="</div>"),t.addClass("loading-container").append(e),this.useMap={},this.hide()},show:function(){var e=this.dom();this.getMask().show(this.domId),e.show()},hide:function(){var e=this.dom();this.getMask().hide(this.domId),e.hide()}}),$.su.Widget.register("echart",{settings:{type:{attribute:"type",defaultValue:"line"},width:{attribute:"width",defaultValue:800},height:{attribute:"height",defaultValue:350},autoResize:{attribute:"auto-resize",defaultValue:!1},chartConfigs:{attribute:"echartConfigs",defaultValue:{title:{text:"",subtext:"",x:30,y:20,textStyle:{fontSize:14}},legend:{data:[]},tooltip:{trigger:"axis"},toolbox:{show:!1},calculable:!1,xAxis:[{axisLine:{lineStyle:{color:"#222",width:1,type:"solid"},onZero:!1},axisTick:{show:!1},splitLine:{show:!0},type:"category",boundaryGap:!1,data:[]}],yAxis:[{axisLine:{lineStyle:{color:"#555",width:1,type:"solid"}},axisTick:{show:!1},type:"value",axisLabel:{formatter:"{value}"}}],series:[],animation:!1}}},listeners:[{selector:function(){return{parent:window}},event:"resize",condition:function(e){return!0===e.settings.autoResize},callback:function(e,t){t.resize()}}],init:function(){},destroy:function(){this.echart&&this.echart.clear(),this._isDestroyed=!0},render:function(e){var t=this,i=this.dom(),n=this.settings;i.addClass(n.cls+"chart-container"),i.append('<div class="chart-before"></div><div class="chart-area"><div class="chart-scale"></div><div class="chart-canvas" style="margin-left: auto;margin-right: auto;"></div></div><div class="chart-after"></div>');var s=$.Deferred();return window.echarts===undefined?$.su.router.loadFile("js/libs/echarts.min.v4.js",function(){if(t._isDestroyed)return s.resolve();a(),s.resolve()}):window.echarts&&(a(),s.resolve()),s.promise();function a(){"line"===n.type?t.initLine():"pie"===n.type?t.initPie():"gauge"===n.type?t.initGauge():"tree"===n.type&&t.initTree(),t.resize("100%"==n.width?i.parent().width():n.width,"100%"==n.height?i.parent().height():n.height)}},reCreateCanvas:function(){var e=this.dom(),t=this.settings;e.find("div.chart-canvas").empty(),t.canvas=document.createElement("canvas"),t.canvas.width=t.width,t.canvas.height=t.height,e.find("div.chart-canvas").append(t.canvas),window.G_vmlCanvasManager&&(t.canvas=window.G_vmlCanvasManager.initElement(t.canvas)),this.ctx=t.canvas.getContext("2d")},resize:function(e,t){var i=this.dom();e=e||i.parent().width(),t=t||i.parent().height(),i.find(".chart-canvas").css({width:e,height:t}),this.echart.resize()},initLine:function(){for(var e=this.dom(),t=this.settings.chartConfigs,i=t.xAxis[0].data.length,n=0,s=t.series.length;n<s;n++){var a=t.series[n];a.data=this.adjustDataLength(i,a.data)}this.echart=echarts.init(e.find(".chart-canvas").get(0))},initPie:function(){var e=this.dom();this.settings,this.echart=echarts.init(e.find(".chart-canvas").get(0))},initGauge:function(){var e=this.dom();this.settings,this.echart=echarts.init(e.find(".chart-canvas").get(0))},initTree:function(){var e=this.dom();this.settings,this.echart=echarts.init(e.find(".chart-canvas").get(0))},adjustDataLength:function(e,t){if(t.length>e)t.length=e;else if(t.length<e)for(;t.length<e;)t.push("-");return t},addData:function(e){for(var t=this.echart.getOption().series,i=e.length,n=0;n<i;n++){var s=e[n],a=t[s.seriesIndex].data,r=s.dataIndex;r>a.length-1?(a.shift(),a.push(s.data)):a[r]=s.data}this.echart.setOption({series:t})},setSeries:function(e){for(var t=this.echart.getOption().xAxis[0].data.length,i=0,n=e.length;i<n;i++)e[i].data=this.adjustDataLength(t,e[i].data);this.echart.setOption({series:e},!1)},setOption:function(e,t){var i=this.settings;if((t=t!==undefined&&t)&&(e=$.extend(!0,{},i.chartConfigs,e)),e.xAxis){var n=e.xAxis[0].data.length;e.series=e.series||[];for(var s=0,a=i.chartConfigs.series.length;s<a;s++){var r=e.series[s]=e.series[s]||{};r.data=this.adjustDataLength(n,r.data||[])}}this.echart.setOption(e,t)},setPieOption:function(e,t){this.settings,this.echart.setOption(e,t)},setGaugeOption:function(e,t){this.echart.setOption(e,t)},setTreeOption:function(e,t){this.echart.setOption(e,t)},addListener:function(e,t){this.echart.on(e,t)},getEchart:function(){return this.echart}});var Notes=$.su.Widget.register("notes",{settings:{title:{attribute:"title",defaultValue:""},autoIndex:{attribute:"autoIndex",defaultValue:!0},items:{attribute:"items",defaultValue:null}},listeners:[],init:function(){},render:function(){this.element=this.dom(),this.element.addClass("notes-ctn").empty(),this.settings.title=this.settings.title||$.su.CHAR.COMMON.NOTE+":",this.element.append('<div class="notes-title">'+this.settings.title+"</div>"),this.element.append(this.createListItem(this.settings.items))},createListItem:function(e){if(e&&$.isArray(e)){for(var t,i='<ul class="notes-ul">',n=1,s=0,a=e.length;s<a;s++)(t="")!=(t=$.isFunction(e[s].renderer)?e[s].renderer(e[s].text):e[s].text)&&(!0===this.settings.autoIndex&&(t='<span class="notes-index">'+n+'.</span> <span class="notes-content">'+t+"</span>",n++),i+='<li class="notes-li">',i+=t,i+="</li>");return i+="</ul>"}}});jQuery,$.su.Widget.register("toast",{settings:{noticeText:{attribute:"notice-text",defaultValue:""},showTime:{attribute:"show-time",defaultValue:3e3},fadeTime:{attribute:"fade-time",defaultValue:300}},listeners:[{selector:"div.close",event:"click",callback:function(e,t){e.preventDefault(),e.stopPropagation(),t.hide()}}],init:function(){},render:function(){var e=this.dom(),t=this.settings;e.addClass(t.cls+" notice-bar-container"),e.css({"display":"none"});var i="";i+='<div class="img-wrap">',i+='<span class="icon"></span>',i+="</div>",i+='<div class="text-wrap">',i+='<span class="text">'+t.noticeText+"</span>",i+="</div>",i+='<div class="close">',i+="</div>",e.append(i)},show:function(e,t){var i=this.dom(),n=this,s=this.settings;i.removeClass("success fail other"),t?1==t?i.addClass("fail"):2==t&&i.addClass("other"):i.addClass("success"),e&&this.setText(e),s.timerFlag&&clearTimeout(s.timer),this.dom().fadeIn(s.fadeTime),this.settings.timer=setTimeout(function(){n.hide()},s.showTime),s.timerFlag=!0,this.setPosition("center","auto",null,68)},hide:function(e){this.dom(),this.dom().stop(!0).fadeOut(e?0:this.settings.fadeTime),this.settings.timerFlag=!1},setText:function(e){"string"==typeof e&&this.dom().find("span.text").text(e)}}),function(h){h.su.Widget.register("searchList",{settings:{multiselect:{attribute:"multiselect",defaultValue:!1},maxLine:{attribute:"max-line",defaultValue:4},scroll:{attribute:"scroll",defaultValue:!1},numPerPage:{attribute:"num-per-page",defaultValue:10},pathSeparator:{attribute:"path-separator",defaultValue:">"}},listeners:[{selector:".devicesList-item-container",event:"click",callback:function(e,t){e.stopPropagation();var i=h(this).data("viewObj");if(!i._status.disabled){var n=i._relatedData;if(t.settings.multiselect){var s=h(this).find(".devicesList-item-checkbox[widget=checkbox]").data("viewObj"),a=e.target?e.target:e.srcElement,r=h(a).closest(".devicesList-item-checkbox[widget=checkbox]"),o=!s._status.checked;0<r.size()&&(o=!o);var d=t._selectedData;if(o)s.setValue(!0),d.push(n),h(this).addClass("item-selected");else{s.setValue(!1);for(var l=0,c=d.length;l<c;l++)if(n.key==d[l].key){d.splice(l,1);break}h(this).removeClass("item-selected")}}else{t._selectedData.push(n);var u=t.getSelected();t.dom().triggerHandler("ev_item_click",u),h(this).closest("[widget=devicesList]").find(".item-selected").removeClass("item-selected"),h(this).addClass("item-selected")}}}},{selector:".searchList-paging-container .paging-btn",event:"click",callback:function(e,t){var i=t.dom().find(".searchList-item-container"),n=parseInt(h(this).text(),10),s=t.settings.numPerPage,a=t.dom().find(".paging-btn-num");i.hide(),isNaN(n)&&(n=h(this).hasClass("pageing-btn-prev")?1:a.length),i.filter(function(e){return(n-1)*s<=e&&e<n*s}).show(),t.dom().find(".current").removeClass("current"),a.hide(),n<=2?a.filter(function(e){return e<=4}).show():n>=a.length-1?a.filter(function(e){return e>=a.length-5}).show():a.filter(function(e){return n-3<=e&&e<=n+1}).show(),a.eq(n-1).addClass("current")}}],init:function(e){},render:function(){this.settings;var e=this.dom();e.addClass("searchList-container widget-container ");var t="";t+='<div class="searchList-header">',t+='<div class="searchList-results-title">',t+='<span class="searchList-results-label">'+h.su.CHAR.SEARCH.SEARCH_RESULTS+"</span>",t+='<span class="searchList-results-separator"> - </span>',t+='<span class="searchList-results-count">'+h.su.CHAR.SEARCH.RESULTS+"</span>",t+="</div>",t+="</div>",t+='<div class="no-results-prompt">',t+="<p>"+h.su.CHAR.SEARCH.NO_RESULTS_PROMPT+"</p>",t+="</div>",t+='<div class="searchList-content-container">',t+='<ul class="searchList-content-ul"></ul>',t+="</div>",e.append(t),h.su.scrollbar({ele:".searchList-content-ul"})},loadItems:function(e){var t=this.dom().find(".searchList-content-ul"),i=(this.settings,this.dom());t.empty();var n=e.length;if(0===n)i.find(".no-results-prompt").show(),i.find(".searchList-content-container").hide();else{i.find(".no-results-prompt").hide(),i.find(".searchList-content-container").show();for(var s=0;s<n;s++){var a=e[s],r=h('<li id="'+this.domId+"-item-"+s+'" class="searchList-item-container"></li>'),o=h(this.renderContent(a));r.append(o).appendTo(t)}}i.find(".searchList-results-count").text(n+" "+h.su.CHAR.SEARCH.RESULTS),this.renderSearchList()},renderSearchList:function(){var n=this.dom(),e=this.settings,t=e.maxLine,i=e.numPerPage,s=n.find(".searchList-item-container"),a=s.eq(0).outerHeight(!0)*t;if(s.length>i&&!e.scroll){var r=Math.ceil(s.length/i);s.filter(function(e){return i<=e}).hide()}else e.scroll&&(n.outerHeight(a),n.css({"overflow-y":"scroll"}));!function o(){var e='<div class="searchList-paging-container paging-container disabled">';e+='<div class="paging-wrap">',e+='<div class="paging-btns inline-block">',5<r&&(e+='<a href="javascript:void(0);" class="paging-btn pageing-btn-prev" data-index="prev">',e+='<span class="icon"></span><span class="text"><</span></a>');e+='<div class="num-buttons-container">';for(var t=0;t<r;t++)e+='<a href="javascript:void(0);" class="paging-btn paging-btn-num pageing-btn-'+t+'">',e+='<span class="icon"></span>',e+='<span class="text">'+(t+1)+"</span>",e+="</a>";e+="</div>",5<r&&(e+='<a href="javascript:void(0);" class="paging-btn pageing-btn-next" data-index="next">',e+='<span class="icon"></span><span class="text">></span></a>');e+="</div></div></div>",n.find(".searchList-paging-container").remove(),h(e).appendTo(n);var i=n.find(".paging-btn-num");i.eq(0).addClass("current"),5<r&&i.filter(function(e){return 5<=e}).hide()}()},renderContent:function(e){var t=this.settings,i=e.name,n=e.path,s=e.introduction,a=t.pathSeparator;h.isArray(n)||(n=[n]);var r='<div class="searchList-item-content">',o=n.length;r+='<a href="#'+i+'">';for(var d=0;d<o;d++)r+='<span class="path-node">'+this.handleSearchItemContent(n[d])+"</span>",d!=o-1&&(r+='<span class="path-separator"> '+a+" </span>");return r+="</a>",""!=s&&(r+='<div class="searchList-item-introduction">'+s+"</div>",r+="</div>"),r},setSearchWorld:function(i){this.dom().find(".searchList-item-content").each(function(){var e=h(this).find(".path-node").last();wordTransed=i.replace(/[\*\.\?\+\$\^\[\]\(\)\{\}\|\\\/]/g,function(e){return"\\"+e});var t=new RegExp(wordTransed,"i");e.html(e.text().replace(t,function(e){return'<span class="searchList-matched-text">'+e+"</span>"}))})},handleSearchItemContent:function(e){return e}})}(jQuery),function(){var t=$.su.Widget.register("AXNavigator",{extend:"navigator",listeners:function(){return[{selector:"li.navigator-li a",event:"click",callback:function(e,t){var i=$(this).parent().attr("navi-value");t.hasChildren(i)&&t.toggleOpen(i),i&&t.dom().triggerHandler("ev_navigator_clicked",[i]),e.stopPropagation()}},{selector:"",event:"click",callback:function(e,t){e.stopPropagation()}}]},render:function(){t.superclass.render.call(this),this.initCloseAll()},loadItems:function(e){t.superclass.loadItems.call(this,e),this.initCloseAll(),this.dom().triggerHandler("ev_navigator_loaded",[e])},hide:function(e){var t=this.dom();t.removeClass("show"),t.slideUp(e==undefined?200:0).addClass("hidden")},show:function(e){var t=this.dom();t.removeClass("hidden"),t.slideDown(e==undefined?200:0).addClass("show")},toggleShow:function(){var e=this.dom();e.hasClass("show")?e.slideUp(200).addClass("hidden"):e.slideDown(200).removeClass("hidden"),e.toggleClass("show")},select:function(e){this.dom();this.unSelectAll(),this.closeSiblings(e);var t=this.find(e);t.addClass("selected"),t.parentsUntil($(".navigator-ul-level1"),".navigator-li").addClass("has-child-selected")},unSelectAll:function(){var e=this.dom().find("li.navigator-li.selected");e.removeClass("selected"),e.parentsUntil($(".navigator-ul-level1"),".navigator-li").removeClass("has-child-selected")},openItem:function(e){e.addClass("opened").children("ul.navigator-ul").slideDown(200)},closeItem:function(e){e.removeClass("opened").children("ul.navigator-ul").slideUp(200)},closeAll:function(){var e=this.dom();e.find("li.navigator-li").removeClass("opened"),e.find("ul.navigator-ul-sub").slideUp(0)},initCloseAll:function(){this.dom().find("ul.navigator-ul-sub").slideUp(0)},open:function(e){var t=this.find(e);this.closeSiblings(e),this.openItem(t),this.dom().triggerHandler("ev_navigator_opened",[e])},close:function(e){var t=this.find(e);this.closeSiblings(e),this.closeItem(t),this.closeItem(t.find("li.navigator-li"))},closeSiblings:function(e){var t=this.find(e).siblings("li.navigator-li.opened"),i=t.find("li.navigator-li.opened");this.closeItem(t),this.closeItem(i)},isOpened:function(e){return this.find(e).hasClass("opened")},toggleOpen:function(e){this.isOpened(e)?this.close(e):this.open(e)},addClass:function(e){return this.dom().addClass(e)},removeClass:function(e){return this.dom().removeClass(e)}})}(),$.su.Widget.register("search",{settings:{itemName:{attribute:"item-name",defaultValue:""}},listeners:[{selector:function(){return{parent:"#"+this.textbox.domId}},event:"ev_view_change",callback:function(e,t,i){if("value"==t.type){var n=t.value;i.dom().triggerHandler("ev_view_change",[{"type":"value","value":n}])}}},{selector:"input",event:"focus",callback:function(e,t){t.dom().triggerHandler("ev_view_change",[{"type":"value","value":t.textbox.getValue()}]),t.dom().find(".search-content-container").show()}},{selector:"",event:"blur",callback:function(e,t){t.dom().find(".search-content-container").hide()}},{selector:"",event:"keydown",callback:function(e,t){var i=t.dom().find("li.search-content-li"),n=i.length,s=t.dom().find("li.search-content-li.focused"),a=s.index(),r=e.keyCode;40==r?a<0&&0<n?i.eq(0).addClass("focused"):0<=a&&a<n-1&&(i.eq(a).removeClass("focused"),i.eq(a+1).addClass("focused")):38==r?(0<a?(i.eq(a).removeClass("focused"),i.eq(a-1).addClass("focused")):0==a&&i.eq(a).removeClass("focused"),e.preventDefault()):13==r&&0<=a&&s.trigger("click")}},{selector:"li.search-content-li",event:"click",callback:function(e,t){var i=$(this).attr("event-key");i&&t.dom().triggerHandler("ev_item_selected",[i]),t.dom().find(".search-content-container").hide()}}],init:function(){},render:function(){var e=this.dom();this.settings,e.empty();var t=$('<div widget="textbox"></div>');t.attr("id",this.domId+"-sub-textbox"),e.append(t),this.textbox=new $.su.widgets.textbox({id:t}),this.textbox.render(),e.append('<div class="search-content-container"><div class="search-content-ul-before"></div><ul class="search-content-ul"></ul><div class="search-content-ul-after"></div></div>')},setValue:function(e){this.textbox.setValue(e)},loadItems:function(e){if(e){var t=this.dom().find(".search-content-ul");t.empty();for(var i=e.length,n="",s=0;s<i;s++){var a=e[s];n+='<li class="search-content-li" event-key="'+a.name+'">',n+='<div class="search-content-li-body">',n+='<div class="search-content-li-text-before"></div>',n+='<div class="search-content-li-text">'+a.text+"</div>",n+='<div class="search-content-li-text-after"></div>',n+="</div>",n+="</li>"}t.append(n)}}}),$.su.Widget.register("mobileTopBar",{settings:{readOnly:{attribute:"read-only",defaultValue:!1},leftButtonId:{attribute:"left-button-id",defaultValue:null},rightButtonId:{attribute:"right-button-id",defaultValue:null}},listeners:[{selector:".text-wrap input",event:"keyup",callback:function(e,t){var i=$(this).val();t.dom().triggerHandler("ev_view_change",[{"type":"value","value":i}])}}],init:function(){},render:function(){var e=this.dom(),t=this.settings,i="<div>";if(i+='<div class="logo inline-block"></div>',i+='<div class="center-text inline-block hidden"></div>',i+='<div class="top-bar-button-container">',null==t.leftButtonId)t.leftButtonId="menu-button",i+='<div widget="button" icon-cls="menu" class="inline-block menu-button" id="menu-button"></div>';else{var n=$("#"+this.settings.leftButtonId);n.attr("widget","button")}if(null==t.rightButtonId)t.rightButtonId="func-button",i+='<div widget="button" class="inline-block func-button" id="func-button" text="{COMMON.SAVE}"></div>';else{var s=$("#"+this.settings.rightButtonId);s.attr("widget","button")}i+="</div>",i+="</div>";var a=$(i);n&&a.find(".top-bar-button-container").prepend(n),s&&a.find(".top-bar-button-container").append(s),e.addClass("top-bar").empty().append(a),e.find("div[widget=button]").each(function(){var e=$(this);new $.su.widgets.button({id:e}).render()})},setCenterText:function(e){if(null!==e&&e!==undefined){var t=this.dom().find(".logo"),i=this.dom().find(".center-text");""===e?(t.show(),i.hide()):(t.hide(),i.show().html(e))}},leftBtn:function(){return this.dom().find("#"+this.settings.leftButtonId).data("viewObj")},rightBtn:function(){return this.dom().find("#"+this.settings.rightButtonId).data("viewObj")},addClass:function(e){return this.dom().addClass(e)},removeClass:function(e){return this.dom().removeClass(e)}}),jQuery,$.su.Widget.register("transition",{init:function(){this._fields=[]},render:function(){var i=this;this._domStr=this.dom().html();var e=this._domStr.replace(/{.*?}/g,function(e){var t=$.su.getAttrObject($.su.CHAR,e);return t||(i._fields.push({name:e.replace(/[\{,\}]/g,""),value:null}),e)}),t=(this._initTransferedStr=e).replace(/{.*?}/g,function(e){return""});this.dom().html(t)},setField:function(e,t){for(var i=this._fields,n=0;n<i.length;n++)i[n].name===e&&(i[n].value=t);this._updateDomStr()},_updateDomStr:function(){var a=this,e=this._initTransferedStr.replace(/{.*?}/g,function(e){for(var t=e.replace(/[\{,\}]/g,""),i=a._fields,n=0;n<i.length;n++)if(i[n].name===t){var s=$.su.escapeHtml(i[n].value);return null===s?"":s}return""});this.dom().html(e)}}),function(o){o.su.Widget.register("information",{settings:{operation:{attribute:"operation",defaultValue:""},plugins:{attribute:"plugins",defaultValue:""},caseSensitive:{attribute:"case-sensitive",defaultValue:!0}},listeners:[{selector:".information-panel-tbar-container .search-text",event:"keyup",callback:function(e,t){13===e.keyCode&&t.dom().find(".btn-search").trigger("click")}},{selector:".information-panel-tbar-container .btn-search",event:"click",callback:function(e,t){var i=t.dom().find(".search-text").val();t.search(i),t._search.success&&t.showResult(),t._search.success&&0<t._search.total&&t.jumpTo(t._search.current)}},{selector:".information-panel-tbar-container .btn-search-prev",event:"click",callback:function(e,t){t._search.current<=1?t._search.current=t._search.total:t._search.current--,t.jumpTo(t._search.current)}},{selector:".information-panel-tbar-container .btn-search-next",event:"click",callback:function(e,t){t._search.current>=t._search.total?t._search.current=1:t._search.current++,t.jumpTo(t._search.current)}},{selector:".information-panel-tbar-container .btn-clear",event:"click",callback:function(e,t){t.clear()}},{selector:".information-panel-tbar-container .btn-refresh",event:"click",callback:function(e,t){t.refresh()}}],init:function(e){this._items=[],this._textList=[],this._keyMap={},this._search={}},render:function(){var e=this.dom(),t=this.settings;e.addClass("container widget-container information-panel-container");var i=o('<div class="information-panel-wrap"><div class="information-panel-content"><div class="information-panel-tbar-container hidden"></div><div class="information-panel-content-container"><div class="information-content-container"><div class="information-content-inner"></div></div></div></div></div>');e.append(i),t.plugins&&this.initPlugins(t.plugins.split("|")),o.su.scrollbar({ele:e.find(".information-content-container")[0],opts:{minScrollbarLength:50}})},initPlugins:function(e){var n=this.dom(),s=this,a=this.settings;s.plugins={};for(var t=0,i=(e=o.isArray(e)?e:[e]).length;t<i;t++)r(e[t]);function r(e){var t=o.extend({},a,{objs:{grid:s},plugins:s.plugins});switch(e){case"tBar":t.operation&&s.initTBar(t.operation.split("|"));break;case"paging":e="informationPaging";var i=o('<div id="'+s.domId+"_"+e+'"></div>').appendTo(n);o.su.widgets[e]&&(s.plugins[e]=new o.su.widgets[e](o.extend(t,{id:i})),s.plugins[e].render())}}},initTBar:function(e){var t=this.dom().find("div.information-panel-tbar-container");this.settings;t.removeClass("hidden");for(var i='<div class="operation-container" id="'+this.domId+'">',n=0,s=e.length;n<s;n++)switch(e[n]){case"clear":i+='<a href="javascript:void(0);" tbar-name="clear" class="operation-btn btn-clear">',i+='<span class="icon"></span>',i+='<span class="text">'+o.su.CHAR.OPERATION.CLEAR_ALL+"</span>",i+="</a>";break;case"search":i+='<div class="text-container search-container hidden-result">',i+='<div class="widget-wrap text-wrap search-text-wrap">',i+='<span class="text-wrap-inner">',i+='<input type="text" class="text-text search-text" placeholder="'+o.su.CHAR.COMMON.SEARCH+'" />',i+="</span>",i+='<a href="javascript:void(0);" class="btn-search"></a>',i+="</div>",i+='<div class="search-result-wrap">',i+='<span class="search-result-success">',i+='<span class="search-result-text">'+o.su.CHAR.OPERATION.RESULT+": ",i+='<span id="search-result-current"></span>/<span id="search-result-total"></span>',i+="</span>",i+='<a href="javascript:void(0);" tbar-name="search-next" class="search-result-btn btn-search-next">',i+='<span class="icon"></span>',i+="</a>",i+='<a href="javascript:void(0);" tbar-name="search-prev" class="search-result-btn btn-search-prev">',i+='<span class="icon"></span>',i+="</a>",i+="</span>",i+='<span class="search-result-fail"><span class="search-result-text">'+o.su.CHAR.OPERATION.NO_MATCHES+"</span></span>",i+="</div>",i+="</div>";break;case"refresh":i+='<a href="javascript:void(0);" tbar-name="refresh" class="operation-btn btn-refresh">',i+='<span class="icon"></span>',i+='<span class="text">'+o.su.CHAR.OPERATION.REFRESH+"</span>",i+="</a>"}var a=o(i+="</div>");t.append(a)},syncData:function(e,t){this._items=[],this._textList=[],this.hideResult(),this.dom().find(".search-text").val(""),this.dom().find(".information-content-inner").empty(),this.dom().triggerHandler("ev_store_render_items",[e])},renderModels:function(e,t,i){this.dom(),this.settings;for(var n="",s=0;s<t.length;s++){var a=t[s].getData();this._items.push(a),this._keyMap[a.key]=s,n+=this.renderRow(a,s)}this.dom().find(".information-content-inner").html(n)},getRow:function(e,t){this.dom(),this.settings},createRow:function(e,t){this.dom(),this.settings},renderRow:function(e,t){var i=this.convert(e);return this._textList.push(i),'<p class="information-wrap" data-index="'+t+'">'+i+"</p>"},getPlugin:function(e){this.settings;return this.plugins[e]},remove:function(e){var t=this._keyMap[e],i=this.dom();t!==undefined?(i.find(".information-wrap[data-index="+t+"]").remove(),delete this._keyMap[e],this._items.splice(t,1),this._textList.splice(t,1)):(i.find(".information-content-inner").html(""),this.init(),paging=this.getPlugin("informationPaging"),paging&&paging.updateBtns())},updateBtns:function(){var e;(e=this.getPlugin("informationPaging"))&&e.updateBtns()},refresh:function(){this.dom().triggerHandler("ev_refresh"),this.hideResult(),this.dom().find(".search-text").val("")},clear:function(){this.dataBind[0];this.dom().triggerHandler("ev_grid_delete_all"),this.hideResult(),this.dom().find(".search-text").val(""),this.dom().triggerHandler("ev_clear")},search:function(e){var t=this,i=t.dom().find(".information-content-inner");if(t.hideResult(),"string"===o.type(e)&&0!==e.length){var n,s=0,a=(n=(n=e).replace(/[\*\.\?\+\$\^\[\]\(\)\{\}\|\\\/]/g,function(e){return"\\"+e}),new RegExp(n,t.settings.caseSensitive?"g":"gi"));return i.find(".information-wrap").each(function(){var e;e=o(this).text().replace(a,function(e){return'<span id="search-result-'+ ++s+'" class="highlight">'+o("<div>").text(e).html()+"</span>"}),o(this).html(e)}),t._search.current=1,t._search.total=s,t._search.text=e,t._search.success=!0,s}},clearSearch:function(){this.dom().find(".highlight").replaceWith(function(){return o(this).html()})},showResult:function(){var e=this._search.total,t=this.dom().find(".search-container");0===e?t.addClass("fail-result").removeClass("success-result"):(this.dom().find("#search-result-total").text(e),t.addClass("success-result").removeClass("fail-result")),t.removeClass("hidden-result")},hideResult:function(){this._search.current=1,this._search.total=0,this._search.text="",this._search.success=!1,this.dom().find(".search-container").addClass("hidden-result").removeClass("success-result","fail-result"),this.clearSearch()},jumpTo:function(e){var t=this.dom(),i=t.find("#search-result-"+e),n=t.find(".information-panel-content-container"),s=t.find(".information-content-container"),a=s.height(),r=n.height(),o=n.outerHeight(),d=s.scrollTop(),l=(o-r)/2,c=i.position().top;t.find(".highlight").removeClass("target"),i.addClass("target"),s.scrollTop(c+d-a+2*l),t.find("#search-result-current").text(this._search.current)},getDisplay:function(){return this._textList},convert:function(e){var t,i="";if(this.settings.configs&&"function"===o.type(this.settings.configs.convert)&&this.settings.configs.convert)i=this.settings.configs.convert(e);else{t=this.dataBind[0].dataObj.fields.slice(0,-1);for(var n=0;n<t.length;n++)i+=e[t[n].name]+" "}return i=o("<div>").text(i).html()}})}(jQuery),$.su.Widget.register("informationPaging",{settings:{numPerPage:{attribute:"num-per-page",defaultValue:8},enablePageSize:{attribute:"enable-page-size",defaultValue:!1}},listeners:[{selector:"a.paging-btn-num",event:"click",callback:function(e,t){e.stopPropagation(),e.preventDefault();var i=t.settings,n=i.objs.grid,s=$(this),a=parseInt(s.attr("data-index"),10),r=i.plugins.editor||i.plugins.rowEditor,o=n.getPlugin("editor")?i.configs.editor:i.configs.rowEditor;s.hasClass("disabled")||(o&&o.editing&&r.cancelEdit(),t.goToPage(a))}},{selector:"a.pageing-btn-prev",event:"click",callback:function(e,t){e.stopPropagation(),e.preventDefault(),t.settings.objs.grid,$(this).hasClass("disabled")||t.goFirst()}},{selector:"a.pageing-btn-next",event:"click",callback:function(e,t){e.stopPropagation(),e.preventDefault(),t.settings.objs.grid,$(this),$(this).hasClass("disabled")||t.goLast()}}],init:function(e){this.dom();var t=this.settings;this._pageMap={},$.extend(t,e,e.configs.paging)},render:function(){var i=this,e=this.dom(),t=e.parent().find("div.grid-panel-content");grid=this.settings.objs.grid;var n=this.settings,s='<div class="container widget-container paging-container disabled">';s+='<div class="paging-wrap">',s+='<div class="paging-options inline-block hidden">',s+='<div class="paging-info inline-block">',s+="<span></span>",s+="</div>",s+='<div class="paging-select inline-block">',s+='<div id="'+this.domId+'_select" label-field="'+$.su.CHAR.COMMON.GRID_PAGING_PER+'" widget="combobox"></div>',s+="</div>",s+="</div>",s+='<div class="paging-btns inline-block">',s+='<a href="javascript:void(0);" class="paging-btn pageing-btn-prev" data-index="prev">',s+='<span class="icon"></span>',s+='<span class="text">'+$.su.CHAR.OPERATION.PREV+"</span>",s+="</a>",s+='<div class="num-buttons-container">',s+="</div>",s+='<a href="javascript:void(0);" class="paging-btn pageing-btn-next" data-index="next">',s+='<span class="icon"></span>',s+='<span class="text">'+$.su.CHAR.OPERATION.NEXT+"</span>",s+="</a>",s+="</div>",s+="</div>",s+="</div>",s+='<input type="hidden" class="hidden paging-input">',e.append($(s)),t.append(e),n.numPerPage=n.numPerPage,n.enablePageSize&&(this._numSelect=new $.su.widgets.combobox({id:this.domId+"_select"}),this._numSelect.render(),this._numSelect.loadItems(n.items),n.numPerPage=this._numSelect.getValue()||n.numPerPage,this._numSelect.dom().on("ev_view_change",function(e,t){i._numSelect.setValue(t.value),n.numPerPage=t.value,i.updateRowPage(grid._keys),i.goToPage(n.currentPage),n.objs.grid.updateRowNumber()}))},setTotalPage:function(e,t){this._totalPage=e,t.totalRows&&(this.settings.totalRows=t.totalRows),t.currentPage&&(this.settings.currentPage=t.currentPage),t.currentPageSize&&(this.settings.numPerPage=t.currentPageSize)},updateBtns:function(){var e=this.dom(),t=this.settings,i=t.objs.grid,n=e.find("div.paging-btns"),s=n.find("div.num-buttons-container"),a=(t.numPerPage,t.currentPage),r=this._totalPage;if(t.totalPage=r,i.dom().find("tr.grid-content-tr").removeClass("hidden"),0==r||1==r)n.addClass("disabled").hide();else{n.removeClass("disabled").show();for(var o="",d=0;d<r;d++)o+='<a href="javascript:void(0);" class="paging-btn paging-btn-num pageing-btn-'+d+'" data-index="'+d+'">',o+='<span class="icon"></span>',o+='<span class="text">'+(d+1)+"</span>",o+="</a>",o+='<span class="dots">...</span>'}s.empty().append($(o)),r<a&&(a=t.currentPage=r),this.goToPage(a)},goToPage:function(e){var t=this.dom(),i=this.settings,n=t.find("div.paging-container"),s=i.objs.grid.dom(),a=isNaN(e)?0:e,r=i.numPerPage,o=i.totalPage,d=s.find("tbody.grid-content-data").eq(0);o<=a&&0<o?a=o-1:a<0&&(a=0);var l=n.find("a.paging-btn.pageing-btn-prev"),c=n.find("a.paging-btn.pageing-btn-next"),u=n.find("a.paging-btn-num"),h=n.find("span.dots");if(u.removeClass("current"),h.addClass("hidden"),u.filter("[data-index="+a+"]").addClass("current"),5<o){var p=a-2,f=a+2,v=o-1,g=a+2+(p<0?0-p:v<f?v:0),m=p<0?0:p-(v<f?f-v:0);u.addClass("hidden");for(var b=m;b<=g;b++)u.eq(b).removeClass("hidden")}i.currentPage=a,d.children("tr[data-page!="+a+"]").addClass("hidden"),d.children("tr[data-page="+a+"], .grid-content-tr.empty").removeClass("hidden"),setTimeout(function(){o<=5?(l.hide(),c.hide()):(l.show(),c.show()),0===a?(l.addClass("disabled"),c.removeClass("disabled")):o-1<=a?(l.removeClass("disabled"),c.addClass("disabled")):(l.removeClass("disabled"),c.removeClass("disabled"))},180),s.triggerHandler("ev_grid_paging_changed",[a,r])},goPrev:function(){var e=this.settings.currentPage;--e<0||this.goToPage(e)},goNext:function(){var e=this.settings,t=e.currentPage;e.totalPage<=++t||this.goToPage(t)},goFirst:function(){var e=this.settings;e.totalPage,e.currentPage=0,this.goToPage(0)},goLast:function(){var e=this.settings,t=e.totalPage;e.currentPage=1<t?t-1:t,this.goToPage(e.currentPage)},getPageKeys:function(){for(var e=this.settings,t=e.objs.grid,i=t._renderMap,n=t._keys,s=e.numPerPage,a=s*e.currentPage,r=a+s-1,o=[],d=a;d<=r;d++)i[n[d]]||n[d]==undefined||o.push(n[d]);return o},updateRowPage:function(e){for(var t=this,i=this.settings,n=i.objs.grid,s=i.numPerPage,a=n.dom().find("tbody.grid-content-data").eq(0).children("tr"),r=0,o=e.length;r<o;r++){var d=Math.floor(r/s);this._pageMap[e[r]]=d}return a.each(function(){var e=$(this).attr("data-key");$(this).attr("data-page",t._pageMap[e])}),this._pageMap}}),$.su.Widget.register("treeNode",{settings:{childrenProp:{attribute:"children-prop",defaultValue:"branches"}},listeners:[],init:function(){this._key=$.su.guid("tree-node")},render:function(){this.dom().addClass("tree-node-container")},loadData:function(e){this.dom(),this.settings.childrenProp,this._renderNodeAsBranch(e)},setValue:function(e){},_nodeIsBranch:function(e){},_nodeIsLeaf:function(e){},_renderNodeAsBranch:function(e,t){this._children=[]},_renderNodeAsLeaf:function(e,t){},_findByKey:function(e){if(e===this._key)return this;if(this._children){for(var t=0;t<this._children.length;t++){var i=this._children[t];if(i._findByKey(e))return i}return!1}return!1},find:function(e){}}),$.su.Widget.register("tree",{settings:{childrenProp:{attribute:"children-prop",defaultValue:"branches"},type:{attribute:"type",defaultValue:""}},listeners:[],init:function(){},render:function(){var e=this.dom();e.addClass("tree-container"),e.append('<div class="tree-root"><ul class="tree-root-children-ul"></ul></div>')},_createRootNode:function(e){return new $.su.widgets.treeNode({id:e})},renderTree:function(e){var t=this.settings;$.isArray(e)||(e=[e]);var i=0,n=e.length;for(this._children=[];i<n;i++){var s=$("topo"===t.type?"<div></div>":'<div uuid="'+e[i].uuid+'"></div>');this.dom().find(".tree-root-children-ul").append(s);var a=this._createRootNode(s);this._children.push(a),a.render(),a.loadData(e[i])}},_findByKey:function(e){if(this._children){for(var t=0;t<this._children.length;t++){var i=this._children[t];if(i._findByKey(e))return i}return!1}return!1}}),function(){var s={"FULL":"full","PARTIAL":"partial","UNSELECTED":"unSelected"},e={"FULL":"selected","PARTIAL":"partial-selected"},d=$.su.Widget.register("folderTreeNode",{extend:"treeNode",settings:function(e){return $.extend(!0,{},e,{accordion:!1,lazyLoad:!0})},listeners:function(){return[{selector:".topo-tree-icon",event:"click",callback:function(e,t){e.stopPropagation();var i=t.dom();i.find(".topo-tree-icon:first").hasClass("offline")||(i.closest(".topo-container").find(".folder-tree-folder-node-row").removeClass("selected"),i.children(".folder-tree-folder-node-row").addClass("selected"),i.closest(".topo-container").triggerHandler("ev_item_click",[t._mac,t._nickname,t._modelName,t._key]))}}]},init:function(){d.superclass.init.call(this),this._selectStatus=s.UNSELECTED,this.parentNode=null},render:function(){d.superclass.render.call(this),this.dom().addClass("folder-tree-node-container")},_nodeIsBranch:function(e){return e.hasBranch||e.branches&&0<e.branches.length},_nodeIsLeaf:function(e){return!e.hasBranch},_renderNodeAsBranch:function(e){this._children=[],this._mac=e.mac,this._nickname=e.nickname,this._modelName=e.name;var t=this.dom();t.addClass("folder-tree-folder-node empty"),e.lastChild&&t.addClass("last-child");var i="";i+='<div class="folder-tree-folder-node-row topo">',i+='<div class="topo-tree-icon'+(0<e.modelImg.indexOf("offline")?" offline ":" ")+e.modelImg+'"></div>',i+='<p class="text-node">',i+='<span class="folder-tree-folder-node-text">'+e.nickname+"</span>","master"===e.role&&(i+='<br><span style="font-size: 9px;line-height: 10px;font-weight: normal" class="folder-tree-folder-node-text">'+$.su.CHAR.NETWORK_MAP.MAIN_DECO+"</span>"),i+="</p>",i+="</div>",t.append(i);var n=$('<div class="folder-tree-folder-node-children-ul topo"></div>'),s=e[this.settings.childrenProp];this._nodeIsBranch(e)&&t.removeClass("empty"),0<s.length&&(t.append(n),this._renderNodeAsChild(e))},_renderNodeAsChild:function(e){var t=e[this.settings.childrenProp],i=this.dom(),n=i.find(".folder-tree-folder-node-children-ul"),s=t&&t.length,a=0;if(!(0<s))return i.addClass("empty"),!1;for(i.removeClass("empty");a<s;a++){var r=$("<div></div>");n.append(r);var o=new d({id:r});this._children.push(o),o.parentNode=this,o.render(),a===s-1&&(t[a].lastChild=!0),o.loadData(t[a])}return!0},_renderNodeAsLeaf:function(e){},open:function(e){e=e||0===e?e:200,this._open=!0;var t=this.dom();t.find(".folder-tree-folder-node-children-ul").eq(0).slideDown(e),t.find(".folder-tree-folder-node-open-icon").eq(0).addClass("opened")},close:function(e){e=e||0===e?e:200,this._open=!1;var t=this.dom();t.find(".folder-tree-folder-node-children-ul").eq(0).slideUp(e),t.find(".folder-tree-folder-node-open-icon").eq(0).removeClass("opened")},select:function(){this._selectStatus!=s.FULL&&(this._selectStatus=s.FULL,this.dom().find(".folder-tree-folder-node-select-icon").eq(0).removeClass(e.PARTIAL).addClass(e.FULL))},unSelect:function(){this._selectStatus!=s.UNSELECTED&&(this._selectStatus=s.UNSELECTED,this.dom().find(".folder-tree-folder-node-select-icon").eq(0).removeClass(e.PARTIAL+" "+e.FULL))},partialSelect:function(){this._selectStatus!=s.PARTIAL&&(this._selectStatus=s.PARTIAL,this.dom().find(".folder-tree-folder-node-select-icon").eq(0).removeClass(e.FULL).addClass(e.PARTIAL))},syncSelectedStatusToChildren:function(){var i,e=this._selectStatus;e==s.FULL?i="select":e==s.UNSELECTED&&(i="unSelect"),this._children&&$.each(this._children,function(e,t){i&&t[i](),t.syncSelectedStatusToChildren()})},syncSelectedStatusToParent:function(){if(this.parentNode){for(var e=!0,t=!0,i=this.parentNode._children.length,n=0;n<i;n++){switch(this.parentNode._children[n]._selectStatus){case s.FULL:t=!1;break;case s.UNSELECTED:e=!1;break;case s.PARTIAL:e=t=!1}if(!e&&!t)break}e?this.parentNode.select():t?this.parentNode.unSelect():this.parentNode.partialSelect(),this.parentNode.syncSelectedStatusToParent()}},getSelectedTree:function(i){this._selectStatus==s.FULL?i.push(this._path):this._children&&$.each(this._children,function(e,t){t.getSelectedTree(i)})},_findByPath:function(e){if(e===this._path)return this;if(this._children){for(var t=0;t<this._children.length;t++){var i=this._children[t];if(i._findByPath(e))return i._findByPath(e)}return!1}return!1}})}(),function(){var t=$.su.Widget.register("folderTree",{extend:"tree",listeners:function(){return[{selector:".topo-container",event:"ev_test",callback:function(e,t,i){a}},{selector:".folder-tree-root-children-ul",event:"ev_click_item_open",callback:function(e,t,i){i._selectTree([i._unexpandedTree])}}]},init:function(){this._originData=[],this._unexpandedTree=[],this._setOnce=!0},render:function(){var e=this.settings,t=!1===e.labelField?"label-empty":"",i=this.dom();i.addClass("widget-container folder-tree-container tree-container "+t),"topo"===e.type&&i.addClass("topo-container");var n="";null!==e.labelField&&"topo"!==e.type&&(n+='<div class="widget-fieldlabel-wrap '+e.labelCls+'">',n+='<div class="widget-fieldlabel-inner">',n+='<label class="widget-fieldlabel text-fieldlabel">'+e.labelField+"</label>",e.labelField&&(n+='<span class="widget-separator">'+e.separator+"</span>"),n+="</div>",n+="</div>"),n+='<div class="widget-wrap-outer folder-tree-wrap-outer tree-wrap-outer">',n+='<div class="widget-wrap folder-tree-wrap tree-wrap">',n+='<div class="folder-tree-root tree-root">',n+='<ul class="folder-tree-root-children-ul tree-root-children-ul">',n+="</ul>",n+="</div>",n+="</div>",n+="</div>",i.append(n),$.su.scrollbar({ele:i.find(".folder-tree-wrap-outer")[0],opts:{wheelPropagation:!0,useBothWheelAxes:!0,suppressScrollY:!0}})},_createRootNode:function(e){return new $.su.widgets.folderTreeNode({id:e})},clearTree:function(e){this.dom().find(".tree-root-children-ul").empty()},renderTree:function(e){t.superclass.renderTree.call(this,e),this.setValue(null)},setValue:function(e){null!==e?e.length&&"object"==typeof e&&(this._setOnce&&(this._originData=e,this._unexpandedTree=this.getUnexpandedTree(),this._setOnce=!1),this._selectTree(e)):this.dom().triggerHandler("ev_view_change",[{"type":"value","value":[]}])},_selectTree:function(e){if(null!==e)for(var t=0,i=e.length;t<i;t++)for(var n=0,s=e[t].length;n<s;n++){var a=this._findByPath(e[t][n]);if(a)a.select(),a.syncSelectedStatusToChildren(),a.syncSelectedStatusToParent();else for(var r=e[t][n].match(/(.+)\/.+/);r&&r[1];){var o=this._findByPath(r[1]);o&&o.partialSelect(),r=r[1].match(/(.+)\/.+/)}}},getSelectedTree:function(){if(this._children){var n=[];return $.each(this._children,function(e,t){var i=[];t.getSelectedTree(i),0<i.length&&(n=n.concat(i))}),n}return!1},getUnexpandedTree:function(){for(var e=[],t=0,i=this._originData.length;t<i;t++)for(var n=0,s=this._originData[t].length;n<s;n++){this._findByPath(this._originData[t][n])||e.push(this._originData[t][n])}return e},compareTree:function(e){},_findByPath:function(e){if(this._children){for(var t=0;t<this._children.length;t++){var i=this._children[t];if(i._findByPath(e))return i._findByPath(e)}return!1}return!1}})}(),function(a){var e;a.su.Manager=(e=function(){if("object"==typeof this.constructor.instance)return this.constructor.instance;a.su.Observable.call(this),(this.constructor.instance=this)._map={},this._infoMap={},this.type=null},a.su.inherit(a.su.Observable,e),e.prototype.define=function(e,t,i){var n,s;this._infoMap[e]={},this._infoMap[e].constructor=i?(n=this.type,s=i,function(e){n.call(this,e),s&&a.extend(this,s.call(this))}):this.type,this._infoMap[e].options=t},e.prototype.init=function(e){this._infoMap[e]&&(this._map[e]=new this._infoMap[e].constructor(this._infoMap[e].options))},e.prototype.get=function(e){return this._map[e]},e.prototype.destroy=function(e){delete this._map[e]},e)}(jQuery),function(r){r.su.ModelManager=function(){var e=function(){r.su.Manager.call(this),this.type=r.su.Model};function a(e){return"ev_"+e+"_defined"}return r.su.inherit(r.su.Manager,e),e.prototype.define=function(e,t,i){var n=this,s=r.extend({name:e,factory:i,singleton:!0},t);this._infoMap[e]||(t&&r.su.Model.checkProxyDep(t.proxy)?r.su.Model.importProxyDep(t.proxy,function(){n._infoMap[e]={"settings":s,"constructor":r.su.Model,"status":"defined"},n.trigger(a(e))}):(n._infoMap[e]={"settings":s,"constructor":r.su.Model,"status":"defined"},n.trigger(a(e))))},e.prototype.init=function(e){var t=this._infoMap[e];if(!t||"available"==t.status)return null;!1!==t.settings.singleton?(this._map[e]=new this._infoMap[e].constructor(this._infoMap[e].settings),this._infoMap[e].status="available"):t.status="available"},e.prototype.get=function(e){var t=this._infoMap[e];return t?!1===t.settings.singleton?new this._infoMap[e].constructor(this._infoMap[e].settings):this._map[e]?this._map[e]:null:null},e.prototype.loadDefine=function(e,t){this.one(a(e),t),r.su.router.loadModel(e)},e.prototype.getStatus=function(e){return this._infoMap[e]?this._infoMap[e].status:null},e.prototype.isDefined=function(e){return!!this._infoMap[e]},e.prototype.isAvailable=function(e){return!(!this._infoMap[e]||"available"!==this._infoMap[e].status)},e.prototype.destroy=function(e){delete this._map[e]},e}()}(jQuery),function(r){r.su.StoreManager=function(){var e=function(){r.su.Manager.call(this),this.type=r.su.Store};function a(e){return"ev_"+e+"_defined"}return r.su.inherit(r.su.Manager,e),e.prototype.define=function(e,t,i){var n=this,s=r.extend({name:e,factory:i,singleton:!0},t);this._infoMap[e]||(t&&r.su.Store.checkProxyDep(t.proxy)?r.su.Store.importProxyDep(t.proxy,function(){n._infoMap[e]={"settings":s,"status":"defined"},n.trigger(a(e))}):(n._infoMap[e]={"settings":s,"status":"defined"},n.trigger(a(e))))},e.prototype.init=function(e){var t=this._infoMap[e];if(!t||"available"==t.status)return null;if(!1!==t.settings.singleton){var i=this._infoMap[e].settings.type||"store";this._map[e]=new(r.su[r.su.format.capitalize(i)])(this._infoMap[e].settings),this._infoMap[e].status="available"}else t.status="available"},e.prototype.get=function(e){var t=this._infoMap[e];if(!t)return null;if(!1!==t.settings.singleton)return this._map[e]?this._map[e]:null;var i=this._infoMap[e].settings.type||"store";return new(r.su[r.su.format.capitalize(i)])(t.settings)},e.prototype.loadDefine=function(e,t){this.one(a(e),t),r.su.router.loadModel(e)},e.prototype.getStatus=function(e){return this._infoMap[e]?this._infoMap[e].status:null},e.prototype.isDefined=function(e){return!!this._infoMap[e]},e.prototype.isAvailable=function(e){return!(!this._infoMap[e]||"available"!==this._infoMap[e].status)},e.prototype.destroy=function(e){delete this._map[e]},e}()}(jQuery),function(C){C.su=C.su||{},C.su.ModuleManager=function(){var e=function(){C.su.Manager.call(this),this.type=C.su.Module,this._depMap={},this._toDestroy=[]};C.su.inherit(C.su.Manager,e);return e.prototype.define=function(e,t,i){var n=this,s=C.extend({"name":e,deps:[],models:[],stores:[],views:[]},t);if(!this._infoMap[e]){(function(e,t){if(0!==t.length)for(var i=0;i<t.length;i++)this._depMap.hasOwnProperty(t[i])?0<=C.inArray(this._depMap[t[i]],e)||this._depMap[t[i]].push(e):this._depMap[t[i]]=[e]}).call(this,s.name,s.deps),this._infoMap[e]={"settings":s,"constructor":null,"status":C.su.Module.STATUS.LOADING_DEFINE};var a=function(e){this.factory=i,C.su.Module.call(this,e)};C.su.inherit(C.su.Module,a),this._infoMap[e].constructor=a,function(i,e){var t=this._infoMap[i].settings,n=t.models,s=t.stores,a=t.deps,r=t.views,o=!1,d=!1,l=!1,c=!1,u=function(){for(var e=0;e<n.length;e++){var t=n[e];if(!C.su.modelManager.isDefined(t))return!1}d||(d=!0,v())},h=function(){for(var e=0;e<s.length;e++){var t=s[e];if(!C.su.storeManager.isDefined(t))return!1}l||(l=!0,v())},p=function(){for(var e=0;e<a.length;e++){var t=a[e];if(!C.su.moduleManager.isDefined(t))return!1}o||(o=!0,v())},f=function(){for(var e=0;e<r.length;e++){var t=r[e];if(!C.su.viewManager.isDefined(t,i))return!1}c||(c=!0,v())},v=function(){o&&d&&l&&c&&e()};if(0==n.length)d=!0,v();else for(var g=0;g<n.length;g++){var m=n[g];C.su.modelManager.isDefined(m)?u():C.su.modelManager.loadDefine(m,function(){u()})}if(0==s.length)l=!0,v();else for(var b=0;b<s.length;b++){var y=s[b];C.su.storeManager.isDefined(y)?h():C.su.storeManager.loadDefine(y,function(){h()})}if(0==r.length)c=!0,v();else for(var _=0;_<r.length;_++){var w=r[_];C.su.viewManager.isDefined(w,i)?f():C.su.viewManager.loadDefine(w,i,function(){f()})}if(0==a.length)o=!0,v();else for(var x=0;x<a.length;x++){var T=a[x];C.su.moduleManager.isDefined(T)?p():C.su.moduleManager.getStatus(T)!==C.su.Module.STATUS.LOADING_DEFINE?C.su.moduleManager.loadDefine(T,p):C(C.su.moduleManager).one("ev_module_"+T+"_defined",function(){p()})}}.call(this,e,function(){n._infoMap[e].status=C.su.Module.STATUS.DEFINED,C(n).trigger("ev_module_"+e+"_defined")})}},e.prototype.query=function(e){return!!this._map[e]&&this._map[e]},e.prototype.unload=function(e){this._map[e]&&(this._map[e].destroy(),delete this._map[e],this._infoMap[e].status=C.su.Module.STATUS.DEFINED)},e.prototype.loadDefine=function(e,t){C(this).one("ev_module_"+e+"_defined",t),C.su.router.loadController(e)},e.prototype.load=function(e,t){switch(C.su.moduleManager.getStatus(e)){case C.su.Module.STATUS.LOADING_DEFINE:C(C.su.moduleManager).one("ev_module_"+e+"_defined",function(){C.su.moduleManager.init(e),t&&t()});break;case C.su.Module.STATUS.DEFINED:C.su.moduleManager.init(e),t&&t();break;case C.su.Module.STATUS.AVAILABLE:C.su.moduleManager.query(e);t&&t();break;case!1:default:C.su.moduleManager.loadDefine(e,function(){C.su.moduleManager.init(e),t&&t()})}},e.prototype.getStatus=function(e){var t=this._infoMap;return t[e]?t[e].status:!!C.su.router.query(e)&&C.su.Module.STATUS.DEFINE_NOT_LOADED},e.prototype.isDefined=function(e){return!(!this._infoMap[e]||this._infoMap[e].status===C.su.Module.STATUS.LOADING_DEFINE)},e.prototype.isAvailable=function(e){return!(!this._infoMap[e]||this._infoMap[e].status!==C.su.Module.STATUS.AVAILABLE)},e.prototype.init=function(e){var i=this;this._infoMap[e]&&this._infoMap[e].status!=C.su.Module.STATUS.AVAILABLE&&(this._map[e]=new this._infoMap[e].constructor(this._infoMap[e].settings),this._infoMap[e].status=C.su.Module.STATUS.AVAILABLE,this._map[e].addListener("ev_to_destroy",function(e,t){i.prepareDestroy(t)}))},e.prototype.prepareDestroy=function(e){if(this._depMap[e])for(var t=0;t<this._depMap[e].length;t++){var i=this._depMap[e][t];if(this.isAvailable(i))return void(-1===C.inArray(e,this._toDestroy)&&this._toDestroy.push(e))}this.unload(e);var n=C.inArray(e,this._toDestroy);0<=n&&this._toDestroy.splice(n,1);for(var s=this._infoMap[e].settings.deps,a=0;a<s.length;a++)0<=C.inArray(s[a],this._toDestroy)&&this.prepareDestroy(s[a])},e.prototype.launch=function(e,t){this.load(e,function(){C.su.moduleManager.query(e).load(t)})},e}()}(jQuery),function(s){s.su.ViewManager=function(){var e=function(){s.su.Manager.call(this),this.type=s.su.View};s.su.inherit(s.su.Manager,e),e.prototype.init=function(e){this._infoMap[e];var t=new s.su.View(e,this._infoMap[e].DOM),i=t.getID();return this._map[i]=t};return e.prototype.define=function(e,t){this._infoMap[e]||(this._infoMap[e]={"DOM":t,"status":"defined"})},e.prototype.isDefined=function(e,t){return!!this._infoMap[e]},e.prototype.loadDefine=function(e,t,i){var n=this;s.su.router.loadView(t,e,function(e){(function(e){var n=this;s(e).filter("[view]").each(function(e,t){var i=s(t).attr("view").replace(/[\{,\}]/g,"");n.define(i,s(t))})}).call(n,e),i&&i()})},e.prototype.get=function(e){var t="string"==typeof e?e:e.id;if(this._map[t])return this._map[t]},e.prototype.removeByID=function(e){this._map[e]&&(this._map[e].destroy(),delete this._map[e])},e}()}(jQuery),function(e){var t;e.su.ServiceManager=(t=function(){e.su.Manager.call(this),this.type=e.su.Service},e.su.inherit(e.su.Manager,t),t.prototype.register=function(e,t){if(this._map[e])return this._map[e];this._map[e]=t},t.prototype.get=function(e){return this._map[e]?this._map[e]:null},t)}(jQuery),function(s){var e;s.su=s.su||{},s.su.DataBind=(e=function(e,t){s.su.Observable.call(this);if(this.viewObjs=[],this.dataObj=e,t&&(s.isArray(t)||(t=[t])),this.viewEventHandler={},this.dataEventHandler={},this.dataObj&&this.bindDataObj(this.dataObj),t)for(var i=0;i<t.length;i++)this.bindViewObj(t[i])},s.su.inherit(s.su.Observable,e),e.prototype.getName=function(){if(this.dataObj&&this.dataObj._name)return this.dataObj._name},e.prototype.bind=function(e,t){s.isArray(e)||(e=[e]);for(var i=0;i<e.length;i++)this.bindViewObj(e[i]);this.bindDataObj(t)},e.prototype.bindDataObj=function(e){var t=this.constructor.dataEventMap;for(var i in this.unbindDataObj(),this.dataObj=e,t){var n=t[i].fn;"string"==typeof n&&(n=this[n]);var s=function(e,t){return function(){e.apply(t,arguments)}}(n,this);this.dataEventHandler[i]=s,e.addListener(i,s)}},e.prototype.viewIsBinded=function(e){return 0<=s.inArray(e,this.viewObjs)},e.prototype.bindViewObj=function(e){var t=this.constructor,i=t.viewEventMap[e._type]?t.viewEventMap[e._type]:t.viewEventMap.defaults;if(!this.viewIsBinded(e)){for(var n in this.viewObjs.push(e),this.viewEventHandler[e.domId]={},i){var s=i[n].fn;"string"==typeof s&&(s=this[s]);var a=function(t,i,n){return function(){var e=Array.prototype.slice.call(arguments);e[e.length]=i,t.apply(n,e)}}(s,e,this);this.viewEventHandler[e.domId][n]=a,e.dom().on(n,a)}e.dataBind?e.dataBind.push(this):e.dataBind=[this]}},e.prototype.unbind=function(){this.unbindDataObj(),this.unbindViewObjs()},e.prototype.unbindDataObj=function(){if(this.dataObj){for(var e in this.dataEventHandler)this.dataObj.off(e,this.dataEventHandler[e]);this.dataObj=null}this.trigger("ev_data_unbind")},e.prototype.unbindViewObj=function(e){var t;if(0<=(t=s.inArray(e,this.viewObjs))){var i=this.viewEventHandler[e.domId];for(var n in i)i.hasOwnProperty(n)&&e.dom().off(n,i[n]);delete this.viewEventHandler[e.domId],this.viewObjs.splice(t,1)}0<=(t=s.inArray(this,e.dataBind))&&e.dataBind.splice(t,1)},e.prototype.unbindViewObjs=function(){for(var e=this.viewObjs.length;0<e;e--)this.unbindViewObj(this.viewObjs[e-1])},e.prototype.syncView=function(){},e)}(jQuery),function(r){r.su=r.su||{},r.su.DataFieldBind=function(){var i={sync:function(e){if(this.dataObj){var t=this.dataObj.getValue();this._syncDataValue(t),this.dataObj.disabled&&this.disable()}}},e={defaults:{ev_view_change:{fn:function(e,t,i){switch(e.stopPropagation(),t.type){case"value":this._responseViewValueChanges(t.value,i);break;case"valid":this.validate();break;case"record":this.dataObj&&(this.setValue(t.value),this.dataObj.record())}}},ev_view_update:{fn:function(){if(this.dataObj){var e=this.dataObj.getValue();this._syncDataValue(e)}}},ev_view_disable:{fn:function(){this.dataObj.disable()}},ev_view_enable:{fn:function(){this.dataObj.enable()}},ev_widget_hide:{fn:function(){this.setNormal&&this.setNormal()}}},"switch":{ev_view_change:{fn:function(e,r,t){switch(e.stopPropagation(),r.type){case"value":!function o(n){var s=n.dataBind[0],e=n.settings,t=e.trueValue,a=(e.falseValue,!1);n.showLoading(r.value===t?"on":"off");var i=function(e,t,i){a=!0,i.one("ev_model_submit_complete",function(e){s.dataObj.isDirty()&&s.dataObj.reset(),n.hideLoading()})};s.one("ev_model_before_submit",i),setTimeout(function(){a||(s.off("ev_model_before_submit",i),n.hideLoading())},0)}(t),this._responseViewValueChanges(r.value,t);break;case"valid":this.validate();break;case"record":this.dataObj&&(this.setValue(r.value),this.dataObj.record())}},argsInterface:null}},cell:{ev_view_change:{fn:function(e,o,t){switch(e.stopPropagation(),o.type){case"value":"switch"===t.column.widgetName&&function d(e){var n=e.settings.objs.grid.dataBind[0],s=e.dom().find("[widget=switch]").data("viewObj"),t=e.column.settings,i=t.trueValue,a=(t.falseValue,!1);s.showLoading(o.value===i?"on":"off");var r=function(e,t,i){a=!0,n.one("ev_store_sync_complete",function(e){n.isDirty()&&n.reset(),s.hideLoading()})};n.one("ev_store_before_sync",r),setTimeout(function(){a||(n.off("ev_store_before_sync",r),s.hideLoading())},0)}(t),this._responseViewValueChanges(o.value,t);break;case"valid":this.validate();break;case"record":this.dataObj&&(this.setValue(o.value),this.dataObj.record())}}}}};for(var t in e)"defaults"!=t&&(e[t]=r.extend(!0,{},e.defaults,e[t]));var o=function(e,t){r.su.DataBind.call(this,e,t),this.addListener(i)};r.su.inherit(r.su.DataBind,o),o.argsTransMap={setValue:{defaults:function(e){return e},textBox1:function(e){return e[0]},dataObj1:function(e){return e[0]}},validate:{},getValue:{}},o.viewEventMap=e,o.dataEventMap={ev_data_change:{fn:function(e,t){switch(t.type){case"_value":this.setNormal(),this._responseDataValueChange(t.value.value,t.value.oldValue);break;case"valid":!0===t.value?this.setNormal():this.setError(t.value),this.fireEvent("ev_valid_change",[t.value])}}},ev_model_before_submit:{fn:function(e,t,i){this.trigger("ev_model_before_submit",[t,i])}}};var n=function(r){return function(){var e,t=o.argsTransMap[r];if(this.viewObjs&&0<this.viewObjs.length)for(var i in this.viewObjs){var n,s=this.viewObjs[i],a=s._type;if(s[r])e=(n=s[r].apply(s,t&&t[a]?t[a](arguments):arguments))===undefined?e:n}this.dataObj&&this.dataObj[r]&&(e=n=this.dataObj[r].apply(this.dataObj,t&&t.dataObj?t.dataObj(arguments):arguments));return e}};for(var t in r.su.Widget.regMap){if(r.su.Widget.regMap.hasOwnProperty(t))var s=r.su.Widget.regMap[t];for(var a in s)s.hasOwnProperty(a)&&"function"==typeof s[a]&&"_init"!=a&&"init"!=a&&"create"!=a&&(o.prototype[a]||(o.prototype[a]=n(a)))}for(var t in r.su.DataField.prototype)"function"==typeof r.su.DataField.prototype[t]&&(o.prototype[t]||(o.prototype[t]=n(t)));return o.prototype.setValue=function(e){this.dataObj?this.dataObj.setValue(e):this._syncDataValue(e)},o.prototype.getName=function(){if(this.dataObj&&this.dataObj.name)return this.dataObj.name},o.prototype._responseViewValueChanges=function(e,t){this.dataObj&&(r.su.valueEqual(e,this.dataObj.getValue())||this.dataObj.setValue(e))},o.prototype._responseDataValueChange=function(e,t){if(r.su.valueEqual(e,t)){var i=this.viewObjs.length;if(0===i)this.fireEvent("ev_value_change",[e,t]);else for(var n=0;n<i;n++)for(var s=this.viewObjs[n],a=0;a<s.dataBind.length;a++){s.dataBind[a]instanceof r.su.DataFieldBind&&s.dataBind[a].fireEvent("ev_value_change",[e,t])}}else{if(!1===this._syncDataValue(e))return;this.fireEvent("ev_value_change",[e,t])}},o.prototype._syncDataValue=function(e){for(var t=0;t<this.viewObjs.length;t++){var i=this.viewObjs[t];if(i.setValue&&(i.getValue&&r.su.valueEqual(i.getValue(),e)||i.setValue(e)),this.dataObj&&!r.su.valueEqual(this.dataObj.getValue(),e))return!1;for(var n=0;n<i.dataBind.length;n++){var s=i.dataBind[n];s!==this&&s instanceof r.su.DataFieldBind&&s.getValue&&!r.su.valueEqual(s.getValue(),e)&&i.dataBind[n].setValue(e)}}},o.prototype.bindDataObj=function(e){o.superclass.bindDataObj.call(this,e),this.syncView()},o.prototype.bindViewObj=function(e){o.superclass.bindViewObj.call(this,e),this.syncView()},o.prototype.syncView=function(){this.fireEvent("sync")},o}()}(jQuery),function(r){r.su=r.su||{},r.su.ModelBind=function(){var e={defaults:{"value_change":{fn:"setValue",argsInterface:null},"validate_change":{fn:"validate"},ev_view_change:{fn:function(e,t){switch(t.type){case"value":this.setValue(t.value);break;case"valid":this.validate()}}}},form:{"value_change":{fn:function(e,t,i){},argsInterface:null}}};for(var t in e)"defaults"!=t&&(e[t]=r.extend(!0,{},e.defaults,e[t]));var i={ev_model_submit_error:{fn:function(e,t){r.su.raise({msg:"ev_model_submit_error",type:"model_submit_error",errorCode:t,modelBind:this})},argsInterface:null},ev_model_load_error:{fn:function(e,t){r.su.raise({msg:"ev_model_load_error",type:"model_load_error",errorCode:t,modelBind:this})},argsInterface:null},ev_model_ajax_error:{fn:function(e,t,i){r.su.raise({msg:"ev_model_ajax_error",type:"model_ajax_error",ajaxErrorStatus:t,ajaxErrorXhr:i,modelBind:this})},argsInterface:null},ev_before_load_data:{fn:function(e,t){this.fireEvent("ev_before_load_data",[t])},argsInterface:null},ev_loaded:{fn:function(e,t){this.fireEvent("ev_loaded",[t])},argsInterface:null},ev_data_change:{fn:function(e,t,i,n){this._responseDataChange();var s=this[i.getName()];this.trigger("ev_data_change",[t.value,s,this])}},ev_validate_change:{fn:function(e,t){this.trigger("ev_validate_change",[t])}},ev_model_submit:{fn:function(e,t,i){this.trigger("ev_model_submit",[t,i])}},ev_model_before_submit:{fn:function(e,t){this.trigger("ev_model_before_submit",[t])}},ev_model_submit_complete:{fn:function(e){this.trigger("ev_model_submit_complete",[].slice.call(arguments,1))}}},o=function(e,t){this.subFieldsBinds={},r.su.DataBind.call(this,e,t)};r.su.inherit(r.su.DataBind,o),o.argsTransMap={setValue:{defaults:function(e){return e},textBox1:function(e){return e[0]},dataObj1:function(e){return e[0]}},validate:{},getValue:{}},o.viewEventMap=e,o.dataEventMap=i;var n=function(r){return function(){var e,t=o.argsTransMap[r];if(this.viewObjs&&0<this.viewObjs.length)for(var i in this.viewObjs){var n,s=this.viewObjs[i],a=s._type;if(s[r])e=(n=s[r].apply(s,t&&t[a]?t[a](arguments):arguments))===undefined?e:n}this.dataObj&&this.dataObj[r]&&(e=n=this.dataObj[r].apply(this.dataObj,t&&t.dataObj?t.dataObj(arguments):arguments));return e}};for(var t in r.su.Widget.regMap){if(r.su.Widget.regMap.hasOwnProperty(t))var s=r.su.Widget.regMap[t];for(var a in s)s.hasOwnProperty(a)&&"function"==typeof s[a]&&"_init"!=a&&"init"!=a&&"create"!=a&&(o.prototype[a]||(o.prototype[a]=n(a)))}for(var t in r.su.Model.prototype)"function"==typeof r.su.Model.prototype[t]&&(o.prototype[t]||(o.prototype[t]=n(t)));return o.prototype.bindDataObj=function(e){if(o.superclass.bindDataObj.call(this,e),this.createSubBinds(),this.viewObjs)for(var t=0;t<this.viewObjs.length;t++)this.syncSubViewBinds(this.viewObjs[t]);for(var i in this.syncView(),e.methods)e.methods.hasOwnProperty(i)&&"function"==typeof e.methods[i]&&(this[i]||(this[i]=function(){e.methods[i].apply(e,arguments)}))},o.prototype.createSubBinds=function(){var e=this.dataObj.fields;this.subFieldsBinds={};for(var t=0;t<e.length;t++)this[e[t].name]=this.subFieldsBinds[e[t].name]=new r.su.DataFieldBind(this.dataObj.data[t])},o.prototype.syncSubViewBinds=function(e){if(e.getAllFields){var t=e.getAllFields();if(!t)return;for(var i=0;i<t.length;i++){var n=t[i],s=n.field,a=this.subFieldsBinds[s];a&&!a.viewIsBinded(n)&&a.bindViewObj(n)}}},o.prototype.syncSubViewUnbinds=function(e){if(e.getAllFields)for(var t=e.getAllFields(),i=0;i<t.length;i++){var n=t[i],s=n.field,a=this.subFieldsBinds[s];a&&a.viewIsBinded(n)&&a.unbindViewObj(n)}},o.prototype.bindViewObj=function(e){o.superclass.bindViewObj.call(this,e),this.dataObj&&this.syncSubViewBinds(e),this.syncView()},o.prototype.unbindDataObj=function(){for(var e in this.subFieldsBinds)this.subFieldsBinds.hasOwnProperty(e)&&(this.subFieldsBinds[e].unbind(),delete this[e]);for(var t in this.dataObj.methods)this.dataObj.methods.hasOwnProperty(t)&&delete this[t];this.subFieldsBinds={},o.superclass.unbindDataObj.call(this)},o.prototype.unbindViewObj=function(e){this.syncSubViewUnbinds(e),o.superclass.unbindViewObj.call(this,e)},o.prototype._responseDataChange=function(){for(var e=this.dataObj.getData(),t=0;t<this.viewObjs.length;t++)for(var i=this.viewObjs[t],n=0;n<i.dataBind.length;n++){var s=i.dataBind[n];s.dataObj!==this.dataObj&&s.dataObj.loadData(e)}},o.prototype.getAllFields=function(){return this.subFieldsBinds},o}()}(jQuery),function(c){c.su=c.su||{},c.su.StoreBind=function(){var i={sync:function(e){if(this.dataObj){for(var t=this.dataObj.getAllKeys(),i=0,n=this.viewObjs.length;i<n;i++)this.viewObjs[i].syncData&&this.viewObjs[i].syncData(t);var s=this.getStoreData();this.loadItems&&this.loadItems(s),this.renderTree&&this.renderTree(s);for(i=0,n=this.viewObjs.length;i<n;i++)this.viewObjs[i].dom().triggerHandler("ev_store_bound")}}},l=function(e){if("popEditor"==e._type&&0<e.containerMsg.dom().find("div[widget=form]").length)return e.containerMsg.dom().find("div[widget=form]").eq(0).data("viewObj").dataBind[0];return!1},e={defaults:{ev_grid_edit:{fn:function(e,t,i){var n=i.getPlugin("editor"),s=l(n);if(s){if("add"!=t){var a=this.getSubModelBindByKey(t).getData();s.loadData(a,!0)}else{var r=this.dataObj.createModel();this.addModelBind.modelBind=new c.su.ModelBind(r),s.loadData(r.getData(),!0),this.addModelBind.key=this.dataObj.getModelKey(r)}s.setNormal()}else{r=this.dataObj.createModel();if(this.addModelBind.modelBind=new c.su.ModelBind(r),this.addModelBind.modelBind.bindViewObj(n),"add"!=t){a=this.getSubModelBindByKey(t).getData();this.addModelBind.modelBind.dataObj.loadData(a),this.addModelBind.key=t}else this.addModelBind.modelBind.dataObj.loadData(r.getData()),this.addModelBind.key=this.dataObj.getModelKey(r)}this.trigger("ev_before_add",[this.addModelBind.modelBind,this])},argsInterface:null},ev_grid_cancel:{fn:function(e,t,i){var n=i.getPlugin("editor"),s=l(n);s?s.reset():(this.addModelBind.modelBind.reset(),this.addModelBind.modelBind.unbindViewObj(n),this.addModelBind.key=null,this.addModelBind.modelBind=null)}},ev_grid_save:{fn:function(e,t,i,n){var s=n.getPlugin("editor");if(o=l(s)){if(this.trigger("ev_before_save",[o,this]),!0!==(a=o.dataObj.validate({returnDetail:!0})).result)return this.trigger("ev_editor_validator_fail",[a.field]),void t.preventDefault();if(r=this.dataObj.dataConflict(o.dataObj,i))return this.trigger("ev_editor_data_conflict_fail",[o,r]),void t.preventDefault();if("add"!=i)this.getSubModelBindByKey(i).replaceData(o.modelSerialize(o.getData()));else this.addModelBind.key&&(this.addModelBind.modelBind.replaceData(o.modelSerialize(o.getData())),this.dataObj.insertModel(this.addModelBind.modelBind.dataObj))}else{var a,r,o=this.addModelBind.modelBind;if(this.trigger("ev_before_save",[o,this]),!0!==(a=o.dataObj.validate({returnDetail:!0})).result)return this.trigger("ev_editor_validator_fail",[a.field]),void t.preventDefault();if(r=this.dataObj.dataConflict(o.dataObj,i))return this.trigger("ev_editor_data_conflict_fail",[o,r]),void t.preventDefault();if("add"!=i)this.getSubModelBindByKey(i).loadData(o.getData()),o.unbindViewObj(s);else this.addModelBind.key&&(this.addModelBind.modelBind.unbindViewObj(s),this.addModelBind.modelBind.record(),this.dataObj.insertModel(this.addModelBind.modelBind.dataObj))}if(this.addModelBind.key=null,this.addModelBind.modelBind=null,!1!==this.dataObj.autoSync){var d=c.su.getDefaultEvent(this,this.sync);this.trigger("ev_before_sync",[d.ev,this.dataObj.proxy]),d.exe()}}},ev_grid_delete:{fn:function(e,t,i){this.dataObj.removeDataByKey(t);var n=c.su.getDefaultEvent(this,this.sync);this.trigger("ev_before_sync",[n.ev,this.dataObj.proxy,t]),n.exe()}},ev_grid_delete_all:{fn:function(e){var t=this.dataObj.getAllKeys();this.dataObj.removeDataByKey(t);var i=c.su.getDefaultEvent(this,this.sync,{deleteAll:!0});this.trigger("ev_before_delete_all",[i.ev,this.dataObj.proxy]),i.exe()}},ev_grid_row_selected:{fn:function(e,t){this.dataObj.selectByKey(t)}},ev_grid_row_unselected:{fn:function(e,t){this.dataObj.unselectByKey(t)}},ev_grid_row_selected_all:{fn:function(e,t){this.dataObj.selectAll()}},ev_grid_row_unselected_all:{fn:function(e,t){this.dataObj.unselectAll()}},ev_grid_filter:{fn:function(e,t,i,n){this.dataObj.filter({filters:t,append:i,columns:n})}},ev_store_render_items:{fn:function(e,t,i){if(this.dataObj){for(var d=this.dataObj.keyProperty,l=[],n=[],s=0;s<t.length;s++){var a=this.getSubModelBindByKey(t[s]);n.push(a.dataObj),l.push(a)}i.renderModels(d,n,function(e){for(var t=e.length,i=l.length,n=0;n<t;n++){for(var s=e[n].key,a=e[n].obj,r=0;r<i;r++){var o=l[r];if(o.dataObj.getField(d).getValue()!==s)throw new Error("store render item return unknown key");o.bindViewObj(a);break}l.splice(r,1),i-=1}})}}},ev_store_before_sync:{fn:function(e){this.trigger("ev_store_before_sync")}},ev_store_sync_complete:{fn:function(e){this.trigger("ev_store_sync_complete",[].slice.call(arguments,1))}}},form:{},folderTree:{ev_folder_tree_open:{fn:function(e,t,i){this.dataObj.fetchChildren(t,i)}},ev_folder_tree_close:{fn:function(e,t,i){i()}}}};for(var t in e)"defaults"!=t&&(e[t]=c.extend(!0,{},e.defaults,e[t]));var n={ev_loaded:{fn:function(e){var t=this.dataObj;this.unbindDataObj();for(var i=0;i<this.viewObjs.length;i++){var n=this.viewObjs[i];if("grid"!==n._type&&"repeat"!==n._type||n.remove(),"information"===n._type&&setTimeout(function(){n.updateBtns()},30),"folderTree"===n._type&&n._children.length)return void this.bindDataObj(t,!1)}this.bindDataObj(t),this.fireEvent("ev_loaded"),this.fireEvent("ev_storedata_loaded")},argsInterface:null},ev_model_deleted:{fn:function(e,t){for(var i,n=0;n<t.length;n++){i=t[n];var s=this.getSubModelBindIndex(i);this.subModelsBinds[s].unbind(),this.subModelsBinds.splice(s,1),delete this._convertedkeyMap[this._convertKey(i)];for(var a=0;a<this.viewObjs.length;a++){var r=this.viewObjs[a];"information"===r._type&&r.remove(i),"grid"===r._type&&r.deleteItem(i)}}}},ev_model_inserted:{fn:function(e,t){var i;t=t===undefined?0:t;var n=this.dataObj.getKeyByIndex(t),s=new c.su.ModelBind(this.dataObj.getModelByIndex(t));this.subModelsBinds.splice(t,0,s),this._convertedkeyMap[this._convertKey(n)]=s;for(var a=0;a<this.viewObjs.length;a++)"grid"===(i=this.viewObjs[a])._type&&(i.addItem(n),i.moveItem(n,t))}},ev_store_item_moved:{fn:function(e,t,i,n){var s=this.subModelsBinds.splice(n,1);this.subModelsBinds.splice(i,0,s[0]);for(var a=0;a<this.viewObjs.length;a++)this.viewObjs[a].moveItem(t,i)}},ev_store_operation:{fn:function(e,t){this.fireEvent("ev_operation",[t])}},ev_store_sync_error:{fn:function(e,t){c.su.raise({msg:"ev_store_submit_error",type:"store_submit_error",errorCode:t,storeBind:this})},argsInterface:null},ev_store_ajax_error:{fn:function(e,t,i){c.su.raise({msg:"ev_store_ajax_error",type:"store_ajax_error",ajaxErrorStatus:t,ajaxErrorXhr:i,storeBind:this})},argsInterface:null},ev_data_change:{fn:function(e,t,i,n,s){var a=this.getModelKey(n),r=this.getSubModelBindByKey(a),o=r[i.name];this.trigger("ev_data_change",[t.value,o,r,this])},argsInterface:null},ev_store_before_sync:{fn:function(e,t){this.trigger("ev_store_before_sync",[t])}},ev_store_sync_complete:{fn:function(e){this.trigger("ev_store_sync_complete",[].slice.call(arguments,1))}},ev_render_tree:{fn:function(e){var t=this.dataObj;this.unbindDataObj();for(var i=0;i<this.viewObjs.length;i++){var n=this.viewObjs[i];"folderTree"===n._type&&n._children.length&&n.clearTree()}this.bindDataObj(t),this.fireEvent("ev_loaded"),this.fireEvent("ev_storedata_loaded")},argsInterface:null}},o=function(e,t){this.subModelsBinds=[],this.addModelBind={key:null,modelBind:null},this._convertedkeyMap={},c.su.DataBind.call(this,e,t),this.addListener(i)};c.su.inherit(c.su.DataBind,o),o.argsTransMap={setValue:{defaults:function(e){return e},textBox1:function(e){return e[0]},dataObj1:function(e){return e[0]}}},o.viewEventMap=e,o.dataEventMap=n;var s=function(r){return function(){var e,t=o.argsTransMap[r];if(this.viewObjs&&0<this.viewObjs.length)for(var i in this.viewObjs){var n,s=this.viewObjs[i],a=s._type;if(s[r])e=(n=s[r].apply(s,t&&t[a]?t[a](arguments):arguments))===undefined?e:n}this.dataObj&&this.dataObj[r]&&(e=n=this.dataObj[r].apply(this.dataObj,t&&t.dataObj?t.dataObj(arguments):arguments));return e}};for(var t in c.su.Widget.regMap){if(c.su.Widget.regMap.hasOwnProperty(t))var a=c.su.Widget.regMap[t];for(var r in a)a.hasOwnProperty(r)&&"function"==typeof a[r]&&"_init"!=r&&"init"!=r&&"create"!=r&&(o.prototype[r]||(o.prototype[r]=s(r)))}for(var t in c.su.Store.prototype)"function"==typeof c.su.Store.prototype[t]&&(o.prototype[t]||(o.prototype[t]=s(t)));return o.prototype.bindDataObj=function(e,t){o.superclass.bindDataObj.call(this,e),this.createSubBinds(),0!=t&&t==undefined&&this.syncView()},o.prototype.createSubBinds=function(){this.subModelsBinds=[];for(var e=this.dataObj,t=e.getSize(),i=0;i<t;i++){var n=e.getModelByIndex(i),s=this.getModelKey(n),a=new c.su.ModelBind(n);this.subModelsBinds.push(a),this._convertedkeyMap[this._convertKey(s)]=a}},o.prototype.syncSubViewBinds=function(s){var a=this;"grid"===s._type&&(s.remove(),s.loadGridData(this.dataObj.keyProperty,this.dataObj.data,function(){for(var e=s.getRows(),t=0;t<a.subModelsBinds.length;t++){a.dataObj.getKeyByIndex(t);var i=a.subModelsBinds[t],n=e[t];i.bindViewObj(n)}}))},o.prototype.syncSubViewUnbinds=function(e){var t=0!==e.dom().length;if("grid"===e._type){for(var i=e.getRow(),n=e.getPlugin("editor"),s=i.length,a=0;a<s;a++){var r=i[a].obj,o=r.key,d=this.getSubModelBindByKey(o);d&&d.viewIsBinded(r)&&d.unbindViewObj(r)}t&&e.remove(),this.addModelBind&&this.addModelBind.modelBind&&this.addModelBind.modelBind.viewIsBinded(n)&&this.addModelBind.modelBind.unbindViewObj(n)}},o.prototype.bindViewObj=function(e){o.superclass.bindViewObj.call(this,e),this.syncView()},o.prototype.getModelByKey=o.prototype.getSubModelBindByKey=function(e){return this._convertedkeyMap[this._convertKey(e)]},o.prototype.getModelByIndex=o.prototype.getSubModelBindByIndex=function(e){return this.subModelsBinds[e]},o.prototype.getSubModelBindIndex=function(e){var t=this._convertedkeyMap[this._convertKey(e)];return c.inArray(t,this.subModelsBinds)},o.prototype.getModelIndex=function(e){return c.inArray(e,this.subModelsBinds)},o.prototype.getModelKey=function(e){return e[this.dataObj.keyProperty].getValue()},o.prototype.each=function(e){for(var t=0;t<this.subModelsBinds.length;t++){e(this.subModelsBinds[t])}},o.prototype.setField=function(e,t){for(var i=0;i<this.subModelsBinds.length;i++){var n=this.subModelsBinds[i];t(n[e],n)}},o.prototype.unbindDataObj=function(){for(var e=0;e<this.subModelsBinds.length;e++)this.subModelsBinds[e].unbind();this.subModelsBinds=[],this._convertedkeyMap={},o.superclass.unbindDataObj.call(this)},o.prototype.unbindViewObj=function(e){this.syncSubViewUnbinds(e),o.superclass.unbindViewObj.call(this,e)},o.prototype.syncView=function(){this.fireEvent("sync")},o.prototype.getSubModelBindByModel=function(e){for(var t=0;t<this.subModelsBinds.length;t++)if(this.subModelsBinds[t].dataObj===e)return this.subModelsBinds[t];return!1},o.prototype._convertKey=function(e){return c.type(e)+"_"+e},o.prototype._getOriginalKey=function(e){var t=e.slice(0,6),i=e.slice(7);return"number"===t?Number(i):i},o}()}(jQuery),jQuery,$.extend($.su.settings,{classManager:{loader:"Loader"},Proxy:{defaultRoot:"root"},Model:{defaultProxy:"IPFProxy",depFields:["proxy"]},Store:{defaultProxy:"IPFProxy",depFields:["proxy"]},AjaxService:{defaultProxy:"IPFProxy"},AjaxProxy:{defaultConnection:"Connection"}}),$.su.Navigator=function(){var t={},s={},e=function(e){this.settings=$.extend({},t,e),this.container=$(e.container),this.moduleContainerWidget=e.moduleContainerWidget||"panel",this.service=e.service,this.name="navigator",$.su.Service.call(this)};return $.su.inherit($.su.Service,e),e.prototype.setMenu=function(){},e.prototype.getMenu=function(){},e.prototype.getMenuList=function(){},e.prototype["goto"]=function(){},e.prototype.set=function(e){s=e},e.prototype.setContainer=function(e){this.container=$(e).htmlLoader()},e.prototype.load=function(e){var t=this.service.moduleLoader,i=this.service.loading,n=$.su.getObjectLength(s[e]);t.unLoad(this.container),t.load({module:"index"},{module:"page",view:e},this.container,function(){setTimeout(function(){i.hide(e)},0)},n)},e.prototype.destroy=function(){},e}(),function(u){u.su.App=function(){var t,i;u.ajax("./config/models.json",{async:!1,method:"GET",dataType:"json",success:function(e){t=u.extend({},e)}}),u.ajax("./config/modules.json",{async:!1,method:"GET",dataType:"json",success:function(e){i=e}});var e=function(e){this.override(),u.su.Application.call(this),this.loader=new u.su.Loader,this.classManager=u.su.ClassManager.getInstance(),this.classManager.setLoader(this.loader),new u.su.Ajax({ajax:{type:"POST"},failHandler:function(s){return function(e,t,i,n){s&&s(e,t,i,n)}},errorHandler:function(i){return function(e,t){i&&i(e,t)}}}),new u.su.Vtype,new u.su.Polling,new u.su.Services.ModuleManager,new u.su.Device({service:{ajax:this.serviceManager.get("ajax"),loading:this.serviceManager.get("loading")}}),new u.su.Services.Timer,this.moduleLoader=new u.su.Services.ModuleLoader,this.language=new u.su.LanguageService,this.navigator=new u.su.Navigator({service:{moduleLoader:this.moduleLoader,loading:this.loading}}),this.router=u.su.router=new u.su.Router,this.router.setModelsPath(t),this.router.set(i),this.navigator.set({})};return u.su.inherit(u.su.Application,e),e.prototype.init=function(){var e=u.Deferred(),t=this,i=[],n=u.Deferred();i.push(n),u.su.isMobile()?u.getScript("./js/su/widget/widget.mobile.js",function(){n.resolve()}):n.resolve();var s=u.Deferred();i.push(s);var a=u.su.settings.Loader.classesPath;return this.loader.loadFile(a,function(e){t.loader.setPath(e),s.resolve()}),u.when.apply(this,i).done(function(){new u.su.Time({service:{ajax:t.serviceManager.get("ajax")}}),e.resolve()}),e.promise()},e.prototype.customWidget=function(){var e={errortip:{animate:function(e){var t=this.dom(),i=t.find("div.widget-error-tips-wrap"),n=t.find("div.error-tips-content"),s=t.closest(".html-loader-container"),a=t.closest(".msg-content-wrap"),r=0<s.length?s:0<a.length?a:u("#index-view-container"),o=r.offset(),d=r.width();"string"===u.type(e)&&n.text(e),t.addClass("show").show();var l=i.offset(),c=i.width();l.left-o.left+c>d&&i.css({"right":0})}}};for(var t in e)if(e.hasOwnProperty(t))for(var i in e[t])e[t].hasOwnProperty(i)&&u.fn[t]&&(u.fn[t][i]=e[t][i])},e.prototype.override=function(){Array.prototype.indexOf||(Array.prototype.indexOf=function(e){var t=this.length>>>0,i=Number(arguments[1])||0;for((i=i<0?Math.ceil(i):Math.floor(i))<0&&(i+=t);i<t;i++)if(i in this&&this[i]===e)return i;return-1}),u.su.Store.prototype.getIndexsInSnapshot=function(e){var t=this.snapshot,i=this.keyProperty;if(0===e.length)return undefined;for(var n=[],s=0,a=e.length;s<a;s++)for(var r=0,o=t.length;r<o;r++){var d=e[s];if(t[r][i]==d.toString()){n.push(r);break}}return n},u.su.Store.prototype.beforeRemove=function(e,t,s){var i=this.keyProperty;s=s||{};var a=this,n={"key":[],"index":[]};for(var r in t)t.hasOwnProperty(r)&&n.key.push(t[r].oldModel[i]);return n.index=this.getIndexsInSnapshot(n.key),{ajax:u.extend({},{url:s.url||undefined,type:"POST",traditional:!0},s.ajax),data:u.extend({},n,{operation:"remove"},s.data),success:function(e,t){s.success&&s.success(e),a.fireEvent("ev_store_operation"),a.load()},fail:function(e,t,i,n){a.loadData(a.snapshot),s.fail&&s.fail(e,t,i,n),t&&a.trigger("ev_store_sync_error",t)},error:function(e,t){a.loadData(a.snapshot),s.error&&s.error(e,t),a.trigger("ev_store_ajax_error",[e,t])}}},u.su.Error.handle=function(e){switch(e.type){case"model_ajax_error":case"store_ajax_error":return u.su.moduleManager.query("main").showNotice(u.su.CHAR.ERROR[t]||u.su.CHAR.COMMON.SAVE_FAILED,1),!0;case"module_not_found":case"module_not_defined":return u.su.debug.error("navigator error",e.module),!0;default:var t=e.errorCode;return"timeout"!==t&&u.su.moduleManager.query("main")&&u.su.moduleManager.query("main").showNotice(u.su.CHAR.ERROR[t]||u.su.CHAR.COMMON.SAVE_FAILED,1),!0}}},e.prototype.reset=function(){},e.prototype.reload=function(){},e.prototype.getInfo=function(){},e}(),u.appUtils=u.su.App.utils={intToArray:function(e,t){e=parseInt(e,10);for(var i=[];0<e;)i.push(e%2),e=parseInt(e/2,10);if(i.length<t)for(var n=i.length,s=0;s<t-n;s++)i.push(0);return i},arrayToInt:function(e){for(var t=0,i=1;0<e.length;)t+=(e.shift()||0)*i,i*=2;return t},objectToArray:function(e){var t=[];for(var i in e)t[i]=e[i];return t},resetPortsValue:function(e,t){for(var i=u.appUtils.portSplit(e).split(","),n=u.appUtils.portSplit(t).split(","),s=0;s<i.length;s++){var a=n.indexOf(i[s]);0<=a&&n.splice(a,1)}return u.appUtils.portCombine(n.join(","))},keyHandler:function(e){return e.toString().replace(/[\/\.\:\s\(\)]/g,"_")},doLayout:function(){var e=u("#scroll-layer").height()-u(".bot").height();u("#main-con").css({minHeight:e})}}}(jQuery),$.su.Device=function(){var t={},e=function(e){this.settings=$.extend({},t,e),this.settings.DEVICE_NAME_URL=$.su.url("/locale?form=lang"),this.settings.NETWORK_NAME_ISTRIBAND_URL=$.su.url("/admin/wireless?form=wlan"),this.service=e.service,this.supportLanIptv=!1,this.switchList={isFetched:!1,show_performance:!0},this.name="device",$.su.Service.call(this)};return $.su.inherit($.su.Service,e),e.prototype.reboot=function(){},e.prototype.reset=function(){},e.prototype.getProductName=function(){var t=this;return this.deviceName||this.service.ajax.request({ajax:{async:!1},data:{operation:"read"},url:this.settings.NETWORK_NAME_ISTRIBAND_URL,success:function(e){return t.deviceName=$.su.b64Decode(e.band2_4.host.ssid),t.isTriband=!!e.band5_2,t.isTriband}}),this.deviceName},e.prototype.getIsTriband=function(){var t=this;return this.isTriband===undefined&&this.service.ajax.request({ajax:{async:!1},url:this.settings.NETWORK_NAME_ISTRIBAND_URL,data:{operation:"read"},success:function(e){return t.deviceName=$.su.b64Decode(e.band2_4.host.ssid),t.isTriband=!!e.band5_2,t.isTriband}}),this.isTriband},e.prototype.getRebootTime=function(){var t=this;return this.rebootTime||this.service.ajax.request({ajax:{async:!1},data:{operation:"read"},url:this.settings.DEVICE_NAME_URL,success:function(e){t.rebootTime=e.rebootTime}}),this.rebootTime},e.prototype.getLocale=function(){var t=this;return this.locale||this.service.ajax.request({ajax:{async:!1},url:this.settings.DEVICE_NAME_URL,success:function(e){t.locale=e.locale}}),this.locale},e.prototype.getForce=function(){var t=this;return this.force||this.service.ajax.request({ajax:{async:!1},url:this.settings.DEVICE_NAME_URL,success:function(e){t.force=e.force}}),this.force},e.prototype.getCurrentMode=function(){var t=this;return this.mode||this.service.ajax.request({ajax:{async:!1},data:{operation:"read"},url:$.su.url("/admin/device?form=mode"),success:function(e){t.mode={sysMode:e.sysmode,workMode:e.workmode}}}),this.mode},e.prototype.switchMode=function(e,t,i){var n=this;this.service.loading.show("changeMode"),this.service.ajax.request({url:"./data/sysmod.json",data:{oldValue:e,newValue:t},success:function(e){i(e)},fail:function(){n.service.loading.hide("changeMode")},error:function(){n.service.loading.hide("changeMode")}})},e.prototype.getSoftwareInfo=function(){var t=this;return this.version||this.service.ajax.request({ajax:{async:!1},url:"./data/systemSummaryConfig.json",success:function(e){t.version=e.fw_version}}),this.version},e.prototype.getHardwareInfo=function(){},e.prototype.getDeviceStatus=function(){var t=this;return this.service.ajax.request({ajax:{async:!1},url:"./data/status.json",success:function(e){t.status=e.auth}}),this.status},e.prototype.getLanIptv=function(e){return this.supportLanIptv},e.prototype.getShowPerformance=function(){var t=this,e=t.switchList;return e.isFetched||this.service.ajax.request({ajax:{async:!1},data:{operation:"read"},url:$.su.url("/admin/component_control?form=switch_list"),success:function(e){$.extend(t.switchList,e)}}),e.show_performance},e}(),function(s){s.su.Module=function(){var n=function(e){n.superclass.constructor.call(this,e)};s.su.inherit(s.su.Module,n);return n.prototype.launch=function(e){(function(){var i=s.su.moduleManager.query("index"),e=this.settings,n=e.commonSave,t=e.preventSave;if("available"===s.su.moduleManager.getStatus("index")){if(i.hideSaveBtn(),t)return;!1===n&&i.alwaysShowSaveBtn(this.name),s.each(s.extend({},this.data.stores,this.data.models),function(e,t){t.dataObj&&t.dataObj.proxy&&(!1!==n&&i.registerAutoSaveData(t),i.registerSaveLoading(t))})}}).call(this),n.superclass.launch.call(this,e)},n.prototype.destroy=function(e){var i=s.su.moduleManager.query("index"),t=this.settings.commonSave;"available"===s.su.moduleManager.getStatus("index")&&(!1===t&&i.cancelAlwaysShowSaveBtn(this.name),s.each(s.extend({},this.data.stores,this.data.models),function(e,t){t.dataObj&&t.dataObj.proxy&&(i.unRegisterAutoSaveData(t),i.unRegisterSaveLoading(t))})),n.superclass.destroy.call(this)},n.prototype.registerAutoSaveData=function(e){if("available"!==s.su.moduleManager.getStatus("index"))return!1;var i=s.su.moduleManager.query("index");return s.isArray(e)||(e=[e]),s.each(e,function(e,t){(t instanceof s.su.ModelBind||t instanceof s.su.StoreBind)&&i.registerAutoSaveData(t)}),!0},n.prototype.unRegisterAutoSaveData=function(e){if("available"!==s.su.moduleManager.getStatus("index"))return!1;var i=s.su.moduleManager.query("index");return s.isArray(e)||(e=[e]),s.each(e,function(e,t){(t instanceof s.su.ModelBind||t instanceof s.su.StoreBind)&&i.unRegisterAutoSaveData(t)}),!0},n.STATUS=s.su.Module.STATUS,n}()}(jQuery),$.su.LanguageService=function(){var e=function(){this.init(),this.name="language",$.su.Service.call(this)};return $.su.inherit($.su.Service,e),e.prototype.init=function(){},e.prototype.getLocale=function(e,t){return $.su.language.getLocale(e,t)},e.prototype.switchTo=function(e,t,i){$.su.language.switchTo(e,t,i)},e}(),function(a){var t,n,s,i;a.su.Time=(t={format:"MM/dd/yyyy HH:mm:ss",defaultTime:"01/01/1990 00:00:00",proxy:"timeServiceProxy"},s=n=null,i=function(e){if("object"==typeof i.instance)return i.instance;clearInterval(n),this.settings=a.extend({},t,e),this.name="time",a.su.Service.call(this),(i.instance=this).init()},a.su.inherit(a.su.Service,i),i.prototype.init=function(){var e=this;this.currentTime=null,this.hour24Enable=null,a.su.require([this.settings.proxy]).done(function(){e.proxy=a.su.createSync(e.settings.proxy)})},i.prototype.addListener=function(e,t,i,n){var s=i;"object"===a.type(i)?this.constructor.superclass.on.call(this,e,t,i,n):this.constructor.superclass.on.call(this,e,t),"function"===a.type(i)?this.addListenerHandler(e,s):this.addListenerHandler(e)},i.prototype.removeListener=function(e,t,i,n){this.constructor.superclass.off.call(this,e,t,i,n),this.removeListenerHandler(e)},i.prototype.fireEvent=function(e){var t="";switch(e){case"on_time_change":t=this.currentTime;break;case"on_hour24_change":t=this.hour24Enable}this.constructor.superclass.trigger.call(this,e,t)},i.prototype.addListenerHandler=function(e,t){if(this.eventDealer.eventInfo[e]){var i=this;switch(e){case"on_time_change":this.sync(function(e){i.updateTime(),t&&e&&t(e)});break;case"on_hour24_change":this.sync()}}},i.prototype.removeListenerHandler=function(e){var t=this.eventDealer.eventInfo;if(t[e])switch(e){case"on_time_change":0===t[e].length&&this.stopUpdateTime()}},i.prototype.sync=function(t){var i=this;this.isBusy?t&&t(i.currentTime):(this.isBusy=!0,this.proxy.read({success:function(e){i.setHour24("on"===e.hour24Enable),i.setTime(i.convert(e.date+" "+e.time)),i.isBusy=!1,t&&t(e)},fail:function(){i.setHour24(!0),i.setTime(new Date),i.isBusy=!1,t&&t()},error:function(){i.setHour24(!0),i.setTime(new Date),i.isBusy=!1,t&&t()}}))},i.prototype.getTime=function(){var t=this;return null===this.currentTime&&this.proxy.read({ajax:{async:!1},success:function(e){t.setTime(t.convert(e.date+" "+e.time))},fail:function(){t.setTime(new Date)},error:function(){t.setTime(new Date)}}),this.currentTime},i.prototype.setTime=function(e){"date"===a.type(e)&&(this.currentTime=e,this.fireEvent("on_time_change"))},i.prototype.getHour24=function(e){var t=this;return null===this.hour24Enable&&this.proxy.read({ajax:{async:!1},success:function(e){t.setHour24("on"===e.hour24Enable)},fail:function(e){t.setHour24(!0)},error:function(e){t.setHour24(!0)}}),this.hour24Enable},i.prototype.setHour24=function(e){this.hour24Enable=!!e,this.fireEvent("on_hour24_change")},i.prototype.updateTime=function(){var i=this;clearInterval(n),s=new Date,n=setInterval(function(){var e=new Date,t=e.getTime()-s.getTime();s=e,i.setTime(new Date(i.currentTime.getTime()+t))},1e3)},i.prototype.stopUpdateTime=function(){clearInterval(n),n=null},i.prototype.convert=function(e,t){e=e||this.settings.defaultTime,t=t||this.settings.format;var i={"y+":"year","M+":"month","d+":"day","H+":"hour","m+":"minute","s+":"second"},n={};for(var s in i){var a=new RegExp(s).exec(t);n[i[s]]=e.slice(a.index,a.index+a[0].length)}return new Date(n.year,n.month-1,n.day,n.hour,n.minute,n.second)},i.prototype.format=function(e,t,i){i=i||this.hour24Enable;var n=t||this.settings.format,s=e.getHours(),a={"y+":e.getFullYear(),"M+":e.getMonth()+1,"d+":e.getDate(),"H+":s,"m+":e.getMinutes(),"s+":e.getSeconds()};for(var r in!i&&12<s&&(a["H+"]-=12),a){var o=a[r];if(new RegExp("("+r+")").test(n)){var d=RegExp.$1;n="H+"!==r||i?n.replace(d,("0"+o).slice(-1*(d+"").length)):n.replace(d,o)}}return i||(n+=12<s?" PM":" AM"),n},i.prototype.on=i.prototype.addListener,i.prototype.off=i.prototype.removeListener,i)}(jQuery),function(){var t;$.su.define("SPFProxy",{extend:"AjaxProxy",constructor:(t=function(e){t.$parent.call(this,e),e&&e.hasOwnProperty("form")&&(this.form=e.form)},t),form:"",sync:function(e,t){var i=e.operation;"read"===i?this.read.apply(this,arguments):"write"!==i&&i?this[i]?this[i].apply(this,arguments):$.su.debug.error("no such operation: ",i):this.write.apply(this,arguments)},read:function(e,t){var s=this;e.data=this.packReadData();var a=e.success;e.success=function(e,t,i,n){s.trigger("ev_load",[e]),a&&a(e,t,i,n)},this.op("read",e)},write:function(e,t){var i=e.dataObj,n=e.difference;if(i instanceof $.su.Model)e.data=this.packWriteData(n.update);else if(i instanceof $.su.Store){var s=[],a=this.packUpdateData(n.update),r=this.packCreateData(n.insert),o=this.packRemoveData(n.remove);a&&s.push(a),r&&s.push(r),o&&s.push(o),e.data=s}this.op("write",e)},packReadData:function(e){var t={};return t.form=this.form,t.operation="read",t.data=[],[t]},packWriteData:function(e){var t={};return t.form=this.form,t.operation="write",t.data=[e.model],[t]},packUpdateData:function(e){if(!e||$.su.isEmptyObject(e))return!1;var t={};for(var i in t.form=this.form,t.operation="update",t.data=[],e)e.hasOwnProperty(i)&&t.data.push(e[i].model);return t},packRemoveData:function(e){if(!e||$.su.isEmptyObject(e))return!1;var t={};for(var i in t.form=this.form,t.operation="remove",t.data=[],e)e.hasOwnProperty(i)&&t.data.push(e[i].oldModel);return t},packCreateData:function(e){if(!e||$.su.isEmptyObject(e))return!1;var t={};for(var i in t.form=this.form,t.operation="create",t.data=[],e)e.hasOwnProperty(i)&&t.data.push(e[i].model);return t}})}(jQuery),function(n){n.su.define("SPFAjaxRequestCombination",{constructor:function(){this.connection=new n.su.Connection({successJudge:function(){return!0}}),this.requestQueue=[],this.requestWait=null},request:function(e){var t=this,i=e.data;"array"!==n.type(i)?n.su.debug.error("SPF need the data in format of Array"):(this.requestWait&&clearTimeout(this.requestWait),this.requestQueue.push(e),this.requestWait=setTimeout(function(){t.connection.request({url:t.getUrl(),ajax:t.getAjaxOption(),data:t.combineData(),success:t.generateSuccessCallback(),fail:t.generateErrorCallback()}),t.requestQueue=[]},0))},getUrl:function(){return this.requestQueue[0].url||this.requestQueue[0].ajax.url},getAjaxOption:function(){return null},combineData:function(){for(var e=[],t=this.matchTest,i=this.requestQueue,n=i.length,s=0;s<n;s++){var a=i[s].data;if(a){var r=0,o=a.length;if(0!=o)for(;r<o;r++){for(var d=a[r],l=0,c=e.length;l<c;l++){var u=e[l];if(t(u,d)){var h;h=u.data?u.data:u.data=[],d.data&&(h=h.concat(d.data));break}}l===c&&e.push(d)}}}return e},generateSuccessCallback:function(){var f=this.matchTest,v=this.requestQueue;return function(e,t,i){for(var n=v.length,s=0;s<n;s++){var a=v[s],r=[],o=a.data,d=0,l=o.length;if(0!=l){for(;d<l;d++)for(var c=o[d],u=0,h=e.length;u<h;u++){var p=e[u];f(p,c)&&r.push(p)}a.success&&a.success(r,t,i)}}}},generateErrorCallback:function(){var s=this.requestQueue;return function(e,t){for(var i=0;i<s.length;i++){var n=s[i];n.fail&&n.fail(e,t)}}},matchTest:function(e,t){return e.form===t.form&&e.operation===t.operation}})}(jQuery),function(p){var t;p.su.define("IPFProxy",{extend:"AjaxProxy",constructor:(t=function(e){t.$parent.call(this,e),e&&e.hasOwnProperty("preventSuccessEvent")&&(this.preventSuccessEvent=e.preventSuccessEvent),e&&e.hasOwnProperty("preventFailEvent")&&(this.preventFailEvent=e.preventFailEvent),this.defaultOption.preventSuccessEvent=this.preventSuccessEvent,this.defaultOption.preventFailEvent=this.preventFailEvent},t),successJudge:function(e,t){if(!0===e.success||0===e.error_code||0===e.errorcode)return!0;var i=e.error_code||e.errorcode,n=p.su.moduleManager.query("main");switch(i){case"timeout":n instanceof p.su.Module&&n.trigger("ev_login_timeout");break;case-5001:n instanceof p.su.Module&&n.trigger("ev_user_conflict");break;case"permission denied":n instanceof p.su.Module&&n.trigger("ev_permission_denied")}return i},readFilter:function(e){return e.data||e.result},failFilter:function(e){var t=p.extend({},e);return t.errorCode=e.errorCode||e.error||e.error_code||e.errorcode,t},sync:function(e){var t,i=Array.prototype.slice.call(arguments,0),n=e.operation,s=e.dataObj;s instanceof p.su.Model?t="Model":s instanceof p.su.Store&&(t="Store"),"read"===n&&"Model"===t?this.read.apply(this,i):"read"===n&&"Store"===t?this.load.apply(this,i):"write"===n&&"Model"===t?this.write.apply(this,i):"write"===n&&"Store"===t?(p.su.isEmptyObject(e.difference.remove)||this.remove.apply(this,i),p.su.isEmptyObject(e.difference.insert)||this.insert.apply(this,i),p.su.isEmptyObject(e.difference.update)||this.update.apply(this,i)):this[n]?this[n].apply(this,i):p.su.debug.error("no such operation: ",n)},read:function(e,t){var i,s=this;i=e.data&&e.data.operation!==undefined?e.data:{params:e.data},e.data=p.extend({},{operation:"read"},i);var a=e.success;e.success=function(e,t,i,n){s.trigger("ev_load",[e]),a&&a(e,t,i,n)},this.op("read",e)},write:function(e){var t=e.dataObj;e.difference=p.extend({update:{}},e.difference),e.data={operation:"write",params:p.extend(!0,{},e.difference.update.model)};var i=e.success;e.success=function(e){t.record(),i&&i(e)},this.op("write",e)},load:function(e){var t,s=this;t=e.data&&e.data.operation!==undefined?e.data:{params:e.data},e.data=p.extend({},{operation:"read"},t);var a=e.success;e.success=function(e,t,i,n){s.trigger("ev_load",[e]),a&&a(e,t,i,n)},this.op("load",e)},remove:function(e){var t=e.difference.remove,s=e.dataObj,i=s.keyProperty,n={"key":[],"index":[]};for(var a in t)t.hasOwnProperty(a)&&n.key.push(t[a].oldModel[i]);n.index=s.getIndexsInSnapshot(n.key),e.data=p.extend({},{operation:"remove"});var r=e.success||function(){};e.traditional=!0,e.success=function(e,t,i,n){s.record(),r(e,t,i,n)},this.op("remove",e)},insert:function(e){var t=e.difference.insert,i={},s=e.dataObj,n=!1;for(var a in t)if(t.hasOwnProperty(a)){if(n)continue;i.key="add",i["new"]=JSON.stringify(t[a].model),i.old="add",n=!(i.index=0)}e.data=p.extend({},i,{operation:"insert"});var r=e.success||function(){};e.success=function(e,t,i,n){s.record(),r(e,t,i,n)},this.op("insert",e)},update:function(e){var t=e.difference.update,i={},s=e.dataObj,n=s.keyProperty,a=!1;for(var r in t)if(t.hasOwnProperty(r)){if(a)continue;i.key=t[r].oldModel[n],i["new"]=JSON.stringify(t[r].model),i.old=JSON.stringify(t[r].oldModel),a=!0}e.data=p.extend({},i,{operation:"update"});var o=e.success||function(){};e.success=function(e,t,i,n){s.record(),o(e,t,i,n)},this.op("update",e)},_decorateOption:function(l){var c=this;if(l.writeFilter){var e=p.extend(!0,{},l.data),t=l.writeFilter.call(this,e);l.data=p.extend({},e,t)}var u=!!l&&l.success,h=!!l&&l.fail;l.success=function(e,t,i){var n,s=["/admin/system?form=envar","/login?form=check_factory_default","/login?form=auth","/login?form=keys","/admin/log_export?form=save_log","/admin/cloud?form=firmware","/admin/isp?form=isp_upgrade"];p.each(s,function(e,t){s[e]=p.su.url(t).toStringURL?p.su.url(t).toStringURL():p.su.url(t)}),n=s.indexOf(l.url.toStringURL?l.url.toStringURL():l.url)<0?e.data?JSON.parse(p.su.encryptor.AesDecrypt(e.data)):{"error_code":"timeout"}:e;var a=!l.successJudge||l.successJudge(n,t,i);if(!0===a){var r=l.readFilter?l.readFilter.call(c,n):n;u&&u(r,n,t,i);var o=l.data&&l.data.operation;!0!==l.preventSuccessEvent&&o&&"read"!=o&&"load"!=o&&p.su.moduleManager.query("main")&&p.su.moduleManager.query("main").showNotice(p.su.CHAR.COMMON.SAVED)}else{var d=l.failFilter?l.failFilter.call(c,n):n;h&&h(d,a,t,i),!0!==l.preventFailEvent&&p.su.raise({msg:"ev_proxy_fail",type:"proxy_fail",errorCode:n.errorcode||n.error_code,proxy:c})}}}})}(jQuery),function(u){var t;u.su.define("DecoProxy",{extend:"AjaxProxy",constructor:(t=function(e){t.$parent.call(this,e),this.action||(this.action=e&&e.action),e&&e.hasOwnProperty("preventSuccessEvent")&&(this.preventSuccessEvent=e.preventSuccessEvent),e&&e.hasOwnProperty("preventFailEvent")&&(this.preventFailEvent=e.preventFailEvent),this.defaultOption.preventSuccessEvent=this.preventSuccessEvent,this.defaultOption.preventFailEvent=this.preventFailEvent},t),successJudge:function(e,t){if(!1!==e.success)return!0;var i=e.errorCode||e.error||e.error_code||e.errorcode,n=u.su.moduleManager.query("main");switch(i){case"timeout":n instanceof u.su.Module&&n.trigger("ev_login_timeout");break;case"user conflict":n instanceof u.su.Module&&n.trigger("ev_user_conflict");break;case"permission denied":n instanceof u.su.Module&&n.trigger("ev_permission_denied")}return i},readFilter:function(e){return e.data||e.result},failFilter:function(e){var t=u.extend({},e);return t.errorCode=e.errorCode||e.error||e.error_code||e.errorcode,t},sync:function(e){var t,i=Array.prototype.slice.call(arguments,0),n=e.operation,s=e.dataObj;s instanceof u.su.Model?t="Model":s instanceof u.su.Store&&(t="Store"),"read"===n&&"Model"===t?this.read.apply(this,i):"read"===n&&"Store"===t?this.load.apply(this,i):"write"===n&&"Model"===t?this.write.apply(this,i):"write"===n&&"Store"===t?(u.su.isEmptyObject(e.difference.remove)||this.remove.apply(this,i),u.su.isEmptyObject(e.difference.insert)||this.insert.apply(this,i),u.su.isEmptyObject(e.difference.update)||this.update.apply(this,i)):this[n]?this[n].apply(this,i):u.su.debug.error("no such operation: ",n)},_changeUrl:function(e,t,i){var n=this.defaultOption.url;n&&n.indexOf(".json")<0&&(e.url=n+t+"."+i+".json",e.ajax={},e.ajax.url=n+t+"."+i+".json")},read:function(e){var s=this,t=this.action&&this.action.read?"."+this.action.read:"",a=e.success;e.success=function(e,t,i,n){s.trigger("ev_load",[e]),a&&a(e,t,i,n)},this._changeUrl(e,t,"r"),this.op("read",e)},write:function(e){var t=e.dataObj,i=this.action&&this.action.write?"."+this.action.write:"",n=e.success;e.difference=u.extend({update:{}},e.difference),e.data={},e.data.params=u.extend({},e.difference.update.model,e.data),e.success=function(e){t.record(),n&&n(e)},this._changeUrl(e,i,"w"),this.op("write",e)},load:function(e){var s=this,t=this.action&&this.action.read?"."+this.action.read:"",a=e.success;e.success=function(e,t,i,n){s.trigger("ev_load",[e]),a&&a(e,t,i,n)},this._changeUrl(e,t,"r"),this.op("load",e)},remove:function(e){var t=e.difference.remove,s=e.dataObj,i=s.keyProperty,n={"key":[],"index":[]};for(var a in t)t.hasOwnProperty(a)&&n.key.push(t[a].oldModel[i]);n.index=s.getIndexsInSnapshot(n.key),e.data=u.extend({},n);var r=e.success||function(){};e.traditional=!0,e.success=function(e,t,i,n){s.record(),r(e,t,i,n)},this.op("remove",e)},insert:function(e){var t=e.difference.insert,i={},s=e.dataObj,n=!1;for(var a in t)if(t.hasOwnProperty(a)){if(n)continue;i.key="add",i["new"]=JSON.stringify(t[a].model),i.old="add",n=!(i.index=0)}e.data=u.extend({},i,{operation:"insert"});var r=e.success||function(){};e.success=function(e,t,i,n){s.record(),r(e,t,i,n)},this.op("insert",e)},update:function(e){var t=e.difference.update,i={},s=e.dataObj,n=s.keyProperty,a=!1;for(var r in t)if(t.hasOwnProperty(r)){if(a)continue;i.key=t[r].oldModel[n],i["new"]=JSON.stringify(t[r].model),i.old=JSON.stringify(t[r].oldModel),a=!0}e.data=u.extend({},i,{operation:"update"});var o=e.success||function(){};e.success=function(e,t,i,n){s.record(),o(e,t,i,n)},this.op("update",e)},_decorateOption:function(o){var d=this;o.writeFilter&&(o.data=o.writeFilter.call(this,o.data));var l=!!o&&o.success,c=!!o&&o.fail;o.success=function(e,t,i){var n=!o.successJudge||o.successJudge(e,t,i);if(!0===n){var s=o.readFilter?o.readFilter.call(d,e):e;l&&l(s,e,t,i);var a=o.data&&o.data.operation;!0!==o.preventSuccessEvent&&a&&"read"!=a&&"load"!=a&&u.su.moduleManager.query("main")&&u.su.moduleManager.query("main").showNotice(u.su.CHAR.COMMON.SAVED)}else{var r=o.failFilter?o.failFilter.call(d,e):e;c&&c(r,n,t,i),!0!==o.preventFailEvent&&u.su.raise({msg:"ev_proxy_fail",type:"proxy_fail",errorCode:e.errorCode,proxy:d})}}}})}(jQuery);