!function(o){var r,t,n,e,s,i;o.encrypt=o.encrypt||{},o.encrypt.MD5=function(t,e){return CryptoJS.MD5(t,e).toString()},o.encrypt.AES=(r={mode:CryptoJS.mode.CBC,padding:CryptoJS.pad.Pkcs7},(t=function(){}).prototype.genKey=function(){var t=((new Date).getTime()+""+1e9*Math.random()).substr(0,16),e=((new Date).getTime()+""+1e9*Math.random()).substr(0,16);return this.key=t,this._keyUtf8=CryptoJS.enc.Utf8.parse(t),this.iv=e,this._ivUtf8=CryptoJS.enc.Utf8.parse(e),{key:t,iv:e}},t.prototype.setKey=function(t,e){"string"==typeof t&&16==t.length&&(this.key=t,this._keyUtf8=CryptoJS.enc.Utf8.parse(t)),"string"==typeof e&&16==e.length&&(this.iv=e,this._ivUtf8=CryptoJS.enc.Utf8.parse(e))},t.prototype.setStringKey=function(t){var e=t.split("&"),r=e[0].split("=")[1],n=e[1].split("=")[1];this.setKey(r,n)},t.prototype.getKey=function(){return{key:this.key,iv:this.iv}},t.prototype.getKeyString=function(t){return(t=t||"k=%key%&i=%iv%").replace("%key%",this.key).replace("%iv%",this.iv)},t.prototype.encrypt=function(t){var e=o.extend(r,{iv:this._ivUtf8});return CryptoJS.AES.encrypt(t,this._keyUtf8,e).toString()},t.prototype.decrypt=function(t){var e=o.extend(r,{iv:this._ivUtf8});return CryptoJS.AES.decrypt(t,this._keyUtf8,e).toString(CryptoJS.enc.Utf8)},t),o.encrypt.RSA=(n=o.su.encrypt,(e=function(){}).prototype.setKey=function(t,e){this.nn=t,this.ee=e},e.prototype.setStringKey=function(t){var e=t.split("&"),r=e[0].split("=")[1],n=e[1].split("=")[1];this.setKey(r,n)},e.prototype.encrypt=function(t,e,r){return n(t,[this.nn||e,this.ee||r])},e.prototype.getKeyString=function(t){return(t=t||"nn=%nn%&ee=%ee%").replace("%nn%",this.nn).replace("%ee%",this.ee)},e),o.encrypt.encryptor=((s=function(t){this.aes=new o.encrypt.AES,this.rsa=new o.encrypt.RSA}).prototype.setHash=function(){if(2==arguments.length){var t=arguments[0],e=arguments[1];this.hash=o.encrypt.MD5(t+e)}else{var r=arguments[0];this.hash=r}},s.prototype.getHash=function(){return this.hash},s.prototype.setSeq=function(t){this.seq=parseInt(t)},s.prototype.getSeq=function(t){return this.seq},s.prototype.genAESKey=function(){this.aes.genKey(),this.aesKeyString=this.aes.getKeyString()},s.prototype.getAESKey=function(){return this.aes.getKeyString()},s.prototype.setAESStringKey=function(t){this.aes.setStringKey(t),this.aesKeyString=t},s.prototype.setRSAKey=function(t,e){this.rsa.setKey(t,e)},s.prototype.setRSAStringKey=function(t){this.rsa.setStringKey(t)},s.prototype.getRSAKey=function(){return this.rsa.getKeyString()},s.prototype.getSignature=function(t,e){if(e)var r=this.aesKeyString+"&h="+this.hash+"&s="+t||this.seq;else r="h="+this.hash+"&s="+t||this.seq;if(53<r.length)var n=this.rsa.encrypt(r.substr(0,53))+this.rsa.encrypt(r.substr(53));else n=this.rsa.encrypt(r);return n},s.prototype.AesEncrypt=function(t,e){var r={},n=this.aes.encrypt(t),o=n.length;return r.sign=this.getSignature(this.seq+o,e),r.data=n,r},s.prototype.AesDecrypt=function(t){return this.aes.decrypt(t)},s),o.encrypt.encryptManager=((i=function(){}).prototype.genEncryptor=function(){return this.encryptor=new o.encrypt.encryptor,this.encryptor},i.prototype.recordEncryptor=function(){this.encryptor&&(localStorage.setItem("encryptorAES",this.encryptor.getAESKey()),localStorage.setItem("encryptorSeq",this.encryptor.getSeq()),localStorage.setItem("encryptorHash",this.encryptor.getHash()),localStorage.setItem("encryptorRsa",this.encryptor.getRSAKey()))},i.prototype.getEncryptor=function(){var t=localStorage.getItem("encryptorAES"),e=localStorage.getItem("encryptorSeq"),r=localStorage.getItem("encryptorHash"),n=localStorage.getItem("encryptorRsa");return this.encryptor||(this.encryptor=new o.encrypt.encryptor,this.encryptor.setAESStringKey(t),this.encryptor.setSeq(e),this.encryptor.setHash(r),this.encryptor.setRSAStringKey(n)),!!(t&&e&&r&&n)&&this.encryptor},i.prototype.cleanStorage=function(){localStorage.removeItem("encryptorAES"),localStorage.removeItem("encryptorSeq"),localStorage.removeItem("encryptorHash"),localStorage.removeItem("encryptorRsa")},new i)}(jQuery);