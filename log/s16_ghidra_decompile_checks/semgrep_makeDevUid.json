{"errors": [], "interfile_languages_used": [], "paths": {"scanned": ["/tmp/haruspex_makeDevUid/FUN_004007f0_004007f0.c", "/tmp/haruspex_makeDevUid/FUN_004008c4_004008c4.c", "/tmp/haruspex_makeDevUid/FUN_00400bb0_00400bb0.c", "/tmp/haruspex_makeDevUid/_fini_00400cd0.c", "/tmp/haruspex_makeDevUid/_ftext_00400790.c", "/tmp/haruspex_makeDevUid/_init_00400718.c", "/tmp/haruspex_makeDevUid/main_00400930.c"]}, "results": [{"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 57, "line": 19, "offset": 355}, "extra": {"engine_kind": "OSS", "fingerprint": "21997b2dff7a5b92b03d346e4a8b2ad66f5fac1236c6a1d7fe1a8cdb15dab8a9c4975f547a98f7472d7f3dccbc71f66ca3d6cdcf2c8f3ce2491e6a0b7374d904_0", "is_ignored": false, "lines": "  pFVar2 = fopen(\"/mnt/flash/device/dev_unique.ini\",\"r\");", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "fopen", "end": {"col": 17, "line": 19, "offset": 315}, "start": {"col": 12, "line": 19, "offset": 310}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_makeDevUid/main_00400930.c", "start": {"col": 12, "line": 19, "offset": 310}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 70, "line": 21, "offset": 457}, "extra": {"engine_kind": "OSS", "fingerprint": "baa785c3e402514edd6afbc658430feedfae6987646ca3c777d93cd6dcbc247c74ffd965c97320a83bc16ebe8012a30e1dcc0f0597d30404b1cc7b23847104b3_0", "is_ignored": false, "lines": "    system(\"mkdir -p /mnt/flash/device/ 2 > /dev/null 1 > /dev/null\");", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "system", "end": {"col": 11, "line": 21, "offset": 398}, "start": {"col": 5, "line": 21, "offset": 392}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_makeDevUid/main_00400930.c", "start": {"col": 5, "line": 21, "offset": 392}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 59, "line": 22, "offset": 517}, "extra": {"engine_kind": "OSS", "fingerprint": "21997b2dff7a5b92b03d346e4a8b2ad66f5fac1236c6a1d7fe1a8cdb15dab8a9c4975f547a98f7472d7f3dccbc71f66ca3d6cdcf2c8f3ce2491e6a0b7374d904_1", "is_ignored": false, "lines": "    pFVar2 = fopen(\"/mnt/flash/device/dev_unique.ini\",\"w\");", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "fopen", "end": {"col": 19, "line": 22, "offset": 477}, "start": {"col": 14, "line": 22, "offset": 472}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_makeDevUid/main_00400930.c", "start": {"col": 14, "line": 22, "offset": 472}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-insecure-api-rand-srand", "end": {"col": 38, "line": 36, "offset": 1020}, "extra": {"engine_kind": "OSS", "fingerprint": "b8a4324ba1c5832cbb0c9e2d8379cf012eac217d3319bf5a1e17555641153ade27d222679c51afde97cc20bb35111d78e7bc09de5ed1ed38563c0d6f3f26428b_0", "is_ignored": false, "lines": "      srand(uVar1 << 0x18 | uVar3 << 0x10 | (uint)(byte)local_18 | (uint)local_18._0_1_ << 8 |\n            tStack_38.tv_usec << 0xc);", "message": "The rand() PRNG should not be used in applications intended to be  portable when good randomness is needed. Instead, the use of random()  is recommended.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "HIGH", "references": ["https://cwe.mitre.org/data/definitions/338", "https://cwe.mitre.org/data/definitions/330", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf"]}, "metavars": {}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_makeDevUid/main_00400930.c", "start": {"col": 7, "line": 35, "offset": 894}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 38, "line": 36, "offset": 1020}, "extra": {"engine_kind": "OSS", "fingerprint": "834fc91936e9f274c0f4c585dc4b70b86a8b02150a88f003950990afede945df2bc20a81507c11fad9f99a4d48a17791289613bfc75c751d1e62f3fdeeaf49ab_0", "is_ignored": false, "lines": "      srand(uVar1 << 0x18 | uVar3 << 0x10 | (uint)(byte)local_18 | (uint)local_18._0_1_ << 8 |\n            tStack_38.tv_usec << 0xc);", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "srand", "end": {"col": 12, "line": 35, "offset": 899}, "start": {"col": 7, "line": 35, "offset": 894}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_makeDevUid/main_00400930.c", "start": {"col": 7, "line": 35, "offset": 894}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-insecure-api-rand-srand", "end": {"col": 23, "line": 39, "offset": 1080}, "extra": {"engine_kind": "OSS", "fingerprint": "b8a4324ba1c5832cbb0c9e2d8379cf012eac217d3319bf5a1e17555641153ade27d222679c51afde97cc20bb35111d78e7bc09de5ed1ed38563c0d6f3f26428b_1", "is_ignored": false, "lines": "        iVar4 = rand();", "message": "The rand() PRNG should not be used in applications intended to be  portable when good randomness is needed. Instead, the use of random()  is recommended.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "HIGH", "references": ["https://cwe.mitre.org/data/definitions/338", "https://cwe.mitre.org/data/definitions/330", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf"]}, "metavars": {}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_makeDevUid/main_00400930.c", "start": {"col": 17, "line": 39, "offset": 1074}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 23, "line": 39, "offset": 1080}, "extra": {"engine_kind": "OSS", "fingerprint": "24808117e1d6935b1a16e545f3059351a8b8c5b161aeabae969cd54e5c01af2b42f258c66a8509492d83345ad2bd45444fba044eed94bd8587f94f84bc675d39_0", "is_ignored": false, "lines": "        iVar4 = rand();", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "rand", "end": {"col": 21, "line": 39, "offset": 1078}, "start": {"col": 17, "line": 39, "offset": 1074}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_makeDevUid/main_00400930.c", "start": {"col": 17, "line": 39, "offset": 1074}}], "skipped_rules": [], "version": "1.89.0"}
