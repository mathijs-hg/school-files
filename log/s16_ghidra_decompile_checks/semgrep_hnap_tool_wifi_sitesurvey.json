{"errors": [], "interfile_languages_used": [], "paths": {"scanned": ["/tmp/haruspex_hnap_tool_wifi_sitesurvey/FUN_00400e10_00400e10.c", "/tmp/haruspex_hnap_tool_wifi_sitesurvey/FUN_00400ee4_00400ee4.c", "/tmp/haruspex_hnap_tool_wifi_sitesurvey/FUN_00400f50_00400f50.c", "/tmp/haruspex_hnap_tool_wifi_sitesurvey/FUN_00400f8c_00400f8c.c", "/tmp/haruspex_hnap_tool_wifi_sitesurvey/FUN_00401cd0_00401cd0.c", "/tmp/haruspex_hnap_tool_wifi_sitesurvey/FUN_00401ff4_00401ff4.c", "/tmp/haruspex_hnap_tool_wifi_sitesurvey/FUN_00402114_00402114.c", "/tmp/haruspex_hnap_tool_wifi_sitesurvey/FUN_004021a0_004021a0.c", "/tmp/haruspex_hnap_tool_wifi_sitesurvey/FUN_00402294_00402294.c", "/tmp/haruspex_hnap_tool_wifi_sitesurvey/FUN_004023c0_004023c0.c", "/tmp/haruspex_hnap_tool_wifi_sitesurvey/FUN_00402530_00402530.c", "/tmp/haruspex_hnap_tool_wifi_sitesurvey/_fini_00402830.c", "/tmp/haruspex_hnap_tool_wifi_sitesurvey/_ftext_00400db0.c", "/tmp/haruspex_hnap_tool_wifi_sitesurvey/_init_00400d30.c", "/tmp/haruspex_hnap_tool_wifi_sitesurvey/ixmlAppendNewElement_00402478.c", "/tmp/haruspex_hnap_tool_wifi_sitesurvey/ixmlElement_setTagName_00401e78.c", "/tmp/haruspex_hnap_tool_wifi_sitesurvey/ixmlNode_setNodeName_00401dcc.c", "/tmp/haruspex_hnap_tool_wifi_sitesurvey/main_0040107c.c"]}, "results": [{"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 33, "line": 12, "offset": 245}, "extra": {"engine_kind": "OSS", "fingerprint": "268fd6cb56e55a7ec4774a578e54690f238593354fe6084aa25813ec3385c7868b2341f7528725883dd4cf88be831128af0e02ead23ebf84b30967299479bc22_0", "is_ignored": false, "lines": "  strncpy(param_1,__src,param_2);", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "strncpy", "end": {"col": 10, "line": 12, "offset": 222}, "start": {"col": 3, "line": 12, "offset": 215}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_hnap_tool_wifi_sitesurvey/FUN_00401cd0_00401cd0.c", "start": {"col": 3, "line": 12, "offset": 215}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-unterminated-string-strncpy-stpncpy", "end": {"col": 33, "line": 12, "offset": 245}, "extra": {"engine_kind": "OSS", "fingerprint": "d43ccbc89060e7d8da16913d781532a5c4a269bce651bc3a0c2fbc5bd8a784e26ca2b615b8af518f94258995b22626f44f624fe2640c4bf5ba4b5957323eb73a_0", "is_ignored": false, "lines": "  strncpy(param_1,__src,param_2);", "message": "If there is no NUL character byte in the first n bytes of the source string, strncpy() and stpncpy() do not NUL-terminate the destination buffer. If the program does not explicitly terminate the destination buffer, this will almost certainly result in information disclosure, and possibly a buffer overflow condition.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://cwe.mitre.org/data/definitions/170", "https://cwe.mitre.org/data/definitions/126", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf"]}, "metavars": {"$FUN": {"abstract_content": "strncpy", "end": {"col": 10, "line": 12, "offset": 222}, "start": {"col": 3, "line": 12, "offset": 215}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_hnap_tool_wifi_sitesurvey/FUN_00401cd0_00401cd0.c", "start": {"col": 3, "line": 12, "offset": 215}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-signed-unsigned-conversion", "end": {"col": 27, "line": 14, "offset": 288}, "extra": {"engine_kind": "OSS", "fingerprint": "850c885d09e5a605592f5d616285d28806dc6d3c4853ea4e42b29aaeaebf173f0602779dd26ac6f9e8b5d78bdcdee33ac07481013dc29e454545a759468dcfd6_0", "is_ignored": false, "lines": "  iVar2 = (int)param_2 / 2;", "message": "The software uses a signed primitive and performs a cast to an unsigned primitive, or uses an unsigned primitive and performs a cast to a signed primitive, which can produce an unexpected value. When the result of a function is to be used as a size parameter, using negative return values can have unexpected results. Although less frequent an issue, unsigned-to-signed conversion can be  the precursor to buffer underwrite conditions. Buffer underwrites  occur frequently when large unsigned values are cast to signed values,  and then used as indexes into a buffer or for pointer arithmetic.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "LOW", "references": ["https://cwe.mitre.org/data/definitions/195", "https://cwe.mitre.org/data/definitions/196", "https://cwe.mitre.org/data/definitions/194", "https://cwe.mitre.org/data/definitions/191", "https://cwe.mitre.org/data/definitions/681", "https://cwe.mitre.org/data/definitions/789", "https://g.co/kgs/PCHQjJ", "https://github.com/struct/mms", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "http://www.phrack.org/issues/60/10.html#article", "https://docs.microsoft.com/en-us/cpp/sanitizers/asan-error-examples"]}, "metavars": {"$SIGNED": {"abstract_content": "iVar2", "end": {"col": 8, "line": 14, "offset": 269}, "start": {"col": 3, "line": 14, "offset": 264}}, "$UNSIGNED": {"abstract_content": "param_2", "end": {"col": 23, "line": 14, "offset": 284}, "start": {"col": 16, "line": 14, "offset": 277}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_hnap_tool_wifi_sitesurvey/FUN_00401cd0_00401cd0.c", "start": {"col": 3, "line": 14, "offset": 264}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-insecure-api-rand-srand", "end": {"col": 19, "line": 17, "offset": 354}, "extra": {"engine_kind": "OSS", "fingerprint": "ccdc01d5ee510781ed480500964900781f07e017bc9b97c5895ac0d7ec11eb972abdc0471b792f6ee3c22d80c2b950f9d8220fc9ccf16cc6ef2e4799869ebe17_0", "is_ignored": false, "lines": "    iVar1 = rand();", "message": "The rand() PRNG should not be used in applications intended to be  portable when good randomness is needed. Instead, the use of random()  is recommended.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "HIGH", "references": ["https://cwe.mitre.org/data/definitions/338", "https://cwe.mitre.org/data/definitions/330", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf"]}, "metavars": {}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_hnap_tool_wifi_sitesurvey/FUN_00401cd0_00401cd0.c", "start": {"col": 13, "line": 17, "offset": 348}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 19, "line": 17, "offset": 354}, "extra": {"engine_kind": "OSS", "fingerprint": "ee0147701fa722a6420e4d0475998d291a861bd1c0114b3ef29685b67a51b625693ae96264c8b635c74364e0ef5f4d517a6e6cab9367fd46af29c2c217ae82e7_0", "is_ignored": false, "lines": "    iVar1 = rand();", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "rand", "end": {"col": 17, "line": 17, "offset": 352}, "start": {"col": 13, "line": 17, "offset": 348}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_hnap_tool_wifi_sitesurvey/FUN_00401cd0_00401cd0.c", "start": {"col": 13, "line": 17, "offset": 348}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 47, "line": 22, "offset": 658}, "extra": {"engine_kind": "OSS", "fingerprint": "736705b20048d9c4f1dbb696162853dbb441e5d9313b5df63bd14669036abd71aafe932e91c26e20331250bfda08c9c0dee4bddeefafbc8d9e26f95c61fefab6_0", "is_ignored": false, "lines": "          snprintf(param_3,param_4,\"%s\",iVar2);", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "snprintf", "end": {"col": 19, "line": 22, "offset": 630}, "start": {"col": 11, "line": 22, "offset": 622}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_hnap_tool_wifi_sitesurvey/FUN_00402294_00402294.c", "start": {"col": 11, "line": 22, "offset": 622}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-signed-unsigned-conversion", "end": {"col": 30, "line": 44, "offset": 848}, "extra": {"engine_kind": "OSS", "fingerprint": "bd20059d0037a0519f418a5ef391b76b6eec970face373ff41ac4ff4ef54d24c5e37a0fc11aad95732272d9a1042d91ae570138185be434747ddf0493905cb5b_0", "is_ignored": false, "lines": "  memset(auStack_4cf,0,0x3ff);", "message": "The software uses a signed primitive and performs a cast to an unsigned primitive, or uses an unsigned primitive and performs a cast to a signed primitive, which can produce an unexpected value. When the result of a function is to be used as a size parameter, using negative return values can have unexpected results. Although less frequent an issue, unsigned-to-signed conversion can be  the precursor to buffer underwrite conditions. Buffer underwrites  occur frequently when large unsigned values are cast to signed values,  and then used as indexes into a buffer or for pointer arithmetic.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "LOW", "references": ["https://cwe.mitre.org/data/definitions/195", "https://cwe.mitre.org/data/definitions/196", "https://cwe.mitre.org/data/definitions/194", "https://cwe.mitre.org/data/definitions/191", "https://cwe.mitre.org/data/definitions/681", "https://cwe.mitre.org/data/definitions/789", "https://g.co/kgs/PCHQjJ", "https://github.com/struct/mms", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "http://www.phrack.org/issues/60/10.html#article", "https://docs.microsoft.com/en-us/cpp/sanitizers/asan-error-examples"]}, "metavars": {"$CHAR": {"abstract_content": "0", "end": {"col": 23, "line": 44, "offset": 841}, "start": {"col": 22, "line": 44, "offset": 840}}, "$DST": {"abstract_content": "auStack_4cf", "end": {"col": 21, "line": 44, "offset": 839}, "start": {"col": 10, "line": 44, "offset": 828}}, "$LEN": {"abstract_content": "0x3ff", "end": {"col": 29, "line": 44, "offset": 847}, "start": {"col": 24, "line": 44, "offset": 842}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_hnap_tool_wifi_sitesurvey/main_0040107c.c", "start": {"col": 3, "line": 44, "offset": 821}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 33, "line": 54, "offset": 1223}, "extra": {"engine_kind": "OSS", "fingerprint": "61ae4b1d5c34aa4a5d3738a14b8b2e986fad455ed09c7bc7f147cc30f98235fcd7c0b6514cf3bafaa2b5fd3c03bbab7094ea7a792f0cd684190068a7dec6fd03_0", "is_ignored": false, "lines": "    local_5c = fopen(pcVar6,\"w\");", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "fopen", "end": {"col": 21, "line": 54, "offset": 1211}, "start": {"col": 16, "line": 54, "offset": 1206}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_hnap_tool_wifi_sitesurvey/main_0040107c.c", "start": {"col": 16, "line": 54, "offset": 1206}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 22, "line": 60, "offset": 1403}, "extra": {"engine_kind": "OSS", "fingerprint": "b59a008cc8ff6ade0811ef409ee3dd6f9dd642392a8d1fcf2a93cc72374f99c309295ecd73c9064f9b707dbc591f4ef60365cbcd277d88259a67c784b52f8350_0", "is_ignored": false, "lines": "      __s = tmpfile();", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "tmpfile", "end": {"col": 20, "line": 60, "offset": 1401}, "start": {"col": 13, "line": 60, "offset": 1394}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_hnap_tool_wifi_sitesurvey/main_0040107c.c", "start": {"col": 13, "line": 60, "offset": 1394}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 38, "line": 61, "offset": 1442}, "extra": {"engine_kind": "OSS", "fingerprint": "683183101c588fd1257799dcb15eac1296b1d113d6c7b0feca6eea26dcfc1d1aa49f69616bb09f5a6668403f45db730dc04725b754fb6a06629a024514d111e8_0", "is_ignored": false, "lines": "      pcVar6 = (char *)malloc(0x5554);", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "malloc", "end": {"col": 30, "line": 61, "offset": 1434}, "start": {"col": 24, "line": 61, "offset": 1428}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_hnap_tool_wifi_sitesurvey/main_0040107c.c", "start": {"col": 24, "line": 61, "offset": 1428}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-signed-unsigned-conversion", "end": {"col": 38, "line": 61, "offset": 1442}, "extra": {"engine_kind": "OSS", "fingerprint": "37c18e637b3b1f43cf18d5e3c4f2ea7ccb415ef3b8ae3deda1db695f2be5933e8e69c68eb2042a612f8ec15892f695bc1e7e6677ed229c74c2f1601fdd3ef41f_0", "is_ignored": false, "lines": "      pcVar6 = (char *)malloc(0x5554);", "message": "The software uses a signed primitive and performs a cast to an unsigned primitive, or uses an unsigned primitive and performs a cast to a signed primitive, which can produce an unexpected value. When the result of a function is to be used as a size parameter, using negative return values can have unexpected results. Although less frequent an issue, unsigned-to-signed conversion can be  the precursor to buffer underwrite conditions. Buffer underwrites  occur frequently when large unsigned values are cast to signed values,  and then used as indexes into a buffer or for pointer arithmetic.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "LOW", "references": ["https://cwe.mitre.org/data/definitions/195", "https://cwe.mitre.org/data/definitions/196", "https://cwe.mitre.org/data/definitions/194", "https://cwe.mitre.org/data/definitions/191", "https://cwe.mitre.org/data/definitions/681", "https://cwe.mitre.org/data/definitions/789", "https://g.co/kgs/PCHQjJ", "https://github.com/struct/mms", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "http://www.phrack.org/issues/60/10.html#article", "https://docs.microsoft.com/en-us/cpp/sanitizers/asan-error-examples"]}, "metavars": {"$LEN": {"abstract_content": "0x5554", "end": {"col": 37, "line": 61, "offset": 1441}, "start": {"col": 31, "line": 61, "offset": 1435}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_hnap_tool_wifi_sitesurvey/main_0040107c.c", "start": {"col": 24, "line": 61, "offset": 1428}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 60, "line": 70, "offset": 1753}, "extra": {"engine_kind": "OSS", "fingerprint": "45babd5e404e4c60ef34fb60236f68a7b8945cb112d52ed9a6e55ea72abad1ae9e01027dda46869bd9c8767f485925951013eebf816f7315f35b0c670c1f880c_0", "is_ignored": false, "lines": "          system(\"iwpriv wlan0 set_mib band2G5GSelected=2\");", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "system", "end": {"col": 17, "line": 70, "offset": 1710}, "start": {"col": 11, "line": 70, "offset": 1704}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_hnap_tool_wifi_sitesurvey/main_0040107c.c", "start": {"col": 11, "line": 70, "offset": 1704}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 60, "line": 73, "offset": 1839}, "extra": {"engine_kind": "OSS", "fingerprint": "45babd5e404e4c60ef34fb60236f68a7b8945cb112d52ed9a6e55ea72abad1ae9e01027dda46869bd9c8767f485925951013eebf816f7315f35b0c670c1f880c_1", "is_ignored": false, "lines": "          system(\"iwpriv wlan0 set_mib band2G5GSelected=1\");", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "system", "end": {"col": 17, "line": 73, "offset": 1796}, "start": {"col": 11, "line": 73, "offset": 1790}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_hnap_tool_wifi_sitesurvey/main_0040107c.c", "start": {"col": 11, "line": 73, "offset": 1790}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 58, "line": 76, "offset": 1944}, "extra": {"engine_kind": "OSS", "fingerprint": "45babd5e404e4c60ef34fb60236f68a7b8945cb112d52ed9a6e55ea72abad1ae9e01027dda46869bd9c8767f485925951013eebf816f7315f35b0c670c1f880c_2", "is_ignored": false, "lines": "        system(\"iwpriv wlan0 set_mib band2G5GSelected=3\");", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "system", "end": {"col": 15, "line": 76, "offset": 1901}, "start": {"col": 9, "line": 76, "offset": 1895}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_hnap_tool_wifi_sitesurvey/main_0040107c.c", "start": {"col": 9, "line": 76, "offset": 1895}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-incorrect-use-of-free", "end": {"col": 21, "line": 80, "offset": 2058}, "extra": {"engine_kind": "OSS", "fingerprint": "1b625868823dcf14c7893a782ba1a98decc74d2130b883b9c2dcadf570444821e05862bd9fd7c0a91d805226c5e7bd51800afa9d57f7a4c9a4c2411443d3ac67_0", "is_ignored": false, "lines": "        free(pcVar6);", "message": "The software calls free() on a pointer to memory that has a short  lifetime and was not allocated using associated heap allocation  functions such as malloc(), calloc(), or realloc().", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://cwe.mitre.org/data/definitions/590", "https://github.com/shellphish/how2heap/blob/master/glibc_2.23/house_of_spirit.c"]}, "metavars": {"$ARR": {"abstract_content": "local_a9", "end": {"col": 16, "line": 23, "offset": 430}, "start": {"col": 8, "line": 23, "offset": 422}}, "$LEN": {"abstract_content": "21", "end": {"col": 20, "line": 23, "offset": 434}, "start": {"col": 18, "line": 23, "offset": 432}}, "$PTR": {"abstract_content": "pcVar6", "end": {"col": 20, "line": 80, "offset": 2057}, "propagated_value": {"svalue_abstract_content": "(char*malloc(0x5554)", "svalue_end": {"col": 38, "line": 61, "offset": 1442}, "svalue_start": {"col": 16, "line": 61, "offset": 1420}}, "start": {"col": 14, "line": 80, "offset": 2051}}, "$TYPE": {"abstract_content": "char", "end": {"col": 7, "line": 23, "offset": 421}, "start": {"col": 3, "line": 23, "offset": 417}}}, "severity": "ERROR", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_hnap_tool_wifi_sitesurvey/main_0040107c.c", "start": {"col": 9, "line": 80, "offset": 2046}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 45, "line": 95, "offset": 2589}, "extra": {"engine_kind": "OSS", "fingerprint": "1a494d976512c59731c63e66929ad2f84df1121faf25e620eddd270daf6e50ede51117f8e5623f72687fe2ec0d57ccecaf105c69467dd72fba1c805c03e2dd89_0", "is_ignored": false, "lines": "        pcVar6 = fgets(&local_4d0,0x400,__s);", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$1": {"abstract_content": "s", "end": {"col": 5, "line": 2, "offset": 5}, "start": {"col": 4, "line": 2, "offset": 4}}, "$FUN": {"abstract_content": "fgets", "end": {"col": 23, "line": 95, "offset": 2567}, "start": {"col": 18, "line": 95, "offset": 2562}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_hnap_tool_wifi_sitesurvey/main_0040107c.c", "start": {"col": 18, "line": 95, "offset": 2562}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-signed-unsigned-conversion", "end": {"col": 36, "line": 97, "offset": 2663}, "extra": {"engine_kind": "OSS", "fingerprint": "da71bfb6e19b76ab679581392b3340ee9568cace4e02fdd71f0e048aecaa31b619c47c2801b2bd9927101802baf617c7358af2d9cb3f94f3d713bd549ed92c42_0", "is_ignored": false, "lines": "          memset(acStack_d0,0,0x6b);", "message": "The software uses a signed primitive and performs a cast to an unsigned primitive, or uses an unsigned primitive and performs a cast to a signed primitive, which can produce an unexpected value. When the result of a function is to be used as a size parameter, using negative return values can have unexpected results. Although less frequent an issue, unsigned-to-signed conversion can be  the precursor to buffer underwrite conditions. Buffer underwrites  occur frequently when large unsigned values are cast to signed values,  and then used as indexes into a buffer or for pointer arithmetic.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "LOW", "references": ["https://cwe.mitre.org/data/definitions/195", "https://cwe.mitre.org/data/definitions/196", "https://cwe.mitre.org/data/definitions/194", "https://cwe.mitre.org/data/definitions/191", "https://cwe.mitre.org/data/definitions/681", "https://cwe.mitre.org/data/definitions/789", "https://g.co/kgs/PCHQjJ", "https://github.com/struct/mms", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "http://www.phrack.org/issues/60/10.html#article", "https://docs.microsoft.com/en-us/cpp/sanitizers/asan-error-examples"]}, "metavars": {"$CHAR": {"abstract_content": "0", "end": {"col": 30, "line": 97, "offset": 2657}, "start": {"col": 29, "line": 97, "offset": 2656}}, "$DST": {"abstract_content": "acStack_d0", "end": {"col": 28, "line": 97, "offset": 2655}, "start": {"col": 18, "line": 97, "offset": 2645}}, "$LEN": {"abstract_content": "0x6b", "end": {"col": 35, "line": 97, "offset": 2662}, "start": {"col": 31, "line": 97, "offset": 2658}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_hnap_tool_wifi_sitesurvey/main_0040107c.c", "start": {"col": 11, "line": 97, "offset": 2638}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 43, "line": 98, "offset": 2707}, "extra": {"engine_kind": "OSS", "fingerprint": "d75b52dbd4aca39982b642b92250d3e7261e9128e349cb7dce23f461b2fed880d676691aa895e239a89ebd9d4faf9f2cc60de31d9a46ac6532df40fef2a564dc_0", "is_ignored": false, "lines": "          strncpy(acStack_d0,&local_4d0,4);", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "strncpy", "end": {"col": 18, "line": 98, "offset": 2682}, "start": {"col": 11, "line": 98, "offset": 2675}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_hnap_tool_wifi_sitesurvey/main_0040107c.c", "start": {"col": 11, "line": 98, "offset": 2675}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-signed-unsigned-conversion", "end": {"col": 43, "line": 98, "offset": 2707}, "extra": {"engine_kind": "OSS", "fingerprint": "0df07bb0568d09d6f48b2927471da3f4203d92b89b3d6a3d7792d57f19982ce6c5706fc1d4ec2cbc6774b458dce107e67c064fec98db2f8eb8000db80e8d05c1_0", "is_ignored": false, "lines": "          strncpy(acStack_d0,&local_4d0,4);", "message": "The software uses a signed primitive and performs a cast to an unsigned primitive, or uses an unsigned primitive and performs a cast to a signed primitive, which can produce an unexpected value. When the result of a function is to be used as a size parameter, using negative return values can have unexpected results. Although less frequent an issue, unsigned-to-signed conversion can be  the precursor to buffer underwrite conditions. Buffer underwrites  occur frequently when large unsigned values are cast to signed values,  and then used as indexes into a buffer or for pointer arithmetic.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "LOW", "references": ["https://cwe.mitre.org/data/definitions/195", "https://cwe.mitre.org/data/definitions/196", "https://cwe.mitre.org/data/definitions/194", "https://cwe.mitre.org/data/definitions/191", "https://cwe.mitre.org/data/definitions/681", "https://cwe.mitre.org/data/definitions/789", "https://g.co/kgs/PCHQjJ", "https://github.com/struct/mms", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "http://www.phrack.org/issues/60/10.html#article", "https://docs.microsoft.com/en-us/cpp/sanitizers/asan-error-examples"]}, "metavars": {"$DST": {"abstract_content": "acStack_d0", "end": {"col": 29, "line": 98, "offset": 2693}, "start": {"col": 19, "line": 98, "offset": 2683}}, "$LEN": {"abstract_content": "4", "end": {"col": 42, "line": 98, "offset": 2706}, "start": {"col": 41, "line": 98, "offset": 2705}}, "$SRC": {"abstract_content": "&local_4d0", "end": {"col": 40, "line": 98, "offset": 2704}, "start": {"col": 30, "line": 98, "offset": 2694}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_hnap_tool_wifi_sitesurvey/main_0040107c.c", "start": {"col": 11, "line": 98, "offset": 2675}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-unterminated-string-strncpy-stpncpy", "end": {"col": 43, "line": 98, "offset": 2707}, "extra": {"engine_kind": "OSS", "fingerprint": "1d66126483e8aa491f169359a3fdc439ee62418f682227035826f4d3d394b6ac1b359bdc6e1956631ac3ef928557530f044f803a321e092bcbb03791cbccc3f9_0", "is_ignored": false, "lines": "          strncpy(acStack_d0,&local_4d0,4);", "message": "If there is no NUL character byte in the first n bytes of the source string, strncpy() and stpncpy() do not NUL-terminate the destination buffer. If the program does not explicitly terminate the destination buffer, this will almost certainly result in information disclosure, and possibly a buffer overflow condition.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://cwe.mitre.org/data/definitions/170", "https://cwe.mitre.org/data/definitions/126", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf"]}, "metavars": {"$FUN": {"abstract_content": "strncpy", "end": {"col": 18, "line": 98, "offset": 2682}, "start": {"col": 11, "line": 98, "offset": 2675}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_hnap_tool_wifi_sitesurvey/main_0040107c.c", "start": {"col": 11, "line": 98, "offset": 2675}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-incorrect-use-of-strncpy-stpncpy-strlcpy", "end": {"col": 47, "line": 99, "offset": 2755}, "extra": {"engine_kind": "OSS", "fingerprint": "2fa636b3fc14d11cfc0c79b039f378bbb95de294c3f28280b399f90ba0e87e3ea5dae423c7f10dfd1129a72e088f0e6f11eef2c15f66263cf71a9fc129b7e734_0", "is_ignored": false, "lines": "          strncpy(acStack_cb,acStack_4cc,0x21);", "message": "The software uses the size of a source buffer when reading from or writing to a destination buffer, which may cause it to access memory that is outside of the bounds of the buffer.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://cwe.mitre.org/data/definitions/806", "https://github.com/0xdea/advisories/blob/master/2020-07-solaris-whodo-w.txt", "https://dustri.org/b/playing-with-weggli.html"]}, "metavars": {"$DST": {"abstract_content": "acStack_cb", "end": {"col": 29, "line": 99, "offset": 2737}, "start": {"col": 19, "line": 99, "offset": 2727}}, "$FUN": {"abstract_content": "strncpy", "end": {"col": 18, "line": 99, "offset": 2726}, "start": {"col": 11, "line": 99, "offset": 2719}}, "$LEN": {"abstract_content": "0x21", "end": {"col": 46, "line": 99, "offset": 2754}, "start": {"col": 42, "line": 99, "offset": 2750}}, "$SRC": {"abstract_content": "acStack_4cc", "end": {"col": 41, "line": 99, "offset": 2749}, "start": {"col": 30, "line": 99, "offset": 2738}}, "$TYPE": {"abstract_content": "char", "end": {"col": 7, "line": 15, "offset": 224}, "start": {"col": 3, "line": 15, "offset": 220}}}, "severity": "ERROR", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_hnap_tool_wifi_sitesurvey/main_0040107c.c", "start": {"col": 11, "line": 99, "offset": 2719}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 47, "line": 99, "offset": 2755}, "extra": {"engine_kind": "OSS", "fingerprint": "d75b52dbd4aca39982b642b92250d3e7261e9128e349cb7dce23f461b2fed880d676691aa895e239a89ebd9d4faf9f2cc60de31d9a46ac6532df40fef2a564dc_1", "is_ignored": false, "lines": "          strncpy(acStack_cb,acStack_4cc,0x21);", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "strncpy", "end": {"col": 18, "line": 99, "offset": 2726}, "start": {"col": 11, "line": 99, "offset": 2719}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_hnap_tool_wifi_sitesurvey/main_0040107c.c", "start": {"col": 11, "line": 99, "offset": 2719}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-signed-unsigned-conversion", "end": {"col": 47, "line": 99, "offset": 2755}, "extra": {"engine_kind": "OSS", "fingerprint": "7dc268884af71e7322459f55bc93b30894089e9a752b7bfa9b90d014e52b0ccd01d85a076e6326bc749b45461f05027d0447486832e0b648f066289a5c4ec093_0", "is_ignored": false, "lines": "          strncpy(acStack_cb,acStack_4cc,0x21);", "message": "The software uses a signed primitive and performs a cast to an unsigned primitive, or uses an unsigned primitive and performs a cast to a signed primitive, which can produce an unexpected value. When the result of a function is to be used as a size parameter, using negative return values can have unexpected results. Although less frequent an issue, unsigned-to-signed conversion can be  the precursor to buffer underwrite conditions. Buffer underwrites  occur frequently when large unsigned values are cast to signed values,  and then used as indexes into a buffer or for pointer arithmetic.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "LOW", "references": ["https://cwe.mitre.org/data/definitions/195", "https://cwe.mitre.org/data/definitions/196", "https://cwe.mitre.org/data/definitions/194", "https://cwe.mitre.org/data/definitions/191", "https://cwe.mitre.org/data/definitions/681", "https://cwe.mitre.org/data/definitions/789", "https://g.co/kgs/PCHQjJ", "https://github.com/struct/mms", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "http://www.phrack.org/issues/60/10.html#article", "https://docs.microsoft.com/en-us/cpp/sanitizers/asan-error-examples"]}, "metavars": {"$DST": {"abstract_content": "acStack_cb", "end": {"col": 29, "line": 99, "offset": 2737}, "start": {"col": 19, "line": 99, "offset": 2727}}, "$LEN": {"abstract_content": "0x21", "end": {"col": 46, "line": 99, "offset": 2754}, "start": {"col": 42, "line": 99, "offset": 2750}}, "$SRC": {"abstract_content": "acStack_4cc", "end": {"col": 41, "line": 99, "offset": 2749}, "start": {"col": 30, "line": 99, "offset": 2738}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_hnap_tool_wifi_sitesurvey/main_0040107c.c", "start": {"col": 11, "line": 99, "offset": 2719}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-unterminated-string-strncpy-stpncpy", "end": {"col": 47, "line": 99, "offset": 2755}, "extra": {"engine_kind": "OSS", "fingerprint": "1d66126483e8aa491f169359a3fdc439ee62418f682227035826f4d3d394b6ac1b359bdc6e1956631ac3ef928557530f044f803a321e092bcbb03791cbccc3f9_1", "is_ignored": false, "lines": "          strncpy(acStack_cb,acStack_4cc,0x21);", "message": "If there is no NUL character byte in the first n bytes of the source string, strncpy() and stpncpy() do not NUL-terminate the destination buffer. If the program does not explicitly terminate the destination buffer, this will almost certainly result in information disclosure, and possibly a buffer overflow condition.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://cwe.mitre.org/data/definitions/170", "https://cwe.mitre.org/data/definitions/126", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf"]}, "metavars": {"$FUN": {"abstract_content": "strncpy", "end": {"col": 18, "line": 99, "offset": 2726}, "start": {"col": 11, "line": 99, "offset": 2719}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_hnap_tool_wifi_sitesurvey/main_0040107c.c", "start": {"col": 11, "line": 99, "offset": 2719}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-incorrect-use-of-strncpy-stpncpy-strlcpy", "end": {"col": 45, "line": 100, "offset": 2801}, "extra": {"engine_kind": "OSS", "fingerprint": "f684d86beaab6245fc0040a696345709054749f1be76b706d13da0eed6b0c9599e33ee4426701115b65d93c9f59f272df4f4dd3103a7301692df0050f9d731f0_0", "is_ignored": false, "lines": "          strncpy(local_a9,acStack_4ab,0x14);", "message": "The software uses the size of a source buffer when reading from or writing to a destination buffer, which may cause it to access memory that is outside of the bounds of the buffer.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://cwe.mitre.org/data/definitions/806", "https://github.com/0xdea/advisories/blob/master/2020-07-solaris-whodo-w.txt", "https://dustri.org/b/playing-with-weggli.html"]}, "metavars": {"$DST": {"abstract_content": "local_a9", "end": {"col": 27, "line": 100, "offset": 2783}, "start": {"col": 19, "line": 100, "offset": 2775}}, "$FUN": {"abstract_content": "strncpy", "end": {"col": 18, "line": 100, "offset": 2774}, "start": {"col": 11, "line": 100, "offset": 2767}}, "$LEN": {"abstract_content": "0x14", "end": {"col": 44, "line": 100, "offset": 2800}, "start": {"col": 40, "line": 100, "offset": 2796}}, "$SRC": {"abstract_content": "acStack_4ab", "end": {"col": 39, "line": 100, "offset": 2795}, "start": {"col": 28, "line": 100, "offset": 2784}}, "$TYPE": {"abstract_content": "char", "end": {"col": 7, "line": 16, "offset": 249}, "start": {"col": 3, "line": 16, "offset": 245}}}, "severity": "ERROR", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_hnap_tool_wifi_sitesurvey/main_0040107c.c", "start": {"col": 11, "line": 100, "offset": 2767}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 45, "line": 100, "offset": 2801}, "extra": {"engine_kind": "OSS", "fingerprint": "d75b52dbd4aca39982b642b92250d3e7261e9128e349cb7dce23f461b2fed880d676691aa895e239a89ebd9d4faf9f2cc60de31d9a46ac6532df40fef2a564dc_2", "is_ignored": false, "lines": "          strncpy(local_a9,acStack_4ab,0x14);", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "strncpy", "end": {"col": 18, "line": 100, "offset": 2774}, "start": {"col": 11, "line": 100, "offset": 2767}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_hnap_tool_wifi_sitesurvey/main_0040107c.c", "start": {"col": 11, "line": 100, "offset": 2767}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-signed-unsigned-conversion", "end": {"col": 45, "line": 100, "offset": 2801}, "extra": {"engine_kind": "OSS", "fingerprint": "b247953ffd833048792280cdd438ccdbc4be8ed9bfdd5f9cf2477c72500826c9cae46988821088dab17415dadb379cd1cebc8534907b07a478e7e00e9f35053a_0", "is_ignored": false, "lines": "          strncpy(local_a9,acStack_4ab,0x14);", "message": "The software uses a signed primitive and performs a cast to an unsigned primitive, or uses an unsigned primitive and performs a cast to a signed primitive, which can produce an unexpected value. When the result of a function is to be used as a size parameter, using negative return values can have unexpected results. Although less frequent an issue, unsigned-to-signed conversion can be  the precursor to buffer underwrite conditions. Buffer underwrites  occur frequently when large unsigned values are cast to signed values,  and then used as indexes into a buffer or for pointer arithmetic.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "LOW", "references": ["https://cwe.mitre.org/data/definitions/195", "https://cwe.mitre.org/data/definitions/196", "https://cwe.mitre.org/data/definitions/194", "https://cwe.mitre.org/data/definitions/191", "https://cwe.mitre.org/data/definitions/681", "https://cwe.mitre.org/data/definitions/789", "https://g.co/kgs/PCHQjJ", "https://github.com/struct/mms", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "http://www.phrack.org/issues/60/10.html#article", "https://docs.microsoft.com/en-us/cpp/sanitizers/asan-error-examples"]}, "metavars": {"$DST": {"abstract_content": "local_a9", "end": {"col": 27, "line": 100, "offset": 2783}, "start": {"col": 19, "line": 100, "offset": 2775}}, "$LEN": {"abstract_content": "0x14", "end": {"col": 44, "line": 100, "offset": 2800}, "start": {"col": 40, "line": 100, "offset": 2796}}, "$SRC": {"abstract_content": "acStack_4ab", "end": {"col": 39, "line": 100, "offset": 2795}, "start": {"col": 28, "line": 100, "offset": 2784}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_hnap_tool_wifi_sitesurvey/main_0040107c.c", "start": {"col": 11, "line": 100, "offset": 2767}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-unterminated-string-strncpy-stpncpy", "end": {"col": 45, "line": 100, "offset": 2801}, "extra": {"engine_kind": "OSS", "fingerprint": "1d66126483e8aa491f169359a3fdc439ee62418f682227035826f4d3d394b6ac1b359bdc6e1956631ac3ef928557530f044f803a321e092bcbb03791cbccc3f9_2", "is_ignored": false, "lines": "          strncpy(local_a9,acStack_4ab,0x14);", "message": "If there is no NUL character byte in the first n bytes of the source string, strncpy() and stpncpy() do not NUL-terminate the destination buffer. If the program does not explicitly terminate the destination buffer, this will almost certainly result in information disclosure, and possibly a buffer overflow condition.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://cwe.mitre.org/data/definitions/170", "https://cwe.mitre.org/data/definitions/126", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf"]}, "metavars": {"$FUN": {"abstract_content": "strncpy", "end": {"col": 18, "line": 100, "offset": 2774}, "start": {"col": 11, "line": 100, "offset": 2767}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_hnap_tool_wifi_sitesurvey/main_0040107c.c", "start": {"col": 11, "line": 100, "offset": 2767}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-incorrect-use-of-strncpy-stpncpy-strlcpy", "end": {"col": 47, "line": 101, "offset": 2849}, "extra": {"engine_kind": "OSS", "fingerprint": "ccdc4d74c85c696b278604c2cfbcfd9fb342db5794599bb7e179191a86038ef163ef3a485a6c16510606e24d3886fa53645a7fb91001acd2c8941edf4632b583_0", "is_ignored": false, "lines": "          strncpy(acStack_94,acStack_497,0x17);", "message": "The software uses the size of a source buffer when reading from or writing to a destination buffer, which may cause it to access memory that is outside of the bounds of the buffer.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://cwe.mitre.org/data/definitions/806", "https://github.com/0xdea/advisories/blob/master/2020-07-solaris-whodo-w.txt", "https://dustri.org/b/playing-with-weggli.html"]}, "metavars": {"$DST": {"abstract_content": "acStack_94", "end": {"col": 29, "line": 101, "offset": 2831}, "start": {"col": 19, "line": 101, "offset": 2821}}, "$FUN": {"abstract_content": "strncpy", "end": {"col": 18, "line": 101, "offset": 2820}, "start": {"col": 11, "line": 101, "offset": 2813}}, "$LEN": {"abstract_content": "0x17", "end": {"col": 46, "line": 101, "offset": 2848}, "start": {"col": 42, "line": 101, "offset": 2844}}, "$SRC": {"abstract_content": "acStack_497", "end": {"col": 41, "line": 101, "offset": 2843}, "start": {"col": 30, "line": 101, "offset": 2832}}, "$TYPE": {"abstract_content": "char", "end": {"col": 7, "line": 17, "offset": 274}, "start": {"col": 3, "line": 17, "offset": 270}}}, "severity": "ERROR", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_hnap_tool_wifi_sitesurvey/main_0040107c.c", "start": {"col": 11, "line": 101, "offset": 2813}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 47, "line": 101, "offset": 2849}, "extra": {"engine_kind": "OSS", "fingerprint": "d75b52dbd4aca39982b642b92250d3e7261e9128e349cb7dce23f461b2fed880d676691aa895e239a89ebd9d4faf9f2cc60de31d9a46ac6532df40fef2a564dc_3", "is_ignored": false, "lines": "          strncpy(acStack_94,acStack_497,0x17);", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "strncpy", "end": {"col": 18, "line": 101, "offset": 2820}, "start": {"col": 11, "line": 101, "offset": 2813}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_hnap_tool_wifi_sitesurvey/main_0040107c.c", "start": {"col": 11, "line": 101, "offset": 2813}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-signed-unsigned-conversion", "end": {"col": 47, "line": 101, "offset": 2849}, "extra": {"engine_kind": "OSS", "fingerprint": "8c7798383bebf4abf5c3b2fb721cf5f490a654e08a77be8fdb0c243b84cc1dbc33e16799d418bf2c05fddd12ca353279bcd973f86de39cd8a35d9896c7597c05_0", "is_ignored": false, "lines": "          strncpy(acStack_94,acStack_497,0x17);", "message": "The software uses a signed primitive and performs a cast to an unsigned primitive, or uses an unsigned primitive and performs a cast to a signed primitive, which can produce an unexpected value. When the result of a function is to be used as a size parameter, using negative return values can have unexpected results. Although less frequent an issue, unsigned-to-signed conversion can be  the precursor to buffer underwrite conditions. Buffer underwrites  occur frequently when large unsigned values are cast to signed values,  and then used as indexes into a buffer or for pointer arithmetic.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "LOW", "references": ["https://cwe.mitre.org/data/definitions/195", "https://cwe.mitre.org/data/definitions/196", "https://cwe.mitre.org/data/definitions/194", "https://cwe.mitre.org/data/definitions/191", "https://cwe.mitre.org/data/definitions/681", "https://cwe.mitre.org/data/definitions/789", "https://g.co/kgs/PCHQjJ", "https://github.com/struct/mms", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "http://www.phrack.org/issues/60/10.html#article", "https://docs.microsoft.com/en-us/cpp/sanitizers/asan-error-examples"]}, "metavars": {"$DST": {"abstract_content": "acStack_94", "end": {"col": 29, "line": 101, "offset": 2831}, "start": {"col": 19, "line": 101, "offset": 2821}}, "$LEN": {"abstract_content": "0x17", "end": {"col": 46, "line": 101, "offset": 2848}, "start": {"col": 42, "line": 101, "offset": 2844}}, "$SRC": {"abstract_content": "acStack_497", "end": {"col": 41, "line": 101, "offset": 2843}, "start": {"col": 30, "line": 101, "offset": 2832}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_hnap_tool_wifi_sitesurvey/main_0040107c.c", "start": {"col": 11, "line": 101, "offset": 2813}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-unterminated-string-strncpy-stpncpy", "end": {"col": 47, "line": 101, "offset": 2849}, "extra": {"engine_kind": "OSS", "fingerprint": "1d66126483e8aa491f169359a3fdc439ee62418f682227035826f4d3d394b6ac1b359bdc6e1956631ac3ef928557530f044f803a321e092bcbb03791cbccc3f9_3", "is_ignored": false, "lines": "          strncpy(acStack_94,acStack_497,0x17);", "message": "If there is no NUL character byte in the first n bytes of the source string, strncpy() and stpncpy() do not NUL-terminate the destination buffer. If the program does not explicitly terminate the destination buffer, this will almost certainly result in information disclosure, and possibly a buffer overflow condition.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://cwe.mitre.org/data/definitions/170", "https://cwe.mitre.org/data/definitions/126", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf"]}, "metavars": {"$FUN": {"abstract_content": "strncpy", "end": {"col": 18, "line": 101, "offset": 2820}, "start": {"col": 11, "line": 101, "offset": 2813}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_hnap_tool_wifi_sitesurvey/main_0040107c.c", "start": {"col": 11, "line": 101, "offset": 2813}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-incorrect-use-of-strncpy-stpncpy-strlcpy", "end": {"col": 45, "line": 102, "offset": 2895}, "extra": {"engine_kind": "OSS", "fingerprint": "fb51e8481d5b2b4450e72de55feace04b3dad4ec8c515ec10caff1ae6cab4e9acfd32ace1b46973a44183de59c42a646cf7669edc55b38ad0fc3fd8e4504770c_0", "is_ignored": false, "lines": "          strncpy(acStack_7c,acStack_480,10);", "message": "The software uses the size of a source buffer when reading from or writing to a destination buffer, which may cause it to access memory that is outside of the bounds of the buffer.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://cwe.mitre.org/data/definitions/806", "https://github.com/0xdea/advisories/blob/master/2020-07-solaris-whodo-w.txt", "https://dustri.org/b/playing-with-weggli.html"]}, "metavars": {"$DST": {"abstract_content": "acStack_7c", "end": {"col": 29, "line": 102, "offset": 2879}, "start": {"col": 19, "line": 102, "offset": 2869}}, "$FUN": {"abstract_content": "strncpy", "end": {"col": 18, "line": 102, "offset": 2868}, "start": {"col": 11, "line": 102, "offset": 2861}}, "$LEN": {"abstract_content": "10", "end": {"col": 44, "line": 102, "offset": 2894}, "start": {"col": 42, "line": 102, "offset": 2892}}, "$SRC": {"abstract_content": "acStack_480", "end": {"col": 41, "line": 102, "offset": 2891}, "start": {"col": 30, "line": 102, "offset": 2880}}, "$TYPE": {"abstract_content": "char", "end": {"col": 7, "line": 18, "offset": 299}, "start": {"col": 3, "line": 18, "offset": 295}}}, "severity": "ERROR", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_hnap_tool_wifi_sitesurvey/main_0040107c.c", "start": {"col": 11, "line": 102, "offset": 2861}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 45, "line": 102, "offset": 2895}, "extra": {"engine_kind": "OSS", "fingerprint": "d75b52dbd4aca39982b642b92250d3e7261e9128e349cb7dce23f461b2fed880d676691aa895e239a89ebd9d4faf9f2cc60de31d9a46ac6532df40fef2a564dc_4", "is_ignored": false, "lines": "          strncpy(acStack_7c,acStack_480,10);", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "strncpy", "end": {"col": 18, "line": 102, "offset": 2868}, "start": {"col": 11, "line": 102, "offset": 2861}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_hnap_tool_wifi_sitesurvey/main_0040107c.c", "start": {"col": 11, "line": 102, "offset": 2861}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-signed-unsigned-conversion", "end": {"col": 45, "line": 102, "offset": 2895}, "extra": {"engine_kind": "OSS", "fingerprint": "49b7975388b8d8f9fe881003cfd2bbc7c7b6d64aea7f681c7fa246a2d6895e09f1636881114d73af808c1d674eb912dd20b64961b282b86b224c88e75df293c9_0", "is_ignored": false, "lines": "          strncpy(acStack_7c,acStack_480,10);", "message": "The software uses a signed primitive and performs a cast to an unsigned primitive, or uses an unsigned primitive and performs a cast to a signed primitive, which can produce an unexpected value. When the result of a function is to be used as a size parameter, using negative return values can have unexpected results. Although less frequent an issue, unsigned-to-signed conversion can be  the precursor to buffer underwrite conditions. Buffer underwrites  occur frequently when large unsigned values are cast to signed values,  and then used as indexes into a buffer or for pointer arithmetic.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "LOW", "references": ["https://cwe.mitre.org/data/definitions/195", "https://cwe.mitre.org/data/definitions/196", "https://cwe.mitre.org/data/definitions/194", "https://cwe.mitre.org/data/definitions/191", "https://cwe.mitre.org/data/definitions/681", "https://cwe.mitre.org/data/definitions/789", "https://g.co/kgs/PCHQjJ", "https://github.com/struct/mms", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "http://www.phrack.org/issues/60/10.html#article", "https://docs.microsoft.com/en-us/cpp/sanitizers/asan-error-examples"]}, "metavars": {"$DST": {"abstract_content": "acStack_7c", "end": {"col": 29, "line": 102, "offset": 2879}, "start": {"col": 19, "line": 102, "offset": 2869}}, "$LEN": {"abstract_content": "10", "end": {"col": 44, "line": 102, "offset": 2894}, "start": {"col": 42, "line": 102, "offset": 2892}}, "$SRC": {"abstract_content": "acStack_480", "end": {"col": 41, "line": 102, "offset": 2891}, "start": {"col": 30, "line": 102, "offset": 2880}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_hnap_tool_wifi_sitesurvey/main_0040107c.c", "start": {"col": 11, "line": 102, "offset": 2861}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-unterminated-string-strncpy-stpncpy", "end": {"col": 45, "line": 102, "offset": 2895}, "extra": {"engine_kind": "OSS", "fingerprint": "1d66126483e8aa491f169359a3fdc439ee62418f682227035826f4d3d394b6ac1b359bdc6e1956631ac3ef928557530f044f803a321e092bcbb03791cbccc3f9_4", "is_ignored": false, "lines": "          strncpy(acStack_7c,acStack_480,10);", "message": "If there is no NUL character byte in the first n bytes of the source string, strncpy() and stpncpy() do not NUL-terminate the destination buffer. If the program does not explicitly terminate the destination buffer, this will almost certainly result in information disclosure, and possibly a buffer overflow condition.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://cwe.mitre.org/data/definitions/170", "https://cwe.mitre.org/data/definitions/126", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf"]}, "metavars": {"$FUN": {"abstract_content": "strncpy", "end": {"col": 18, "line": 102, "offset": 2868}, "start": {"col": 11, "line": 102, "offset": 2861}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_hnap_tool_wifi_sitesurvey/main_0040107c.c", "start": {"col": 11, "line": 102, "offset": 2861}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-incorrect-use-of-strncpy-stpncpy-strlcpy", "end": {"col": 44, "line": 103, "offset": 2940}, "extra": {"engine_kind": "OSS", "fingerprint": "73d15d7631d6bc2c4d10c61aa407bc10b1911290fce3add2841866eab3dfb15de0d0f5b65b00137bff81cf240645834f76a2005b9ca045e76ba883a4757fdb8b_0", "is_ignored": false, "lines": "          strncpy(acStack_71,acStack_476,8);", "message": "The software uses the size of a source buffer when reading from or writing to a destination buffer, which may cause it to access memory that is outside of the bounds of the buffer.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://cwe.mitre.org/data/definitions/806", "https://github.com/0xdea/advisories/blob/master/2020-07-solaris-whodo-w.txt", "https://dustri.org/b/playing-with-weggli.html"]}, "metavars": {"$DST": {"abstract_content": "acStack_71", "end": {"col": 29, "line": 103, "offset": 2925}, "start": {"col": 19, "line": 103, "offset": 2915}}, "$FUN": {"abstract_content": "strncpy", "end": {"col": 18, "line": 103, "offset": 2914}, "start": {"col": 11, "line": 103, "offset": 2907}}, "$LEN": {"abstract_content": "8", "end": {"col": 43, "line": 103, "offset": 2939}, "start": {"col": 42, "line": 103, "offset": 2938}}, "$SRC": {"abstract_content": "acStack_476", "end": {"col": 41, "line": 103, "offset": 2937}, "start": {"col": 30, "line": 103, "offset": 2926}}, "$TYPE": {"abstract_content": "char", "end": {"col": 7, "line": 19, "offset": 324}, "start": {"col": 3, "line": 19, "offset": 320}}}, "severity": "ERROR", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_hnap_tool_wifi_sitesurvey/main_0040107c.c", "start": {"col": 11, "line": 103, "offset": 2907}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 44, "line": 103, "offset": 2940}, "extra": {"engine_kind": "OSS", "fingerprint": "d75b52dbd4aca39982b642b92250d3e7261e9128e349cb7dce23f461b2fed880d676691aa895e239a89ebd9d4faf9f2cc60de31d9a46ac6532df40fef2a564dc_5", "is_ignored": false, "lines": "          strncpy(acStack_71,acStack_476,8);", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "strncpy", "end": {"col": 18, "line": 103, "offset": 2914}, "start": {"col": 11, "line": 103, "offset": 2907}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_hnap_tool_wifi_sitesurvey/main_0040107c.c", "start": {"col": 11, "line": 103, "offset": 2907}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-signed-unsigned-conversion", "end": {"col": 44, "line": 103, "offset": 2940}, "extra": {"engine_kind": "OSS", "fingerprint": "078729d761b0f12532a56231aa76ba81ee8f2a747eb0799edac8281fe1550a2c10eb44ac95ae7a261def8a570ded66ce3537cca11186f9b00ca8ca97721d3f7b_0", "is_ignored": false, "lines": "          strncpy(acStack_71,acStack_476,8);", "message": "The software uses a signed primitive and performs a cast to an unsigned primitive, or uses an unsigned primitive and performs a cast to a signed primitive, which can produce an unexpected value. When the result of a function is to be used as a size parameter, using negative return values can have unexpected results. Although less frequent an issue, unsigned-to-signed conversion can be  the precursor to buffer underwrite conditions. Buffer underwrites  occur frequently when large unsigned values are cast to signed values,  and then used as indexes into a buffer or for pointer arithmetic.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "LOW", "references": ["https://cwe.mitre.org/data/definitions/195", "https://cwe.mitre.org/data/definitions/196", "https://cwe.mitre.org/data/definitions/194", "https://cwe.mitre.org/data/definitions/191", "https://cwe.mitre.org/data/definitions/681", "https://cwe.mitre.org/data/definitions/789", "https://g.co/kgs/PCHQjJ", "https://github.com/struct/mms", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "http://www.phrack.org/issues/60/10.html#article", "https://docs.microsoft.com/en-us/cpp/sanitizers/asan-error-examples"]}, "metavars": {"$DST": {"abstract_content": "acStack_71", "end": {"col": 29, "line": 103, "offset": 2925}, "start": {"col": 19, "line": 103, "offset": 2915}}, "$LEN": {"abstract_content": "8", "end": {"col": 43, "line": 103, "offset": 2939}, "start": {"col": 42, "line": 103, "offset": 2938}}, "$SRC": {"abstract_content": "acStack_476", "end": {"col": 41, "line": 103, "offset": 2937}, "start": {"col": 30, "line": 103, "offset": 2926}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_hnap_tool_wifi_sitesurvey/main_0040107c.c", "start": {"col": 11, "line": 103, "offset": 2907}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-unterminated-string-strncpy-stpncpy", "end": {"col": 44, "line": 103, "offset": 2940}, "extra": {"engine_kind": "OSS", "fingerprint": "1d66126483e8aa491f169359a3fdc439ee62418f682227035826f4d3d394b6ac1b359bdc6e1956631ac3ef928557530f044f803a321e092bcbb03791cbccc3f9_5", "is_ignored": false, "lines": "          strncpy(acStack_71,acStack_476,8);", "message": "If there is no NUL character byte in the first n bytes of the source string, strncpy() and stpncpy() do not NUL-terminate the destination buffer. If the program does not explicitly terminate the destination buffer, this will almost certainly result in information disclosure, and possibly a buffer overflow condition.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://cwe.mitre.org/data/definitions/170", "https://cwe.mitre.org/data/definitions/126", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf"]}, "metavars": {"$FUN": {"abstract_content": "strncpy", "end": {"col": 18, "line": 103, "offset": 2914}, "start": {"col": 11, "line": 103, "offset": 2907}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_hnap_tool_wifi_sitesurvey/main_0040107c.c", "start": {"col": 11, "line": 103, "offset": 2907}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 44, "line": 104, "offset": 2985}, "extra": {"engine_kind": "OSS", "fingerprint": "d75b52dbd4aca39982b642b92250d3e7261e9128e349cb7dce23f461b2fed880d676691aa895e239a89ebd9d4faf9f2cc60de31d9a46ac6532df40fef2a564dc_6", "is_ignored": false, "lines": "          strncpy(acStack_68,acStack_46e,2);", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "strncpy", "end": {"col": 18, "line": 104, "offset": 2959}, "start": {"col": 11, "line": 104, "offset": 2952}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_hnap_tool_wifi_sitesurvey/main_0040107c.c", "start": {"col": 11, "line": 104, "offset": 2952}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-signed-unsigned-conversion", "end": {"col": 44, "line": 104, "offset": 2985}, "extra": {"engine_kind": "OSS", "fingerprint": "aeb861b27b4f763f4a17272d63eafbfce2ed1b8b1c44f4de324799c123d670b782931b39618563a81585b7870f0ac25ff66220b6877f83497400dc0a63fc38d1_0", "is_ignored": false, "lines": "          strncpy(acStack_68,acStack_46e,2);", "message": "The software uses a signed primitive and performs a cast to an unsigned primitive, or uses an unsigned primitive and performs a cast to a signed primitive, which can produce an unexpected value. When the result of a function is to be used as a size parameter, using negative return values can have unexpected results. Although less frequent an issue, unsigned-to-signed conversion can be  the precursor to buffer underwrite conditions. Buffer underwrites  occur frequently when large unsigned values are cast to signed values,  and then used as indexes into a buffer or for pointer arithmetic.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "LOW", "references": ["https://cwe.mitre.org/data/definitions/195", "https://cwe.mitre.org/data/definitions/196", "https://cwe.mitre.org/data/definitions/194", "https://cwe.mitre.org/data/definitions/191", "https://cwe.mitre.org/data/definitions/681", "https://cwe.mitre.org/data/definitions/789", "https://g.co/kgs/PCHQjJ", "https://github.com/struct/mms", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "http://www.phrack.org/issues/60/10.html#article", "https://docs.microsoft.com/en-us/cpp/sanitizers/asan-error-examples"]}, "metavars": {"$DST": {"abstract_content": "acStack_68", "end": {"col": 29, "line": 104, "offset": 2970}, "start": {"col": 19, "line": 104, "offset": 2960}}, "$LEN": {"abstract_content": "2", "end": {"col": 43, "line": 104, "offset": 2984}, "start": {"col": 42, "line": 104, "offset": 2983}}, "$SRC": {"abstract_content": "acStack_46e", "end": {"col": 41, "line": 104, "offset": 2982}, "start": {"col": 30, "line": 104, "offset": 2971}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_hnap_tool_wifi_sitesurvey/main_0040107c.c", "start": {"col": 11, "line": 104, "offset": 2952}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-unterminated-string-strncpy-stpncpy", "end": {"col": 44, "line": 104, "offset": 2985}, "extra": {"engine_kind": "OSS", "fingerprint": "1d66126483e8aa491f169359a3fdc439ee62418f682227035826f4d3d394b6ac1b359bdc6e1956631ac3ef928557530f044f803a321e092bcbb03791cbccc3f9_6", "is_ignored": false, "lines": "          strncpy(acStack_68,acStack_46e,2);", "message": "If there is no NUL character byte in the first n bytes of the source string, strncpy() and stpncpy() do not NUL-terminate the destination buffer. If the program does not explicitly terminate the destination buffer, this will almost certainly result in information disclosure, and possibly a buffer overflow condition.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://cwe.mitre.org/data/definitions/170", "https://cwe.mitre.org/data/definitions/126", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf"]}, "metavars": {"$FUN": {"abstract_content": "strncpy", "end": {"col": 18, "line": 104, "offset": 2959}, "start": {"col": 11, "line": 104, "offset": 2952}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_hnap_tool_wifi_sitesurvey/main_0040107c.c", "start": {"col": 11, "line": 104, "offset": 2952}}], "skipped_rules": [], "version": "1.89.0"}
