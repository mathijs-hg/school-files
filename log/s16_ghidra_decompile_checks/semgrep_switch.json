{"errors": [], "interfile_languages_used": [], "paths": {"scanned": ["/tmp/haruspex_switch/__do_global_ctors_aux_004101c0.c", "/tmp/haruspex_switch/__do_global_dtors_aux_00400830.c", "/tmp/haruspex_switch/__start_004007d0.c", "/tmp/haruspex_switch/_fini_00410380.c", "/tmp/haruspex_switch/_init_00400750.c", "/tmp/haruspex_switch/acl_dip_add_004052a4.c", "/tmp/haruspex_switch/acl_dip_meter_004022e0.c", "/tmp/haruspex_switch/acl_dip_modify_00403fec.c", "/tmp/haruspex_switch/acl_dip_pppoe_00404940.c", "/tmp/haruspex_switch/acl_dip_trtcm_00402c4c.c", "/tmp/haruspex_switch/acl_ethertype_00403874.c", "/tmp/haruspex_switch/acl_l4_add_00405bec.c", "/tmp/haruspex_switch/acl_sp_add_0040631c.c", "/tmp/haruspex_switch/dip_add_0040701c.c", "/tmp/haruspex_switch/dip_clear_004075b4.c", "/tmp/haruspex_switch/dip_del_004073e8.c", "/tmp/haruspex_switch/dip_dump_00406a4c.c", "/tmp/haruspex_switch/dump_gphy_0040c8d0.c", "/tmp/haruspex_switch/egress_rate_set_00401e14.c", "/tmp/haruspex_switch/frame_dummy_004008fc.c", "/tmp/haruspex_switch/getnext_00401f5c.c", "/tmp/haruspex_switch/igmp_disable_0040c170.c", "/tmp/haruspex_switch/igmp_enable_0040c2b8.c", "/tmp/haruspex_switch/igmp_off_0040c0d8.c", "/tmp/haruspex_switch/igmp_on_0040b8a8.c", "/tmp/haruspex_switch/ingress_rate_set_00401ccc.c", "/tmp/haruspex_switch/ip_to_str_004021f8.c", "/tmp/haruspex_switch/main_0040ceac.c", "/tmp/haruspex_switch/mii_mgr_cl45_read_0040c400.c", "/tmp/haruspex_switch/mii_mgr_cl45_write_0040c660.c", "/tmp/haruspex_switch/mii_read_004018ec.c", "/tmp/haruspex_switch/mii_write_00401a5c.c", "/tmp/haruspex_switch/phy_crossover_0040cbc8.c", "/tmp/haruspex_switch/phy_dump_00401ba4.c", "/tmp/haruspex_switch/reg_read_004013dc.c", "/tmp/haruspex_switch/reg_read_tr_00401528.c", "/tmp/haruspex_switch/reg_write_00401670.c", "/tmp/haruspex_switch/reg_write_tr_004017b0.c", "/tmp/haruspex_switch/set_mirror_from_0040aba0.c", "/tmp/haruspex_switch/set_mirror_to_0040aa70.c", "/tmp/haruspex_switch/sip_add_00407bd4.c", "/tmp/haruspex_switch/sip_clear_004081fc.c", "/tmp/haruspex_switch/sip_del_0040800c.c", "/tmp/haruspex_switch/sip_dump_0040765c.c", "/tmp/haruspex_switch/str_to_ip_0040208c.c", "/tmp/haruspex_switch/switch_fini_00400a38.c", "/tmp/haruspex_switch/switch_init_00400980.c", "/tmp/haruspex_switch/table_add_004089a0.c", "/tmp/haruspex_switch/table_clear_0040a9c8.c", "/tmp/haruspex_switch/table_del_fid_0040a24c.c", "/tmp/haruspex_switch/table_del_vid_0040a610.c", "/tmp/haruspex_switch/table_dump_004082a4.c", "/tmp/haruspex_switch/table_search_mac_fid_00409a14.c", "/tmp/haruspex_switch/table_search_mac_vid_004091e8.c", "/tmp/haruspex_switch/usage_00400a98.c", "/tmp/haruspex_switch/vlan_clear_0040b258.c", "/tmp/haruspex_switch/vlan_dump_0040ad70.c", "/tmp/haruspex_switch/vlan_set_0040b3bc.c"]}, "results": [{"check_id": "external.semgrep-rules-0xdea.c.raptor-signed-unsigned-conversion", "end": {"col": 54, "line": 17, "offset": 373}, "extra": {"engine_kind": "OSS", "fingerprint": "364ce772e7700e754f4c982fc1d464e88a746e532654c40b5eba51805e876a99fe67863e88488b674968b650ce42e82552a4d7845756fb36c79be7275f24cda5_0", "is_ignored": false, "lines": "          (sVar1 = strlen(*(char **)(param_2 + 0x14)), sVar1 != 8)) {", "message": "The software uses a signed primitive and performs a cast to an unsigned primitive, or uses an unsigned primitive and performs a cast to a signed primitive, which can produce an unexpected value. When the result of a function is to be used as a size parameter, using negative return values can have unexpected results. Although less frequent an issue, unsigned-to-signed conversion can be  the precursor to buffer underwrite conditions. Buffer underwrites  occur frequently when large unsigned values are cast to signed values,  and then used as indexes into a buffer or for pointer arithmetic.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "LOW", "references": ["https://cwe.mitre.org/data/definitions/195", "https://cwe.mitre.org/data/definitions/196", "https://cwe.mitre.org/data/definitions/194", "https://cwe.mitre.org/data/definitions/191", "https://cwe.mitre.org/data/definitions/681", "https://cwe.mitre.org/data/definitions/789", "https://g.co/kgs/PCHQjJ", "https://github.com/struct/mms", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "http://www.phrack.org/issues/60/10.html#article", "https://docs.microsoft.com/en-us/cpp/sanitizers/asan-error-examples"]}, "metavars": {"$SIGNED": {"abstract_content": "param_2", "end": {"col": 45, "line": 17, "offset": 364}, "start": {"col": 38, "line": 17, "offset": 357}}, "$UNSIGNED": {"abstract_content": "sVar1", "end": {"col": 17, "line": 17, "offset": 336}, "start": {"col": 12, "line": 17, "offset": 331}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/acl_dip_add_004052a4.c", "start": {"col": 12, "line": 17, "offset": 331}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 57, "line": 42, "offset": 1455}, "extra": {"engine_kind": "OSS", "fingerprint": "826b5783f9a2b4526e108a6d238acac9656fbd9b57f552d8f8850f065f2e038465147408845dc7fabc14124008d03e9d48190afa98256769f331a65b9fe1177f_0", "is_ignored": false, "lines": "    while ((local_30 < 0x14 && (reg_read(0x90,&local_24), (int)local_24 < 0))) {", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "reg_read", "end": {"col": 41, "line": 42, "offset": 1439}, "start": {"col": 33, "line": 42, "offset": 1431}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/acl_dip_add_004052a4.c", "start": {"col": 33, "line": 42, "offset": 1431}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 57, "line": 59, "offset": 2064}, "extra": {"engine_kind": "OSS", "fingerprint": "826b5783f9a2b4526e108a6d238acac9656fbd9b57f552d8f8850f065f2e038465147408845dc7fabc14124008d03e9d48190afa98256769f331a65b9fe1177f_1", "is_ignored": false, "lines": "    while ((local_30 < 0x14 && (reg_read(0x90,&local_24), (int)local_24 < 0))) {", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "reg_read", "end": {"col": 41, "line": 59, "offset": 2048}, "start": {"col": 33, "line": 59, "offset": 2040}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/acl_dip_add_004052a4.c", "start": {"col": 33, "line": 59, "offset": 2040}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 57, "line": 76, "offset": 2605}, "extra": {"engine_kind": "OSS", "fingerprint": "826b5783f9a2b4526e108a6d238acac9656fbd9b57f552d8f8850f065f2e038465147408845dc7fabc14124008d03e9d48190afa98256769f331a65b9fe1177f_2", "is_ignored": false, "lines": "    while ((local_30 < 0x14 && (reg_read(0x90,&local_24), (int)local_24 < 0))) {", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "reg_read", "end": {"col": 41, "line": 76, "offset": 2589}, "start": {"col": 33, "line": 76, "offset": 2581}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/acl_dip_add_004052a4.c", "start": {"col": 33, "line": 76, "offset": 2581}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 57, "line": 93, "offset": 3164}, "extra": {"engine_kind": "OSS", "fingerprint": "826b5783f9a2b4526e108a6d238acac9656fbd9b57f552d8f8850f065f2e038465147408845dc7fabc14124008d03e9d48190afa98256769f331a65b9fe1177f_3", "is_ignored": false, "lines": "    while ((local_30 < 0x14 && (reg_read(0x90,&local_24), (int)local_24 < 0))) {", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "reg_read", "end": {"col": 41, "line": 93, "offset": 3148}, "start": {"col": 33, "line": 93, "offset": 3140}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/acl_dip_add_004052a4.c", "start": {"col": 33, "line": 93, "offset": 3140}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-signed-unsigned-conversion", "end": {"col": 54, "line": 16, "offset": 314}, "extra": {"engine_kind": "OSS", "fingerprint": "ee88fb76b83ffcfcf31b5427555611d53b6a47f920ab1ea423a955206818db77011bb5f1d180aa5b41a5471f497dd244b110a2dc8e60340750fde5bac51c14b6_0", "is_ignored": false, "lines": "          (sVar1 = strlen(*(char **)(param_2 + 0x14)), sVar1 != 8)) {", "message": "The software uses a signed primitive and performs a cast to an unsigned primitive, or uses an unsigned primitive and performs a cast to a signed primitive, which can produce an unexpected value. When the result of a function is to be used as a size parameter, using negative return values can have unexpected results. Although less frequent an issue, unsigned-to-signed conversion can be  the precursor to buffer underwrite conditions. Buffer underwrites  occur frequently when large unsigned values are cast to signed values,  and then used as indexes into a buffer or for pointer arithmetic.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "LOW", "references": ["https://cwe.mitre.org/data/definitions/195", "https://cwe.mitre.org/data/definitions/196", "https://cwe.mitre.org/data/definitions/194", "https://cwe.mitre.org/data/definitions/191", "https://cwe.mitre.org/data/definitions/681", "https://cwe.mitre.org/data/definitions/789", "https://g.co/kgs/PCHQjJ", "https://github.com/struct/mms", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "http://www.phrack.org/issues/60/10.html#article", "https://docs.microsoft.com/en-us/cpp/sanitizers/asan-error-examples"]}, "metavars": {"$SIGNED": {"abstract_content": "param_2", "end": {"col": 45, "line": 16, "offset": 305}, "start": {"col": 38, "line": 16, "offset": 298}}, "$UNSIGNED": {"abstract_content": "sVar1", "end": {"col": 17, "line": 16, "offset": 277}, "start": {"col": 12, "line": 16, "offset": 272}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/acl_dip_meter_004022e0.c", "start": {"col": 12, "line": 16, "offset": 272}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 57, "line": 41, "offset": 1373}, "extra": {"engine_kind": "OSS", "fingerprint": "10e5d5f5b1fc4c01600772b2555a38b60e086b55ca709af536839de772820c3d63a41e3fbc548d338dd84802d0040cf15cc909d17b1f1d94ed234a833f17dbe9_0", "is_ignored": false, "lines": "    while ((local_30 < 0x14 && (reg_read(0x90,&local_20), (int)local_20 < 0))) {", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "reg_read", "end": {"col": 41, "line": 41, "offset": 1357}, "start": {"col": 33, "line": 41, "offset": 1349}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/acl_dip_meter_004022e0.c", "start": {"col": 33, "line": 41, "offset": 1349}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 57, "line": 58, "offset": 1982}, "extra": {"engine_kind": "OSS", "fingerprint": "10e5d5f5b1fc4c01600772b2555a38b60e086b55ca709af536839de772820c3d63a41e3fbc548d338dd84802d0040cf15cc909d17b1f1d94ed234a833f17dbe9_1", "is_ignored": false, "lines": "    while ((local_30 < 0x14 && (reg_read(0x90,&local_20), (int)local_20 < 0))) {", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "reg_read", "end": {"col": 41, "line": 58, "offset": 1966}, "start": {"col": 33, "line": 58, "offset": 1958}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/acl_dip_meter_004022e0.c", "start": {"col": 33, "line": 58, "offset": 1958}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 57, "line": 75, "offset": 2523}, "extra": {"engine_kind": "OSS", "fingerprint": "10e5d5f5b1fc4c01600772b2555a38b60e086b55ca709af536839de772820c3d63a41e3fbc548d338dd84802d0040cf15cc909d17b1f1d94ed234a833f17dbe9_2", "is_ignored": false, "lines": "    while ((local_30 < 0x14 && (reg_read(0x90,&local_20), (int)local_20 < 0))) {", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "reg_read", "end": {"col": 41, "line": 75, "offset": 2507}, "start": {"col": 33, "line": 75, "offset": 2499}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/acl_dip_meter_004022e0.c", "start": {"col": 33, "line": 75, "offset": 2499}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 57, "line": 93, "offset": 3153}, "extra": {"engine_kind": "OSS", "fingerprint": "10e5d5f5b1fc4c01600772b2555a38b60e086b55ca709af536839de772820c3d63a41e3fbc548d338dd84802d0040cf15cc909d17b1f1d94ed234a833f17dbe9_3", "is_ignored": false, "lines": "    while ((local_30 < 0x14 && (reg_read(0x90,&local_20), (int)local_20 < 0))) {", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "reg_read", "end": {"col": 41, "line": 93, "offset": 3137}, "start": {"col": 33, "line": 93, "offset": 3129}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/acl_dip_meter_004022e0.c", "start": {"col": 33, "line": 93, "offset": 3129}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-signed-unsigned-conversion", "end": {"col": 54, "line": 17, "offset": 376}, "extra": {"engine_kind": "OSS", "fingerprint": "3be784b7b34b68c662ac0997816298caab587c3054e63b52b13662773b0880f2612372eef0fec17803d9db9a1ed43af7f0956caa2f7ac2cd6ec4961a03bf58ad_0", "is_ignored": false, "lines": "          (sVar1 = strlen(*(char **)(param_2 + 0x14)), sVar1 != 8)) {", "message": "The software uses a signed primitive and performs a cast to an unsigned primitive, or uses an unsigned primitive and performs a cast to a signed primitive, which can produce an unexpected value. When the result of a function is to be used as a size parameter, using negative return values can have unexpected results. Although less frequent an issue, unsigned-to-signed conversion can be  the precursor to buffer underwrite conditions. Buffer underwrites  occur frequently when large unsigned values are cast to signed values,  and then used as indexes into a buffer or for pointer arithmetic.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "LOW", "references": ["https://cwe.mitre.org/data/definitions/195", "https://cwe.mitre.org/data/definitions/196", "https://cwe.mitre.org/data/definitions/194", "https://cwe.mitre.org/data/definitions/191", "https://cwe.mitre.org/data/definitions/681", "https://cwe.mitre.org/data/definitions/789", "https://g.co/kgs/PCHQjJ", "https://github.com/struct/mms", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "http://www.phrack.org/issues/60/10.html#article", "https://docs.microsoft.com/en-us/cpp/sanitizers/asan-error-examples"]}, "metavars": {"$SIGNED": {"abstract_content": "param_2", "end": {"col": 45, "line": 17, "offset": 367}, "start": {"col": 38, "line": 17, "offset": 360}}, "$UNSIGNED": {"abstract_content": "sVar1", "end": {"col": 17, "line": 17, "offset": 339}, "start": {"col": 12, "line": 17, "offset": 334}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/acl_dip_modify_00403fec.c", "start": {"col": 12, "line": 17, "offset": 334}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 57, "line": 42, "offset": 1458}, "extra": {"engine_kind": "OSS", "fingerprint": "dc594f4786c69ff61e3b7804468fbe98f6152b635ecd54f15d22345ffcbf4d76ef22b5be7caca3f8a59063d0dc0b43bd66b1760afa8ec071ed84359adae7e0ec_0", "is_ignored": false, "lines": "    while ((local_30 < 0x14 && (reg_read(0x90,&local_24), (int)local_24 < 0))) {", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "reg_read", "end": {"col": 41, "line": 42, "offset": 1442}, "start": {"col": 33, "line": 42, "offset": 1434}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/acl_dip_modify_00403fec.c", "start": {"col": 33, "line": 42, "offset": 1434}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 57, "line": 59, "offset": 2067}, "extra": {"engine_kind": "OSS", "fingerprint": "dc594f4786c69ff61e3b7804468fbe98f6152b635ecd54f15d22345ffcbf4d76ef22b5be7caca3f8a59063d0dc0b43bd66b1760afa8ec071ed84359adae7e0ec_1", "is_ignored": false, "lines": "    while ((local_30 < 0x14 && (reg_read(0x90,&local_24), (int)local_24 < 0))) {", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "reg_read", "end": {"col": 41, "line": 59, "offset": 2051}, "start": {"col": 33, "line": 59, "offset": 2043}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/acl_dip_modify_00403fec.c", "start": {"col": 33, "line": 59, "offset": 2043}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 57, "line": 76, "offset": 2608}, "extra": {"engine_kind": "OSS", "fingerprint": "dc594f4786c69ff61e3b7804468fbe98f6152b635ecd54f15d22345ffcbf4d76ef22b5be7caca3f8a59063d0dc0b43bd66b1760afa8ec071ed84359adae7e0ec_2", "is_ignored": false, "lines": "    while ((local_30 < 0x14 && (reg_read(0x90,&local_24), (int)local_24 < 0))) {", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "reg_read", "end": {"col": 41, "line": 76, "offset": 2592}, "start": {"col": 33, "line": 76, "offset": 2584}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/acl_dip_modify_00403fec.c", "start": {"col": 33, "line": 76, "offset": 2584}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 57, "line": 93, "offset": 3167}, "extra": {"engine_kind": "OSS", "fingerprint": "dc594f4786c69ff61e3b7804468fbe98f6152b635ecd54f15d22345ffcbf4d76ef22b5be7caca3f8a59063d0dc0b43bd66b1760afa8ec071ed84359adae7e0ec_3", "is_ignored": false, "lines": "    while ((local_30 < 0x14 && (reg_read(0x90,&local_24), (int)local_24 < 0))) {", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "reg_read", "end": {"col": 41, "line": 93, "offset": 3151}, "start": {"col": 33, "line": 93, "offset": 3143}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/acl_dip_modify_00403fec.c", "start": {"col": 33, "line": 93, "offset": 3143}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-signed-unsigned-conversion", "end": {"col": 54, "line": 17, "offset": 375}, "extra": {"engine_kind": "OSS", "fingerprint": "debe472a16a2d64816e2c798c504257efaa5defe198ed3c0348e5dfdc3f77208db63d2a1e797e864160e594ef654ecce58d663d24c36a3ffb4d90ed5792ec212_0", "is_ignored": false, "lines": "          (sVar1 = strlen(*(char **)(param_2 + 0x14)), sVar1 != 8)) {", "message": "The software uses a signed primitive and performs a cast to an unsigned primitive, or uses an unsigned primitive and performs a cast to a signed primitive, which can produce an unexpected value. When the result of a function is to be used as a size parameter, using negative return values can have unexpected results. Although less frequent an issue, unsigned-to-signed conversion can be  the precursor to buffer underwrite conditions. Buffer underwrites  occur frequently when large unsigned values are cast to signed values,  and then used as indexes into a buffer or for pointer arithmetic.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "LOW", "references": ["https://cwe.mitre.org/data/definitions/195", "https://cwe.mitre.org/data/definitions/196", "https://cwe.mitre.org/data/definitions/194", "https://cwe.mitre.org/data/definitions/191", "https://cwe.mitre.org/data/definitions/681", "https://cwe.mitre.org/data/definitions/789", "https://g.co/kgs/PCHQjJ", "https://github.com/struct/mms", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "http://www.phrack.org/issues/60/10.html#article", "https://docs.microsoft.com/en-us/cpp/sanitizers/asan-error-examples"]}, "metavars": {"$SIGNED": {"abstract_content": "param_2", "end": {"col": 45, "line": 17, "offset": 366}, "start": {"col": 38, "line": 17, "offset": 359}}, "$UNSIGNED": {"abstract_content": "sVar1", "end": {"col": 17, "line": 17, "offset": 338}, "start": {"col": 12, "line": 17, "offset": 333}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/acl_dip_pppoe_00404940.c", "start": {"col": 12, "line": 17, "offset": 333}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 57, "line": 42, "offset": 1457}, "extra": {"engine_kind": "OSS", "fingerprint": "9d6c89efee7b1fa761e7d374f953a2bca42bad32833ce73b0af648decbfe87bc8f96a1a76b796742f14075007ae20a231ee998dc579b6a91f3722d692dc20224_0", "is_ignored": false, "lines": "    while ((local_30 < 0x14 && (reg_read(0x90,&local_24), (int)local_24 < 0))) {", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "reg_read", "end": {"col": 41, "line": 42, "offset": 1441}, "start": {"col": 33, "line": 42, "offset": 1433}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/acl_dip_pppoe_00404940.c", "start": {"col": 33, "line": 42, "offset": 1433}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 57, "line": 59, "offset": 2066}, "extra": {"engine_kind": "OSS", "fingerprint": "9d6c89efee7b1fa761e7d374f953a2bca42bad32833ce73b0af648decbfe87bc8f96a1a76b796742f14075007ae20a231ee998dc579b6a91f3722d692dc20224_1", "is_ignored": false, "lines": "    while ((local_30 < 0x14 && (reg_read(0x90,&local_24), (int)local_24 < 0))) {", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "reg_read", "end": {"col": 41, "line": 59, "offset": 2050}, "start": {"col": 33, "line": 59, "offset": 2042}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/acl_dip_pppoe_00404940.c", "start": {"col": 33, "line": 59, "offset": 2042}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 57, "line": 76, "offset": 2607}, "extra": {"engine_kind": "OSS", "fingerprint": "9d6c89efee7b1fa761e7d374f953a2bca42bad32833ce73b0af648decbfe87bc8f96a1a76b796742f14075007ae20a231ee998dc579b6a91f3722d692dc20224_2", "is_ignored": false, "lines": "    while ((local_30 < 0x14 && (reg_read(0x90,&local_24), (int)local_24 < 0))) {", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "reg_read", "end": {"col": 41, "line": 76, "offset": 2591}, "start": {"col": 33, "line": 76, "offset": 2583}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/acl_dip_pppoe_00404940.c", "start": {"col": 33, "line": 76, "offset": 2583}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 57, "line": 93, "offset": 3166}, "extra": {"engine_kind": "OSS", "fingerprint": "9d6c89efee7b1fa761e7d374f953a2bca42bad32833ce73b0af648decbfe87bc8f96a1a76b796742f14075007ae20a231ee998dc579b6a91f3722d692dc20224_3", "is_ignored": false, "lines": "    while ((local_30 < 0x14 && (reg_read(0x90,&local_24), (int)local_24 < 0))) {", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "reg_read", "end": {"col": 41, "line": 93, "offset": 3150}, "start": {"col": 33, "line": 93, "offset": 3142}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/acl_dip_pppoe_00404940.c", "start": {"col": 33, "line": 93, "offset": 3142}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-signed-unsigned-conversion", "end": {"col": 54, "line": 19, "offset": 359}, "extra": {"engine_kind": "OSS", "fingerprint": "54198a6e73434c23d614fcc1b642ec1816c9fe57f821a433a5891ab3a3a4d96a1d6ddd53a4fb7b71213bb4d4f3ed4b7c251cd754f2b104e8a9e301c29fa86443_0", "is_ignored": false, "lines": "          (sVar1 = strlen(*(char **)(param_2 + 0x14)), sVar1 != 8)) {", "message": "The software uses a signed primitive and performs a cast to an unsigned primitive, or uses an unsigned primitive and performs a cast to a signed primitive, which can produce an unexpected value. When the result of a function is to be used as a size parameter, using negative return values can have unexpected results. Although less frequent an issue, unsigned-to-signed conversion can be  the precursor to buffer underwrite conditions. Buffer underwrites  occur frequently when large unsigned values are cast to signed values,  and then used as indexes into a buffer or for pointer arithmetic.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "LOW", "references": ["https://cwe.mitre.org/data/definitions/195", "https://cwe.mitre.org/data/definitions/196", "https://cwe.mitre.org/data/definitions/194", "https://cwe.mitre.org/data/definitions/191", "https://cwe.mitre.org/data/definitions/681", "https://cwe.mitre.org/data/definitions/789", "https://g.co/kgs/PCHQjJ", "https://github.com/struct/mms", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "http://www.phrack.org/issues/60/10.html#article", "https://docs.microsoft.com/en-us/cpp/sanitizers/asan-error-examples"]}, "metavars": {"$SIGNED": {"abstract_content": "param_2", "end": {"col": 45, "line": 19, "offset": 350}, "start": {"col": 38, "line": 19, "offset": 343}}, "$UNSIGNED": {"abstract_content": "sVar1", "end": {"col": 17, "line": 19, "offset": 322}, "start": {"col": 12, "line": 19, "offset": 317}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/acl_dip_trtcm_00402c4c.c", "start": {"col": 12, "line": 19, "offset": 317}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 57, "line": 44, "offset": 1418}, "extra": {"engine_kind": "OSS", "fingerprint": "f3d0fa5787fdee5b04beb8b6df89ee898b395e7a2596ee895784fecc320aaa2cb23338bc28dc44818fec2026020b87a626aa177a24c17c30bc53c2056636f648_0", "is_ignored": false, "lines": "    while ((local_40 < 0x14 && (reg_read(0x90,&local_24), (int)local_24 < 0))) {", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "reg_read", "end": {"col": 41, "line": 44, "offset": 1402}, "start": {"col": 33, "line": 44, "offset": 1394}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/acl_dip_trtcm_00402c4c.c", "start": {"col": 33, "line": 44, "offset": 1394}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 57, "line": 61, "offset": 2027}, "extra": {"engine_kind": "OSS", "fingerprint": "f3d0fa5787fdee5b04beb8b6df89ee898b395e7a2596ee895784fecc320aaa2cb23338bc28dc44818fec2026020b87a626aa177a24c17c30bc53c2056636f648_1", "is_ignored": false, "lines": "    while ((local_40 < 0x14 && (reg_read(0x90,&local_24), (int)local_24 < 0))) {", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "reg_read", "end": {"col": 41, "line": 61, "offset": 2011}, "start": {"col": 33, "line": 61, "offset": 2003}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/acl_dip_trtcm_00402c4c.c", "start": {"col": 33, "line": 61, "offset": 2003}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 57, "line": 82, "offset": 2890}, "extra": {"engine_kind": "OSS", "fingerprint": "f3d0fa5787fdee5b04beb8b6df89ee898b395e7a2596ee895784fecc320aaa2cb23338bc28dc44818fec2026020b87a626aa177a24c17c30bc53c2056636f648_2", "is_ignored": false, "lines": "    while ((local_40 < 0x14 && (reg_read(0x90,&local_24), (int)local_24 < 0))) {", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "reg_read", "end": {"col": 41, "line": 82, "offset": 2874}, "start": {"col": 33, "line": 82, "offset": 2866}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/acl_dip_trtcm_00402c4c.c", "start": {"col": 33, "line": 82, "offset": 2866}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 57, "line": 99, "offset": 3431}, "extra": {"engine_kind": "OSS", "fingerprint": "f3d0fa5787fdee5b04beb8b6df89ee898b395e7a2596ee895784fecc320aaa2cb23338bc28dc44818fec2026020b87a626aa177a24c17c30bc53c2056636f648_3", "is_ignored": false, "lines": "    while ((local_40 < 0x14 && (reg_read(0x90,&local_24), (int)local_24 < 0))) {", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "reg_read", "end": {"col": 41, "line": 99, "offset": 3415}, "start": {"col": 33, "line": 99, "offset": 3407}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/acl_dip_trtcm_00402c4c.c", "start": {"col": 33, "line": 99, "offset": 3407}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 57, "line": 116, "offset": 3982}, "extra": {"engine_kind": "OSS", "fingerprint": "f3d0fa5787fdee5b04beb8b6df89ee898b395e7a2596ee895784fecc320aaa2cb23338bc28dc44818fec2026020b87a626aa177a24c17c30bc53c2056636f648_4", "is_ignored": false, "lines": "    while ((local_40 < 0x14 && (reg_read(0x90,&local_24), (int)local_24 < 0))) {", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "reg_read", "end": {"col": 41, "line": 116, "offset": 3966}, "start": {"col": 33, "line": 116, "offset": 3958}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/acl_dip_trtcm_00402c4c.c", "start": {"col": 33, "line": 116, "offset": 3958}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-signed-unsigned-conversion", "end": {"col": 54, "line": 15, "offset": 297}, "extra": {"engine_kind": "OSS", "fingerprint": "9ebce11b23d88c7ce3c7790fec050d7f7be38a09a0f810a534828f91b28dc44fed5d6c152523acd9680802ac4dc9e9e95e049fab19cd677d8defb0a044507b29_0", "is_ignored": false, "lines": "          (sVar1 = strlen(*(char **)(param_2 + 0x14)), sVar1 != 8)) {", "message": "The software uses a signed primitive and performs a cast to an unsigned primitive, or uses an unsigned primitive and performs a cast to a signed primitive, which can produce an unexpected value. When the result of a function is to be used as a size parameter, using negative return values can have unexpected results. Although less frequent an issue, unsigned-to-signed conversion can be  the precursor to buffer underwrite conditions. Buffer underwrites  occur frequently when large unsigned values are cast to signed values,  and then used as indexes into a buffer or for pointer arithmetic.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "LOW", "references": ["https://cwe.mitre.org/data/definitions/195", "https://cwe.mitre.org/data/definitions/196", "https://cwe.mitre.org/data/definitions/194", "https://cwe.mitre.org/data/definitions/191", "https://cwe.mitre.org/data/definitions/681", "https://cwe.mitre.org/data/definitions/789", "https://g.co/kgs/PCHQjJ", "https://github.com/struct/mms", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "http://www.phrack.org/issues/60/10.html#article", "https://docs.microsoft.com/en-us/cpp/sanitizers/asan-error-examples"]}, "metavars": {"$SIGNED": {"abstract_content": "param_2", "end": {"col": 45, "line": 15, "offset": 288}, "start": {"col": 38, "line": 15, "offset": 281}}, "$UNSIGNED": {"abstract_content": "sVar1", "end": {"col": 17, "line": 15, "offset": 260}, "start": {"col": 12, "line": 15, "offset": 255}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/acl_ethertype_00403874.c", "start": {"col": 12, "line": 15, "offset": 255}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 56, "line": 40, "offset": 1375}, "extra": {"engine_kind": "OSS", "fingerprint": "fc71ca2abed5ecb04cdc52b6dae55f2e3dbbeb5443411d254a38c372fbcc74227466c05f86c32218bfd9d14400f27868b6a41047a2a21eda3d6015086cd0878b_0", "is_ignored": false, "lines": "    while ((local_30 < 0x14 && (reg_read(0x90,local_20), (int)local_20[0] < 0))) {", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "reg_read", "end": {"col": 41, "line": 40, "offset": 1360}, "start": {"col": 33, "line": 40, "offset": 1352}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/acl_ethertype_00403874.c", "start": {"col": 33, "line": 40, "offset": 1352}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 56, "line": 57, "offset": 1936}, "extra": {"engine_kind": "OSS", "fingerprint": "fc71ca2abed5ecb04cdc52b6dae55f2e3dbbeb5443411d254a38c372fbcc74227466c05f86c32218bfd9d14400f27868b6a41047a2a21eda3d6015086cd0878b_1", "is_ignored": false, "lines": "    while ((local_30 < 0x14 && (reg_read(0x90,local_20), (int)local_20[0] < 0))) {", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "reg_read", "end": {"col": 41, "line": 57, "offset": 1921}, "start": {"col": 33, "line": 57, "offset": 1913}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/acl_ethertype_00403874.c", "start": {"col": 33, "line": 57, "offset": 1913}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 56, "line": 74, "offset": 2515}, "extra": {"engine_kind": "OSS", "fingerprint": "fc71ca2abed5ecb04cdc52b6dae55f2e3dbbeb5443411d254a38c372fbcc74227466c05f86c32218bfd9d14400f27868b6a41047a2a21eda3d6015086cd0878b_2", "is_ignored": false, "lines": "    while ((local_30 < 0x14 && (reg_read(0x90,local_20), (int)local_20[0] < 0))) {", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "reg_read", "end": {"col": 41, "line": 74, "offset": 2500}, "start": {"col": 33, "line": 74, "offset": 2492}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/acl_ethertype_00403874.c", "start": {"col": 33, "line": 74, "offset": 2492}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-signed-unsigned-conversion", "end": {"col": 54, "line": 15, "offset": 294}, "extra": {"engine_kind": "OSS", "fingerprint": "891bb88a95f6d0ff0c3ee1165a6063e1f97555418d00c15e917ea33b109682e8553d197ef0f93b748ead2f8d1040c108d33a26c010ffce33753f91e916eb21f7_0", "is_ignored": false, "lines": "          (sVar1 = strlen(*(char **)(param_2 + 0x14)), sVar1 != 8)) {", "message": "The software uses a signed primitive and performs a cast to an unsigned primitive, or uses an unsigned primitive and performs a cast to a signed primitive, which can produce an unexpected value. When the result of a function is to be used as a size parameter, using negative return values can have unexpected results. Although less frequent an issue, unsigned-to-signed conversion can be  the precursor to buffer underwrite conditions. Buffer underwrites  occur frequently when large unsigned values are cast to signed values,  and then used as indexes into a buffer or for pointer arithmetic.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "LOW", "references": ["https://cwe.mitre.org/data/definitions/195", "https://cwe.mitre.org/data/definitions/196", "https://cwe.mitre.org/data/definitions/194", "https://cwe.mitre.org/data/definitions/191", "https://cwe.mitre.org/data/definitions/681", "https://cwe.mitre.org/data/definitions/789", "https://g.co/kgs/PCHQjJ", "https://github.com/struct/mms", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "http://www.phrack.org/issues/60/10.html#article", "https://docs.microsoft.com/en-us/cpp/sanitizers/asan-error-examples"]}, "metavars": {"$SIGNED": {"abstract_content": "param_2", "end": {"col": 45, "line": 15, "offset": 285}, "start": {"col": 38, "line": 15, "offset": 278}}, "$UNSIGNED": {"abstract_content": "sVar1", "end": {"col": 17, "line": 15, "offset": 257}, "start": {"col": 12, "line": 15, "offset": 252}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/acl_l4_add_00405bec.c", "start": {"col": 12, "line": 15, "offset": 252}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 56, "line": 40, "offset": 1372}, "extra": {"engine_kind": "OSS", "fingerprint": "632b1dc7037d0a6988638cc8a03d2360aade54ec7cfc44b69651061f0099220d7409eb9d2af1ee39462ba35851299136e53f0d2ffedcbcd4bba62b052b20eb3f_0", "is_ignored": false, "lines": "    while ((local_28 < 0x14 && (reg_read(0x90,local_1c), (int)local_1c[0] < 0))) {", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "reg_read", "end": {"col": 41, "line": 40, "offset": 1357}, "start": {"col": 33, "line": 40, "offset": 1349}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/acl_l4_add_00405bec.c", "start": {"col": 33, "line": 40, "offset": 1349}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 56, "line": 57, "offset": 1933}, "extra": {"engine_kind": "OSS", "fingerprint": "632b1dc7037d0a6988638cc8a03d2360aade54ec7cfc44b69651061f0099220d7409eb9d2af1ee39462ba35851299136e53f0d2ffedcbcd4bba62b052b20eb3f_1", "is_ignored": false, "lines": "    while ((local_28 < 0x14 && (reg_read(0x90,local_1c), (int)local_1c[0] < 0))) {", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "reg_read", "end": {"col": 41, "line": 57, "offset": 1918}, "start": {"col": 33, "line": 57, "offset": 1910}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/acl_l4_add_00405bec.c", "start": {"col": 33, "line": 57, "offset": 1910}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 56, "line": 74, "offset": 2494}, "extra": {"engine_kind": "OSS", "fingerprint": "632b1dc7037d0a6988638cc8a03d2360aade54ec7cfc44b69651061f0099220d7409eb9d2af1ee39462ba35851299136e53f0d2ffedcbcd4bba62b052b20eb3f_2", "is_ignored": false, "lines": "    while ((local_28 < 0x14 && (reg_read(0x90,local_1c), (int)local_1c[0] < 0))) {", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "reg_read", "end": {"col": 41, "line": 74, "offset": 2479}, "start": {"col": 33, "line": 74, "offset": 2471}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/acl_l4_add_00405bec.c", "start": {"col": 33, "line": 74, "offset": 2471}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-signed-unsigned-conversion", "end": {"col": 54, "line": 15, "offset": 294}, "extra": {"engine_kind": "OSS", "fingerprint": "e32395f68debc493ba405fa14382bb00682649841d78e5bea37d6f9c07f81a35463c37bdd351612db188a24a4b8be8ad328bcacb212121fdd0a0b65c55565565_0", "is_ignored": false, "lines": "          (sVar1 = strlen(*(char **)(param_2 + 0x14)), sVar1 != 8)) {", "message": "The software uses a signed primitive and performs a cast to an unsigned primitive, or uses an unsigned primitive and performs a cast to a signed primitive, which can produce an unexpected value. When the result of a function is to be used as a size parameter, using negative return values can have unexpected results. Although less frequent an issue, unsigned-to-signed conversion can be  the precursor to buffer underwrite conditions. Buffer underwrites  occur frequently when large unsigned values are cast to signed values,  and then used as indexes into a buffer or for pointer arithmetic.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "LOW", "references": ["https://cwe.mitre.org/data/definitions/195", "https://cwe.mitre.org/data/definitions/196", "https://cwe.mitre.org/data/definitions/194", "https://cwe.mitre.org/data/definitions/191", "https://cwe.mitre.org/data/definitions/681", "https://cwe.mitre.org/data/definitions/789", "https://g.co/kgs/PCHQjJ", "https://github.com/struct/mms", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "http://www.phrack.org/issues/60/10.html#article", "https://docs.microsoft.com/en-us/cpp/sanitizers/asan-error-examples"]}, "metavars": {"$SIGNED": {"abstract_content": "param_2", "end": {"col": 45, "line": 15, "offset": 285}, "start": {"col": 38, "line": 15, "offset": 278}}, "$UNSIGNED": {"abstract_content": "sVar1", "end": {"col": 17, "line": 15, "offset": 257}, "start": {"col": 12, "line": 15, "offset": 252}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/acl_sp_add_0040631c.c", "start": {"col": 12, "line": 15, "offset": 252}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 56, "line": 40, "offset": 1369}, "extra": {"engine_kind": "OSS", "fingerprint": "1905141112f4abce4460f63527b5478f56508997289dcb7cc8a434b6fe8356f63315f3dc901ebb4298d5b22e2d5f53479663280522b55230bc268a203fb30d2a_0", "is_ignored": false, "lines": "    while ((local_28 < 0x14 && (reg_read(0x90,local_1c), (int)local_1c[0] < 0))) {", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "reg_read", "end": {"col": 41, "line": 40, "offset": 1354}, "start": {"col": 33, "line": 40, "offset": 1346}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/acl_sp_add_0040631c.c", "start": {"col": 33, "line": 40, "offset": 1346}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 56, "line": 57, "offset": 1930}, "extra": {"engine_kind": "OSS", "fingerprint": "1905141112f4abce4460f63527b5478f56508997289dcb7cc8a434b6fe8356f63315f3dc901ebb4298d5b22e2d5f53479663280522b55230bc268a203fb30d2a_1", "is_ignored": false, "lines": "    while ((local_28 < 0x14 && (reg_read(0x90,local_1c), (int)local_1c[0] < 0))) {", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "reg_read", "end": {"col": 41, "line": 57, "offset": 1915}, "start": {"col": 33, "line": 57, "offset": 1907}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/acl_sp_add_0040631c.c", "start": {"col": 33, "line": 57, "offset": 1907}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 56, "line": 74, "offset": 2491}, "extra": {"engine_kind": "OSS", "fingerprint": "1905141112f4abce4460f63527b5478f56508997289dcb7cc8a434b6fe8356f63315f3dc901ebb4298d5b22e2d5f53479663280522b55230bc268a203fb30d2a_2", "is_ignored": false, "lines": "    while ((local_28 < 0x14 && (reg_read(0x90,local_1c), (int)local_1c[0] < 0))) {", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "reg_read", "end": {"col": 41, "line": 74, "offset": 2476}, "start": {"col": 33, "line": 74, "offset": 2468}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/acl_sp_add_0040631c.c", "start": {"col": 33, "line": 74, "offset": 2468}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-signed-unsigned-conversion", "end": {"col": 85, "line": 14, "offset": 426}, "extra": {"engine_kind": "OSS", "fingerprint": "1544a8a84fbe79a42162c7fbbd0ff8e4eeb4a3cab8ff2bc2caf92b6e050a9d3afc58e7493635eba74402343430b66a0191fe4be97f73a24ee8c1a0e5c59d8f17_0", "is_ignored": false, "lines": "  if ((*(int *)(param_2 + 0x10) == 0) || (sVar1 = strlen(*(char **)(param_2 + 0x10)), sVar1 != 8)) {", "message": "The software uses a signed primitive and performs a cast to an unsigned primitive, or uses an unsigned primitive and performs a cast to a signed primitive, which can produce an unexpected value. When the result of a function is to be used as a size parameter, using negative return values can have unexpected results. Although less frequent an issue, unsigned-to-signed conversion can be  the precursor to buffer underwrite conditions. Buffer underwrites  occur frequently when large unsigned values are cast to signed values,  and then used as indexes into a buffer or for pointer arithmetic.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "LOW", "references": ["https://cwe.mitre.org/data/definitions/195", "https://cwe.mitre.org/data/definitions/196", "https://cwe.mitre.org/data/definitions/194", "https://cwe.mitre.org/data/definitions/191", "https://cwe.mitre.org/data/definitions/681", "https://cwe.mitre.org/data/definitions/789", "https://g.co/kgs/PCHQjJ", "https://github.com/struct/mms", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "http://www.phrack.org/issues/60/10.html#article", "https://docs.microsoft.com/en-us/cpp/sanitizers/asan-error-examples"]}, "metavars": {"$SIGNED": {"abstract_content": "param_2", "end": {"col": 76, "line": 14, "offset": 417}, "start": {"col": 69, "line": 14, "offset": 410}}, "$UNSIGNED": {"abstract_content": "sVar1", "end": {"col": 48, "line": 14, "offset": 389}, "start": {"col": 43, "line": 14, "offset": 384}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/dip_add_0040701c.c", "start": {"col": 43, "line": 14, "offset": 384}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 28, "line": 31, "offset": 1077}, "extra": {"engine_kind": "OSS", "fingerprint": "de8d2790418bd7b366f33bdf35156843b19c303e87c8d8035e63b5c74f32b6ea58bcaef814e5e27c254a996d12aa499c40a240152434fffdb1795811613cf99e_0", "is_ignored": false, "lines": "    reg_read(0x7c,local_18);", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "reg_read", "end": {"col": 13, "line": 31, "offset": 1062}, "start": {"col": 5, "line": 31, "offset": 1054}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/dip_add_0040701c.c", "start": {"col": 5, "line": 31, "offset": 1054}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 30, "line": 37, "offset": 1306}, "extra": {"engine_kind": "OSS", "fingerprint": "de8d2790418bd7b366f33bdf35156843b19c303e87c8d8035e63b5c74f32b6ea58bcaef814e5e27c254a996d12aa499c40a240152434fffdb1795811613cf99e_1", "is_ignored": false, "lines": "      reg_read(0x80,local_18);", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "reg_read", "end": {"col": 15, "line": 37, "offset": 1291}, "start": {"col": 7, "line": 37, "offset": 1283}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/dip_add_0040701c.c", "start": {"col": 7, "line": 37, "offset": 1283}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 26, "line": 9, "offset": 214}, "extra": {"engine_kind": "OSS", "fingerprint": "9002ea71fbfc437d0b4d8f69209c22c5aa9df6bc8d3c1fa70e20a3a295fec60d1c44a410120accf189797088a56a3ad005085765679c8429a8d2229a98d718ca_0", "is_ignored": false, "lines": "  reg_read(0x80,local_10);", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "reg_read", "end": {"col": 11, "line": 9, "offset": 199}, "start": {"col": 3, "line": 9, "offset": 191}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/dip_clear_004075b4.c", "start": {"col": 3, "line": 9, "offset": 191}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 28, "line": 24, "offset": 477}, "extra": {"engine_kind": "OSS", "fingerprint": "3b60fbce3dc978c367c64161e760bcfb71391ee384ef60da1eb196e19d454ebfb0125ef9338b2061b934f2029cbfa3b7a2fd814376588b914b8468c603b6ffaf_0", "is_ignored": false, "lines": "    reg_read(0x80,local_1c);", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "reg_read", "end": {"col": 13, "line": 24, "offset": 462}, "start": {"col": 5, "line": 24, "offset": 454}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/dip_del_004073e8.c", "start": {"col": 5, "line": 24, "offset": 454}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 69, "line": 19, "offset": 455}, "extra": {"engine_kind": "OSS", "fingerprint": "754b2ea24527a8309965606363486b93270da49a70a7288810e23ca7d83e86eb4f836d328f9c261e5b4828a8a83a599fbdb0862a6d40dd976f7d6fa289974fc7_0", "is_ignored": false, "lines": "    reg_read((local_70 + 0x40) * 4,&local_68,param_3,param_4,puVar4);", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "reg_read", "end": {"col": 13, "line": 19, "offset": 399}, "start": {"col": 5, "line": 19, "offset": 391}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/dip_dump_00406a4c.c", "start": {"col": 5, "line": 19, "offset": 391}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 36, "line": 30, "offset": 800}, "extra": {"engine_kind": "OSS", "fingerprint": "754b2ea24527a8309965606363486b93270da49a70a7288810e23ca7d83e86eb4f836d328f9c261e5b4828a8a83a599fbdb0862a6d40dd976f7d6fa289974fc7_1", "is_ignored": false, "lines": "    while (reg_read(0x80,&local_68), (local_68 & 0x2000) == 0) {", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "reg_read", "end": {"col": 20, "line": 30, "offset": 784}, "start": {"col": 12, "line": 30, "offset": 776}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/dip_dump_00406a4c.c", "start": {"col": 12, "line": 30, "offset": 776}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 29, "line": 37, "offset": 1012}, "extra": {"engine_kind": "OSS", "fingerprint": "754b2ea24527a8309965606363486b93270da49a70a7288810e23ca7d83e86eb4f836d328f9c261e5b4828a8a83a599fbdb0862a6d40dd976f7d6fa289974fc7_2", "is_ignored": false, "lines": "    reg_read(0x8c,&local_5c);", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "reg_read", "end": {"col": 13, "line": 37, "offset": 996}, "start": {"col": 5, "line": 37, "offset": 988}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/dip_dump_00406a4c.c", "start": {"col": 5, "line": 37, "offset": 988}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 29, "line": 89, "offset": 1914}, "extra": {"engine_kind": "OSS", "fingerprint": "754b2ea24527a8309965606363486b93270da49a70a7288810e23ca7d83e86eb4f836d328f9c261e5b4828a8a83a599fbdb0862a6d40dd976f7d6fa289974fc7_3", "is_ignored": false, "lines": "    reg_read(0x88,&local_60);", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "reg_read", "end": {"col": 13, "line": 89, "offset": 1898}, "start": {"col": 5, "line": 89, "offset": 1890}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/dip_dump_00406a4c.c", "start": {"col": 5, "line": 89, "offset": 1890}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 29, "line": 93, "offset": 2078}, "extra": {"engine_kind": "OSS", "fingerprint": "754b2ea24527a8309965606363486b93270da49a70a7288810e23ca7d83e86eb4f836d328f9c261e5b4828a8a83a599fbdb0862a6d40dd976f7d6fa289974fc7_4", "is_ignored": false, "lines": "    reg_read(0x84,&local_64);", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "reg_read", "end": {"col": 13, "line": 93, "offset": 2062}, "start": {"col": 5, "line": 93, "offset": 2054}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/dip_dump_00406a4c.c", "start": {"col": 5, "line": 93, "offset": 2054}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 56, "line": 35, "offset": 788}, "extra": {"engine_kind": "OSS", "fingerprint": "3d2b2dfa9e407f6e09990a45f78b1a5932530778134630a99485f0518ccc12a8cdde2fdfee1eca28b3a9955390f51316eb49b08cc1da5cbf5cb4d403004b55d4_0", "is_ignored": false, "lines": "      uVar1 = mii_mgr_cl45_read(local_80,0x1e,local_7c);", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "mii_mgr_cl45_read", "end": {"col": 32, "line": 35, "offset": 764}, "start": {"col": 15, "line": 35, "offset": 747}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/dump_gphy_0040c8d0.c", "start": {"col": 15, "line": 35, "offset": 747}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-insecure-api-strcpy-stpcpy-strcat", "end": {"col": 30, "line": 15, "offset": 294}, "extra": {"engine_kind": "OSS", "fingerprint": "4a3152a69afc5b4337ea866102d0e743965333545222b561c19c6146813fc139f22246ac3caa6e3888d8203d998d4386bd1e80d67381726d68bcc6c6fd566e12_0", "is_ignored": false, "lines": "      strcpy(param_3,param_1);", "message": "A buffer overflow condition exists when a program attempts to put more data in a buffer than it can hold, or when a program attempts to put data in a memory area outside of the boundaries of a buffer.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "HIGH", "references": ["https://cwe.mitre.org/data/definitions/676", "https://cwe.mitre.org/data/definitions/120", "https://cwe.mitre.org/data/definitions/787", "https://g.co/kgs/PCHQjJ"]}, "metavars": {}, "severity": "ERROR", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/getnext_00401f5c.c", "start": {"col": 7, "line": 15, "offset": 271}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 30, "line": 15, "offset": 294}, "extra": {"engine_kind": "OSS", "fingerprint": "761415d5d2efe8de44af657bba189368a71a74d9bab89a1ab07ea3e7ee0f42f966a08ab70e5b0718f630ce69e6f6afa3bb6d8fe576ee4bf0e6bf6e75f546a789_0", "is_ignored": false, "lines": "      strcpy(param_3,param_1);", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "strcpy", "end": {"col": 13, "line": 15, "offset": 277}, "start": {"col": 7, "line": 15, "offset": 271}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/getnext_00401f5c.c", "start": {"col": 7, "line": 15, "offset": 271}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-signed-unsigned-conversion", "end": {"col": 39, "line": 19, "offset": 369}, "extra": {"engine_kind": "OSS", "fingerprint": "c267f332e43a1b63de3a48239af6ad9cc821137893344363a25675c82dde31afd1ab0488e819182897316eb6946bb85d7b8e5093fd8bbf82a9097699952bece4_0", "is_ignored": false, "lines": "      __n = (int)pcVar2 - (int)param_1;", "message": "The software uses a signed primitive and performs a cast to an unsigned primitive, or uses an unsigned primitive and performs a cast to a signed primitive, which can produce an unexpected value. When the result of a function is to be used as a size parameter, using negative return values can have unexpected results. Although less frequent an issue, unsigned-to-signed conversion can be  the precursor to buffer underwrite conditions. Buffer underwrites  occur frequently when large unsigned values are cast to signed values,  and then used as indexes into a buffer or for pointer arithmetic.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "LOW", "references": ["https://cwe.mitre.org/data/definitions/195", "https://cwe.mitre.org/data/definitions/196", "https://cwe.mitre.org/data/definitions/194", "https://cwe.mitre.org/data/definitions/191", "https://cwe.mitre.org/data/definitions/681", "https://cwe.mitre.org/data/definitions/789", "https://g.co/kgs/PCHQjJ", "https://github.com/struct/mms", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "http://www.phrack.org/issues/60/10.html#article", "https://docs.microsoft.com/en-us/cpp/sanitizers/asan-error-examples"]}, "metavars": {"$SIGNED": {"abstract_content": "int pcVar2", "end": {"col": 24, "line": 19, "offset": 354}, "start": {"col": 14, "line": 19, "offset": 344}}, "$UNSIGNED": {"abstract_content": "__n", "end": {"col": 10, "line": 19, "offset": 340}, "start": {"col": 7, "line": 19, "offset": 337}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/getnext_00401f5c.c", "start": {"col": 7, "line": 19, "offset": 337}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-pointer-subtraction", "end": {"col": 39, "line": 19, "offset": 369}, "extra": {"engine_kind": "OSS", "fingerprint": "1dfa4e1d82565f2dc889ee5a11c40ca0e2a78aba9b0ed95efddc9bba4ef10b8cbaae0df9b98db82041e26e824d065d9d7bb1a1f457a6d1f5f653cbff4a6c033d_0", "is_ignored": false, "lines": "      __n = (int)pcVar2 - (int)param_1;", "message": "The software subtracts one pointer from another in order to determine size, but this calculation can be incorrect if the pointers do not exist in the same memory chunk.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://cwe.mitre.org/data/definitions/469", "https://github.com/struct/mms"]}, "metavars": {"$PTR1": {"abstract_content": "pcVar2", "end": {"col": 24, "line": 19, "offset": 354}, "propagated_value": {"svalue_abstract_content": "strchr(param_1 param_2)", "svalue_end": {"col": 37, "line": 13, "offset": 230}, "svalue_start": {"col": 14, "line": 13, "offset": 207}}, "start": {"col": 18, "line": 19, "offset": 348}}, "$PTR2": {"abstract_content": "param_1", "end": {"col": 39, "line": 19, "offset": 369}, "start": {"col": 32, "line": 19, "offset": 362}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/getnext_00401f5c.c", "start": {"col": 14, "line": 19, "offset": 344}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 35, "line": 20, "offset": 405}, "extra": {"engine_kind": "OSS", "fingerprint": "8f2198c75b5f5d644135909cb5262ac976259cbd90e8ac986ada8c6b8a1ef11f3f445abdc189ef8bd113814b6f7862cf041988e6320c8438568b1036c81ababf_0", "is_ignored": false, "lines": "      strncpy(param_3,param_1,__n);", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "strncpy", "end": {"col": 14, "line": 20, "offset": 384}, "start": {"col": 7, "line": 20, "offset": 377}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/getnext_00401f5c.c", "start": {"col": 7, "line": 20, "offset": 377}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-signed-unsigned-conversion", "end": {"col": 22, "line": 22, "offset": 455}, "extra": {"engine_kind": "OSS", "fingerprint": "f0d5af38966912b81e948c254add8d3d5daca4367fd5bdfb8999d71b0f3da3c58a3492d1f48b905793181a37330335ef96955a47ba30fe291d2f3a9398d06a9a_0", "is_ignored": false, "lines": "      iVar1 = __n + 1;", "message": "The software uses a signed primitive and performs a cast to an unsigned primitive, or uses an unsigned primitive and performs a cast to a signed primitive, which can produce an unexpected value. When the result of a function is to be used as a size parameter, using negative return values can have unexpected results. Although less frequent an issue, unsigned-to-signed conversion can be  the precursor to buffer underwrite conditions. Buffer underwrites  occur frequently when large unsigned values are cast to signed values,  and then used as indexes into a buffer or for pointer arithmetic.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "LOW", "references": ["https://cwe.mitre.org/data/definitions/195", "https://cwe.mitre.org/data/definitions/196", "https://cwe.mitre.org/data/definitions/194", "https://cwe.mitre.org/data/definitions/191", "https://cwe.mitre.org/data/definitions/681", "https://cwe.mitre.org/data/definitions/789", "https://g.co/kgs/PCHQjJ", "https://github.com/struct/mms", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "http://www.phrack.org/issues/60/10.html#article", "https://docs.microsoft.com/en-us/cpp/sanitizers/asan-error-examples"]}, "metavars": {"$SIGNED": {"abstract_content": "iVar1", "end": {"col": 12, "line": 22, "offset": 445}, "start": {"col": 7, "line": 22, "offset": 440}}, "$UNSIGNED": {"abstract_content": "__n", "end": {"col": 18, "line": 22, "offset": 451}, "propagated_value": {"svalue_abstract_content": "int pcVar2-int param_1", "svalue_end": {"col": 39, "line": 19, "offset": 369}, "svalue_start": {"col": 14, "line": 19, "offset": 344}}, "start": {"col": 15, "line": 22, "offset": 448}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/getnext_00401f5c.c", "start": {"col": 7, "line": 22, "offset": 440}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 26, "line": 7, "offset": 73}, "extra": {"engine_kind": "OSS", "fingerprint": "d90aa231b3248bef502c606c1a1d0926bcc8d69dbe7740b681c5dcd6442aa857aa657f99329e23a44b791db09c0db6a08b8e706b725aae0c4c90a8f093564bca_0", "is_ignored": false, "lines": "  reg_read(0x18,local_10);", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "reg_read", "end": {"col": 11, "line": 7, "offset": 58}, "start": {"col": 3, "line": 7, "offset": 50}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/igmp_off_0040c0d8.c", "start": {"col": 3, "line": 7, "offset": 50}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 30, "line": 22, "offset": 629}, "extra": {"engine_kind": "OSS", "fingerprint": "666bea6e1117be8365a20e09d59668bc9e4f1c02ee040d05675d563fb75c2615002cd62b832c483ef808424992c92452e9f4cde1234ca16dc195016ac714d1ad_0", "is_ignored": false, "lines": "    reg_read(0x2410,local_10);", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "reg_read", "end": {"col": 13, "line": 22, "offset": 612}, "start": {"col": 5, "line": 22, "offset": 604}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/igmp_on_0040b8a8.c", "start": {"col": 5, "line": 22, "offset": 604}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 30, "line": 24, "offset": 699}, "extra": {"engine_kind": "OSS", "fingerprint": "666bea6e1117be8365a20e09d59668bc9e4f1c02ee040d05675d563fb75c2615002cd62b832c483ef808424992c92452e9f4cde1234ca16dc195016ac714d1ad_1", "is_ignored": false, "lines": "    reg_read(0x2010,local_10);", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "reg_read", "end": {"col": 13, "line": 24, "offset": 682}, "start": {"col": 5, "line": 24, "offset": 674}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/igmp_on_0040b8a8.c", "start": {"col": 5, "line": 24, "offset": 674}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 26, "line": 31, "offset": 855}, "extra": {"engine_kind": "OSS", "fingerprint": "666bea6e1117be8365a20e09d59668bc9e4f1c02ee040d05675d563fb75c2615002cd62b832c483ef808424992c92452e9f4cde1234ca16dc195016ac714d1ad_2", "is_ignored": false, "lines": "  reg_read(0x10,local_10);", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "reg_read", "end": {"col": 11, "line": 31, "offset": 840}, "start": {"col": 3, "line": 31, "offset": 832}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/igmp_on_0040b8a8.c", "start": {"col": 3, "line": 31, "offset": 832}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 29, "line": 42, "offset": 1227}, "extra": {"engine_kind": "OSS", "fingerprint": "666bea6e1117be8365a20e09d59668bc9e4f1c02ee040d05675d563fb75c2615002cd62b832c483ef808424992c92452e9f4cde1234ca16dc195016ac714d1ad_3", "is_ignored": false, "lines": "    reg_read(iVar1,local_10);", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "reg_read", "end": {"col": 13, "line": 42, "offset": 1211}, "start": {"col": 5, "line": 42, "offset": 1203}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/igmp_on_0040b8a8.c", "start": {"col": 5, "line": 42, "offset": 1203}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 77, "line": 87, "offset": 2480}, "extra": {"engine_kind": "OSS", "fingerprint": "c4ca2d5f75808b72b14c0bd6c923a6a020da3fd537d0052c95fcce147f4ae7785c21731ad6138fed7b610d8adff86dd2835bdbcce440f08ca544f8f7f0f6d3e3_0", "is_ignored": false, "lines": "  system(\"echo 2 > /sys/devices/virtual/net/br0/brif/eth0/multicast_router\");", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "system", "end": {"col": 9, "line": 87, "offset": 2412}, "start": {"col": 3, "line": 87, "offset": 2406}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/igmp_on_0040b8a8.c", "start": {"col": 3, "line": 87, "offset": 2406}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 31, "line": 8, "offset": 242}, "extra": {"engine_kind": "OSS", "fingerprint": "23a92cc136c7c3755753d7cf18423559e6a58c7726b3725562a3984b070fe1fb3a9d88250a50602adf017975d446d43dd9a29915c80cf55692686bd97adf4a76_0", "is_ignored": false, "lines": "  sprintf(param_1,\"%d.%d.%d.%d\",param_2 >> 0x18,param_2 >> 0x10 & 0xff,param_2 >> 8 & 0xff,\n          param_2 & 0xff,&_gp);", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "sprintf", "end": {"col": 10, "line": 7, "offset": 129}, "start": {"col": 3, "line": 7, "offset": 122}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/ip_to_str_004021f8.c", "start": {"col": 3, "line": 7, "offset": 122}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 40, "line": 42, "offset": 874}, "extra": {"engine_kind": "OSS", "fingerprint": "aed8d8a249020ecad918fee4383e65dd53ae1940f976f0b5caa733a1a48a715a0b932ab2edbe9afb253444ea22b06bfeaf37aab428b261b50ba6baf667b5449f_0", "is_ignored": false, "lines": "        mii_read(uVar3,uVar4,&local_30);", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "mii_read", "end": {"col": 17, "line": 42, "offset": 851}, "start": {"col": 9, "line": 42, "offset": 843}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/main_0040ceac.c", "start": {"col": 9, "line": 42, "offset": 843}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 36, "line": 63, "offset": 1533}, "extra": {"engine_kind": "OSS", "fingerprint": "aed8d8a249020ecad918fee4383e65dd53ae1940f976f0b5caa733a1a48a715a0b932ab2edbe9afb253444ea22b06bfeaf37aab428b261b50ba6baf667b5449f_1", "is_ignored": false, "lines": "        mii_read(uVar3,0,&local_2c);", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "mii_read", "end": {"col": 17, "line": 63, "offset": 1514}, "start": {"col": 9, "line": 63, "offset": 1506}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/main_0040ceac.c", "start": {"col": 9, "line": 63, "offset": 1506}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 38, "line": 92, "offset": 2500}, "extra": {"engine_kind": "OSS", "fingerprint": "aed8d8a249020ecad918fee4383e65dd53ae1940f976f0b5caa733a1a48a715a0b932ab2edbe9afb253444ea22b06bfeaf37aab428b261b50ba6baf667b5449f_2", "is_ignored": false, "lines": "          mii_read(uVar3,0,&local_28);", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "mii_read", "end": {"col": 19, "line": 92, "offset": 2481}, "start": {"col": 11, "line": 92, "offset": 2473}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/main_0040ceac.c", "start": {"col": 11, "line": 92, "offset": 2473}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 62, "line": 176, "offset": 5466}, "extra": {"engine_kind": "OSS", "fingerprint": "262c1bf960eab7ac0044bda4183707f19184aa168c109baabf5d15c7326ae832d389642d56ec286e193c65085ae0f0959a6d02cb56a19f4c6c59b8d7098d3581_0", "is_ignored": false, "lines": "                reg_read(local_88 * 0x100 + 0x3008,&local_24);", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "reg_read", "end": {"col": 25, "line": 176, "offset": 5429}, "start": {"col": 17, "line": 176, "offset": 5421}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/main_0040ceac.c", "start": {"col": 17, "line": 176, "offset": 5421}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 64, "line": 491, "offset": 19560}, "extra": {"engine_kind": "OSS", "fingerprint": "262c1bf960eab7ac0044bda4183707f19184aa168c109baabf5d15c7326ae832d389642d56ec286e193c65085ae0f0959a6d02cb56a19f4c6c59b8d7098d3581_1", "is_ignored": false, "lines": "                                      reg_read(uVar3,&local_20);", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "reg_read", "end": {"col": 47, "line": 491, "offset": 19543}, "start": {"col": 39, "line": 491, "offset": 19535}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/main_0040ceac.c", "start": {"col": 39, "line": 491, "offset": 19535}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 100, "line": 510, "offset": 20963}, "extra": {"engine_kind": "OSS", "fingerprint": "262c1bf960eab7ac0044bda4183707f19184aa168c109baabf5d15c7326ae832d389642d56ec286e193c65085ae0f0959a6d02cb56a19f4c6c59b8d7098d3581_2", "is_ignored": false, "lines": "                                          reg_read((local_90 * 4 + local_8c) * 4 + uVar3,&local_20);", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "reg_read", "end": {"col": 51, "line": 510, "offset": 20914}, "start": {"col": 43, "line": 510, "offset": 20906}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/main_0040ceac.c", "start": {"col": 43, "line": 510, "offset": 20906}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 70, "line": 610, "offset": 27771}, "extra": {"engine_kind": "OSS", "fingerprint": "262c1bf960eab7ac0044bda4183707f19184aa168c109baabf5d15c7326ae832d389642d56ec286e193c65085ae0f0959a6d02cb56a19f4c6c59b8d7098d3581_3", "is_ignored": false, "lines": "                                            reg_read(iVar2,&local_14);", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "reg_read", "end": {"col": 53, "line": 610, "offset": 27754}, "start": {"col": 45, "line": 610, "offset": 27746}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/main_0040ceac.c", "start": {"col": 45, "line": 610, "offset": 27746}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 71, "line": 632, "offset": 29326}, "extra": {"engine_kind": "OSS", "fingerprint": "262c1bf960eab7ac0044bda4183707f19184aa168c109baabf5d15c7326ae832d389642d56ec286e193c65085ae0f0959a6d02cb56a19f4c6c59b8d7098d3581_4", "is_ignored": false, "lines": "                                              reg_read(iVar2,local_10);", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "reg_read", "end": {"col": 55, "line": 632, "offset": 29310}, "start": {"col": 47, "line": 632, "offset": 29302}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/main_0040ceac.c", "start": {"col": 47, "line": 632, "offset": 29302}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 51, "line": 14, "offset": 296}, "extra": {"engine_kind": "OSS", "fingerprint": "a6e5863c950915f6792adbb1a6afa81326de6d3c2b87f3d7c7a549eab6e4637a612c364f691ee76a80b69086d4965b99759d01776fefdeb239ce78c355463c90_0", "is_ignored": false, "lines": "    local_10 = mii_mgr_cl45_read(uVar1,0x1e,0x145);", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "mii_mgr_cl45_read", "end": {"col": 33, "line": 14, "offset": 278}, "start": {"col": 16, "line": 14, "offset": 261}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/phy_crossover_0040cbc8.c", "start": {"col": 16, "line": 14, "offset": 261}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 29, "line": 20, "offset": 534}, "extra": {"engine_kind": "OSS", "fingerprint": "acb5dd2142de94d04dd35ca391a87519f67e47a73f67a414faf11d29e1663a800975291fb31b72fdf086008324136635db523aa4b7e25cf880d923a2c82c2024_0", "is_ignored": false, "lines": "    reg_read(uVar3,&local_c);", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "reg_read", "end": {"col": 13, "line": 20, "offset": 518}, "start": {"col": 5, "line": 20, "offset": 510}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/set_mirror_from_0040aba0.c", "start": {"col": 5, "line": 20, "offset": 510}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 28, "line": 13, "offset": 296}, "extra": {"engine_kind": "OSS", "fingerprint": "d6dd0cb75924e6cca42cc8d5b5d7af2de3ee320ec7b01892b815b3a733faaec8da83090c0363cd9c1c7f97536ec9c65dda228ff63f574292bfd0a5895f01ce63_0", "is_ignored": false, "lines": "    reg_read(0x10,&local_c);", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "reg_read", "end": {"col": 13, "line": 13, "offset": 281}, "start": {"col": 5, "line": 13, "offset": 273}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/set_mirror_to_0040aa70.c", "start": {"col": 5, "line": 13, "offset": 273}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-signed-unsigned-conversion", "end": {"col": 85, "line": 17, "offset": 569}, "extra": {"engine_kind": "OSS", "fingerprint": "f261f4deaae43859b589f346694dfc3b511ad8616259ec16de00735cdd05d622b6e6b7d4b086eb77bef2a8ebf319550b7aab46581a82816727cb23971e2fe5a3_0", "is_ignored": false, "lines": "  if ((*(int *)(param_2 + 0x14) == 0) || (sVar1 = strlen(*(char **)(param_2 + 0x14)), sVar1 != 8)) {", "message": "The software uses a signed primitive and performs a cast to an unsigned primitive, or uses an unsigned primitive and performs a cast to a signed primitive, which can produce an unexpected value. When the result of a function is to be used as a size parameter, using negative return values can have unexpected results. Although less frequent an issue, unsigned-to-signed conversion can be  the precursor to buffer underwrite conditions. Buffer underwrites  occur frequently when large unsigned values are cast to signed values,  and then used as indexes into a buffer or for pointer arithmetic.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "LOW", "references": ["https://cwe.mitre.org/data/definitions/195", "https://cwe.mitre.org/data/definitions/196", "https://cwe.mitre.org/data/definitions/194", "https://cwe.mitre.org/data/definitions/191", "https://cwe.mitre.org/data/definitions/681", "https://cwe.mitre.org/data/definitions/789", "https://g.co/kgs/PCHQjJ", "https://github.com/struct/mms", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "http://www.phrack.org/issues/60/10.html#article", "https://docs.microsoft.com/en-us/cpp/sanitizers/asan-error-examples"]}, "metavars": {"$SIGNED": {"abstract_content": "param_2", "end": {"col": 76, "line": 17, "offset": 560}, "start": {"col": 69, "line": 17, "offset": 553}}, "$UNSIGNED": {"abstract_content": "sVar1", "end": {"col": 48, "line": 17, "offset": 532}, "start": {"col": 43, "line": 17, "offset": 527}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/sip_add_00407bd4.c", "start": {"col": 43, "line": 17, "offset": 527}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 28, "line": 34, "offset": 1220}, "extra": {"engine_kind": "OSS", "fingerprint": "25c6b707ac0f783b7231b6dcea76074fcc4e7c402b5b36c3f217b5c03580f0a8f2afd616fe7472d75773ec5cbf920592011a5fcb6d378e816e54ed51e69e5c67_0", "is_ignored": false, "lines": "    reg_read(0x7c,local_18);", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "reg_read", "end": {"col": 13, "line": 34, "offset": 1205}, "start": {"col": 5, "line": 34, "offset": 1197}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/sip_add_00407bd4.c", "start": {"col": 5, "line": 34, "offset": 1197}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 30, "line": 40, "offset": 1449}, "extra": {"engine_kind": "OSS", "fingerprint": "25c6b707ac0f783b7231b6dcea76074fcc4e7c402b5b36c3f217b5c03580f0a8f2afd616fe7472d75773ec5cbf920592011a5fcb6d378e816e54ed51e69e5c67_1", "is_ignored": false, "lines": "      reg_read(0x80,local_18);", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "reg_read", "end": {"col": 15, "line": 40, "offset": 1434}, "start": {"col": 7, "line": 40, "offset": 1426}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/sip_add_00407bd4.c", "start": {"col": 7, "line": 40, "offset": 1426}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 26, "line": 9, "offset": 214}, "extra": {"engine_kind": "OSS", "fingerprint": "70fcd43228a1ecc574e0ec50e8c17f9556218dd57c9209ac73686136cf319e5bd7d186fc4c1f59f7a80681c54fcc9b9a28e47f9c6ffa0a84786a3085262fdc00_0", "is_ignored": false, "lines": "  reg_read(0x80,local_10);", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "reg_read", "end": {"col": 11, "line": 9, "offset": 199}, "start": {"col": 3, "line": 9, "offset": 191}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/sip_clear_004081fc.c", "start": {"col": 3, "line": 9, "offset": 191}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 28, "line": 24, "offset": 523}, "extra": {"engine_kind": "OSS", "fingerprint": "8815291efccd84723337ba2550e628d8029ab745bb206a683c9f295aab86c27049520f09e4d183d8fdfa6d49ff707c156bdc18131c6a5d7f76310cc52b2394b2_0", "is_ignored": false, "lines": "    reg_read(0x80,local_1c);", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "reg_read", "end": {"col": 13, "line": 24, "offset": 508}, "start": {"col": 5, "line": 24, "offset": 500}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/sip_del_0040800c.c", "start": {"col": 5, "line": 24, "offset": 500}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 69, "line": 19, "offset": 461}, "extra": {"engine_kind": "OSS", "fingerprint": "3d0fdd92a5b731d16d3ff1aec70bec93629f27da08ddf8c8348676b55e95a4065486ad63938d44a0e1c1a140bdef498a59e5d53aec820dbb9734900b5dd66f74_0", "is_ignored": false, "lines": "    reg_read((local_70 + 0x40) * 4,&local_68,param_3,param_4,puVar4);", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "reg_read", "end": {"col": 13, "line": 19, "offset": 405}, "start": {"col": 5, "line": 19, "offset": 397}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/sip_dump_0040765c.c", "start": {"col": 5, "line": 19, "offset": 397}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 36, "line": 30, "offset": 795}, "extra": {"engine_kind": "OSS", "fingerprint": "3d0fdd92a5b731d16d3ff1aec70bec93629f27da08ddf8c8348676b55e95a4065486ad63938d44a0e1c1a140bdef498a59e5d53aec820dbb9734900b5dd66f74_1", "is_ignored": false, "lines": "    while (reg_read(0x80,&local_68), (local_68 & 0x2000) == 0) {", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "reg_read", "end": {"col": 20, "line": 30, "offset": 779}, "start": {"col": 12, "line": 30, "offset": 771}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/sip_dump_0040765c.c", "start": {"col": 12, "line": 30, "offset": 771}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 29, "line": 37, "offset": 1007}, "extra": {"engine_kind": "OSS", "fingerprint": "3d0fdd92a5b731d16d3ff1aec70bec93629f27da08ddf8c8348676b55e95a4065486ad63938d44a0e1c1a140bdef498a59e5d53aec820dbb9734900b5dd66f74_2", "is_ignored": false, "lines": "    reg_read(0x8c,&local_5c);", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "reg_read", "end": {"col": 13, "line": 37, "offset": 991}, "start": {"col": 5, "line": 37, "offset": 983}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/sip_dump_0040765c.c", "start": {"col": 5, "line": 37, "offset": 983}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 29, "line": 89, "offset": 1908}, "extra": {"engine_kind": "OSS", "fingerprint": "3d0fdd92a5b731d16d3ff1aec70bec93629f27da08ddf8c8348676b55e95a4065486ad63938d44a0e1c1a140bdef498a59e5d53aec820dbb9734900b5dd66f74_3", "is_ignored": false, "lines": "    reg_read(0x88,&local_60);", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "reg_read", "end": {"col": 13, "line": 89, "offset": 1892}, "start": {"col": 5, "line": 89, "offset": 1884}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/sip_dump_0040765c.c", "start": {"col": 5, "line": 89, "offset": 1884}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 29, "line": 92, "offset": 2006}, "extra": {"engine_kind": "OSS", "fingerprint": "3d0fdd92a5b731d16d3ff1aec70bec93629f27da08ddf8c8348676b55e95a4065486ad63938d44a0e1c1a140bdef498a59e5d53aec820dbb9734900b5dd66f74_4", "is_ignored": false, "lines": "    reg_read(0x84,&local_64);", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "reg_read", "end": {"col": 13, "line": 92, "offset": 1990}, "start": {"col": 5, "line": 92, "offset": 1982}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/sip_dump_0040765c.c", "start": {"col": 5, "line": 92, "offset": 1982}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-integer-truncation", "end": {"col": 34, "line": 17, "offset": 298}, "extra": {"engine_kind": "OSS", "fingerprint": "b49cfcfdac888cdc4852fd712321812b0ce38af4c40eb8cfdb8b6e54d8b1d78f464af97e0ea9e0190dde83e7b9e2ebbad7d497d0465575b07961274d036dd561_0", "is_ignored": false, "lines": "  cVar1 = **(char **)(param_2 + 4);", "message": "Truncation errors occur when a primitive is cast to a primitive of a  smaller size and data is lost in the conversion. The value cannot be  trusted and the application will be in an undefined state.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://cwe.mitre.org/data/definitions/197", "https://cwe.mitre.org/data/definitions/681", "https://g.co/kgs/PCHQjJ", "https://github.com/struct/mms"]}, "metavars": {"$LARGE": {"abstract_content": "param_2", "end": {"col": 30, "line": 17, "offset": 294}, "start": {"col": 23, "line": 17, "offset": 287}}, "$NARROW": {"abstract_content": "cVar1", "end": {"col": 8, "line": 17, "offset": 272}, "start": {"col": 3, "line": 17, "offset": 267}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/table_add_004089a0.c", "start": {"col": 3, "line": 17, "offset": 267}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-signed-unsigned-conversion", "end": {"col": 79, "line": 18, "offset": 379}, "extra": {"engine_kind": "OSS", "fingerprint": "8913c5789a5db447c4415f0104856bd2b778b673c6d3c8f6c899938cbf7c9ec98bee7d7788ea2b8cd5a1bed210145ec43f24763a222e0db092d2d5bd19c7e42c_0", "is_ignored": false, "lines": "  if ((*(int *)(param_2 + 8) == 0) || (sVar3 = strlen(*(char **)(param_2 + 8)), sVar3 != 0xc)) {", "message": "The software uses a signed primitive and performs a cast to an unsigned primitive, or uses an unsigned primitive and performs a cast to a signed primitive, which can produce an unexpected value. When the result of a function is to be used as a size parameter, using negative return values can have unexpected results. Although less frequent an issue, unsigned-to-signed conversion can be  the precursor to buffer underwrite conditions. Buffer underwrites  occur frequently when large unsigned values are cast to signed values,  and then used as indexes into a buffer or for pointer arithmetic.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "LOW", "references": ["https://cwe.mitre.org/data/definitions/195", "https://cwe.mitre.org/data/definitions/196", "https://cwe.mitre.org/data/definitions/194", "https://cwe.mitre.org/data/definitions/191", "https://cwe.mitre.org/data/definitions/681", "https://cwe.mitre.org/data/definitions/789", "https://g.co/kgs/PCHQjJ", "https://github.com/struct/mms", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "http://www.phrack.org/issues/60/10.html#article", "https://docs.microsoft.com/en-us/cpp/sanitizers/asan-error-examples"]}, "metavars": {"$SIGNED": {"abstract_content": "param_2", "end": {"col": 73, "line": 18, "offset": 373}, "start": {"col": 66, "line": 18, "offset": 366}}, "$UNSIGNED": {"abstract_content": "sVar3", "end": {"col": 45, "line": 18, "offset": 345}, "start": {"col": 40, "line": 18, "offset": 340}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/table_add_004089a0.c", "start": {"col": 40, "line": 18, "offset": 340}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 50, "line": 22, "offset": 522}, "extra": {"engine_kind": "OSS", "fingerprint": "cecc9bf9dd059bc88f073fd0c9123b79012e13e79833a4249548b9229f8907bbd3c0661e53605e9e8d9b3fd6dd7a139197cdf4f23d7c964a09bb0431123212bf_0", "is_ignored": false, "lines": "    strncpy(acStack_14,*(char **)(param_2 + 8),8);", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "strncpy", "end": {"col": 12, "line": 22, "offset": 484}, "start": {"col": 5, "line": 22, "offset": 477}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/table_add_004089a0.c", "start": {"col": 5, "line": 22, "offset": 477}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-signed-unsigned-conversion", "end": {"col": 50, "line": 22, "offset": 522}, "extra": {"engine_kind": "OSS", "fingerprint": "d2d8ad026f848f7996c8c1f24874b9c7137c36896692658f3334105af0e839c388a0f3f394dea299b7a3fb30c806e2bbfe77a5abdb6bb772d31f14848faff40f_0", "is_ignored": false, "lines": "    strncpy(acStack_14,*(char **)(param_2 + 8),8);", "message": "The software uses a signed primitive and performs a cast to an unsigned primitive, or uses an unsigned primitive and performs a cast to a signed primitive, which can produce an unexpected value. When the result of a function is to be used as a size parameter, using negative return values can have unexpected results. Although less frequent an issue, unsigned-to-signed conversion can be  the precursor to buffer underwrite conditions. Buffer underwrites  occur frequently when large unsigned values are cast to signed values,  and then used as indexes into a buffer or for pointer arithmetic.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "LOW", "references": ["https://cwe.mitre.org/data/definitions/195", "https://cwe.mitre.org/data/definitions/196", "https://cwe.mitre.org/data/definitions/194", "https://cwe.mitre.org/data/definitions/191", "https://cwe.mitre.org/data/definitions/681", "https://cwe.mitre.org/data/definitions/789", "https://g.co/kgs/PCHQjJ", "https://github.com/struct/mms", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "http://www.phrack.org/issues/60/10.html#article", "https://docs.microsoft.com/en-us/cpp/sanitizers/asan-error-examples"]}, "metavars": {"$DST": {"abstract_content": "acStack_14", "end": {"col": 23, "line": 22, "offset": 495}, "start": {"col": 13, "line": 22, "offset": 485}}, "$LEN": {"abstract_content": "8", "end": {"col": 49, "line": 22, "offset": 521}, "start": {"col": 48, "line": 22, "offset": 520}}, "$SRC": {"abstract_content": "*char**param_2+8", "end": {"col": 46, "line": 22, "offset": 518}, "start": {"col": 24, "line": 22, "offset": 496}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/table_add_004089a0.c", "start": {"col": 5, "line": 22, "offset": 477}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-unterminated-string-strncpy-stpncpy", "end": {"col": 50, "line": 22, "offset": 522}, "extra": {"engine_kind": "OSS", "fingerprint": "49ae844b88491385b0dd45c684534cd034edf274e0bc51e34cdb5cd1ea2cfe2049d716aa1e5795b0a8e897175fe05415e683623365488af0854f7762d1c2a66b_0", "is_ignored": false, "lines": "    strncpy(acStack_14,*(char **)(param_2 + 8),8);", "message": "If there is no NUL character byte in the first n bytes of the source string, strncpy() and stpncpy() do not NUL-terminate the destination buffer. If the program does not explicitly terminate the destination buffer, this will almost certainly result in information disclosure, and possibly a buffer overflow condition.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://cwe.mitre.org/data/definitions/170", "https://cwe.mitre.org/data/definitions/126", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf"]}, "metavars": {"$FUN": {"abstract_content": "strncpy", "end": {"col": 12, "line": 22, "offset": 484}, "start": {"col": 5, "line": 22, "offset": 477}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/table_add_004089a0.c", "start": {"col": 5, "line": 22, "offset": 477}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 62, "line": 27, "offset": 742}, "extra": {"engine_kind": "OSS", "fingerprint": "cecc9bf9dd059bc88f073fd0c9123b79012e13e79833a4249548b9229f8907bbd3c0661e53605e9e8d9b3fd6dd7a139197cdf4f23d7c964a09bb0431123212bf_1", "is_ignored": false, "lines": "    strncpy(acStack_14,(char *)(*(int *)(param_2 + 8) + 8),4);", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "strncpy", "end": {"col": 12, "line": 27, "offset": 692}, "start": {"col": 5, "line": 27, "offset": 685}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/table_add_004089a0.c", "start": {"col": 5, "line": 27, "offset": 685}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-signed-unsigned-conversion", "end": {"col": 62, "line": 27, "offset": 742}, "extra": {"engine_kind": "OSS", "fingerprint": "5f94b6d67b6ef507aea9bc2674b120d63058f786a7e3a06ae0446ea6ca39fb1e3cec88c8b0f0c6643f74c7877aaf5196e7383dc6e3ba35c649d08328ccac4162_0", "is_ignored": false, "lines": "    strncpy(acStack_14,(char *)(*(int *)(param_2 + 8) + 8),4);", "message": "The software uses a signed primitive and performs a cast to an unsigned primitive, or uses an unsigned primitive and performs a cast to a signed primitive, which can produce an unexpected value. When the result of a function is to be used as a size parameter, using negative return values can have unexpected results. Although less frequent an issue, unsigned-to-signed conversion can be  the precursor to buffer underwrite conditions. Buffer underwrites  occur frequently when large unsigned values are cast to signed values,  and then used as indexes into a buffer or for pointer arithmetic.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "LOW", "references": ["https://cwe.mitre.org/data/definitions/195", "https://cwe.mitre.org/data/definitions/196", "https://cwe.mitre.org/data/definitions/194", "https://cwe.mitre.org/data/definitions/191", "https://cwe.mitre.org/data/definitions/681", "https://cwe.mitre.org/data/definitions/789", "https://g.co/kgs/PCHQjJ", "https://github.com/struct/mms", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "http://www.phrack.org/issues/60/10.html#article", "https://docs.microsoft.com/en-us/cpp/sanitizers/asan-error-examples"]}, "metavars": {"$DST": {"abstract_content": "acStack_14", "end": {"col": 23, "line": 27, "offset": 703}, "start": {"col": 13, "line": 27, "offset": 693}}, "$LEN": {"abstract_content": "4", "end": {"col": 61, "line": 27, "offset": 741}, "start": {"col": 60, "line": 27, "offset": 740}}, "$SRC": {"abstract_content": "char**int*param_2+8+8", "end": {"col": 58, "line": 27, "offset": 738}, "start": {"col": 25, "line": 27, "offset": 705}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/table_add_004089a0.c", "start": {"col": 5, "line": 27, "offset": 685}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-unterminated-string-strncpy-stpncpy", "end": {"col": 62, "line": 27, "offset": 742}, "extra": {"engine_kind": "OSS", "fingerprint": "49ae844b88491385b0dd45c684534cd034edf274e0bc51e34cdb5cd1ea2cfe2049d716aa1e5795b0a8e897175fe05415e683623365488af0854f7762d1c2a66b_1", "is_ignored": false, "lines": "    strncpy(acStack_14,(char *)(*(int *)(param_2 + 8) + 8),4);", "message": "If there is no NUL character byte in the first n bytes of the source string, strncpy() and stpncpy() do not NUL-terminate the destination buffer. If the program does not explicitly terminate the destination buffer, this will almost certainly result in information disclosure, and possibly a buffer overflow condition.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://cwe.mitre.org/data/definitions/170", "https://cwe.mitre.org/data/definitions/126", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf"]}, "metavars": {"$FUN": {"abstract_content": "strncpy", "end": {"col": 12, "line": 27, "offset": 692}, "start": {"col": 5, "line": 27, "offset": 685}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/table_add_004089a0.c", "start": {"col": 5, "line": 27, "offset": 685}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-signed-unsigned-conversion", "end": {"col": 85, "line": 41, "offset": 1261}, "extra": {"engine_kind": "OSS", "fingerprint": "8913c5789a5db447c4415f0104856bd2b778b673c6d3c8f6c899938cbf7c9ec98bee7d7788ea2b8cd5a1bed210145ec43f24763a222e0db092d2d5bd19c7e42c_1", "is_ignored": false, "lines": "    if ((*(int *)(param_2 + 0xc) == 0) || (sVar3 = strlen(*(char **)(param_2 + 0xc)), sVar3 != 8)) {", "message": "The software uses a signed primitive and performs a cast to an unsigned primitive, or uses an unsigned primitive and performs a cast to a signed primitive, which can produce an unexpected value. When the result of a function is to be used as a size parameter, using negative return values can have unexpected results. Although less frequent an issue, unsigned-to-signed conversion can be  the precursor to buffer underwrite conditions. Buffer underwrites  occur frequently when large unsigned values are cast to signed values,  and then used as indexes into a buffer or for pointer arithmetic.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "LOW", "references": ["https://cwe.mitre.org/data/definitions/195", "https://cwe.mitre.org/data/definitions/196", "https://cwe.mitre.org/data/definitions/194", "https://cwe.mitre.org/data/definitions/191", "https://cwe.mitre.org/data/definitions/681", "https://cwe.mitre.org/data/definitions/789", "https://g.co/kgs/PCHQjJ", "https://github.com/struct/mms", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "http://www.phrack.org/issues/60/10.html#article", "https://docs.microsoft.com/en-us/cpp/sanitizers/asan-error-examples"]}, "metavars": {"$SIGNED": {"abstract_content": "param_2", "end": {"col": 77, "line": 41, "offset": 1253}, "start": {"col": 70, "line": 41, "offset": 1246}}, "$UNSIGNED": {"abstract_content": "sVar3", "end": {"col": 49, "line": 41, "offset": 1225}, "start": {"col": 44, "line": 41, "offset": 1220}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/table_add_004089a0.c", "start": {"col": 44, "line": 41, "offset": 1220}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 29, "line": 86, "offset": 2679}, "extra": {"engine_kind": "OSS", "fingerprint": "19d0703344a570c96b9e0fede2b736fa98cd4bd911285356892671e0f367d63c41fa2f5f37401242307fcb348b6c83c45615fcbe676f5f849d3d28441f938498_0", "is_ignored": false, "lines": "    reg_read(0x7c,&local_18);", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "reg_read", "end": {"col": 13, "line": 86, "offset": 2663}, "start": {"col": 5, "line": 86, "offset": 2655}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/table_add_004089a0.c", "start": {"col": 5, "line": 86, "offset": 2655}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 31, "line": 92, "offset": 2903}, "extra": {"engine_kind": "OSS", "fingerprint": "19d0703344a570c96b9e0fede2b736fa98cd4bd911285356892671e0f367d63c41fa2f5f37401242307fcb348b6c83c45615fcbe676f5f849d3d28441f938498_1", "is_ignored": false, "lines": "      reg_read(0x80,&local_18);", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "reg_read", "end": {"col": 15, "line": 92, "offset": 2887}, "start": {"col": 7, "line": 92, "offset": 2879}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/table_add_004089a0.c", "start": {"col": 7, "line": 92, "offset": 2879}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 26, "line": 9, "offset": 216}, "extra": {"engine_kind": "OSS", "fingerprint": "184a824b2a3a04736ad355d23df9f25bbd5b675a0b6751b6c98b2360af1729e75c33ded3b990fe27e5d1de0299bae9c777166511a1e454ff05cadc2df327c05d_0", "is_ignored": false, "lines": "  reg_read(0x80,local_10);", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "reg_read", "end": {"col": 11, "line": 9, "offset": 201}, "start": {"col": 3, "line": 9, "offset": 193}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/table_clear_0040a9c8.c", "start": {"col": 3, "line": 9, "offset": 193}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-signed-unsigned-conversion", "end": {"col": 83, "line": 13, "offset": 263}, "extra": {"engine_kind": "OSS", "fingerprint": "439d13883227bd1f4301d40cc5e4fa869a5fea0a7f1ed3d4d87a66112d69ff3ac3854cefb93300f910e11184248b019b92ba93cf42b6e58d38cd182943b7b7de_0", "is_ignored": false, "lines": "  if ((*(int *)(param_2 + 0xc) == 0) || (sVar1 = strlen(*(char **)(param_2 + 0xc)), sVar1 != 0xc)) {", "message": "The software uses a signed primitive and performs a cast to an unsigned primitive, or uses an unsigned primitive and performs a cast to a signed primitive, which can produce an unexpected value. When the result of a function is to be used as a size parameter, using negative return values can have unexpected results. Although less frequent an issue, unsigned-to-signed conversion can be  the precursor to buffer underwrite conditions. Buffer underwrites  occur frequently when large unsigned values are cast to signed values,  and then used as indexes into a buffer or for pointer arithmetic.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "LOW", "references": ["https://cwe.mitre.org/data/definitions/195", "https://cwe.mitre.org/data/definitions/196", "https://cwe.mitre.org/data/definitions/194", "https://cwe.mitre.org/data/definitions/191", "https://cwe.mitre.org/data/definitions/681", "https://cwe.mitre.org/data/definitions/789", "https://g.co/kgs/PCHQjJ", "https://github.com/struct/mms", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "http://www.phrack.org/issues/60/10.html#article", "https://docs.microsoft.com/en-us/cpp/sanitizers/asan-error-examples"]}, "metavars": {"$SIGNED": {"abstract_content": "param_2", "end": {"col": 75, "line": 13, "offset": 255}, "start": {"col": 68, "line": 13, "offset": 248}}, "$UNSIGNED": {"abstract_content": "sVar1", "end": {"col": 47, "line": 13, "offset": 227}, "start": {"col": 42, "line": 13, "offset": 222}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/table_del_fid_0040a24c.c", "start": {"col": 42, "line": 13, "offset": 222}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 50, "line": 17, "offset": 409}, "extra": {"engine_kind": "OSS", "fingerprint": "348c1e2d9e85ae9086792053aa6436761b16c6951a4913b47b3534b5488dffcf9692cf0cd7f48a0cb48670fc12c460881b5ba938a6599ba50e40e40edcdc3a6e_0", "is_ignored": false, "lines": "  strncpy(acStack_14,*(char **)(param_2 + 0xc),8);", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "strncpy", "end": {"col": 10, "line": 17, "offset": 369}, "start": {"col": 3, "line": 17, "offset": 362}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/table_del_fid_0040a24c.c", "start": {"col": 3, "line": 17, "offset": 362}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-signed-unsigned-conversion", "end": {"col": 50, "line": 17, "offset": 409}, "extra": {"engine_kind": "OSS", "fingerprint": "3dbfa5c7927f8723b29229ebff339eaaa603e96199cf15f466462d31f6fb7bd62201d761437d409f7d7afdecd2174e4446156da659ed25aea8e42bc8e89acfcd_0", "is_ignored": false, "lines": "  strncpy(acStack_14,*(char **)(param_2 + 0xc),8);", "message": "The software uses a signed primitive and performs a cast to an unsigned primitive, or uses an unsigned primitive and performs a cast to a signed primitive, which can produce an unexpected value. When the result of a function is to be used as a size parameter, using negative return values can have unexpected results. Although less frequent an issue, unsigned-to-signed conversion can be  the precursor to buffer underwrite conditions. Buffer underwrites  occur frequently when large unsigned values are cast to signed values,  and then used as indexes into a buffer or for pointer arithmetic.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "LOW", "references": ["https://cwe.mitre.org/data/definitions/195", "https://cwe.mitre.org/data/definitions/196", "https://cwe.mitre.org/data/definitions/194", "https://cwe.mitre.org/data/definitions/191", "https://cwe.mitre.org/data/definitions/681", "https://cwe.mitre.org/data/definitions/789", "https://g.co/kgs/PCHQjJ", "https://github.com/struct/mms", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "http://www.phrack.org/issues/60/10.html#article", "https://docs.microsoft.com/en-us/cpp/sanitizers/asan-error-examples"]}, "metavars": {"$DST": {"abstract_content": "acStack_14", "end": {"col": 21, "line": 17, "offset": 380}, "start": {"col": 11, "line": 17, "offset": 370}}, "$LEN": {"abstract_content": "8", "end": {"col": 49, "line": 17, "offset": 408}, "start": {"col": 48, "line": 17, "offset": 407}}, "$SRC": {"abstract_content": "*char**param_2+0xc", "end": {"col": 46, "line": 17, "offset": 405}, "start": {"col": 22, "line": 17, "offset": 381}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/table_del_fid_0040a24c.c", "start": {"col": 3, "line": 17, "offset": 362}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-unterminated-string-strncpy-stpncpy", "end": {"col": 50, "line": 17, "offset": 409}, "extra": {"engine_kind": "OSS", "fingerprint": "513d2e827b7cedf0fde02c6443fd7783f570c691053d1b77a66f9e83c786135ff7bacb3d5b2efb0412f296a741dbe5fd35e2be884eea07a99b8ed0671f292a1d_0", "is_ignored": false, "lines": "  strncpy(acStack_14,*(char **)(param_2 + 0xc),8);", "message": "If there is no NUL character byte in the first n bytes of the source string, strncpy() and stpncpy() do not NUL-terminate the destination buffer. If the program does not explicitly terminate the destination buffer, this will almost certainly result in information disclosure, and possibly a buffer overflow condition.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://cwe.mitre.org/data/definitions/170", "https://cwe.mitre.org/data/definitions/126", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf"]}, "metavars": {"$FUN": {"abstract_content": "strncpy", "end": {"col": 10, "line": 17, "offset": 369}, "start": {"col": 3, "line": 17, "offset": 362}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/table_del_fid_0040a24c.c", "start": {"col": 3, "line": 17, "offset": 362}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 62, "line": 21, "offset": 567}, "extra": {"engine_kind": "OSS", "fingerprint": "348c1e2d9e85ae9086792053aa6436761b16c6951a4913b47b3534b5488dffcf9692cf0cd7f48a0cb48670fc12c460881b5ba938a6599ba50e40e40edcdc3a6e_1", "is_ignored": false, "lines": "  strncpy(acStack_14,(char *)(*(int *)(param_2 + 0xc) + 8),4);", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "strncpy", "end": {"col": 10, "line": 21, "offset": 515}, "start": {"col": 3, "line": 21, "offset": 508}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/table_del_fid_0040a24c.c", "start": {"col": 3, "line": 21, "offset": 508}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-signed-unsigned-conversion", "end": {"col": 62, "line": 21, "offset": 567}, "extra": {"engine_kind": "OSS", "fingerprint": "ace0b357ae3329704be51138294f372abc37d68fcd43b06a356f176c3d78b32076f0c0357ceea551b0a4c486454349c2c756cdd4e36441269fb9145c9633761a_0", "is_ignored": false, "lines": "  strncpy(acStack_14,(char *)(*(int *)(param_2 + 0xc) + 8),4);", "message": "The software uses a signed primitive and performs a cast to an unsigned primitive, or uses an unsigned primitive and performs a cast to a signed primitive, which can produce an unexpected value. When the result of a function is to be used as a size parameter, using negative return values can have unexpected results. Although less frequent an issue, unsigned-to-signed conversion can be  the precursor to buffer underwrite conditions. Buffer underwrites  occur frequently when large unsigned values are cast to signed values,  and then used as indexes into a buffer or for pointer arithmetic.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "LOW", "references": ["https://cwe.mitre.org/data/definitions/195", "https://cwe.mitre.org/data/definitions/196", "https://cwe.mitre.org/data/definitions/194", "https://cwe.mitre.org/data/definitions/191", "https://cwe.mitre.org/data/definitions/681", "https://cwe.mitre.org/data/definitions/789", "https://g.co/kgs/PCHQjJ", "https://github.com/struct/mms", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "http://www.phrack.org/issues/60/10.html#article", "https://docs.microsoft.com/en-us/cpp/sanitizers/asan-error-examples"]}, "metavars": {"$DST": {"abstract_content": "acStack_14", "end": {"col": 21, "line": 21, "offset": 526}, "start": {"col": 11, "line": 21, "offset": 516}}, "$LEN": {"abstract_content": "4", "end": {"col": 61, "line": 21, "offset": 566}, "start": {"col": 60, "line": 21, "offset": 565}}, "$SRC": {"abstract_content": "char**int*param_2+0xc+8", "end": {"col": 58, "line": 21, "offset": 563}, "start": {"col": 23, "line": 21, "offset": 528}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/table_del_fid_0040a24c.c", "start": {"col": 3, "line": 21, "offset": 508}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-unterminated-string-strncpy-stpncpy", "end": {"col": 62, "line": 21, "offset": 567}, "extra": {"engine_kind": "OSS", "fingerprint": "513d2e827b7cedf0fde02c6443fd7783f570c691053d1b77a66f9e83c786135ff7bacb3d5b2efb0412f296a741dbe5fd35e2be884eea07a99b8ed0671f292a1d_1", "is_ignored": false, "lines": "  strncpy(acStack_14,(char *)(*(int *)(param_2 + 0xc) + 8),4);", "message": "If there is no NUL character byte in the first n bytes of the source string, strncpy() and stpncpy() do not NUL-terminate the destination buffer. If the program does not explicitly terminate the destination buffer, this will almost certainly result in information disclosure, and possibly a buffer overflow condition.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://cwe.mitre.org/data/definitions/170", "https://cwe.mitre.org/data/definitions/126", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf"]}, "metavars": {"$FUN": {"abstract_content": "strncpy", "end": {"col": 10, "line": 21, "offset": 515}, "start": {"col": 3, "line": 21, "offset": 508}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/table_del_fid_0040a24c.c", "start": {"col": 3, "line": 21, "offset": 508}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 29, "line": 39, "offset": 1117}, "extra": {"engine_kind": "OSS", "fingerprint": "2047adc92b3a1b896ca3686a02e6c59f49a8d3381b5efd1df362658ccce90d29598545d2e5d5459ed089ddcd599480095bed0bb36949f0a3004956d0719640f7_0", "is_ignored": false, "lines": "    reg_read(0x80,&local_18);", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "reg_read", "end": {"col": 13, "line": 39, "offset": 1101}, "start": {"col": 5, "line": 39, "offset": 1093}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/table_del_fid_0040a24c.c", "start": {"col": 5, "line": 39, "offset": 1093}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-signed-unsigned-conversion", "end": {"col": 83, "line": 13, "offset": 270}, "extra": {"engine_kind": "OSS", "fingerprint": "d9771b931ec5df0f44baf6d104739b4e4d3f40e52c4f5136ee1e68dfc5ccd19754328b5004b936d81e948a8256684fecb1e82eb324e74732a1c7337349ad87fa_0", "is_ignored": false, "lines": "  if ((*(int *)(param_2 + 0xc) == 0) || (sVar1 = strlen(*(char **)(param_2 + 0xc)), sVar1 != 0xc)) {", "message": "The software uses a signed primitive and performs a cast to an unsigned primitive, or uses an unsigned primitive and performs a cast to a signed primitive, which can produce an unexpected value. When the result of a function is to be used as a size parameter, using negative return values can have unexpected results. Although less frequent an issue, unsigned-to-signed conversion can be  the precursor to buffer underwrite conditions. Buffer underwrites  occur frequently when large unsigned values are cast to signed values,  and then used as indexes into a buffer or for pointer arithmetic.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "LOW", "references": ["https://cwe.mitre.org/data/definitions/195", "https://cwe.mitre.org/data/definitions/196", "https://cwe.mitre.org/data/definitions/194", "https://cwe.mitre.org/data/definitions/191", "https://cwe.mitre.org/data/definitions/681", "https://cwe.mitre.org/data/definitions/789", "https://g.co/kgs/PCHQjJ", "https://github.com/struct/mms", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "http://www.phrack.org/issues/60/10.html#article", "https://docs.microsoft.com/en-us/cpp/sanitizers/asan-error-examples"]}, "metavars": {"$SIGNED": {"abstract_content": "param_2", "end": {"col": 75, "line": 13, "offset": 262}, "start": {"col": 68, "line": 13, "offset": 255}}, "$UNSIGNED": {"abstract_content": "sVar1", "end": {"col": 47, "line": 13, "offset": 234}, "start": {"col": 42, "line": 13, "offset": 229}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/table_del_vid_0040a610.c", "start": {"col": 42, "line": 13, "offset": 229}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 50, "line": 17, "offset": 416}, "extra": {"engine_kind": "OSS", "fingerprint": "2efb50c951ad29a45674871eb4f7b1d8473221d96e2e1087748268e1f0b091e8f6b5f68756da9f2632e8f4e57063b3190e134b809ee54af5f51a4d63acc062f0_0", "is_ignored": false, "lines": "  strncpy(acStack_14,*(char **)(param_2 + 0xc),8);", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "strncpy", "end": {"col": 10, "line": 17, "offset": 376}, "start": {"col": 3, "line": 17, "offset": 369}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/table_del_vid_0040a610.c", "start": {"col": 3, "line": 17, "offset": 369}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-signed-unsigned-conversion", "end": {"col": 50, "line": 17, "offset": 416}, "extra": {"engine_kind": "OSS", "fingerprint": "58bc88f760c07ef5318044fd02f72d113875610e4db90f2644679d1a0247ca7ce1656d4c30141aa7e2085be9a2ff7cf171444c1d3b4205feb2e8ceeeaa35105c_0", "is_ignored": false, "lines": "  strncpy(acStack_14,*(char **)(param_2 + 0xc),8);", "message": "The software uses a signed primitive and performs a cast to an unsigned primitive, or uses an unsigned primitive and performs a cast to a signed primitive, which can produce an unexpected value. When the result of a function is to be used as a size parameter, using negative return values can have unexpected results. Although less frequent an issue, unsigned-to-signed conversion can be  the precursor to buffer underwrite conditions. Buffer underwrites  occur frequently when large unsigned values are cast to signed values,  and then used as indexes into a buffer or for pointer arithmetic.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "LOW", "references": ["https://cwe.mitre.org/data/definitions/195", "https://cwe.mitre.org/data/definitions/196", "https://cwe.mitre.org/data/definitions/194", "https://cwe.mitre.org/data/definitions/191", "https://cwe.mitre.org/data/definitions/681", "https://cwe.mitre.org/data/definitions/789", "https://g.co/kgs/PCHQjJ", "https://github.com/struct/mms", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "http://www.phrack.org/issues/60/10.html#article", "https://docs.microsoft.com/en-us/cpp/sanitizers/asan-error-examples"]}, "metavars": {"$DST": {"abstract_content": "acStack_14", "end": {"col": 21, "line": 17, "offset": 387}, "start": {"col": 11, "line": 17, "offset": 377}}, "$LEN": {"abstract_content": "8", "end": {"col": 49, "line": 17, "offset": 415}, "start": {"col": 48, "line": 17, "offset": 414}}, "$SRC": {"abstract_content": "*char**param_2+0xc", "end": {"col": 46, "line": 17, "offset": 412}, "start": {"col": 22, "line": 17, "offset": 388}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/table_del_vid_0040a610.c", "start": {"col": 3, "line": 17, "offset": 369}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-unterminated-string-strncpy-stpncpy", "end": {"col": 50, "line": 17, "offset": 416}, "extra": {"engine_kind": "OSS", "fingerprint": "a4b27f622cfccd4cc755bab75a021c3d8fdd5d01a87e9be0a2c690d1a5101cc581c562489322205f597bed7a4b1bcc09064ec2414a2662899d00b334ef25c71d_0", "is_ignored": false, "lines": "  strncpy(acStack_14,*(char **)(param_2 + 0xc),8);", "message": "If there is no NUL character byte in the first n bytes of the source string, strncpy() and stpncpy() do not NUL-terminate the destination buffer. If the program does not explicitly terminate the destination buffer, this will almost certainly result in information disclosure, and possibly a buffer overflow condition.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://cwe.mitre.org/data/definitions/170", "https://cwe.mitre.org/data/definitions/126", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf"]}, "metavars": {"$FUN": {"abstract_content": "strncpy", "end": {"col": 10, "line": 17, "offset": 376}, "start": {"col": 3, "line": 17, "offset": 369}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/table_del_vid_0040a610.c", "start": {"col": 3, "line": 17, "offset": 369}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 62, "line": 21, "offset": 574}, "extra": {"engine_kind": "OSS", "fingerprint": "2efb50c951ad29a45674871eb4f7b1d8473221d96e2e1087748268e1f0b091e8f6b5f68756da9f2632e8f4e57063b3190e134b809ee54af5f51a4d63acc062f0_1", "is_ignored": false, "lines": "  strncpy(acStack_14,(char *)(*(int *)(param_2 + 0xc) + 8),4);", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "strncpy", "end": {"col": 10, "line": 21, "offset": 522}, "start": {"col": 3, "line": 21, "offset": 515}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/table_del_vid_0040a610.c", "start": {"col": 3, "line": 21, "offset": 515}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-signed-unsigned-conversion", "end": {"col": 62, "line": 21, "offset": 574}, "extra": {"engine_kind": "OSS", "fingerprint": "3fcbc15faa5936cbfb6327e517df1ff28e87d434799cc53654a9e2b004e686853d841061eb5473d7f1fcabde807df71894d0ea2455ea6f790bdfa470fbe9a3f9_0", "is_ignored": false, "lines": "  strncpy(acStack_14,(char *)(*(int *)(param_2 + 0xc) + 8),4);", "message": "The software uses a signed primitive and performs a cast to an unsigned primitive, or uses an unsigned primitive and performs a cast to a signed primitive, which can produce an unexpected value. When the result of a function is to be used as a size parameter, using negative return values can have unexpected results. Although less frequent an issue, unsigned-to-signed conversion can be  the precursor to buffer underwrite conditions. Buffer underwrites  occur frequently when large unsigned values are cast to signed values,  and then used as indexes into a buffer or for pointer arithmetic.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "LOW", "references": ["https://cwe.mitre.org/data/definitions/195", "https://cwe.mitre.org/data/definitions/196", "https://cwe.mitre.org/data/definitions/194", "https://cwe.mitre.org/data/definitions/191", "https://cwe.mitre.org/data/definitions/681", "https://cwe.mitre.org/data/definitions/789", "https://g.co/kgs/PCHQjJ", "https://github.com/struct/mms", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "http://www.phrack.org/issues/60/10.html#article", "https://docs.microsoft.com/en-us/cpp/sanitizers/asan-error-examples"]}, "metavars": {"$DST": {"abstract_content": "acStack_14", "end": {"col": 21, "line": 21, "offset": 533}, "start": {"col": 11, "line": 21, "offset": 523}}, "$LEN": {"abstract_content": "4", "end": {"col": 61, "line": 21, "offset": 573}, "start": {"col": 60, "line": 21, "offset": 572}}, "$SRC": {"abstract_content": "char**int*param_2+0xc+8", "end": {"col": 58, "line": 21, "offset": 570}, "start": {"col": 23, "line": 21, "offset": 535}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/table_del_vid_0040a610.c", "start": {"col": 3, "line": 21, "offset": 515}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-unterminated-string-strncpy-stpncpy", "end": {"col": 62, "line": 21, "offset": 574}, "extra": {"engine_kind": "OSS", "fingerprint": "a4b27f622cfccd4cc755bab75a021c3d8fdd5d01a87e9be0a2c690d1a5101cc581c562489322205f597bed7a4b1bcc09064ec2414a2662899d00b334ef25c71d_1", "is_ignored": false, "lines": "  strncpy(acStack_14,(char *)(*(int *)(param_2 + 0xc) + 8),4);", "message": "If there is no NUL character byte in the first n bytes of the source string, strncpy() and stpncpy() do not NUL-terminate the destination buffer. If the program does not explicitly terminate the destination buffer, this will almost certainly result in information disclosure, and possibly a buffer overflow condition.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://cwe.mitre.org/data/definitions/170", "https://cwe.mitre.org/data/definitions/126", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf"]}, "metavars": {"$FUN": {"abstract_content": "strncpy", "end": {"col": 10, "line": 21, "offset": 522}, "start": {"col": 3, "line": 21, "offset": 515}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/table_del_vid_0040a610.c", "start": {"col": 3, "line": 21, "offset": 515}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 31, "line": 34, "offset": 1044}, "extra": {"engine_kind": "OSS", "fingerprint": "efc18871dc1acbad46c9f17c274dc63ea13638aa200901deb175f4c58a978001b86fe95674d49c6ff7f31023bb15e83254771c7d94d0a3b7f83ccb280308294d_0", "is_ignored": false, "lines": "      reg_read(0x80,&local_18);", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "reg_read", "end": {"col": 15, "line": 34, "offset": 1028}, "start": {"col": 7, "line": 34, "offset": 1020}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/table_del_vid_0040a610.c", "start": {"col": 7, "line": 34, "offset": 1020}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 69, "line": 18, "offset": 429}, "extra": {"engine_kind": "OSS", "fingerprint": "a253896df60163b2887815fe890783774721a1bce01ad885423ea536d765966423df24bc75558861cf12266223ad3739373b1ef434940580dfd7f7e3c52b7aa2_0", "is_ignored": false, "lines": "    reg_read((local_60 + 0x40) * 4,&local_58,param_3,param_4,puVar4);", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "reg_read", "end": {"col": 13, "line": 18, "offset": 373}, "start": {"col": 5, "line": 18, "offset": 365}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/table_dump_004082a4.c", "start": {"col": 5, "line": 18, "offset": 365}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 31, "line": 30, "offset": 788}, "extra": {"engine_kind": "OSS", "fingerprint": "a253896df60163b2887815fe890783774721a1bce01ad885423ea536d765966423df24bc75558861cf12266223ad3739373b1ef434940580dfd7f7e3c52b7aa2_1", "is_ignored": false, "lines": "      reg_read(0x80,&local_58);", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "reg_read", "end": {"col": 15, "line": 30, "offset": 772}, "start": {"col": 7, "line": 30, "offset": 764}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/table_dump_004082a4.c", "start": {"col": 7, "line": 30, "offset": 764}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 29, "line": 40, "offset": 1188}, "extra": {"engine_kind": "OSS", "fingerprint": "a253896df60163b2887815fe890783774721a1bce01ad885423ea536d765966423df24bc75558861cf12266223ad3739373b1ef434940580dfd7f7e3c52b7aa2_2", "is_ignored": false, "lines": "    reg_read(0x8c,&local_4c);", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "reg_read", "end": {"col": 13, "line": 40, "offset": 1172}, "start": {"col": 5, "line": 40, "offset": 1164}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/table_dump_004082a4.c", "start": {"col": 5, "line": 40, "offset": 1164}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 29, "line": 98, "offset": 2155}, "extra": {"engine_kind": "OSS", "fingerprint": "a253896df60163b2887815fe890783774721a1bce01ad885423ea536d765966423df24bc75558861cf12266223ad3739373b1ef434940580dfd7f7e3c52b7aa2_3", "is_ignored": false, "lines": "    reg_read(0x88,&local_50);", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "reg_read", "end": {"col": 13, "line": 98, "offset": 2139}, "start": {"col": 5, "line": 98, "offset": 2131}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/table_dump_004082a4.c", "start": {"col": 5, "line": 98, "offset": 2131}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 29, "line": 102, "offset": 2307}, "extra": {"engine_kind": "OSS", "fingerprint": "a253896df60163b2887815fe890783774721a1bce01ad885423ea536d765966423df24bc75558861cf12266223ad3739373b1ef434940580dfd7f7e3c52b7aa2_4", "is_ignored": false, "lines": "    reg_read(0x84,&local_54);", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "reg_read", "end": {"col": 13, "line": 102, "offset": 2291}, "start": {"col": 5, "line": 102, "offset": 2283}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/table_dump_004082a4.c", "start": {"col": 5, "line": 102, "offset": 2283}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-signed-unsigned-conversion", "end": {"col": 83, "line": 19, "offset": 383}, "extra": {"engine_kind": "OSS", "fingerprint": "d0c1fc208d23ff8abda045b8618d26597887ebefc10d66e1391265b061b150453d1658b57de7f1c23c2c886e334310811acf4d905768072396417b978ccff572_0", "is_ignored": false, "lines": "  if ((*(int *)(param_2 + 0xc) == 0) || (sVar1 = strlen(*(char **)(param_2 + 0xc)), sVar1 != 0xc)) {", "message": "The software uses a signed primitive and performs a cast to an unsigned primitive, or uses an unsigned primitive and performs a cast to a signed primitive, which can produce an unexpected value. When the result of a function is to be used as a size parameter, using negative return values can have unexpected results. Although less frequent an issue, unsigned-to-signed conversion can be  the precursor to buffer underwrite conditions. Buffer underwrites  occur frequently when large unsigned values are cast to signed values,  and then used as indexes into a buffer or for pointer arithmetic.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "LOW", "references": ["https://cwe.mitre.org/data/definitions/195", "https://cwe.mitre.org/data/definitions/196", "https://cwe.mitre.org/data/definitions/194", "https://cwe.mitre.org/data/definitions/191", "https://cwe.mitre.org/data/definitions/681", "https://cwe.mitre.org/data/definitions/789", "https://g.co/kgs/PCHQjJ", "https://github.com/struct/mms", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "http://www.phrack.org/issues/60/10.html#article", "https://docs.microsoft.com/en-us/cpp/sanitizers/asan-error-examples"]}, "metavars": {"$SIGNED": {"abstract_content": "param_2", "end": {"col": 75, "line": 19, "offset": 375}, "start": {"col": 68, "line": 19, "offset": 368}}, "$UNSIGNED": {"abstract_content": "sVar1", "end": {"col": 47, "line": 19, "offset": 347}, "start": {"col": 42, "line": 19, "offset": 342}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/table_search_mac_fid_00409a14.c", "start": {"col": 42, "line": 19, "offset": 342}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 52, "line": 23, "offset": 528}, "extra": {"engine_kind": "OSS", "fingerprint": "13532e9e11f3874050982a3ea5c7227587bdb8beeebaff36fcf84e76da61460cb878e4db419cbdc63b07c2b5a9e3fa5220f89763648db710ae4dfe3a2b6902d4_0", "is_ignored": false, "lines": "    strncpy(acStack_18,*(char **)(param_2 + 0xc),8);", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "strncpy", "end": {"col": 12, "line": 23, "offset": 488}, "start": {"col": 5, "line": 23, "offset": 481}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/table_search_mac_fid_00409a14.c", "start": {"col": 5, "line": 23, "offset": 481}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-signed-unsigned-conversion", "end": {"col": 52, "line": 23, "offset": 528}, "extra": {"engine_kind": "OSS", "fingerprint": "f2752a69cf9a4734c9de19b0be3d2e8b354097df93525a505f2018f20e6cae95de32e314839327eb254d4ddd7e91556702a5bde84510d544e85ebbfc04630ef7_0", "is_ignored": false, "lines": "    strncpy(acStack_18,*(char **)(param_2 + 0xc),8);", "message": "The software uses a signed primitive and performs a cast to an unsigned primitive, or uses an unsigned primitive and performs a cast to a signed primitive, which can produce an unexpected value. When the result of a function is to be used as a size parameter, using negative return values can have unexpected results. Although less frequent an issue, unsigned-to-signed conversion can be  the precursor to buffer underwrite conditions. Buffer underwrites  occur frequently when large unsigned values are cast to signed values,  and then used as indexes into a buffer or for pointer arithmetic.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "LOW", "references": ["https://cwe.mitre.org/data/definitions/195", "https://cwe.mitre.org/data/definitions/196", "https://cwe.mitre.org/data/definitions/194", "https://cwe.mitre.org/data/definitions/191", "https://cwe.mitre.org/data/definitions/681", "https://cwe.mitre.org/data/definitions/789", "https://g.co/kgs/PCHQjJ", "https://github.com/struct/mms", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "http://www.phrack.org/issues/60/10.html#article", "https://docs.microsoft.com/en-us/cpp/sanitizers/asan-error-examples"]}, "metavars": {"$DST": {"abstract_content": "acStack_18", "end": {"col": 23, "line": 23, "offset": 499}, "start": {"col": 13, "line": 23, "offset": 489}}, "$LEN": {"abstract_content": "8", "end": {"col": 51, "line": 23, "offset": 527}, "start": {"col": 50, "line": 23, "offset": 526}}, "$SRC": {"abstract_content": "*char**param_2+0xc", "end": {"col": 48, "line": 23, "offset": 524}, "start": {"col": 24, "line": 23, "offset": 500}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/table_search_mac_fid_00409a14.c", "start": {"col": 5, "line": 23, "offset": 481}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-unterminated-string-strncpy-stpncpy", "end": {"col": 52, "line": 23, "offset": 528}, "extra": {"engine_kind": "OSS", "fingerprint": "a3143493cdfc637e78e34a79589731a0767279f4557ea110bf11077aa0ff5b1d6e33c29951989e113b3bf3e81889889ef59a7b271ba1bb9cbba0ce0cc10cf099_0", "is_ignored": false, "lines": "    strncpy(acStack_18,*(char **)(param_2 + 0xc),8);", "message": "If there is no NUL character byte in the first n bytes of the source string, strncpy() and stpncpy() do not NUL-terminate the destination buffer. If the program does not explicitly terminate the destination buffer, this will almost certainly result in information disclosure, and possibly a buffer overflow condition.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://cwe.mitre.org/data/definitions/170", "https://cwe.mitre.org/data/definitions/126", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf"]}, "metavars": {"$FUN": {"abstract_content": "strncpy", "end": {"col": 12, "line": 23, "offset": 488}, "start": {"col": 5, "line": 23, "offset": 481}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/table_search_mac_fid_00409a14.c", "start": {"col": 5, "line": 23, "offset": 481}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 64, "line": 27, "offset": 695}, "extra": {"engine_kind": "OSS", "fingerprint": "13532e9e11f3874050982a3ea5c7227587bdb8beeebaff36fcf84e76da61460cb878e4db419cbdc63b07c2b5a9e3fa5220f89763648db710ae4dfe3a2b6902d4_1", "is_ignored": false, "lines": "    strncpy(acStack_18,(char *)(*(int *)(param_2 + 0xc) + 8),4);", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "strncpy", "end": {"col": 12, "line": 27, "offset": 643}, "start": {"col": 5, "line": 27, "offset": 636}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/table_search_mac_fid_00409a14.c", "start": {"col": 5, "line": 27, "offset": 636}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-signed-unsigned-conversion", "end": {"col": 64, "line": 27, "offset": 695}, "extra": {"engine_kind": "OSS", "fingerprint": "ef0d958c9b45eb5dcf237479e21aae12ef47fbadd558dea90127d37afb3a1e94b578f0cb09d9842b9beadf3a510c208db867b5b71190d93ae589780549e8c837_0", "is_ignored": false, "lines": "    strncpy(acStack_18,(char *)(*(int *)(param_2 + 0xc) + 8),4);", "message": "The software uses a signed primitive and performs a cast to an unsigned primitive, or uses an unsigned primitive and performs a cast to a signed primitive, which can produce an unexpected value. When the result of a function is to be used as a size parameter, using negative return values can have unexpected results. Although less frequent an issue, unsigned-to-signed conversion can be  the precursor to buffer underwrite conditions. Buffer underwrites  occur frequently when large unsigned values are cast to signed values,  and then used as indexes into a buffer or for pointer arithmetic.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "LOW", "references": ["https://cwe.mitre.org/data/definitions/195", "https://cwe.mitre.org/data/definitions/196", "https://cwe.mitre.org/data/definitions/194", "https://cwe.mitre.org/data/definitions/191", "https://cwe.mitre.org/data/definitions/681", "https://cwe.mitre.org/data/definitions/789", "https://g.co/kgs/PCHQjJ", "https://github.com/struct/mms", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "http://www.phrack.org/issues/60/10.html#article", "https://docs.microsoft.com/en-us/cpp/sanitizers/asan-error-examples"]}, "metavars": {"$DST": {"abstract_content": "acStack_18", "end": {"col": 23, "line": 27, "offset": 654}, "start": {"col": 13, "line": 27, "offset": 644}}, "$LEN": {"abstract_content": "4", "end": {"col": 63, "line": 27, "offset": 694}, "start": {"col": 62, "line": 27, "offset": 693}}, "$SRC": {"abstract_content": "char**int*param_2+0xc+8", "end": {"col": 60, "line": 27, "offset": 691}, "start": {"col": 25, "line": 27, "offset": 656}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/table_search_mac_fid_00409a14.c", "start": {"col": 5, "line": 27, "offset": 636}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-unterminated-string-strncpy-stpncpy", "end": {"col": 64, "line": 27, "offset": 695}, "extra": {"engine_kind": "OSS", "fingerprint": "a3143493cdfc637e78e34a79589731a0767279f4557ea110bf11077aa0ff5b1d6e33c29951989e113b3bf3e81889889ef59a7b271ba1bb9cbba0ce0cc10cf099_1", "is_ignored": false, "lines": "    strncpy(acStack_18,(char *)(*(int *)(param_2 + 0xc) + 8),4);", "message": "If there is no NUL character byte in the first n bytes of the source string, strncpy() and stpncpy() do not NUL-terminate the destination buffer. If the program does not explicitly terminate the destination buffer, this will almost certainly result in information disclosure, and possibly a buffer overflow condition.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://cwe.mitre.org/data/definitions/170", "https://cwe.mitre.org/data/definitions/126", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf"]}, "metavars": {"$FUN": {"abstract_content": "strncpy", "end": {"col": 12, "line": 27, "offset": 643}, "start": {"col": 5, "line": 27, "offset": 636}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/table_search_mac_fid_00409a14.c", "start": {"col": 5, "line": 27, "offset": 636}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 59, "line": 39, "offset": 1108}, "extra": {"engine_kind": "OSS", "fingerprint": "178194a564247b2dcf0cdc6b34398600f2c242a4805d54586ffa19607163dbfcb3d25a23cf7aa639c29561587a845e7ae0724aef2dc135739de1455b5fa47a01_0", "is_ignored": false, "lines": "      while ((local_30 < 0x14 && (reg_read(0x80,&local_28), (local_28 & 0x8000) != 0))) {", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "reg_read", "end": {"col": 43, "line": 39, "offset": 1092}, "start": {"col": 35, "line": 39, "offset": 1084}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/table_search_mac_fid_00409a14.c", "start": {"col": 35, "line": 39, "offset": 1084}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 33, "line": 50, "offset": 1514}, "extra": {"engine_kind": "OSS", "fingerprint": "178194a564247b2dcf0cdc6b34398600f2c242a4805d54586ffa19607163dbfcb3d25a23cf7aa639c29561587a845e7ae0724aef2dc135739de1455b5fa47a01_1", "is_ignored": false, "lines": "        reg_read(0x8c,&local_1c);", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "reg_read", "end": {"col": 17, "line": 50, "offset": 1498}, "start": {"col": 9, "line": 50, "offset": 1490}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/table_search_mac_fid_00409a14.c", "start": {"col": 9, "line": 50, "offset": 1490}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 33, "line": 108, "offset": 2708}, "extra": {"engine_kind": "OSS", "fingerprint": "178194a564247b2dcf0cdc6b34398600f2c242a4805d54586ffa19607163dbfcb3d25a23cf7aa639c29561587a845e7ae0724aef2dc135739de1455b5fa47a01_2", "is_ignored": false, "lines": "        reg_read(0x88,&local_20);", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "reg_read", "end": {"col": 17, "line": 108, "offset": 2692}, "start": {"col": 9, "line": 108, "offset": 2684}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/table_search_mac_fid_00409a14.c", "start": {"col": 9, "line": 108, "offset": 2684}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 33, "line": 112, "offset": 2871}, "extra": {"engine_kind": "OSS", "fingerprint": "178194a564247b2dcf0cdc6b34398600f2c242a4805d54586ffa19607163dbfcb3d25a23cf7aa639c29561587a845e7ae0724aef2dc135739de1455b5fa47a01_3", "is_ignored": false, "lines": "        reg_read(0x84,&local_24);", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "reg_read", "end": {"col": 17, "line": 112, "offset": 2855}, "start": {"col": 9, "line": 112, "offset": 2847}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/table_search_mac_fid_00409a14.c", "start": {"col": 9, "line": 112, "offset": 2847}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-signed-unsigned-conversion", "end": {"col": 83, "line": 19, "offset": 383}, "extra": {"engine_kind": "OSS", "fingerprint": "b2da23168bb2a1ce4b69d54698eb43c4e2c528001f764e70bae3fac2b63eaf33654fb529e8a7fc73d396c1afa223445bc9760426e22d080a85bb69ff37c8cbfb_0", "is_ignored": false, "lines": "  if ((*(int *)(param_2 + 0xc) == 0) || (sVar1 = strlen(*(char **)(param_2 + 0xc)), sVar1 != 0xc)) {", "message": "The software uses a signed primitive and performs a cast to an unsigned primitive, or uses an unsigned primitive and performs a cast to a signed primitive, which can produce an unexpected value. When the result of a function is to be used as a size parameter, using negative return values can have unexpected results. Although less frequent an issue, unsigned-to-signed conversion can be  the precursor to buffer underwrite conditions. Buffer underwrites  occur frequently when large unsigned values are cast to signed values,  and then used as indexes into a buffer or for pointer arithmetic.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "LOW", "references": ["https://cwe.mitre.org/data/definitions/195", "https://cwe.mitre.org/data/definitions/196", "https://cwe.mitre.org/data/definitions/194", "https://cwe.mitre.org/data/definitions/191", "https://cwe.mitre.org/data/definitions/681", "https://cwe.mitre.org/data/definitions/789", "https://g.co/kgs/PCHQjJ", "https://github.com/struct/mms", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "http://www.phrack.org/issues/60/10.html#article", "https://docs.microsoft.com/en-us/cpp/sanitizers/asan-error-examples"]}, "metavars": {"$SIGNED": {"abstract_content": "param_2", "end": {"col": 75, "line": 19, "offset": 375}, "start": {"col": 68, "line": 19, "offset": 368}}, "$UNSIGNED": {"abstract_content": "sVar1", "end": {"col": 47, "line": 19, "offset": 347}, "start": {"col": 42, "line": 19, "offset": 342}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/table_search_mac_vid_004091e8.c", "start": {"col": 42, "line": 19, "offset": 342}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 52, "line": 23, "offset": 528}, "extra": {"engine_kind": "OSS", "fingerprint": "86803482c8e20893960fd4f6f04d27f919b86fa62cdfc7b555f0e39975e6bc92385c969446fc5fe347aa982a5b820bbbf3841c51b04a5ee6f95010fa2396b55a_0", "is_ignored": false, "lines": "    strncpy(acStack_18,*(char **)(param_2 + 0xc),8);", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "strncpy", "end": {"col": 12, "line": 23, "offset": 488}, "start": {"col": 5, "line": 23, "offset": 481}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/table_search_mac_vid_004091e8.c", "start": {"col": 5, "line": 23, "offset": 481}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-signed-unsigned-conversion", "end": {"col": 52, "line": 23, "offset": 528}, "extra": {"engine_kind": "OSS", "fingerprint": "23eed3f1ecc6549ece6cad241301c19bf74b0b4ebba3e3ed1557929e175f749afe9834a10aedf7fe947d18a0d15b276848d45bc137986476be4b735378329c27_0", "is_ignored": false, "lines": "    strncpy(acStack_18,*(char **)(param_2 + 0xc),8);", "message": "The software uses a signed primitive and performs a cast to an unsigned primitive, or uses an unsigned primitive and performs a cast to a signed primitive, which can produce an unexpected value. When the result of a function is to be used as a size parameter, using negative return values can have unexpected results. Although less frequent an issue, unsigned-to-signed conversion can be  the precursor to buffer underwrite conditions. Buffer underwrites  occur frequently when large unsigned values are cast to signed values,  and then used as indexes into a buffer or for pointer arithmetic.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "LOW", "references": ["https://cwe.mitre.org/data/definitions/195", "https://cwe.mitre.org/data/definitions/196", "https://cwe.mitre.org/data/definitions/194", "https://cwe.mitre.org/data/definitions/191", "https://cwe.mitre.org/data/definitions/681", "https://cwe.mitre.org/data/definitions/789", "https://g.co/kgs/PCHQjJ", "https://github.com/struct/mms", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "http://www.phrack.org/issues/60/10.html#article", "https://docs.microsoft.com/en-us/cpp/sanitizers/asan-error-examples"]}, "metavars": {"$DST": {"abstract_content": "acStack_18", "end": {"col": 23, "line": 23, "offset": 499}, "start": {"col": 13, "line": 23, "offset": 489}}, "$LEN": {"abstract_content": "8", "end": {"col": 51, "line": 23, "offset": 527}, "start": {"col": 50, "line": 23, "offset": 526}}, "$SRC": {"abstract_content": "*char**param_2+0xc", "end": {"col": 48, "line": 23, "offset": 524}, "start": {"col": 24, "line": 23, "offset": 500}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/table_search_mac_vid_004091e8.c", "start": {"col": 5, "line": 23, "offset": 481}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-unterminated-string-strncpy-stpncpy", "end": {"col": 52, "line": 23, "offset": 528}, "extra": {"engine_kind": "OSS", "fingerprint": "6cdcfb86d75ea4d519f3ebe23d908e8be4d870e0cd2ab7e26219b5040777308197a294fc8bf0a6263383f3288b641e361b945a8a035d436a2d7f9a13196e54ca_0", "is_ignored": false, "lines": "    strncpy(acStack_18,*(char **)(param_2 + 0xc),8);", "message": "If there is no NUL character byte in the first n bytes of the source string, strncpy() and stpncpy() do not NUL-terminate the destination buffer. If the program does not explicitly terminate the destination buffer, this will almost certainly result in information disclosure, and possibly a buffer overflow condition.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://cwe.mitre.org/data/definitions/170", "https://cwe.mitre.org/data/definitions/126", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf"]}, "metavars": {"$FUN": {"abstract_content": "strncpy", "end": {"col": 12, "line": 23, "offset": 488}, "start": {"col": 5, "line": 23, "offset": 481}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/table_search_mac_vid_004091e8.c", "start": {"col": 5, "line": 23, "offset": 481}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 64, "line": 27, "offset": 695}, "extra": {"engine_kind": "OSS", "fingerprint": "86803482c8e20893960fd4f6f04d27f919b86fa62cdfc7b555f0e39975e6bc92385c969446fc5fe347aa982a5b820bbbf3841c51b04a5ee6f95010fa2396b55a_1", "is_ignored": false, "lines": "    strncpy(acStack_18,(char *)(*(int *)(param_2 + 0xc) + 8),4);", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "strncpy", "end": {"col": 12, "line": 27, "offset": 643}, "start": {"col": 5, "line": 27, "offset": 636}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/table_search_mac_vid_004091e8.c", "start": {"col": 5, "line": 27, "offset": 636}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-signed-unsigned-conversion", "end": {"col": 64, "line": 27, "offset": 695}, "extra": {"engine_kind": "OSS", "fingerprint": "cec48c07e502de08e4d69b7c9aedeb142631dee789c6865459131586cd5e1c917ca8abebef6c44363571d9cb4d3252ec41f92122d3599506e61fc7c6233a88a6_0", "is_ignored": false, "lines": "    strncpy(acStack_18,(char *)(*(int *)(param_2 + 0xc) + 8),4);", "message": "The software uses a signed primitive and performs a cast to an unsigned primitive, or uses an unsigned primitive and performs a cast to a signed primitive, which can produce an unexpected value. When the result of a function is to be used as a size parameter, using negative return values can have unexpected results. Although less frequent an issue, unsigned-to-signed conversion can be  the precursor to buffer underwrite conditions. Buffer underwrites  occur frequently when large unsigned values are cast to signed values,  and then used as indexes into a buffer or for pointer arithmetic.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "LOW", "references": ["https://cwe.mitre.org/data/definitions/195", "https://cwe.mitre.org/data/definitions/196", "https://cwe.mitre.org/data/definitions/194", "https://cwe.mitre.org/data/definitions/191", "https://cwe.mitre.org/data/definitions/681", "https://cwe.mitre.org/data/definitions/789", "https://g.co/kgs/PCHQjJ", "https://github.com/struct/mms", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "http://www.phrack.org/issues/60/10.html#article", "https://docs.microsoft.com/en-us/cpp/sanitizers/asan-error-examples"]}, "metavars": {"$DST": {"abstract_content": "acStack_18", "end": {"col": 23, "line": 27, "offset": 654}, "start": {"col": 13, "line": 27, "offset": 644}}, "$LEN": {"abstract_content": "4", "end": {"col": 63, "line": 27, "offset": 694}, "start": {"col": 62, "line": 27, "offset": 693}}, "$SRC": {"abstract_content": "char**int*param_2+0xc+8", "end": {"col": 60, "line": 27, "offset": 691}, "start": {"col": 25, "line": 27, "offset": 656}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/table_search_mac_vid_004091e8.c", "start": {"col": 5, "line": 27, "offset": 636}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-unterminated-string-strncpy-stpncpy", "end": {"col": 64, "line": 27, "offset": 695}, "extra": {"engine_kind": "OSS", "fingerprint": "6cdcfb86d75ea4d519f3ebe23d908e8be4d870e0cd2ab7e26219b5040777308197a294fc8bf0a6263383f3288b641e361b945a8a035d436a2d7f9a13196e54ca_1", "is_ignored": false, "lines": "    strncpy(acStack_18,(char *)(*(int *)(param_2 + 0xc) + 8),4);", "message": "If there is no NUL character byte in the first n bytes of the source string, strncpy() and stpncpy() do not NUL-terminate the destination buffer. If the program does not explicitly terminate the destination buffer, this will almost certainly result in information disclosure, and possibly a buffer overflow condition.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://cwe.mitre.org/data/definitions/170", "https://cwe.mitre.org/data/definitions/126", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf"]}, "metavars": {"$FUN": {"abstract_content": "strncpy", "end": {"col": 12, "line": 27, "offset": 643}, "start": {"col": 5, "line": 27, "offset": 636}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/table_search_mac_vid_004091e8.c", "start": {"col": 5, "line": 27, "offset": 636}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 59, "line": 39, "offset": 1115}, "extra": {"engine_kind": "OSS", "fingerprint": "ff431054d17a65c3561f07b93a31ddf367f89bdda0d2df8b72a5c10ee0237e689e3254ee5d738ffce57baf7d8b8c00faf4a0a66cd7717197acb2b8e01c2a6720_0", "is_ignored": false, "lines": "      while ((local_30 < 0x14 && (reg_read(0x80,&local_28), (local_28 & 0x8000) != 0))) {", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "reg_read", "end": {"col": 43, "line": 39, "offset": 1099}, "start": {"col": 35, "line": 39, "offset": 1091}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/table_search_mac_vid_004091e8.c", "start": {"col": 35, "line": 39, "offset": 1091}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 33, "line": 50, "offset": 1521}, "extra": {"engine_kind": "OSS", "fingerprint": "ff431054d17a65c3561f07b93a31ddf367f89bdda0d2df8b72a5c10ee0237e689e3254ee5d738ffce57baf7d8b8c00faf4a0a66cd7717197acb2b8e01c2a6720_1", "is_ignored": false, "lines": "        reg_read(0x8c,&local_1c);", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "reg_read", "end": {"col": 17, "line": 50, "offset": 1505}, "start": {"col": 9, "line": 50, "offset": 1497}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/table_search_mac_vid_004091e8.c", "start": {"col": 9, "line": 50, "offset": 1497}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 33, "line": 108, "offset": 2715}, "extra": {"engine_kind": "OSS", "fingerprint": "ff431054d17a65c3561f07b93a31ddf367f89bdda0d2df8b72a5c10ee0237e689e3254ee5d738ffce57baf7d8b8c00faf4a0a66cd7717197acb2b8e01c2a6720_2", "is_ignored": false, "lines": "        reg_read(0x88,&local_20);", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "reg_read", "end": {"col": 17, "line": 108, "offset": 2699}, "start": {"col": 9, "line": 108, "offset": 2691}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/table_search_mac_vid_004091e8.c", "start": {"col": 9, "line": 108, "offset": 2691}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 33, "line": 112, "offset": 2878}, "extra": {"engine_kind": "OSS", "fingerprint": "ff431054d17a65c3561f07b93a31ddf367f89bdda0d2df8b72a5c10ee0237e689e3254ee5d738ffce57baf7d8b8c00faf4a0a66cd7717197acb2b8e01c2a6720_3", "is_ignored": false, "lines": "        reg_read(0x84,&local_24);", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "reg_read", "end": {"col": 17, "line": 112, "offset": 2862}, "start": {"col": 9, "line": 112, "offset": 2854}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/table_search_mac_vid_004091e8.c", "start": {"col": 9, "line": 112, "offset": 2854}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 30, "line": 20, "offset": 385}, "extra": {"engine_kind": "OSS", "fingerprint": "1074ea69b4c1c963f2ff1206df4c0f77c773e57b5a467527ec5386379fb00ea63897d5e7d10be35d13e26af75cb33a49405d124f625f8533aa1d3945dc54b7c7_0", "is_ignored": false, "lines": "      reg_read(0x90,local_10);", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "reg_read", "end": {"col": 15, "line": 20, "offset": 370}, "start": {"col": 7, "line": 20, "offset": 362}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/vlan_clear_0040b258.c", "start": {"col": 7, "line": 20, "offset": 362}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 57, "line": 19, "offset": 517}, "extra": {"engine_kind": "OSS", "fingerprint": "15564ebd5d0d7dcafee16f429b07deef9c1230522da875fbadeffc3d75dd7f9b592556d956fb563cac02face016b60c611d9c3d86637c86b97da75d7d136ada6_0", "is_ignored": false, "lines": "    while ((local_14 < 0x14 && (reg_read(0x90,&local_10), (int)local_10 < 0))) {", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "reg_read", "end": {"col": 41, "line": 19, "offset": 501}, "start": {"col": 33, "line": 19, "offset": 493}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/vlan_dump_0040ad70.c", "start": {"col": 33, "line": 19, "offset": 493}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 29, "line": 26, "offset": 685}, "extra": {"engine_kind": "OSS", "fingerprint": "15564ebd5d0d7dcafee16f429b07deef9c1230522da875fbadeffc3d75dd7f9b592556d956fb563cac02face016b60c611d9c3d86637c86b97da75d7d136ada6_1", "is_ignored": false, "lines": "    reg_read(0x94,&local_10);", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "reg_read", "end": {"col": 13, "line": 26, "offset": 669}, "start": {"col": 5, "line": 26, "offset": 661}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/vlan_dump_0040ad70.c", "start": {"col": 5, "line": 26, "offset": 661}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 29, "line": 27, "offset": 715}, "extra": {"engine_kind": "OSS", "fingerprint": "15564ebd5d0d7dcafee16f429b07deef9c1230522da875fbadeffc3d75dd7f9b592556d956fb563cac02face016b60c611d9c3d86637c86b97da75d7d136ada6_2", "is_ignored": false, "lines": "    reg_read(0x98,auStack_c);", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "reg_read", "end": {"col": 13, "line": 27, "offset": 699}, "start": {"col": 5, "line": 27, "offset": 691}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/vlan_dump_0040ad70.c", "start": {"col": 5, "line": 27, "offset": 691}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-signed-unsigned-conversion", "end": {"col": 49, "line": 23, "offset": 492}, "extra": {"engine_kind": "OSS", "fingerprint": "a93a51bb1ad4a4ffca85ce786306cdc56353c9f3b8ad7dcdb6cf0498ec6fd8916e371f616ad2c0ab6ee57736a56e4fa1bc6a1fb14e9014c6a28be9698e717df6_0", "is_ignored": false, "lines": "      sVar2 = strlen(*(char **)(param_2 + 0x14));", "message": "The software uses a signed primitive and performs a cast to an unsigned primitive, or uses an unsigned primitive and performs a cast to a signed primitive, which can produce an unexpected value. When the result of a function is to be used as a size parameter, using negative return values can have unexpected results. Although less frequent an issue, unsigned-to-signed conversion can be  the precursor to buffer underwrite conditions. Buffer underwrites  occur frequently when large unsigned values are cast to signed values,  and then used as indexes into a buffer or for pointer arithmetic.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "LOW", "references": ["https://cwe.mitre.org/data/definitions/195", "https://cwe.mitre.org/data/definitions/196", "https://cwe.mitre.org/data/definitions/194", "https://cwe.mitre.org/data/definitions/191", "https://cwe.mitre.org/data/definitions/681", "https://cwe.mitre.org/data/definitions/789", "https://g.co/kgs/PCHQjJ", "https://github.com/struct/mms", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "http://www.phrack.org/issues/60/10.html#article", "https://docs.microsoft.com/en-us/cpp/sanitizers/asan-error-examples"]}, "metavars": {"$SIGNED": {"abstract_content": "param_2", "end": {"col": 40, "line": 23, "offset": 483}, "start": {"col": 33, "line": 23, "offset": 476}}, "$UNSIGNED": {"abstract_content": "sVar2", "end": {"col": 12, "line": 23, "offset": 455}, "start": {"col": 7, "line": 23, "offset": 450}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/vlan_set_0040b3bc.c", "start": {"col": 7, "line": 23, "offset": 450}}, {"check_id": "external.semgrep-rules-0xdea.c.raptor-interesting-api-calls", "end": {"col": 34, "line": 53, "offset": 1715}, "extra": {"engine_kind": "OSS", "fingerprint": "448591364999ee346b8fa0a7ea96cc95edb6bd452467645d25c9aa0c298e373a5dba60b4fd74f20fc85536bd68e12fe84a345521742707eedd78a44059318b15_0", "is_ignored": false, "lines": "          reg_read(0x90,local_10);", "message": "Locate all calls to interesting and potentially insecure API functions (candidate points). The auditor can backtrace from these candidate points to find pathways allowing access from untrusted input.", "metadata": {"author": "Marco Ivaldi <raptor@0xdeadbeef.info>", "confidence": "MEDIUM", "references": ["https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java", "https://github.com/x509cert/banned/blob/master/banned.h", "https://g.co/kgs/PCHQjJ", "https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf", "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/28719-banned-api-usage-use-updated-function-replacement"]}, "metavars": {"$FUN": {"abstract_content": "reg_read", "end": {"col": 19, "line": 53, "offset": 1700}, "start": {"col": 11, "line": 53, "offset": 1692}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/tmp/haruspex_switch/vlan_set_0040b3bc.c", "start": {"col": 11, "line": 53, "offset": 1692}}], "skipped_rules": [], "version": "1.62.0"}
